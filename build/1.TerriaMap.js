webpackJsonp([1],{1933:function(e,t,i){var n,r;n=[i(31),i(1),i(0),i(2),i(3)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e){e=t(e,!0),this.value=o.toValue(e)}return n(o.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),o.toValue=function(e,t){return i(t)?(t[0]=e,t):new Uint8Array([e])},o}.apply(t,n))&&(e.exports=r)},1934:function(e,t,i){var n,r;n=[i(31),i(1),i(0),i(2),i(3)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e,i){e=t(e,0),i=t(i,Number.MAX_VALUE),this.value=new Float32Array([e,i])}return n(o.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),o.fromDistanceDisplayCondition=function(e){return new o(e.near,e.far)},o.toValue=function(e,t){return i(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])},o}.apply(t,n))&&(e.exports=r)},1935:function(e,t,i){var n,r;n=[i(1),i(0),i(2),i(6),i(181),i(2225),i(2226),i(2224),i(2227),i(2228),i(2229),i(303),i(295)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h){"use strict";function p(i){i=e(i,e.EMPTY_OBJECT);var n=e(i.translucent,!0),r=e(i.closed,!1),o=e(i.materialSupport,p.MaterialSupport.TEXTURED);this.material=t(i.material)?i.material:h.fromType(h.ColorType),this.translucent=n,this._vertexShaderSource=e(i.vertexShaderSource,o.vertexShaderSource),this._fragmentShaderSource=e(i.fragmentShaderSource,o.fragmentShaderSource),this._renderState=d.getDefaultRenderState(n,r,i.renderState),this._closed=r,this._materialSupport=o,this._vertexFormat=o.vertexFormat,this._flat=e(i.flat,!1),this._faceForward=e(i.faceForward,!r)}return i(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource,p.prototype.isTranslucent=d.prototype.isTranslucent,p.prototype.getRenderState=d.prototype.getRenderState,p.MaterialSupport={BASIC:n({vertexFormat:r.POSITION_AND_NORMAL,vertexShaderSource:u,fragmentShaderSource:s}),TEXTURED:n({vertexFormat:r.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:l}),ALL:n({vertexFormat:r.ALL,vertexShaderSource:a,fragmentShaderSource:o})},p}.apply(t,n))&&(e.exports=r)},1936:function(e,t,i){var n,r;n=[i(12),i(25),i(1),i(0),i(2),i(21),i(3),i(154),i(15),i(215),i(428),i(159),i(184),i(421),i(425),i(156),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){var t=e.entity,i=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new u,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=i,this._id=i+"-"+t.id,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=f.supportsMaterialsforEntitiesOnTerrain(e.scene)}var v=new p(t.WHITE),y=new m(!0),w=new m(!0),x=new m(!1),C=new m(t.BLACK),T=new m(h.DISABLED),E=new m(new s),A=new m(d.TERRAIN);return r(g.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&_.isConstant(this._showProperty)&&_.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!n(this._entity.availability)&&_.isConstant(this._showProperty)&&_.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),g.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},g.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},g.prototype.createFillGeometryInstance=a.throwInstantiationError,g.prototype.createOutlineGeometryInstance=a.throwInstantiationError,g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){o(this)},g.prototype._isHidden=function(e,t){var i=t.show;return n(i)&&i.isConstant&&!i.getValue(l.MINIMUM_VALUE)},g.prototype._isOnTerrain=function(e,t){return!1},g.prototype._getIsClosed=function(e){return!0},g.prototype._isDynamic=a.throwInstantiationError,g.prototype._setStaticOptions=a.throwInstantiationError,g.prototype._onEntityPropertyChanged=function(e,t,r,o){if(-1!==this._observedPropertyNames.indexOf(t)){var a=this._entity[this._geometryPropertyName];if(!n(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,u=!n(s)||!s.isConstant||s.getValue(l.MINIMUM_VALUE),d=a.outline,h=n(d);if(h&&d.isConstant&&(h=d.getValue(l.MINIMUM_VALUE)),!u&&!h)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var m=a.show;if(this._isHidden(e,a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));this._materialProperty=i(a.material,v),this._fillProperty=i(s,w),this._showProperty=i(m,y),this._showOutlineProperty=i(a.outline,x),this._outlineColorProperty=h?i(a.outlineColor,C):void 0,this._shadowsProperty=i(a.shadows,T),this._distanceDisplayConditionProperty=i(a.distanceDisplayCondition,E),this._classificationTypeProperty=i(a.classificationType,A),this._fillEnabled=u;var f=this._isOnTerrain(e,a)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof p);if(h&&f&&(c(c.geometryOutlines),h=!1),this._onTerrain=f,this._outlineEnabled=h,this._isDynamic(e,a))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,a),this._isClosed=this._getIsClosed(this._options);var _=a.outlineWidth;this._outlineWidth=n(_)?_.getValue(l.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}}},g.prototype.createDynamicUpdater=function(e,t){return new this.constructor.DynamicGeometryUpdater(this,e,t)},g}.apply(t,n))&&(e.exports=r)},1937:function(e,t,i){var n,r;n=[i(38),i(12),i(0),i(21),i(3),i(746),i(1935),i(152),i(183),i(744),i(421),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h){"use strict";function p(e,t,i){this._primitives=t,this._orderedGroundPrimitives=i,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}return p.prototype._isHidden=function(e,t,i){return!e.isShowing||!e.isAvailable(i)||!h.getValueOrDefault(t.show,i,!0)},p.prototype._setOptions=r.throwInstantiationError,p.prototype.update=function(e){var t=this._geometryUpdater,n=t._onTerrain,r=this._primitives,l=this._orderedGroundPrimitives;n?l.remove(this._primitive):(r.removeAndDestroy(this._primitive),r.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var p=this._entity,m=p[this._geometryUpdater._geometryPropertyName];if(this._setOptions(p,m,e),!this._isHidden(p,m,e)){var f=this._geometryUpdater.shadowsProperty.getValue(e),_=this._options;if(!i(m.fill)||m.fill.getValue(e)){var g,v=t.fillMaterialProperty,y=v instanceof c,w=t._getIsClosed(_);if(y)g=new s({closed:w});else{var x=d.getValue(e,v,this._material);this._material=x,g=new a({material:x,translucent:x.isTranslucent(),closed:w})}if(n)_.vertexFormat=s.VERTEX_FORMAT,this._primitive=l.add(new o({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:g,asynchronous:!1,shadows:f,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),h.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{_.vertexFormat=g.vertexFormat;var C=this._geometryUpdater.createFillGeometryInstance(e);y&&(g.translucent=255!==C.attributes.color.value[3]),this._primitive=r.add(new u({geometryInstances:C,appearance:g,asynchronous:!1,shadows:f}))}}if(!n&&i(m.outline)&&m.outline.getValue(e)){var T=this._geometryUpdater.createOutlineGeometryInstance(e),E=h.getValueOrDefault(m.outlineWidth,e,1);this._outlinePrimitive=r.add(new u({geometryInstances:T,appearance:new s({flat:!0,translucent:255!==T.attributes.color.value[3],renderState:{lineWidth:t._scene.clampLineWidth(E)}}),asynchronous:!1,shadows:f}))}}},p.prototype.getBoundingSphere=function(t){var n,r=this._entity,o=this._primitive,a=this._outlinePrimitive;return i(o)&&o.show&&o.ready&&(n=o.getGeometryInstanceAttributes(r),i(n)&&i(n.boundingSphere))?(e.clone(n.boundingSphere,t),l.DONE):i(a)&&a.show&&a.ready&&(n=a.getGeometryInstanceAttributes(r),i(n)&&i(n.boundingSphere))?(e.clone(n.boundingSphere,t),l.DONE):i(o)&&!o.ready||i(a)&&!a.ready?l.PENDING:l.FAILED},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){var e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),n(this)},p}.apply(t,n))&&(e.exports=r)},1938:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({ROUNDED:0,MITERED:1,BEVELED:2})}.apply(t,n))&&(e.exports=r)},1939:function(e,t,i){var n,r;n=[i(25),i(0),i(2),i(3),i(295)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(){n.throwInstantiationError()}return i(o.prototype,{isConstant:{get:n.throwInstantiationError},definitionChanged:{get:n.throwInstantiationError}}),o.prototype.getType=n.throwInstantiationError,o.prototype.getValue=n.throwInstantiationError,o.prototype.equals=n.throwInstantiationError,o.getValue=function(i,n,o){var a;return t(n)&&(a=n.getType(i),t(a))?(t(o)&&o.type===a||(o=r.fromType(a)),n.getValue(i,o.uniforms),o):(t(o)&&o.type===r.ColorType||(o=r.fromType(r.ColorType)),e.clone(e.WHITE,o.uniforms.color),o)},o}.apply(t,n))&&(e.exports=r)},1940:function(e,t,i){var n,r;n=[],void 0!==(r=function(){"use strict";function e(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}return e}.apply(t,n))&&(e.exports=r)},1941:function(e,t,i){var n,r;n=[i(0),i(2),i(3),i(15),i(217),i(131),i(89)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(t,i,n,r){function o(){n.raiseEvent(t)}var a=[];i.removeAll();for(var s=r.length,u=0;u<s;u++){var l=r.get(u);e(l.data)&&-1===a.indexOf(l.data)&&i.add(l.data.definitionChanged,o)}}function u(){this._eventHelper=new r,this._definitionChanged=new n,this._intervals=new o,this._intervals.changedEvent.addEventListener(u.prototype._intervalsChanged,this)}return t(u.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),u.prototype.getValue=function(t,i){var n=this._intervals.findDataForIntervalContainingDate(t);if(e(n))return n.getValue(t,i)},u.prototype.equals=function(e){return this===e||e instanceof u&&this._intervals.equals(e._intervals,a.equals)},u.prototype._intervalsChanged=function(){s(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)},u}.apply(t,n))&&(e.exports=r)},1942:function(e,t,i){var n,r;n=[i(6),i(34)],void 0!==(r=function(e,t){"use strict";var i={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===i.RGBA4||e===i.RGB5_A1||e===i.RGB565||e===i.DEPTH_COMPONENT16||e===i.STENCIL_INDEX8||e===i.DEPTH_STENCIL}};return e(i)}.apply(t,n))&&(e.exports=r)},1943:function(e,t,i){var n,r;n=[i(1),i(0),i(2),i(3),i(15),i(216),i(1941),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s){"use strict";function u(t){this._referenceFrame=e(t,o.FIXED),this._definitionChanged=new r,this._composite=new a,this._composite.definitionChanged.addEventListener(u.prototype._raiseDefinitionChanged,this)}return i(u.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},u.prototype.getValueInReferenceFrame=function(e,i,n){var r=this._composite._intervals.findDataForIntervalContainingDate(e);if(t(r))return r.getValueInReferenceFrame(e,i,n)},u.prototype.equals=function(e){return this===e||e instanceof u&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)},u.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},u}.apply(t,n))&&(e.exports=r)},1944:function(e,t,i){var n,r;n=[i(0),i(2),i(3),i(15),i(26),i(89)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(t){var i=!0;if(t._resolveEntity){var n=t._targetCollection.getById(t._targetId);if(e(n)?(n.definitionChanged.addEventListener(u.prototype._onTargetEntityDefinitionChanged,t),t._targetEntity=n,t._resolveEntity=!1):(n=t._targetEntity,i=!1),!e(n))throw new r('target entity "'+t._targetId+'" could not be resolved.')}return i}function s(t){var i=t._targetProperty;if(t._resolveProperty){var n=a(t),o=t._targetPropertyNames;i=t._targetEntity;for(var s=o.length,u=0;u<s&&e(i);u++)i=i[o[u]];if(e(i))t._targetProperty=i,t._resolveProperty=!n;else if(!e(t._targetProperty))throw new r('targetProperty "'+t._targetId+"."+o.join(".")+'" could not be resolved.')}return i}function u(e,t,i){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=i,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new n,this._resolveEntity=!0,this._resolveProperty=!0,e.collectionChanged.addEventListener(u.prototype._onCollectionChanged,this)}return t(u.prototype,{isConstant:{get:function(){return o.isConstant(s(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return s(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return s(this)}}}),u.fromString=function(e,t){for(var i,n=[],r=!0,o=!1,a="",s=0;s<t.length;++s){var l=t.charAt(s);o?(a+=l,o=!1):"\\"===l?o=!0:r&&"#"===l?(i=a,r=!1,a=""):r||"."!==l?a+=l:(n.push(a),a="")}return n.push(a),new u(e,i,n)},u.prototype.getValue=function(e,t){return s(this).getValue(e,t)},u.prototype.getValueInReferenceFrame=function(e,t,i){return s(this).getValueInReferenceFrame(e,t,i)},u.prototype.getType=function(e){return s(this).getType(e)},u.prototype.equals=function(e){if(this===e)return!0;var t=this._targetPropertyNames,i=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==i.length)return!1;for(var n=this._targetPropertyNames.length,r=0;r<n;r++)if(t[r]!==i[r])return!1;return!0},u.prototype._onTargetEntityDefinitionChanged=function(e,t,i,n){this._targetPropertyNames[0]===t&&(this._resolveProperty=!0,this._definitionChanged.raiseEvent(this))},u.prototype._onCollectionChanged=function(t,i,n){var r=this._targetEntity;e(r)&&(-1!==n.indexOf(r)?(r.definitionChanged.removeEventListener(u.prototype._onTargetEntityDefinitionChanged,this),this._resolveEntity=!0,this._resolveProperty=!0):this._resolveEntity&&(s(this),this._resolveEntity||this._definitionChanged.raiseEvent(this)))},u}.apply(t,n))&&(e.exports=r)},1945:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({START:0,LOADING:1,DONE:2,FAILED:3})}.apply(t,n))&&(e.exports=r)},1946:function(e,t,i){var n,r;n=[i(130),i(38),i(10),i(12),i(31),i(1),i(0),i(3),i(76),i(90),i(129),i(151),i(54),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(e){e=o(e,o.EMPTY_OBJECT);var t=e.minimum,n=e.maximum,r=o(e.vertexFormat,p.DEFAULT);this._minimum=i.clone(t),this._maximum=i.clone(n),this._vertexFormat=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}var f=new i;m.fromDimensions=function(e){e=o(e,o.EMPTY_OBJECT);var t=e.dimensions,n=i.multiplyByScalar(t,.5,new i);return new m({minimum:i.negate(n,new i),maximum:n,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})},m.fromAxisAlignedBoundingBox=function(e){return new m({minimum:e.minimum,maximum:e.maximum})},m.packedLength=2*i.packedLength+p.packedLength+1,m.pack=function(e,t,n){return n=o(n,0),i.pack(e._minimum,t,n),i.pack(e._maximum,t,n+i.packedLength),p.pack(e._vertexFormat,t,n+2*i.packedLength),t[n+2*i.packedLength+p.packedLength]=o(e._offsetAttribute,-1),t};var _=new i,g=new i,v=new p,y={minimum:_,maximum:g,vertexFormat:v,offsetAttribute:void 0};m.unpack=function(e,t,n){t=o(t,0);var r=i.unpack(e,t,_),s=i.unpack(e,t+i.packedLength,g),u=p.unpack(e,t+2*i.packedLength,v),l=e[t+2*i.packedLength+p.packedLength];return a(n)?(n._minimum=i.clone(r,n._minimum),n._maximum=i.clone(s,n._maximum),n._vertexFormat=p.clone(u,n._vertexFormat),n._offsetAttribute=-1===l?void 0:l,n):(y.offsetAttribute=-1===l?void 0:l,new m(y))},m.createGeometry=function(n){var o=n._minimum,s=n._maximum,p=n._vertexFormat;if(!i.equals(o,s)){var m,_,g=new c;if(p.position&&(p.st||p.normal||p.tangent||p.bitangent)){if(p.position&&(_=new Float64Array(72),_[0]=o.x,_[1]=o.y,_[2]=s.z,_[3]=s.x,_[4]=o.y,_[5]=s.z,_[6]=s.x,_[7]=s.y,_[8]=s.z,_[9]=o.x,_[10]=s.y,_[11]=s.z,_[12]=o.x,_[13]=o.y,_[14]=o.z,_[15]=s.x,_[16]=o.y,_[17]=o.z,_[18]=s.x,_[19]=s.y,_[20]=o.z,_[21]=o.x,_[22]=s.y,_[23]=o.z,_[24]=s.x,_[25]=o.y,_[26]=o.z,_[27]=s.x,_[28]=s.y,_[29]=o.z,_[30]=s.x,_[31]=s.y,_[32]=s.z,_[33]=s.x,_[34]=o.y,_[35]=s.z,_[36]=o.x,_[37]=o.y,_[38]=o.z,_[39]=o.x,_[40]=s.y,_[41]=o.z,_[42]=o.x,_[43]=s.y,_[44]=s.z,_[45]=o.x,_[46]=o.y,_[47]=s.z,_[48]=o.x,_[49]=s.y,_[50]=o.z,_[51]=s.x,_[52]=s.y,_[53]=o.z,_[54]=s.x,_[55]=s.y,_[56]=s.z,_[57]=o.x,_[58]=s.y,_[59]=s.z,_[60]=o.x,_[61]=o.y,_[62]=o.z,_[63]=s.x,_[64]=o.y,_[65]=o.z,_[66]=s.x,_[67]=o.y,_[68]=s.z,_[69]=o.x,_[70]=o.y,_[71]=s.z,g.position=new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:_})),p.normal){var v=new Float32Array(72);v[0]=0,v[1]=0,v[2]=1,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=1,v[9]=0,v[10]=0,v[11]=1,v[12]=0,v[13]=0,v[14]=-1,v[15]=0,v[16]=0,v[17]=-1,v[18]=0,v[19]=0,v[20]=-1,v[21]=0,v[22]=0,v[23]=-1,v[24]=1,v[25]=0,v[26]=0,v[27]=1,v[28]=0,v[29]=0,v[30]=1,v[31]=0,v[32]=0,v[33]=1,v[34]=0,v[35]=0,v[36]=-1,v[37]=0,v[38]=0,v[39]=-1,v[40]=0,v[41]=0,v[42]=-1,v[43]=0,v[44]=0,v[45]=-1,v[46]=0,v[47]=0,v[48]=0,v[49]=1,v[50]=0,v[51]=0,v[52]=1,v[53]=0,v[54]=0,v[55]=1,v[56]=0,v[57]=0,v[58]=1,v[59]=0,v[60]=0,v[61]=-1,v[62]=0,v[63]=0,v[64]=-1,v[65]=0,v[66]=0,v[67]=-1,v[68]=0,v[69]=0,v[70]=-1,v[71]=0,g.normal=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:v})}if(p.st){var y=new Float32Array(48);y[0]=0,y[1]=0,y[2]=1,y[3]=0,y[4]=1,y[5]=1,y[6]=0,y[7]=1,y[8]=1,y[9]=0,y[10]=0,y[11]=0,y[12]=0,y[13]=1,y[14]=1,y[15]=1,y[16]=0,y[17]=0,y[18]=1,y[19]=0,y[20]=1,y[21]=1,y[22]=0,y[23]=1,y[24]=1,y[25]=0,y[26]=0,y[27]=0,y[28]=0,y[29]=1,y[30]=1,y[31]=1,y[32]=1,y[33]=0,y[34]=0,y[35]=0,y[36]=0,y[37]=1,y[38]=1,y[39]=1,y[40]=0,y[41]=0,y[42]=1,y[43]=0,y[44]=1,y[45]=1,y[46]=0,y[47]=1,g.st=new l({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:y})}if(p.tangent){var w=new Float32Array(72);w[0]=1,w[1]=0,w[2]=0,w[3]=1,w[4]=0,w[5]=0,w[6]=1,w[7]=0,w[8]=0,w[9]=1,w[10]=0,w[11]=0,w[12]=-1,w[13]=0,w[14]=0,w[15]=-1,w[16]=0,w[17]=0,w[18]=-1,w[19]=0,w[20]=0,w[21]=-1,w[22]=0,w[23]=0,w[24]=0,w[25]=1,w[26]=0,w[27]=0,w[28]=1,w[29]=0,w[30]=0,w[31]=1,w[32]=0,w[33]=0,w[34]=1,w[35]=0,w[36]=0,w[37]=-1,w[38]=0,w[39]=0,w[40]=-1,w[41]=0,w[42]=0,w[43]=-1,w[44]=0,w[45]=0,w[46]=-1,w[47]=0,w[48]=-1,w[49]=0,w[50]=0,w[51]=-1,w[52]=0,w[53]=0,w[54]=-1,w[55]=0,w[56]=0,w[57]=-1,w[58]=0,w[59]=0,w[60]=1,w[61]=0,w[62]=0,w[63]=1,w[64]=0,w[65]=0,w[66]=1,w[67]=0,w[68]=0,w[69]=1,w[70]=0,w[71]=0,g.tangent=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:w})}if(p.bitangent){var x=new Float32Array(72);x[0]=0,x[1]=1,x[2]=0,x[3]=0,x[4]=1,x[5]=0,x[6]=0,x[7]=1,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=1,x[14]=0,x[15]=0,x[16]=1,x[17]=0,x[18]=0,x[19]=1,x[20]=0,x[21]=0,x[22]=1,x[23]=0,x[24]=0,x[25]=0,x[26]=1,x[27]=0,x[28]=0,x[29]=1,x[30]=0,x[31]=0,x[32]=1,x[33]=0,x[34]=0,x[35]=1,x[36]=0,x[37]=0,x[38]=1,x[39]=0,x[40]=0,x[41]=1,x[42]=0,x[43]=0,x[44]=1,x[45]=0,x[46]=0,x[47]=1,x[48]=0,x[49]=0,x[50]=1,x[51]=0,x[52]=0,x[53]=1,x[54]=0,x[55]=0,x[56]=1,x[57]=0,x[58]=0,x[59]=1,x[60]=0,x[61]=0,x[62]=1,x[63]=0,x[64]=0,x[65]=1,x[66]=0,x[67]=0,x[68]=1,x[69]=0,x[70]=0,x[71]=1,g.bitangent=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:x})}m=new Uint16Array(36),m[0]=0,m[1]=1,m[2]=2,m[3]=0,m[4]=2,m[5]=3,m[6]=6,m[7]=5,m[8]=4,m[9]=7,m[10]=6,m[11]=4,m[12]=8,m[13]=9,m[14]=10,m[15]=8,m[16]=10,m[17]=11,m[18]=14,m[19]=13,m[20]=12,m[21]=15,m[22]=14,m[23]=12,m[24]=18,m[25]=17,m[26]=16,m[27]=19,m[28]=18,m[29]=16,m[30]=20,m[31]=21,m[32]=22,m[33]=20,m[34]=22,m[35]=23}else _=new Float64Array(24),_[0]=o.x,_[1]=o.y,_[2]=o.z,_[3]=s.x,_[4]=o.y,_[5]=o.z,_[6]=s.x,_[7]=s.y,_[8]=o.z,_[9]=o.x,_[10]=s.y,_[11]=o.z,_[12]=o.x,_[13]=o.y,_[14]=s.z,_[15]=s.x,_[16]=o.y,_[17]=s.z,_[18]=s.x,_[19]=s.y,_[20]=s.z,_[21]=o.x,_[22]=s.y,_[23]=s.z,g.position=new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:_}),m=new Uint16Array(36),m[0]=4,m[1]=5,m[2]=6,m[3]=4,m[4]=6,m[5]=7,m[6]=1,m[7]=0,m[8]=3,m[9]=1,m[10]=3,m[11]=2,m[12]=1,m[13]=6,m[14]=5,m[15]=1,m[16]=2,m[17]=6,m[18]=2,m[19]=3,m[20]=7,m[21]=2,m[22]=7,m[23]=6,m[24]=3,m[25]=0,m[26]=4,m[27]=3,m[28]=4,m[29]=7,m[30]=0,m[31]=1,m[32]=5,m[33]=0,m[34]=5,m[35]=4;var C=i.subtract(s,o,f),T=.5*i.magnitude(C);if(a(n._offsetAttribute)){var E=_.length,A=new Uint8Array(E/3),P=n._offsetAttribute===d.NONE?0:1;e(A,P),g.applyOffset=new l({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}return new u({attributes:g,indices:m,primitiveType:h.TRIANGLES,boundingSphere:new t(i.ZERO,T),offsetAttribute:n._offsetAttribute})}};var w;return m.getUnitBox=function(){return a(w)||(w=m.createGeometry(m.fromDimensions({dimensions:new i(1,1,1),vertexFormat:p.POSITION_ONLY}))),w},m}.apply(t,n))&&(e.exports=r)},1947:function(e,t,i){var n,r;n=[i(38),i(17),i(10),i(41),i(24),i(1),i(0),i(2),i(3),i(294),i(23),i(225),i(15),i(773),i(761),i(71),i(157),i(9),i(40),i(20),i(289),i(424),i(747),i(59),i(186),i(16),i(50),i(805),i(1955),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D){"use strict";function I(e){this._scene=e,this._transform=y.clone(y.IDENTITY),this._invTransform=y.clone(y.IDENTITY),this._actualTransform=y.clone(y.IDENTITY),this._actualInvTransform=y.clone(y.IDENTITY),this._transformChanged=!1,this.position=new i,this._position=new i,this._positionWC=new i,this._positionCartographic=new r,this.direction=new i,this._direction=new i,this._directionWC=new i,this.up=new i,this._up=new i,this._upWC=new i,this.right=new i,this._right=new i,this._rightWC=new i,this.frustum=new C,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=g.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new h,this._moveEnd=new h,this._changed=new h,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new y,this._invViewMatrix=new y,O(this),this._mode=D.SCENE3D,this._modeChanged=!0;var t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new r(Math.PI,g.PI_OVER_TWO)),this._max2Dfrustum=void 0,this._suspendTerrainAdjustment=!1,q(this,I.DEFAULT_VIEW_RECTANGLE,this.position,!0);var n=i.magnitude(this.position);n+=n*I.DEFAULT_VIEW_FACTOR,i.normalize(this.position,this.position),i.multiplyByScalar(this.position,n,this.position)}function O(e){y.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),y.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),y.inverseTransformation(e._viewMatrix,e._invViewMatrix)}function M(e){P.basisTo2D(e._projection,e._transform,e._actualTransform)}function F(e){var t=e._projection,r=t.ellipsoid,o=y.getColumn(e._transform,3,fe),a=r.cartesianToCartographic(o,he),s=t.project(a,pe),u=_e;u.x=s.z,u.y=s.x,u.z=s.y,u.w=1;var l=n.clone(n.UNIT_X,ye),c=n.add(y.getColumn(e._transform,0,me),o,me);r.cartesianToCartographic(c,a),t.project(a,s);var d=ge;d.x=s.z,d.y=s.x,d.z=s.y,d.w=0,i.subtract(d,u,d),d.x=0;var h=ve;if(i.magnitudeSquared(d)>g.EPSILON10)i.cross(l,d,h);else{var p=n.add(y.getColumn(e._transform,1,me),o,me);r.cartesianToCartographic(p,a),t.project(a,s),h.x=s.z,h.y=s.x,h.z=s.y,h.w=0,i.subtract(h,u,h),h.x=0,i.magnitudeSquared(h)<g.EPSILON10&&(n.clone(n.UNIT_Y,d),n.clone(n.UNIT_Z,h))}i.cross(h,l,d),i.normalize(d,d),i.cross(l,d,h),i.normalize(h,h),y.setColumn(e._actualTransform,0,d,e._actualTransform),y.setColumn(e._actualTransform,1,h,e._actualTransform),y.setColumn(e._actualTransform,2,l,e._actualTransform),y.setColumn(e._actualTransform,3,u,e._actualTransform)}function N(e){var t=e._mode,n=!1,r=0;t===D.SCENE2D&&(r=e.frustum.right-e.frustum.left,n=r!==e._positionCartographic.height);var o=e._position,a=!i.equals(o,e.position)||n;a&&(o=i.clone(e.position,e._position));var s=e._direction,u=!i.equals(s,e.direction);u&&(i.normalize(e.direction,e.direction),s=i.clone(e.direction,e._direction));var l=e._up,c=!i.equals(l,e.up);c&&(i.normalize(e.up,e.up),l=i.clone(e.up,e._up));var d=e._right,h=!i.equals(d,e.right);h&&(i.normalize(e.right,e.right),d=i.clone(e.right,e._right));var p=e._transformChanged||e._modeChanged;e._transformChanged=!1,p&&(y.inverseTransformation(e._transform,e._invTransform),e._mode===D.COLUMBUS_VIEW||e._mode===D.SCENE2D?y.equals(y.IDENTITY,e._transform)?y.clone(I.TRANSFORM_2D,e._actualTransform):e._mode===D.COLUMBUS_VIEW?M(e):F(e):y.clone(e._transform,e._actualTransform),y.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);var m=e._actualTransform;if(a||p)if(e._positionWC=y.multiplyByPoint(m,o,e._positionWC),t===D.SCENE3D||t===D.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{var f=we;f.x=e._positionWC.y,f.y=e._positionWC.z,f.z=e._positionWC.x,t===D.SCENE2D&&(f.z=r),e._projection.unproject(f,e._positionCartographic)}if(u||c||h){var _=i.dot(s,i.cross(l,d,we));if(Math.abs(1-_)>g.EPSILON2){var v=1/i.magnitudeSquared(l),w=i.dot(l,s)*v,x=i.multiplyByScalar(s,w,we);l=i.normalize(i.subtract(l,x,e._up),e._up),i.clone(l,e.up),d=i.cross(s,l,e._right),i.clone(d,e.right)}}(u||p)&&(e._directionWC=y.multiplyByPointAsVector(m,s,e._directionWC),i.normalize(e._directionWC,e._directionWC)),(c||p)&&(e._upWC=y.multiplyByPointAsVector(m,l,e._upWC),i.normalize(e._upWC,e._upWC)),(h||p)&&(e._rightWC=y.multiplyByPointAsVector(m,d,e._rightWC),i.normalize(e._rightWC,e._rightWC)),(a||u||c||h||p)&&O(e)}function L(e,t){var i;return i=g.equalsEpsilon(Math.abs(e.z),1,g.EPSILON3)?Math.atan2(t.y,t.x)-g.PI_OVER_TWO:Math.atan2(e.y,e.x)-g.PI_OVER_TWO,g.TWO_PI-g.zeroToTwoPi(i)}function R(e){return g.PI_OVER_TWO-g.acosClamped(e.z)}function V(e,t,i){var n=0;return g.equalsEpsilon(Math.abs(e.z),1,g.EPSILON3)||(n=Math.atan2(-i.z,t.z),n=g.zeroToTwoPi(n+g.TWO_PI)),n}function U(e,t,n){var r=y.clone(e.transform,Oe),o=P.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,Me);e._setTransform(o),i.clone(i.ZERO,e.position),n.heading=n.heading-g.PI_OVER_TWO;var a=T.fromHeadingPitchRoll(n,Fe),s=v.fromQuaternion(a,Ne);v.getColumn(s,0,e.direction),v.getColumn(s,2,e.up),i.cross(e.direction,e.up,e.right),e._setTransform(r),e._adjustOrthographicFrustum(!0)}function z(e,t,n,r){var o=y.clone(e.transform,Oe);if(e._setTransform(y.IDENTITY),!i.equals(t,e.positionWC)){if(r){var a=e._projection,s=a.ellipsoid.cartesianToCartographic(t,Le);t=a.project(s,Ie)}i.clone(t,e.position)}n.heading=n.heading-g.PI_OVER_TWO;var u=T.fromHeadingPitchRoll(n,Fe),l=v.fromQuaternion(u,Ne);v.getColumn(l,0,e.direction),v.getColumn(l,2,e.up),i.cross(e.direction,e.up,e.right),e._setTransform(o),e._adjustOrthographicFrustum(!0)}function B(e,n,r,o){var a=y.clone(e.transform,Oe);if(e._setTransform(y.IDENTITY),!i.equals(n,e.positionWC)){if(o){var s=e._projection,u=s.ellipsoid.cartesianToCartographic(n,Le);n=s.project(u,Ie)}t.clone(n,e.position);var l=.5*-n.z,c=-l,d=e.frustum;if(c>l){var h=d.top/d.right;d.right=c,d.left=l,d.top=d.right*h,d.bottom=-d.top}}if(e._scene.mapMode2D===b.ROTATE){r.heading=r.heading-g.PI_OVER_TWO,r.pitch=-g.PI_OVER_TWO,r.roll=0;var p=T.fromHeadingPitchRoll(r,Fe),m=v.fromQuaternion(p,Ne);v.getColumn(m,2,e.up),i.cross(e.direction,e.up,e.right)}e._setTransform(a)}function H(e,t,n,r){var o=i.clone(n.direction,Re),a=i.clone(n.up,Ve);if(e._scene.mode===D.SCENE3D){var s=e._projection.ellipsoid,u=P.eastNorthUpToFixedFrame(t,s,xe),l=y.inverseTransformation(u,Ce);y.multiplyByPointAsVector(l,o,o),y.multiplyByPointAsVector(l,a,a)}var c=i.cross(o,a,Ue);return r.heading=L(o,a),r.pitch=R(o),r.roll=V(o,a,c),r}function k(e,t){var i,n,r=e._scene.mapMode2D===b.ROTATE,o=e._maxCoord.x,a=e._maxCoord.y;r?(n=o,i=-n):(n=t.x-2*o,i=t.x+2*o),t.x>o&&(t.x=n),t.x<-o&&(t.x=i),t.y>a&&(t.y=a),t.y<-a&&(t.y=-a)}function G(e,t){var n=e.position,r=i.normalize(n,Xe);if(a(e.constrainedAxis)){var o=i.equalsEpsilon(r,e.constrainedAxis,g.EPSILON2),s=i.equalsEpsilon(r,i.negate(e.constrainedAxis,Ze),g.EPSILON2);if(o||s)(o&&t<0||s&&t>0)&&e.rotate(e.right,t);else{var u=i.normalize(e.constrainedAxis,Qe),l=i.dot(r,u),c=g.acosClamped(l);t>0&&t>c&&(t=c-g.EPSILON4),l=i.dot(r,i.negate(u,Ze)),c=g.acosClamped(l),t<0&&-t>c&&(t=-c+g.EPSILON4);var d=i.cross(u,r,qe);e.rotate(d,t)}}else e.rotate(e.right,t)}function W(e,t){a(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function Y(e,t){var i,n=e.frustum;if(t*=.5,Math.abs(n.top)+Math.abs(n.bottom)>Math.abs(n.left)+Math.abs(n.right)){var r=n.top-t,o=n.bottom+t,a=e._maxCoord.y;e._scene.mapMode2D===b.ROTATE&&(a*=e.maximumZoomFactor),o>a&&(o=a,r=-a),r<=o&&(r=1,o=-1),i=n.right/n.top,n.top=r,n.bottom=o,n.right=n.top*i,n.left=-n.right}else{var s=n.right-t,u=n.left+t,l=e._maxCoord.x;e._scene.mapMode2D===b.ROTATE&&(l*=e.maximumZoomFactor),s>l&&(s=l,u=-l),s<=u&&(s=1,u=-1),i=n.top/n.right,n.right=s,n.left=u,n.top=n.right*i,n.bottom=-n.top}}function j(e,t){e.move(e.direction,t)}function X(e,t,n){t=g.clamp(t,-g.PI_OVER_TWO,g.PI_OVER_TWO),e=g.zeroToTwoPi(e)-g.PI_OVER_TWO;var r=T.fromAxisAngle(i.UNIT_Y,-t,$e),o=T.fromAxisAngle(i.UNIT_Z,-e,et),a=T.multiply(o,r,o),s=v.fromQuaternion(a,tt),u=i.clone(i.UNIT_X,Je);return v.multiplyByVector(s,u,u),i.negate(u,u),i.multiplyByScalar(u,n,u),u}function Q(e,t,n,r){return Math.abs(i.dot(t,n))/r-i.dot(e,n)}function q(e,t,n,r){var o=e._projection.ellipsoid,s=r?e:pt,u=t.north,l=t.south,c=t.east,h=t.west;h>c&&(c+=g.TWO_PI);var p,m=.5*(h+c);if(l<-g.PI_OVER_TWO+g.RADIANS_PER_DEGREE&&u>g.PI_OVER_TWO-g.RADIANS_PER_DEGREE)p=0;else{var f=nt;f.longitude=m,f.latitude=u,f.height=0;var _=rt;_.longitude=m,_.latitude=l,_.height=0;var v=it;a(v)&&v.ellipsoid===o||(it=v=new d(void 0,void 0,o)),v.setEndPoints(f,_),p=v.interpolateUsingFraction(.5,nt).latitude}var y=nt;y.longitude=m,y.latitude=p,y.height=0;var x=o.cartographicToCartesian(y,dt),C=nt;C.longitude=c,C.latitude=u;var T=o.cartographicToCartesian(C,ot);C.longitude=h;var E=o.cartographicToCartesian(C,st);C.longitude=m;var A=o.cartographicToCartesian(C,lt);C.latitude=l;var P=o.cartographicToCartesian(C,ct);C.longitude=c;var S=o.cartographicToCartesian(C,ut);C.longitude=h;var b=o.cartographicToCartesian(C,at);i.subtract(E,x,E),i.subtract(S,x,S),i.subtract(T,x,T),i.subtract(b,x,b),i.subtract(A,x,A),i.subtract(P,x,P);var D=o.geodeticSurfaceNormal(x,s.direction);i.negate(D,D);var I=i.cross(D,i.UNIT_Z,s.right);i.normalize(I,I);var O,M=i.cross(I,D,s.up);if(e.frustum instanceof w){var F,N,L=Math.max(i.distance(T,E),i.distance(S,b)),R=Math.max(i.distance(T,S),i.distance(E,b)),V=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top,U=R*V;L>U?(F=L,N=F/V):(N=R,F=U),O=Math.max(F,N)}else{var z=Math.tan(.5*e.frustum.fovy),B=e.frustum.aspectRatio*z;if(O=Math.max(Q(D,M,E,z),Q(D,M,S,z),Q(D,M,T,z),Q(D,M,b,z),Q(D,M,A,z),Q(D,M,P,z),Q(D,I,E,B),Q(D,I,S,B),Q(D,I,T,B),Q(D,I,b,B),Q(D,I,A,B),Q(D,I,P,B)),l<0&&u>0){var H=nt;H.longitude=h,H.latitude=0,H.height=0;var k=o.cartographicToCartesian(H,ht);i.subtract(k,x,k),O=Math.max(O,Q(D,M,k,z),Q(D,I,k,B)),H.longitude=c,k=o.cartographicToCartesian(H,ht),i.subtract(k,x,k),O=Math.max(O,Q(D,M,k,z),Q(D,I,k,B))}}return i.add(x,i.multiplyByScalar(D,-O,ht),n)}function Z(e,t,i){var n=e._projection;t.west>t.east&&(t=A.MAX_VALUE);var r=e._actualTransform,o=e._actualInvTransform,s=mt;s.longitude=t.east,s.latitude=t.north;var u=n.project(s,ft);y.multiplyByPoint(r,u,u),y.multiplyByPoint(o,u,u),s.longitude=t.west,s.latitude=t.south;var l=n.project(s,_t);if(y.multiplyByPoint(r,l,l),y.multiplyByPoint(o,l,l),i.x=.5*(u.x-l.x)+l.x,i.y=.5*(u.y-l.y)+l.y,a(e.frustum.fovy)){var c=Math.tan(.5*e.frustum.fovy),d=e.frustum.aspectRatio*c;i.z=.5*Math.max((u.x-l.x)/d,(u.y-l.y)/c)}else{var h=u.x-l.x,p=u.y-l.y;i.z=Math.max(h,p)}return i}function K(e,t,i){var n=e._projection;t.west>t.east&&(t=A.MAX_VALUE);var r=gt;r.longitude=t.east,r.latitude=t.north;var o=n.project(r,vt);r.longitude=t.west,r.latitude=t.south;var a,s,u=n.project(r,yt),l=.5*Math.abs(o.x-u.x),c=.5*Math.abs(o.y-u.y),d=e.frustum.right/e.frustum.top,h=c*d;return l>h?(a=l,s=a/d):(s=c,a=h),c=Math.max(2*a,2*s),i.x=.5*(o.x-u.x)+u.x,i.y=.5*(o.y-u.y)+u.y,r=n.unproject(i,r),r.height=c,i=n.project(r,i)}function J(e,t,i,n){i=o(i,c.WGS84);var r=e.getPickRay(t,wt),a=_.rayEllipsoid(r,i);if(a){var s=a.start>0?a.start:a.stop;return E.getPoint(r,s,n)}}function $(e,t,n,r){var o=e.getPickRay(t,xt),a=o.origin;a=i.fromElements(a.y,a.z,0,a);var s=n.unproject(a);if(!(s.latitude<-g.PI_OVER_TWO||s.latitude>g.PI_OVER_TWO))return n.ellipsoid.cartographicToCartesian(s,r)}function ee(e,t,n,r){var o=e.getPickRay(t,Ct),a=-o.origin.x/o.direction.x;E.getPoint(o,a,r);var s=n.unproject(new i(r.y,r.z,0));if(!(s.latitude<-g.PI_OVER_TWO||s.latitude>g.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return n.ellipsoid.cartographicToCartesian(s,r)}function te(e,t,n){var r=e._scene.canvas,o=r.clientWidth,a=r.clientHeight,s=Math.tan(.5*e.frustum.fovy),u=e.frustum.aspectRatio*s,l=e.frustum.near,c=2/o*t.x-1,d=2/a*(a-t.y)-1,h=e.positionWC;i.clone(h,n.origin);var p=i.multiplyByScalar(e.directionWC,l,Tt);i.add(h,p,p);var m=i.multiplyByScalar(e.rightWC,c*l*u,Et),f=i.multiplyByScalar(e.upWC,d*l*s,At),_=i.add(p,m,n.direction);return i.add(_,f,_),i.subtract(_,h,_),i.normalize(_,_),n}function ie(e,t,n){var r=e._scene.canvas,o=r.clientWidth,s=r.clientHeight,u=e.frustum;a(u._offCenterFrustum)&&(u=u._offCenterFrustum);var l=2/o*t.x-1;l*=.5*(u.right-u.left);var c=2/s*(s-t.y)-1;c*=.5*(u.top-u.bottom);var d=n.origin;return i.clone(e.position,d),i.multiplyByScalar(e.right,l,Pt),i.add(Pt,d,d),i.multiplyByScalar(e.up,c,Pt),i.add(Pt,d,d),i.clone(e.directionWC,n.direction),e._mode!==D.COLUMBUS_VIEW&&e._mode!==D.SCENE2D||i.fromElements(n.origin.z,n.origin.x,n.origin.y,n.origin),n}function ne(e,t,n,r,o,a){function s(n){var r=i.lerp(t,u,n.time,new i);e.worldToCameraCoordinatesPoint(r,e.position)}var u=i.clone(t);return n.y>r?u.y-=n.y-r:n.y<-r&&(u.y+=-r-n.y),n.z>o?u.z-=n.z-o:n.z<-o&&(u.z+=-o-n.z),{easingFunction:l.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:a,update:s}}function re(e,t){var n=e.position,r=e.direction,o=e.worldToCameraCoordinatesVector(i.UNIT_X,It),a=-i.dot(o,n)/i.dot(o,r),s=i.add(n,i.multiplyByScalar(r,a,Ot),Ot);e.cameraToWorldCoordinatesPoint(s,s),n=e.cameraToWorldCoordinatesPoint(e.position,Mt);var u=Math.tan(.5*e.frustum.fovy),l=e.frustum.aspectRatio*u,c=i.magnitude(i.subtract(n,s,Ft)),d=l*c,h=u*c,p=e._maxCoord.x,m=e._maxCoord.y,f=Math.max(d-p,p),_=Math.max(h-m,m);if(n.z<-f||n.z>f||n.y<-_||n.y>_){var g=s.y<-f||s.y>f,v=s.z<-_||s.z>_;if(g||v)return ne(e,n,s,f,_,t)}}function oe(e,t){var i=e.frustum,n=Math.tan(.5*i.fovy),r=i.aspectRatio*n;return Math.max(t/r,t/n)}function ae(e,t){var i=e.frustum;a(i._offCenterFrustum)&&(i=i._offCenterFrustum);var n,r,o=i.right/i.top,s=t*o;return t>s?(n=t,r=n/o):(r=t,n=s),1.5*Math.max(n,r)}function se(e,t,i){a(i)||(i=p.clone(I.DEFAULT_OFFSET));var n=e._scene.screenSpaceCameraController.minimumZoomDistance,r=e._scene.screenSpaceCameraController.maximumZoomDistance,o=i.range;if(!a(o)||0===o){var s=t.radius;0===s?i.range=Rt:e.frustum instanceof w||e._mode===D.SCENE2D?i.range=ae(e,s):i.range=oe(e,s),i.range=g.clamp(i.range,n,r)}return i}function ue(e,t){var n,r,o=t.radii,a=e.positionWC,s=i.multiplyComponents(t.oneOverRadii,a,Yt),u=i.magnitude(s),l=i.normalize(s,jt);i.equalsEpsilon(l,i.UNIT_Z,g.EPSILON10)?(n=new i(0,1,0),r=new i(0,0,1)):(n=i.normalize(i.cross(i.UNIT_Z,l,Xt),Xt),r=i.normalize(i.cross(l,n,Qt),Qt));var c=Math.sqrt(i.magnitudeSquared(s)-1),d=i.multiplyByScalar(l,1/u,Yt),h=c/u,p=i.multiplyByScalar(n,h,jt),m=i.multiplyByScalar(r,h,Xt),f=i.add(d,m,qt[0]);i.subtract(f,p,f),i.multiplyComponents(o,f,f);var _=i.subtract(d,m,qt[1]);i.subtract(_,p,_),i.multiplyComponents(o,_,_);var v=i.subtract(d,m,qt[2]);i.add(v,p,v),i.multiplyComponents(o,v,v);var y=i.add(d,m,qt[3]);return i.add(y,p,y),i.multiplyComponents(o,y,y),qt}function le(e,t,i,n,r,o){Zt.x=e,Zt.y=t;var s=n.pickEllipsoid(Zt,r,Kt);return a(s)?(Jt[i]=r.cartesianToCartographic(s,Jt[i]),1):(Jt[i]=r.cartesianToCartographic(o[i],Jt[i]),0)}I.TRANSFORM_2D=new y(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),I.TRANSFORM_2D_INVERSE=y.inverseTransformation(I.TRANSFORM_2D,new y),I.DEFAULT_VIEW_RECTANGLE=A.fromDegrees(-95,-20,-70,90),I.DEFAULT_VIEW_FACTOR=.5,I.DEFAULT_OFFSET=new p(0,-g.PI_OVER_FOUR,0),I.prototype._updateCameraChanged=function(){var e=this;if(0!==e._changed.numberOfListeners){var t=e.percentageChanged;if(e._mode===D.SCENE2D){if(!a(e._changedFrustum))return e._changedPosition=i.clone(e.position,e._changedPosition),void(e._changedFrustum=e.frustum.clone());var n,r=e.position,o=e._changedPosition,s=e.frustum,u=e._changedFrustum,l=r.x+s.left,c=r.x+s.right,d=o.x+u.left,h=o.x+u.right,p=r.y+s.bottom,m=r.y+s.top,f=o.y+u.bottom,_=o.y+u.top,v=Math.max(l,d),y=Math.min(c,h),w=Math.max(p,f),x=Math.min(m,_);if(v>=y||w>=m)n=1;else{var C=u;l<d&&c>h&&p<f&&m>_&&(C=s),n=1-(y-v)*(x-w)/((C.right-C.left)*(C.top-C.bottom))}return void(n>t&&(e._changed.raiseEvent(n),e._changedPosition=i.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone(e._changedFrustum)))}if(!a(e._changedDirection))return e._changedPosition=i.clone(e.positionWC,e._changedPosition),void(e._changedDirection=i.clone(e.directionWC,e._changedDirection));var T,E=g.acosClamped(i.dot(e.directionWC,e._changedDirection));T=a(e.frustum.fovy)?E/(.5*e.frustum.fovy):E;var A=i.distance(e.positionWC,e._changedPosition),P=A/e.positionCartographic.height;(T>t||P>t)&&(e._changed.raiseEvent(Math.max(T,P)),e._changedPosition=i.clone(e.positionWC,e._changedPosition),e._changedDirection=i.clone(e.directionWC,e._changedDirection))}};var ce=new y,de=new r;I.prototype._adjustHeightForTerrain=function(){var e=this._scene,t=e.screenSpaceCameraController,n=t.enableCollisionDetection,r=t.minimumCollisionTerrainHeight,o=t.minimumZoomDistance;if(!this._suspendTerrainAdjustment&&n){var s=this._mode,u=e.globe;if(a(u)&&s!==D.SCENE2D&&s!==D.MORPHING){var l,c,d=u.ellipsoid,h=e.mapProjection;y.equals(this.transform,y.IDENTITY)||(l=y.clone(this.transform,ce),c=i.magnitude(this.position),this._setTransform(y.IDENTITY));var p=de;s===D.SCENE3D?d.cartesianToCartographic(this.position,p):h.unproject(this.position,p);var m=!1;if(p.height<r){var f=u.getHeight(p);a(f)&&(f+=o,p.height<f&&(p.height=f,s===D.SCENE3D?d.cartographicToCartesian(p,this.position):h.project(p,this.position),m=!0))}a(l)&&(this._setTransform(l),m&&(i.normalize(this.position,this.position),i.negate(this.position,this.direction),i.multiplyByScalar(this.position,Math.max(c,o),this.position),i.normalize(this.direction,this.direction),i.cross(this.direction,this.up,this.right),i.cross(this.right,this.direction,this.up)))}}};var he=new r,pe=new i,me=new i,fe=new n,_e=new n,ge=new n,ve=new n,ye=new n,we=new i,xe=new y,Ce=new y;s(I.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return N(this),this._invTransform}},viewMatrix:{get:function(){return N(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return N(this),this._invViewMatrix}},positionCartographic:{get:function(){return N(this),this._positionCartographic}},positionWC:{get:function(){return N(this),this._positionWC}},directionWC:{get:function(){return N(this),this._directionWC}},upWC:{get:function(){return N(this),this._upWC}},rightWC:{get:function(){return N(this),this._rightWC}},heading:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid,t=y.clone(this._transform,xe),i=P.eastNorthUpToFixedFrame(this.positionWC,e,Ce);this._setTransform(i);var n=L(this.direction,this.up);return this._setTransform(t),n}}},pitch:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid,t=y.clone(this._transform,xe),i=P.eastNorthUpToFixedFrame(this.positionWC,e,Ce);this._setTransform(i);var n=R(this.direction);return this._setTransform(t),n}}},roll:{get:function(){if(this._mode!==D.MORPHING){var e=this._projection.ellipsoid,t=y.clone(this._transform,xe),i=P.eastNorthUpToFixedFrame(this.positionWC,e,Ce);this._setTransform(i);var n=V(this.direction,this.up,this.right);return this._setTransform(t),n}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),I.prototype.update=function(e){var t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==D.MORPHING,t=this._mode===D.SCENE2D),t){var i=this._max2Dfrustum=this.frustum.clone(),n=i.top/i.right;i.right=2*this._maxCoord.x,i.left=-i.right,i.top=n*i.right,i.bottom=-i.top}this._mode===D.SCENE2D&&k(this,this.position);var r=this._scene.globe,o=!a(r)||r._surface.tileProvider.ready&&0===r._surface._tileLoadQueueHigh.length&&0===r._surface._tileLoadQueueMedium.length&&0===r._surface._tileLoadQueueLow.length&&0===r._surface._debug.tilesWaitingForChildren;this._suspendTerrainAdjustment&&(this._suspendTerrainAdjustment=!o),o&&this._adjustHeightForTerrain()};var Te=new i,Ee=new i,Ae=new i;I.prototype._setTransform=function(e){var t=i.clone(this.positionWC,Te),n=i.clone(this.upWC,Ee),r=i.clone(this.directionWC,Ae);y.clone(e,this._transform),this._transformChanged=!0,N(this);var o=this._actualInvTransform;y.multiplyByPoint(o,t,this.position),y.multiplyByPointAsVector(o,r,this.direction),y.multiplyByPointAsVector(o,n,this.up),i.cross(this.direction,this.up,this.right),N(this)};var Pe=new t,Se=new E,be=new i,De=new i;I.prototype._adjustOrthographicFrustum=function(e){if(this.frustum instanceof w&&(e||!(this._positionCartographic.height<15e4))){if(!y.equals(y.IDENTITY,this.transform))return void(this.frustum.width=i.magnitude(this.position));var t,n,r=this._scene,o=r.globe;if(a(o)){var s=Pe;s.x=r.drawingBufferWidth/2,s.y=r.drawingBufferHeight/2;var u=this.getPickRay(s,Se);if(t=o.pickWorldCoordinates(u,r,be),r.pickPositionSupported&&(n=r.pickPositionWorldCoordinates(s,De)),a(t)&&a(n)){var l=a(n)?i.distance(n,this.positionWC):Number.POSITIVE_INFINITY,c=a(t)?i.distance(t,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(l,c)}else a(n)?this.frustum.width=i.distance(n,this.positionWC):a(t)&&(this.frustum.width=i.distance(t,this.positionWC))}if(!a(o)||!a(t)&&!a(n)){var d=Math.max(this.positionCartographic.height,0);this.frustum.width=d}}};var Ie=new i,Oe=new y,Me=new y,Fe=new T,Ne=new v,Le=new r,Re=new i,Ve=new i,Ue=new i,ze={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},Be=new m;I.prototype.setView=function(e){e=o(e,o.EMPTY_OBJECT);var t=o(e.orientation,o.EMPTY_OBJECT),n=this._mode;if(n!==D.MORPHING){a(e.endTransform)&&this._setTransform(e.endTransform);var r=o(e.convert,!0),s=o(e.destination,i.clone(this.positionWC,Ie));a(s)&&a(s.west)&&(s=this.getRectangleCameraCoordinates(s,Ie),r=!1),a(t.direction)&&(t=H(this,s,t,ze.orientation)),Be.heading=o(t.heading,0),Be.pitch=o(t.pitch,-g.PI_OVER_TWO),Be.roll=o(t.roll,0),this._suspendTerrainAdjustment=!0,n===D.SCENE3D?U(this,s,Be):n===D.SCENE2D?B(this,s,Be,r):z(this,s,Be,r)}};var He=new i;I.prototype.flyHome=function(e){var t=this._mode;if(t===D.MORPHING&&this._scene.completeMorph(),t===D.SCENE2D)this.flyTo({destination:I.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:y.IDENTITY});else if(t===D.SCENE3D){var n=this.getRectangleCameraCoordinates(I.DEFAULT_VIEW_RECTANGLE),r=i.magnitude(n);r+=r*I.DEFAULT_VIEW_FACTOR,i.normalize(n,n),i.multiplyByScalar(n,r,n),this.flyTo({destination:n,duration:e,endTransform:y.IDENTITY})}else if(t===D.COLUMBUS_VIEW){var o=this._projection.ellipsoid.maximumRadius,a=new i(0,-1,1);a=i.multiplyByScalar(i.normalize(a,a),5*o,a),this.flyTo({destination:a,duration:e,orientation:{heading:0,pitch:-Math.acos(i.normalize(a,He).z),roll:0},endTransform:y.IDENTITY,convert:!1})}},I.prototype.worldToCameraCoordinates=function(e,t){return a(t)||(t=new n),N(this),y.multiplyByVector(this._actualInvTransform,e,t)},I.prototype.worldToCameraCoordinatesPoint=function(e,t){return a(t)||(t=new i),N(this),y.multiplyByPoint(this._actualInvTransform,e,t)},I.prototype.worldToCameraCoordinatesVector=function(e,t){return a(t)||(t=new i),N(this),y.multiplyByPointAsVector(this._actualInvTransform,e,t)},I.prototype.cameraToWorldCoordinates=function(e,t){return a(t)||(t=new n),N(this),y.multiplyByVector(this._actualTransform,e,t)},I.prototype.cameraToWorldCoordinatesPoint=function(e,t){return a(t)||(t=new i),N(this),y.multiplyByPoint(this._actualTransform,e,t)},I.prototype.cameraToWorldCoordinatesVector=function(e,t){return a(t)||(t=new i),N(this),y.multiplyByPointAsVector(this._actualTransform,e,t)};var ke=new i;I.prototype.move=function(e,t){var n=this.position;i.multiplyByScalar(e,t,ke),i.add(n,ke,n),this._mode===D.SCENE2D&&k(this,n),this._adjustOrthographicFrustum(!0)},I.prototype.moveForward=function(e){e=o(e,this.defaultMoveAmount),this._mode===D.SCENE2D?Y(this,e):this.move(this.direction,e)},I.prototype.moveBackward=function(e){e=o(e,this.defaultMoveAmount),this._mode===D.SCENE2D?Y(this,-e):this.move(this.direction,-e)},I.prototype.moveUp=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,e)},I.prototype.moveDown=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,-e)},I.prototype.moveRight=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,e)},I.prototype.moveLeft=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,-e)},I.prototype.lookLeft=function(e){e=o(e,this.defaultLookAmount),this._mode!==D.SCENE2D&&this.look(this.up,-e)},I.prototype.lookRight=function(e){e=o(e,this.defaultLookAmount),this._mode!==D.SCENE2D&&this.look(this.up,e)},I.prototype.lookUp=function(e){e=o(e,this.defaultLookAmount),this._mode!==D.SCENE2D&&this.look(this.right,-e)},I.prototype.lookDown=function(e){e=o(e,this.defaultLookAmount),this._mode!==D.SCENE2D&&this.look(this.right,e)};var Ge=new T,We=new v;I.prototype.look=function(e,t){var i=o(t,this.defaultLookAmount),n=T.fromAxisAngle(e,-i,Ge),r=v.fromQuaternion(n,We),a=this.direction,s=this.up,u=this.right;v.multiplyByVector(r,a,a),v.multiplyByVector(r,s,s),v.multiplyByVector(r,u,u)},I.prototype.twistLeft=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,e)},I.prototype.twistRight=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,-e)};var Ye=new T,je=new v;I.prototype.rotate=function(e,t){var n=o(t,this.defaultRotateAmount),r=T.fromAxisAngle(e,-n,Ye),a=v.fromQuaternion(r,je);v.multiplyByVector(a,this.position,this.position),v.multiplyByVector(a,this.direction,this.direction),v.multiplyByVector(a,this.up,this.up),i.cross(this.direction,this.up,this.right),i.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},I.prototype.rotateDown=function(e){e=o(e,this.defaultRotateAmount),G(this,e)},I.prototype.rotateUp=function(e){e=o(e,this.defaultRotateAmount),G(this,-e)};var Xe=new i,Qe=new i,qe=new i,Ze=new i;I.prototype.rotateRight=function(e){e=o(e,this.defaultRotateAmount),W(this,-e)},I.prototype.rotateLeft=function(e){e=o(e,this.defaultRotateAmount),W(this,e)},I.prototype.zoomIn=function(e){e=o(e,this.defaultZoomAmount),this._mode===D.SCENE2D?Y(this,e):j(this,e)},I.prototype.zoomOut=function(e){e=o(e,this.defaultZoomAmount),this._mode===D.SCENE2D?Y(this,-e):j(this,-e)},I.prototype.getMagnitude=function(){return this._mode===D.SCENE3D?i.magnitude(this.position):this._mode===D.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===D.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var Ke=new y;I.prototype.lookAt=function(e,t){var i=P.eastNorthUpToFixedFrame(e,c.WGS84,Ke);this.lookAtTransform(i,t)};var Je=new i,$e=new T,et=new T,tt=new v;I.prototype.lookAtTransform=function(e,n){if(this._setTransform(e),a(n)){var r;if(r=a(n.heading)?X(n.heading,n.pitch,n.range):n,this._mode===D.SCENE2D){t.clone(t.ZERO,this.position),i.negate(r,this.up),this.up.z=0,i.magnitudeSquared(this.up)<g.EPSILON10&&i.clone(i.UNIT_Y,this.up),i.normalize(this.up,this.up),this._setTransform(y.IDENTITY),i.negate(i.UNIT_Z,this.direction),i.cross(this.direction,this.up,this.right),i.normalize(this.right,this.right);var o=this.frustum,s=o.top/o.right;return o.right=.5*i.magnitude(r),o.left=-o.right,o.top=s*o.right,o.bottom=-o.top,void this._setTransform(e)}i.clone(r,this.position),i.negate(this.position,this.direction),i.normalize(this.direction,this.direction),i.cross(this.direction,i.UNIT_Z,this.right),i.magnitudeSquared(this.right)<g.EPSILON10&&i.clone(i.UNIT_X,this.right),i.normalize(this.right,this.right),i.cross(this.right,this.direction,this.up),i.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)}};var it,nt=new r,rt=new r,ot=new i,at=new i,st=new i,ut=new i,lt=new i,ct=new i,dt=new i,ht=new i,pt={direction:new i,right:new i,up:new i},mt=new r,ft=new i,_t=new i,gt=new r,vt=new i,yt=new i;I.prototype.getRectangleCameraCoordinates=function(e,t){var n=this._mode;return a(t)||(t=new i),n===D.SCENE3D?q(this,e,t):n===D.COLUMBUS_VIEW?Z(this,e,t):n===D.SCENE2D?K(this,e,t):void 0};var wt=new E,xt=new E,Ct=new E;I.prototype.pickEllipsoid=function(e,t,n){var r=this._scene.canvas;if(0!==r.clientWidth&&0!==r.clientHeight){if(a(n)||(n=new i),t=o(t,c.WGS84),this._mode===D.SCENE3D)n=J(this,e,t,n);else if(this._mode===D.SCENE2D)n=$(this,e,this._projection,n);else{if(this._mode!==D.COLUMBUS_VIEW)return;n=ee(this,e,this._projection,n)}return n}};var Tt=new i,Et=new i,At=new i,Pt=new i;I.prototype.getPickRay=function(e,t){a(t)||(t=new E);var i=this.frustum;return a(i.aspectRatio)&&a(i.fov)&&a(i.near)?te(this,e,t):ie(this,e,t)};var St=new i,bt=new i;I.prototype.distanceToBoundingSphere=function(e){var t=i.subtract(this.positionWC,e.center,St),n=i.multiplyByScalar(this.directionWC,i.dot(t,this.directionWC),bt);return Math.max(0,i.magnitude(n)-e.radius)};var Dt=new t;I.prototype.getPixelSize=function(e,t,i){var n=this.distanceToBoundingSphere(e),r=this.frustum.getPixelDimensions(t,i,n,Dt);return Math.max(r.x,r.y)};var It=new i,Ot=new i,Mt=new i,Ft=new i;I.prototype.createCorrectPositionTween=function(e){if(this._mode===D.COLUMBUS_VIEW)return re(this,e)};var Nt=new i,Lt={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};I.prototype.cancelFlight=function(){a(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},I.prototype.flyTo=function(e){e=o(e,o.EMPTY_OBJECT);var t=e.destination;if(this._mode!==D.MORPHING){this.cancelFlight();var i=o(e.orientation,o.EMPTY_OBJECT);if(a(i.direction)&&(i=H(this,t,i,ze.orientation)),a(e.duration)&&e.duration<=0){var n=ze;return n.destination=e.destination,n.orientation.heading=i.heading,n.orientation.pitch=i.pitch,n.orientation.roll=i.roll,n.convert=e.convert,n.endTransform=e.endTransform,this.setView(n),void("function"==typeof e.complete&&e.complete())}var r=a(t.west);r&&(t=this.getRectangleCameraCoordinates(t,Nt));var s,u=this;Lt.destination=t,Lt.heading=i.heading,Lt.pitch=i.pitch,Lt.roll=i.roll,Lt.duration=e.duration,Lt.complete=function(){s===u._currentFlight&&(u._currentFlight=void 0),a(e.complete)&&e.complete()},Lt.cancel=e.cancel,Lt.endTransform=e.endTransform,Lt.convert=!r&&e.convert,Lt.maximumHeight=e.maximumHeight,Lt.pitchAdjustHeight=e.pitchAdjustHeight,Lt.flyOverLongitude=e.flyOverLongitude,Lt.flyOverLongitudeWeight=e.flyOverLongitudeWeight,Lt.easingFunction=e.easingFunction;var l=this._scene;s=l.tweens.add(S.createTween(l,Lt)),this._currentFlight=s}};var Rt=100;I.prototype.viewBoundingSphere=function(e,t){t=se(this,e,t),this.lookAt(e.center,t)};var Vt=new y,Ut=new i,zt=new i,Bt=new i,Ht=new i,kt=new n,Gt=new T,Wt=new v;I.prototype.flyToBoundingSphere=function(e,t){t=o(t,o.EMPTY_OBJECT);var n=this._mode===D.SCENE2D||this._mode===D.COLUMBUS_VIEW;this._setTransform(y.IDENTITY);var r,a=se(this,e,t.offset);r=n?i.multiplyByScalar(i.UNIT_Z,a.range,Ut):X(a.heading,a.pitch,a.range);var s=P.eastNorthUpToFixedFrame(e.center,c.WGS84,Vt);y.multiplyByPoint(s,r,r);var u,l;if(!n){if(u=i.subtract(e.center,r,zt),i.normalize(u,u),l=y.multiplyByPointAsVector(s,i.UNIT_Z,Bt),1-Math.abs(i.dot(u,l))<g.EPSILON6){var d=T.fromAxisAngle(u,a.heading,Gt),h=v.fromQuaternion(d,Wt);i.fromCartesian4(y.getColumn(s,1,kt),l),v.multiplyByVector(h,l,l)}var p=i.cross(u,l,Ht);i.cross(p,u,l),i.normalize(l,l)}this.flyTo({destination:r,orientation:{direction:u,up:l},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Yt=new i,jt=new i,Xt=new i,Qt=new i,qt=[new i,new i,new i,new i],Zt=new t,Kt=new i,Jt=[new r,new r,new r,new r];return I.prototype.computeViewRectangle=function(t,n){t=o(t,c.WGS84);var r=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),a=new e(i.ZERO,t.maximumRadius);if(r.computeVisibility(a)!==f.OUTSIDE){var s=this._scene.canvas,u=s.clientWidth,l=s.clientHeight,d=0,h=ue(this,t);if(d+=le(0,0,0,this,t,h),d+=le(0,l,1,this,t,h),d+=le(u,l,2,this,t,h),(d+=le(u,0,3,this,t,h))<2)return A.MAX_VALUE;n=A.fromCartographicArray(Jt,n);for(var p=0,m=Jt[3].longitude,_=0;_<4;++_){var v=Jt[_].longitude,y=Math.abs(v-m);y>g.PI?p+=g.TWO_PI-y:p+=y,m=v}return g.equalsEpsilon(Math.abs(p),g.TWO_PI,g.EPSILON9)&&(n.west=-g.PI,n.east=g.PI,Jt[0].latitude>=0?n.north=g.PI_OVER_TWO:n.south=-g.PI_OVER_TWO),n}},I.prototype.switchToPerspectiveFrustum=function(){if(!(this._mode===D.SCENE2D||this.frustum instanceof C)){var e=this._scene;this.frustum=new C,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=g.toRadians(60)}},I.prototype.switchToOrthographicFrustum=function(){if(!(this._mode===D.SCENE2D||this.frustum instanceof w)){var e=this._scene;this.frustum=new w,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.width=i.magnitude(this.position);var t=this.frustum.projectionMatrix;a(t)&&this._adjustOrthographicFrustum(!0)}},I.clone=function(e,t){return a(t)||(t=new I(e._scene)),i.clone(e.position,t.position),i.clone(e.direction,t.direction),i.clone(e.up,t.up),i.clone(e.right,t.right),y.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t},I}.apply(t,n))&&(e.exports=r)},1948:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},1949:function(e,t,i){var n,r;n=[i(12),i(1),i(0),i(2),i(21),i(3),i(61),i(1942)],void 0!==(r=function(e,t,i,n,r,o,a,s){"use strict";function u(e){e=t(e,t.EMPTY_OBJECT);var n=e.context,r=n._gl,o=(a.maximumRenderbufferSize,t(e.format,s.RGBA4)),u=i(e.width)?e.width:r.drawingBufferWidth,l=i(e.height)?e.height:r.drawingBufferHeight;this._gl=r,this._format=o,this._width=u,this._height=l,this._renderbuffer=this._gl.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._renderbuffer),r.renderbufferStorage(r.RENDERBUFFER,o,u,l),r.bindRenderbuffer(r.RENDERBUFFER,null)}return n(u.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),u.prototype._getRenderbuffer=function(){return this._renderbuffer},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),r(this)},u}.apply(t,n))&&(e.exports=r)},1950:function(e,t,i){var n,r;n=[i(293),i(10),i(12),i(1),i(0),i(2),i(3),i(151),i(215),i(428),i(153),i(219),i(425),i(1936),i(89),i(1978)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f){"use strict";function _(e){p.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}var g=new h(0);return r(Object.create)&&(_.prototype=Object.create(p.prototype),_.prototype.constructor=_),o(_.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),_.prototype._computeCenter=a.throwInstantiationError,_.prototype._onEntityPropertyChanged=function(e,t,i,o){if(p.prototype._onEntityPropertyChanged.call(this,e,t,i,o),-1!==this._observedPropertyNames.indexOf(t)){var a=this._entity[this._geometryPropertyName];if(r(a)){r(a.zIndex)&&(r(a.height)||r(a.extrudedHeight))&&l(l.geometryZIndex),this._zIndex=n(a.zIndex,g),r(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var s=a.heightReference,u=a.extrudedHeightReference;if(r(s)||r(u)){var c=new d(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new f(this._scene,c,s,u)}}}},_.getGeometryHeight=function(e,t,i){return m.getValueOrDefault(t,i,c.NONE)!==c.CLAMP_TO_GROUND?m.getValueOrUndefined(e,i):0},_.getGeometryExtrudedHeight=function(e,t,i){return m.getValueOrDefault(t,i,c.NONE)!==c.CLAMP_TO_GROUND?m.getValueOrUndefined(e,i):_.CLAMP_TO_GROUND},_.CLAMP_TO_GROUND="clamp",_.computeGeometryOffsetAttribute=function(e,t,i){var n=m.getValueOrDefault(e,i,c.NONE),r=m.getValueOrDefault(t,i,c.NONE),o=0;return n!==c.NONE&&o++,r===c.RELATIVE_TO_GROUND&&o++,2===o?s.ALL:1===o?s.TOP:void 0},_}.apply(t,n))&&(e.exports=r)},1952:function(e,t,i){var n,r;n=[i(0),i(2),i(3),i(23),i(15),i(216),i(89)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(e){this._definitionChanged=new r,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}return t(s.prototype,{isConstant:{get:function(){return a.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return e(this._value)?this._value.referenceFrame:o.FIXED}}}),s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},s.prototype.setValue=function(t){this._value!==t&&(this._value=t,e(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),e(t)&&(this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},s.prototype.getValueInReferenceFrame=function(t,i,r){if(e(this._value))return r=this._value.getValueInReferenceFrame(t,i,r),e(r)?n.WGS84.scaleToGeodeticSurface(r,r):void 0},s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value},s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},s}.apply(t,n))&&(e.exports=r)},1953:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({NONE:-1,PARTIAL:0,FULL:1})}.apply(t,n))&&(e.exports=r)},1954:function(e,t,i){var n,r;n=[i(130),i(38),i(17),i(10),i(31),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(151),i(49),i(9),i(54),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){e=o(e,o.EMPTY_OBJECT);var t=o(e.radii,T),i=Math.round(o(e.stackPartitions,64)),r=Math.round(o(e.slicePartitions,64)),a=o(e.vertexFormat,_.DEFAULT);this._radii=n.clone(t),this._stackPartitions=i,this._slicePartitions=r,this._vertexFormat=_.clone(a),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}var v=new n,y=new n,w=new n,x=new n,C=new n,T=new n(1,1,1),E=Math.cos,A=Math.sin;g.packedLength=n.packedLength+_.packedLength+3,g.pack=function(e,t,i){return i=o(i,0),n.pack(e._radii,t,i),i+=n.packedLength,_.pack(e._vertexFormat,t,i),i+=_.packedLength,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i]=o(e._offsetAttribute,-1),t};var P=new n,S=new _,b={radii:P,vertexFormat:S,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};g.unpack=function(e,t,i){t=o(t,0);var r=n.unpack(e,t,P);t+=n.packedLength;var s=_.unpack(e,t,S);t+=_.packedLength;var u=e[t++],l=e[t++],c=e[t];return a(i)?(i._radii=n.clone(r,i._radii),i._vertexFormat=_.clone(s,i._vertexFormat),i._stackPartitions=u,i._slicePartitions=l,i._offsetAttribute=-1===c?void 0:c,i):(b.stackPartitions=u,b.slicePartitions=l,b.offsetAttribute=-1===c?void 0:c,new g(b))},g.createGeometry=function(o){var s=o._radii;if(!(s.x<=0||s.y<=0||s.z<=0)){var _,g,T=u.fromCartesian3(s),P=o._vertexFormat,S=o._slicePartitions+1,b=o._stackPartitions+1,D=b*S,I=new Float64Array(3*D),O=6*(S-1)*(b-2),M=p.createTypedArray(D,O),F=P.normal?new Float32Array(3*D):void 0,N=P.tangent?new Float32Array(3*D):void 0,L=P.bitangent?new Float32Array(3*D):void 0,R=P.st?new Float32Array(2*D):void 0,V=new Array(S),U=new Array(S),z=0;for(_=0;_<S;_++){var B=m.TWO_PI*_/(S-1);V[_]=E(B),U[_]=A(B),I[z++]=0,I[z++]=0,I[z++]=s.z}for(_=1;_<b-1;_++){var H=Math.PI*_/(b-1),k=A(H),G=s.x*k,W=s.y*k,Y=s.z*E(H);for(g=0;g<S;g++)I[z++]=V[g]*G,I[z++]=U[g]*W,I[z++]=Y}for(_=0;_<S;_++)I[z++]=0,I[z++]=0,I[z++]=-s.z;var j=new d;P.position&&(j.position=new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:I}));var X=0,Q=0,q=0,Z=0;if(P.st||P.normal||P.tangent||P.bitangent){for(_=0;_<D;_++){var K=n.fromArray(I,3*_,v),J=T.geodeticSurfaceNormal(K,y);if(P.st){var $=i.negate(J,C);i.magnitude($)<m.EPSILON6&&(z=3*(_+S*Math.floor(.5*b)),z>I.length&&(z=3*(_-S*Math.floor(.5*b))),n.fromArray(I,z,$),T.geodeticSurfaceNormal($,$),i.negate($,$)),R[X++]=Math.atan2($.y,$.x)/m.TWO_PI+.5,R[X++]=Math.asin(J.z)/Math.PI+.5}if(P.normal&&(F[Q++]=J.x,F[Q++]=J.y,F[Q++]=J.z),P.tangent||P.bitangent){var ee=w;if(_<S||_>D-S-1?(n.cross(n.UNIT_X,J,ee),n.normalize(ee,ee)):(n.cross(n.UNIT_Z,J,ee),n.normalize(ee,ee)),P.tangent&&(N[q++]=ee.x,N[q++]=ee.y,N[q++]=ee.z),P.bitangent){var te=n.cross(J,ee,x);n.normalize(te,te),L[Z++]=te.x,L[Z++]=te.y,L[Z++]=te.z}}}P.st&&(j.st=new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:R})),P.normal&&(j.normal=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:F})),P.tangent&&(j.tangent=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:N})),P.bitangent&&(j.bitangent=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:L}))}if(a(o._offsetAttribute)){var ie=I.length,ne=new Uint8Array(ie/3),re=o._offsetAttribute===h.NONE?0:1;e(ne,re),j.applyOffset=new c({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:1,values:ne})}for(z=0,g=0;g<S-1;g++)M[z++]=S+g,M[z++]=S+g+1,M[z++]=g+1;var oe,ae;for(_=1;_<b-2;_++)for(oe=_*S,ae=(_+1)*S,g=0;g<S-1;g++)M[z++]=ae+g,M[z++]=ae+g+1,M[z++]=oe+g+1,M[z++]=ae+g,M[z++]=oe+g+1,M[z++]=oe+g;for(_=b-2,oe=_*S,ae=(_+1)*S,g=0;g<S-1;g++)M[z++]=ae+g,M[z++]=oe+g+1,M[z++]=oe+g;return new l({attributes:j,indices:M,primitiveType:f.TRIANGLES,boundingSphere:t.fromEllipsoid(T),offsetAttribute:o._offsetAttribute})}};var D;return g.getUnitEllipsoid=function(){return a(D)||(D=g.createGeometry(new g({radii:new n(1,1,1),vertexFormat:_.POSITION_ONLY}))),D},g}.apply(t,n))&&(e.exports=r)},1955:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({ROTATE:0,INFINITE_SCROLL:1})}.apply(t,n))&&(e.exports=r)},1956:function(e,t,i){var n;void 0!==(n=function(){"use strict";return{NEAREST:0,LINEAR:1}}.call(t,i,t,e))&&(e.exports=n)},1957:function(e,t,i){var n,r;n=[i(101),i(1),i(0),i(2),i(21),i(3)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(i){i=t(i,t.EMPTY_OBJECT),this._primitives=[],this._guid=e(),this._zIndex=void 0,this.show=t(i.show,!0),this.destroyPrimitives=t(i.destroyPrimitives,!0)}function s(e,t){return e._primitives.indexOf(t)}return n(a.prototype,{length:{get:function(){return this._primitives.length}}}),a.prototype.add=function(e){var t=e._external=e._external||{};return(t._composites=t._composites||{})[this._guid]={collection:this},this._primitives.push(e),e},a.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},a.prototype.removeAndDestroy=function(e){var t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},a.prototype.removeAll=function(){if(this.destroyPrimitives)for(var e=this._primitives,t=e.length,i=0;i<t;++i)e[i].destroy();this._primitives=[]},a.prototype.contains=function(e){return!!(i(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},a.prototype.raise=function(e){if(i(e)){var t=s(this,e),n=this._primitives;if(t!==n.length-1){var r=n[t];n[t]=n[t+1],n[t+1]=r}}},a.prototype.raiseToTop=function(e){if(i(e)){var t=s(this,e),n=this._primitives;t!==n.length-1&&(n.splice(t,1),n.push(e))}},a.prototype.lower=function(e){if(i(e)){var t=s(this,e),n=this._primitives;if(0!==t){var r=n[t];n[t]=n[t-1],n[t-1]=r}}},a.prototype.lowerToBottom=function(e){if(i(e)){var t=s(this,e),n=this._primitives;0!==t&&(n.splice(t,1),n.unshift(e))}},a.prototype.get=function(e){return this._primitives[e]},a.prototype.update=function(e){if(this.show)for(var t=this._primitives,i=0;i<t.length;++i)t[i].update(e)},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this.removeAll(),r(this)},a}.apply(t,n))&&(e.exports=r)},1958:function(e,t,i){var n,r;n=[i(1),i(0),i(219),i(1936),i(1978)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e,o,a,s){if(n.prototype._onEntityPropertyChanged.call(this,e,o,a,s),-1!==this._observedPropertyNames.indexOf(o)){var u=this._entity[this._geometryPropertyName];if(t(u)){t(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var l=u.heightReference;if(t(l)){var c=new i(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new r(this._scene,c,l)}}}}return o}.apply(t,n))&&(e.exports=r)},1959:function(e,t,i){var n,r;n=[i(17),i(10),i(41),i(24),i(1938),i(426),i(9),i(40),i(20),i(748),i(59),i(50)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d){"use strict";function h(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++){var r=e[n];F=t.cartesianToCartographic(r,F),i[n]=F.height,e[n]=t.scaleToGeodeticSurface(r,r)}return i}function p(e,i,n,r){var o,a=e[0],s=e[1],u=t.angleBetween(a,s),l=Math.ceil(u/r),c=new Array(l);if(i===n){for(o=0;o<l;o++)c[o]=i;return c.push(n),c}var d=n-i,h=d/l;for(o=1;o<l;o++){var p=i+o*h;c[o]=p}return c[0]=i,c.push(n),c}function m(i,n,r,a){var s=new o(r,a),u=s.projectPointOntoPlane(t.add(r,i,N),N),l=s.projectPointOntoPlane(t.add(r,n,L),L),c=e.angleBetween(u,l);return l.x*u.y-l.y*u.x>=0?-c:c}function f(e,i,n,r,o,a,l,c){var h=H,p=k;V=d.eastNorthUpToFixedFrame(e,o,V),h=u.multiplyByPointAsVector(V,R,h),h=t.normalize(h,h);var f=m(h,i,e,o);z=s.fromRotationZ(f,z),G.z=a,V=u.multiplyTransformation(V,u.fromRotationTranslation(z,G,U),V);var _=B;_[0]=l;for(var g=0;g<c;g++)for(var v=0;v<n.length;v+=3)p=t.fromArray(n,v,p),p=s.multiplyByVector(_,p,p),p=u.multiplyByPoint(V,p,p),r.push(p.x,p.y,p.z);return r}function _(e,i,n,r,o,a,s){for(var u=0;u<e.length;u+=3){r=f(t.fromArray(e,u,W),i,n,r,o,a[u/3],s,1)}return r}function g(e,t){var i=e.length,n=new Array(6*i),r=0,o=t.x+t.width/2,a=t.y+t.height/2,s=e[0];n[r++]=s.x-o,n[r++]=0,n[r++]=s.y-a;for(var u=1;u<i;u++){s=e[u];var l=s.x-o,c=s.y-a;n[r++]=l,n[r++]=0,n[r++]=c,n[r++]=l,n[r++]=0,n[r++]=c}return s=e[0],n[r++]=s.x-o,n[r++]=0,n[r++]=s.y-a,n}function v(e,t){for(var i=e.length,n=new Array(3*i),r=0,o=t.x+t.width/2,a=t.y+t.height/2,s=0;s<i;s++)n[r++]=e[s].x-o,n[r++]=0,n[r++]=e[s].y-a;return n}function y(e,i,n,o,u,l,d,h,p,m){var _,g=t.angleBetween(t.subtract(i,e,I),t.subtract(n,e,O)),v=o===r.BEVELED?0:Math.ceil(g/a.toRadians(5));_=u?s.fromQuaternion(c.fromAxisAngle(t.negate(e,I),g/(v+1),Y),X):s.fromQuaternion(c.fromAxisAngle(e,g/(v+1),Y),X);var y,w;if(i=t.clone(i,j),v>0)for(var x=m?2:1,C=0;C<v;C++)i=s.multiplyByVector(_,i,i),y=t.subtract(i,e,I),y=t.normalize(y,y),u||(y=t.negate(y,y)),w=l.scaleToGeodeticSurface(i,O),d=f(w,y,h,d,l,p,1,x);else y=t.subtract(i,e,I),y=t.normalize(y,y),u||(y=t.negate(y,y)),w=l.scaleToGeodeticSurface(i,O),d=f(w,y,h,d,l,p,1,1),n=t.clone(n,j),y=t.subtract(n,e,I),y=t.normalize(y,y),u||(y=t.negate(y,y)),w=l.scaleToGeodeticSurface(n,O),d=f(w,y,h,d,l,p,1,1);return d}var w=[new t,new t],x=new t,C=new t,T=new t,E=new t,A=new t,P=new t,S=new t,b=new t,D=new t,I=new t,O=new t,M={},F=new n,N=new t,L=new t,R=new t(-1,0,0),V=new u,U=new u,z=new s,B=s.IDENTITY.clone(),H=new t,k=new i,G=new t,W=new t,Y=new c,j=new t,X=new s;M.removeDuplicatesFromShape=function(t){for(var i=t.length,n=[],r=i-1,o=0;o<i;r=o++){var a=t[r],s=t[o];e.equals(a,s)||n.push(s)}return n},M.angleIsGreaterThanPi=function(e,i,n,r){var a=new o(n,r),s=a.projectPointOntoPlane(t.add(n,e,N),N),u=a.projectPointOntoPlane(t.add(n,i,L),L);return u.x*s.y-u.y*s.x>=0};var Q=new t,q=new t;return M.computePositions=function(e,i,n,o,s){var u=o._ellipsoid,c=h(e,u),d=o._granularity,m=o._cornerType,O=s?g(i,n):v(i,n),F=s?v(i,n):void 0,N=n.height/2,L=n.width/2,R=e.length,V=[],U=s?[]:void 0,z=x,B=C,H=T,k=E,G=A,W=P,Y=S,j=b,X=D,Z=e[0],K=e[1];k=u.geodeticSurfaceNormal(Z,k),z=t.subtract(K,Z,z),z=t.normalize(z,z),j=t.cross(k,z,j),j=t.normalize(j,j);var J=c[0],$=c[1];s&&(U=f(Z,j,F,U,u,J+N,1,1)),X=t.clone(Z,X),Z=K,B=t.negate(z,B);for(var ee,te,ie=1;ie<R-1;ie++){var ne=s?2:1;K=e[ie+1],z=t.subtract(K,Z,z),z=t.normalize(z,z),H=t.add(z,B,H),H=t.normalize(H,H),k=u.geodeticSurfaceNormal(Z,k);var re=t.multiplyByScalar(k,t.dot(z,k),Q);t.subtract(z,re,re),t.normalize(re,re);var oe=t.multiplyByScalar(k,t.dot(B,k),q);t.subtract(B,oe,oe),t.normalize(oe,oe);if(!a.equalsEpsilon(Math.abs(t.dot(re,oe)),1,a.EPSILON7)){H=t.cross(H,k,H),H=t.cross(k,H,H),H=t.normalize(H,H);var ae=1/Math.max(.25,t.magnitude(t.cross(H,B,I))),se=M.angleIsGreaterThanPi(z,B,Z,u);se?(G=t.add(Z,t.multiplyByScalar(H,ae*L,H),G),W=t.add(G,t.multiplyByScalar(j,L,W),W),w[0]=t.clone(X,w[0]),w[1]=t.clone(W,w[1]),ee=p(w,J+N,$+N,d),te=l.generateArc({positions:w,granularity:d,ellipsoid:u}),V=_(te,j,O,V,u,ee,1),j=t.cross(k,z,j),j=t.normalize(j,j),Y=t.add(G,t.multiplyByScalar(j,L,Y),Y),m===r.ROUNDED||m===r.BEVELED?y(G,W,Y,m,se,u,V,O,$+N,s):(H=t.negate(H,H),V=f(Z,H,O,V,u,$+N,ae,ne)),X=t.clone(Y,X)):(G=t.add(Z,t.multiplyByScalar(H,ae*L,H),G),W=t.add(G,t.multiplyByScalar(j,-L,W),W),w[0]=t.clone(X,w[0]),w[1]=t.clone(W,w[1]),ee=p(w,J+N,$+N,d),te=l.generateArc({positions:w,granularity:d,ellipsoid:u}),V=_(te,j,O,V,u,ee,1),j=t.cross(k,z,j),j=t.normalize(j,j),Y=t.add(G,t.multiplyByScalar(j,-L,Y),Y),m===r.ROUNDED||m===r.BEVELED?y(G,W,Y,m,se,u,V,O,$+N,s):V=f(Z,H,O,V,u,$+N,ae,ne),X=t.clone(Y,X)),B=t.negate(z,B)}else V=f(X,j,O,V,u,J+N,1,1),X=Z;J=$,$=c[ie+1],Z=K}w[0]=t.clone(X,w[0]),w[1]=t.clone(Z,w[1]),ee=p(w,J+N,$+N,d),te=l.generateArc({positions:w,granularity:d,ellipsoid:u}),V=_(te,j,O,V,u,ee,1),s&&(U=f(Z,j,F,U,u,$+N,1,1)),R=V.length;var ue=s?R+U.length:R,le=new Float64Array(ue);return le.set(V),s&&le.set(U,R),le},M}.apply(t,n))&&(e.exports=r)},1964:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6})}.apply(t,n))&&(e.exports=r)},1965:function(e,t,i){var n,r;n=[i(10),i(0),i(3),i(36),i(9),i(40),i(187),i(300)],void 0!==(r=function(e,t,i,n,r,o,a,s){"use strict";function u(e){var t=6.239996+.0172019696544*e;return.001657*Math.sin(t+.01671*Math.sin(t))}function l(e,t){t=n.addSeconds(e,w,t);var i=n.totalDays(t)-x;return t=n.addSeconds(t,u(i),t)}function c(i,n,a,s,u,l,c){a<0&&(a=-a,u+=r.PI);var p=i*(1-n),m=s-u,_=u,g=h(l-s,n);d(n,0);f(m,a,_,P);var v=p*(1+n),y=Math.cos(g),w=Math.sin(g),x=1+n*y,C=v/x;return t(c)?(c.x=C*y,c.y=C*w,c.z=0):c=new e(C*y,C*w,0),o.multiplyByVector(P,c,c)}function d(e,t){return e<=t?"Circular":e<1-t?"Elliptical":e<=1+t?"Parabolic":"Hyperbolic"}function h(e,t){return m(p(e,t),t)}function p(e,t){var i=Math.floor(e/r.TWO_PI);e-=i*r.TWO_PI;var n,o=e+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),a=Number.MAX_VALUE;for(n=0;n<S&&Math.abs(a-o)>b;++n){a=o;o=a-(a-t*Math.sin(a)-e)/(1-t*Math.cos(a))}return a=o+i*r.TWO_PI}function m(e,t){var i=Math.floor(e/r.TWO_PI);e-=i*r.TWO_PI;var n=Math.cos(e)-t,o=Math.sin(e)*Math.sqrt(1-t*t),a=Math.atan2(o,n);return a=r.zeroToTwoPi(a),e<0&&(a-=r.TWO_PI),a+=i*r.TWO_PI}function f(e,i,n,r){var a=Math.cos(e),s=Math.sin(e),u=Math.cos(i),l=Math.sin(i),c=Math.cos(n),d=Math.sin(n);return t(r)?(r[0]=c*a-d*s*u,r[1]=d*a+c*s*u,r[2]=s*l,r[3]=-c*s-d*a*u,r[4]=-d*s+c*a*u,r[5]=a*l,r[6]=d*l,r[7]=-c*l,r[8]=u):r=new o(c*a-d*s*u,-c*s-d*a*u,d*l,d*a+c*s*u,-d*s+c*a*u,-c*l,s*l,a*l,u),r}function _(e,t){l(e,Pe);var i=Pe.dayNumber-C.dayNumber+(Pe.secondsOfDay-C.secondsOfDay)/a.SECONDS_PER_DAY,n=i/(10*a.DAYS_PER_JULIAN_CENTURY),r=.3595362*n,o=D+B*Math.cos(M*r)+Q*Math.sin(M*r)+H*Math.cos(F*r)+q*Math.sin(F*r)+k*Math.cos(N*r)+Z*Math.sin(N*r)+G*Math.cos(L*r)+K*Math.sin(L*r)+W*Math.cos(R*r)+J*Math.sin(R*r)+Y*Math.cos(V*r)+$*Math.sin(V*r)+j*Math.cos(U*r)+ee*Math.sin(U*r)+X*Math.cos(z*r)+te*Math.sin(z*r),s=I+O*n+ce*Math.cos(ie*r)+ve*Math.sin(ie*r)+de*Math.cos(ne*r)+ye*Math.sin(ne*r)+he*Math.cos(re*r)+we*Math.sin(re*r)+pe*Math.cos(oe*r)+xe*Math.sin(oe*r)+me*Math.cos(ae*r)+Ce*Math.sin(ae*r)+fe*Math.cos(se*r)+Te*Math.sin(se*r)+_e*Math.cos(ue*r)+Ee*Math.sin(ue*r)+ge*Math.cos(le*r)+Ae*Math.sin(le*r);return c(o,.0167086342-.0004203654*n,469.97289*A*n,102.93734808*E+11612.3529*A*n,174.87317577*E-8679.27034*A*n,s,t)}function g(e,t){l(e,Pe);var i=Pe.dayNumber-C.dayNumber+(Pe.secondsOfDay-C.secondsOfDay)/a.SECONDS_PER_DAY,n=i/a.DAYS_PER_JULIAN_CENTURY,r=n*n,o=r*n,s=o*n,u=383397.7725+.004*n,d=.055545526-1.6e-8*n,h=5.15668983*E,p=-8e-5*n+.02966*r-42e-6*o-1.3e-7*s,m=83.35324312*E,f=14643420.2669*n-38.2702*r-.045047*o+21301e-8*s,_=125.04455501*E,g=-6967919.3631*n+6.3602*r+.007625*o-3586e-8*s,v=218.31664563*E,y=1732559343.4847*n-6.391*r+.006588*o-3169e-8*s,w=297.85019547*E+A*(1602961601.209*n-6.3706*r+.006593*o-3169e-8*s),x=93.27209062*E+A*(1739527262.8478*n-12.7512*r-.001037*o+417e-8*s),P=134.96340251*E+A*(1717915923.2178*n+31.8792*r+.051635*o-2447e-7*s),S=357.52910918*E+A*(129596581.0481*n-.5532*r+136e-6*o-1149e-8*s),b=310.17137918*E-A*(6967051.436*n+6.2068*r+.007618*o-3219e-8*s),D=2*w,I=4*w,O=6*w,M=2*P,F=3*P,N=4*P,L=2*x;u+=3400.4*Math.cos(D)-635.6*Math.cos(D-P)-235.6*Math.cos(P)+218.1*Math.cos(D-S)+181*Math.cos(D+P),d+=.014216*Math.cos(D-P)+.008551*Math.cos(D-M)-.001383*Math.cos(P)+.001356*Math.cos(D+P)-.001147*Math.cos(I-F)-914e-6*Math.cos(I-M)+869e-6*Math.cos(D-S-P)-627e-6*Math.cos(D)-394e-6*Math.cos(I-N)+282e-6*Math.cos(D-S-M)-279e-6*Math.cos(w-P)-236e-6*Math.cos(M)+231e-6*Math.cos(I)+229e-6*Math.cos(O-N)-201e-6*Math.cos(M-L),p+=486.26*Math.cos(D-L)-40.13*Math.cos(D)+37.51*Math.cos(L)+25.73*Math.cos(M-L)+19.97*Math.cos(D-S-L),f+=-55609*Math.sin(D-P)-34711*Math.sin(D-M)-9792*Math.sin(P)+9385*Math.sin(I-F)+7505*Math.sin(I-M)+5318*Math.sin(D+P)+3484*Math.sin(I-N)-3417*Math.sin(D-S-P)-2530*Math.sin(O-N)-2376*Math.sin(D)-2075*Math.sin(D-F)-1883*Math.sin(M)-1736*Math.sin(O-5*P)+1626*Math.sin(S)-1370*Math.sin(O-F),g+=-5392*Math.sin(D-L)-540*Math.sin(S)-441*Math.sin(D)+423*Math.sin(L)-288*Math.sin(M-L),y+=-3332.9*Math.sin(D)+1197.4*Math.sin(D-P)-662.5*Math.sin(S)+396.3*Math.sin(P)-218*Math.sin(D-S);var R=2*b,V=3*b;p+=46.997*Math.cos(b)*n-.614*Math.cos(D-L+b)*n+.614*Math.cos(D-L-b)*n-.0297*Math.cos(R)*r-.0335*Math.cos(b)*r+.0012*Math.cos(D-L+R)*r-16e-5*Math.cos(b)*o+4e-5*Math.cos(V)*o+4e-5*Math.cos(R)*o;var U=2.116*Math.sin(b)*n-.111*Math.sin(D-L-b)*n-.0015*Math.sin(b)*r;return f+=U,y+=U,g+=-520.77*Math.sin(b)*n+13.66*Math.sin(D-L+b)*n+1.12*Math.sin(D-b)*n-1.06*Math.sin(L-b)*n+.66*Math.sin(R)*r+.371*Math.sin(b)*r-.035*Math.sin(D-L+R)*r-.015*Math.sin(D-L+b)*r+.0014*Math.sin(b)*o-.0011*Math.sin(V)*o-9e-4*Math.sin(R)*o,u*=T,c(u,d,h+p*A,m+f*A,_+g*A,v+y*A,t)}function v(t,i){return i=g(t,i),e.multiplyByScalar(i,Se,i)}var y={},w=32.184,x=2451545,C=new n(2451545,0,s.TAI),T=1e3,E=r.RADIANS_PER_DEGREE,A=r.RADIANS_PER_ARCSECOND,P=new o,S=50,b=r.EPSILON8,D=149598022260.7121,I=100.46645683*E,O=1295977422.83429*A,M=16002,F=21863,N=32004,L=10931,R=14529,V=16368,U=15318,z=32794,B=64e-7*14959787e4,H=-2273887.624,k=927506.794,G=14959787e4*-8e-7,W=32e-7*14959787e4,Y=-613351.267,j=284235.953,X=-164557.657,Q=-2243968.05,q=-688150.202,Z=1017265.516,K=807828.498,J=14e-7*14959787e4,$=359034.888,ee=14959787e4*-28e-7,te=329115.314,ie=10,ne=16002,re=21863,oe=10931,ae=1473,se=32004,ue=4387,le=73,ce=-325e-7,de=-322e-7,he=1e-7*-79,pe=232*1e-7,me=1e-7*-52,fe=97e-7,_e=55e-7,ge=-41e-7,ve=-105e-7,ye=-137e-7,we=258e-7,xe=35e-7,Ce=1e-7*-116,Te=-88e-7,Ee=-112e-7,Ae=-8e-6,Pe=new n(0,0,s.TAI),Se=-.01215058143522694,be=new o(1.0000000000000002,5.619723173785822e-16,4.690511510146299e-19,-5.154129427414611e-16,.9174820620691819,-.39777715593191376,-2.23970096136568e-16,.39777715593191376,.9174820620691819),De=new e;return y.computeSunPositionInEarthInertialFrame=function(i,r){return t(i)||(i=n.now()),t(r)||(r=new e),De=_(i,De),r=e.negate(De,r),v(i,De),e.subtract(r,De,r),o.multiplyByVector(be,r,r),r},y.computeMoonPositionInEarthInertialFrame=function(e,i){return t(e)||(e=n.now()),i=g(e,i),o.multiplyByVector(be,i,i),i},y}.apply(t,n))&&(e.exports=r)},1966:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_Position = position;\n    v_textureCoordinates = textureCoordinates;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},1967:function(e,t,i){var n,r;n=[i(10),i(25),i(150),i(1),i(0),i(21),i(3),i(1968),i(2154),i(128),i(40),i(289),i(424),i(747),i(437),i(59),i(152),i(183)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(e){e=n(e,n.EMPTY_OBJECT),this._camera=e.camera,this._color=n(e.color,t.CYAN),this._updateOnChange=n(e.updateOnChange,!0),this.show=n(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var y=new e,w=new c,x=new f,C=new p,T=new m,E=new d,A=new h,P=new t,S=[1,1e5];return v.prototype.update=function(n){if(this.show){var r,o,a=this._planesPrimitives,h=this._outlinePrimitives;if(this._updateOnChange){for(o=a.length,r=0;r<o;++r)h[r]=h[r]&&h[r].destroy(),a[r]=a[r]&&a[r].destroy();a.length=0,h.length=0}if(0===a.length){var v,b=this._camera,D=b.frustum;v=D instanceof p?C:D instanceof m?T:D instanceof d?E:A,v=D.clone(v);var I=n.frustumSplits,O=I.length-1;O<=0&&(I=S,I[0]=this._camera.frustum.near,I[1]=this._camera.frustum.far,O=1);var M=b.positionWC,F=b.directionWC,N=b.upWC,L=b.rightWC;L=e.negate(L,y);var R=w;c.setColumn(R,0,L,R),c.setColumn(R,1,N,R),c.setColumn(R,2,F,R);var V=f.fromRotationMatrix(R,x);for(a.length=h.length=O,r=0;r<O;++r)v.near=I[r],v.far=I[r+1],a[r]=new g({geometryInstances:new l({geometry:new s({origin:M,orientation:V,frustum:v,_drawNearPlane:0===r}),attributes:{color:i.fromColor(t.fromAlpha(this._color,.1,P))},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!0,flat:!0}),asynchronous:!1}),h[r]=new g({geometryInstances:new l({geometry:new u({origin:M,orientation:V,frustum:v,_drawNearPlane:0===r}),attributes:{color:i.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!1,flat:!0}),asynchronous:!1})}for(o=a.length,r=0;r<o;++r)h[r].update(n),a[r].update(n)}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){for(var e=this._planesPrimitives.length,t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return o(this)},v}.apply(t,n))&&(e.exports=r)},1968:function(e,t,i){var n,r;n=[i(38),i(10),i(41),i(12),i(31),i(1),i(0),i(76),i(90),i(129),i(40),i(20),i(289),i(747),i(54),i(59),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){var i,n,r=e.frustum,a=e.orientation,s=e.origin,u=o(e.vertexFormat,_.DEFAULT),l=o(e._drawNearPlane,!0);r instanceof p?(i=y,n=p.packedLength):r instanceof h&&(i=w,n=h.packedLength),this._frustumType=i,this._frustum=r.clone(),this._origin=t.clone(s),this._orientation=f.clone(a),this._drawNearPlane=l,this._vertexFormat=u,this._workerName="createFrustumGeometry",this.packedLength=2+n+t.packedLength+f.packedLength+_.packedLength}function v(e,t,i,n,r,o,s,u){for(var l=e/3*2,c=0;c<4;++c)a(t)&&(t[e]=o.x,t[e+1]=o.y,t[e+2]=o.z),a(i)&&(i[e]=s.x,i[e+1]=s.y,i[e+2]=s.z),a(n)&&(n[e]=u.x,n[e+1]=u.y,n[e+2]=u.z),e+=3;r[l]=0,r[l+1]=0,r[l+2]=1,r[l+3]=0,r[l+4]=1,r[l+5]=1,r[l+6]=0,r[l+7]=1}var y=0,w=1;g.pack=function(e,i,n){n=o(n,0);var r=e._frustumType,a=e._frustum;return i[n++]=r,r===y?(p.pack(a,i,n),n+=p.packedLength):(h.pack(a,i,n),n+=h.packedLength),t.pack(e._origin,i,n),n+=t.packedLength,f.pack(e._orientation,i,n),n+=f.packedLength,_.pack(e._vertexFormat,i,n),n+=_.packedLength,i[n]=e._drawNearPlane?1:0,i};var x=new p,C=new h,T=new f,E=new t,A=new _;g.unpack=function(e,i,n){i=o(i,0);var r,s=e[i++];s===y?(r=p.unpack(e,i,x),i+=p.packedLength):(r=h.unpack(e,i,C),i+=h.packedLength);var u=t.unpack(e,i,E);i+=t.packedLength;var l=f.unpack(e,i,T);i+=f.packedLength;var c=_.unpack(e,i,A);i+=_.packedLength;var d=1===e[i];if(!a(n))return new g({frustum:r,origin:u,orientation:l,vertexFormat:c,_drawNearPlane:d});var m=s===n._frustumType?n._frustum:void 0;return n._frustum=r.clone(m),n._frustumType=s,n._origin=t.clone(u,n._origin),n._orientation=f.clone(l,n._orientation),n._vertexFormat=_.clone(c,n._vertexFormat),n._drawNearPlane=d,n};var P=new c,S=new d,b=new d,D=new t,I=new t,O=new t,M=new t,F=new t,N=new t,L=new Array(3),R=new Array(4);R[0]=new i(-1,-1,1,1),R[1]=new i(1,-1,1,1),R[2]=new i(1,1,1,1),R[3]=new i(-1,1,1,1);for(var V=new Array(4),U=0;U<4;++U)V[U]=new i;return g._computeNearFarPlanes=function(e,n,r,s,u,l,h,p){var m=c.fromQuaternion(n,P),f=o(l,D),_=o(h,I),g=o(p,O);f=c.getColumn(m,0,f),_=c.getColumn(m,1,_),g=c.getColumn(m,2,g),t.normalize(f,f),t.normalize(_,_),t.normalize(g,g),t.negate(f,f);var v,w,x=d.computeView(e,g,_,f,S);if(r===y){var C=s.projectionMatrix,T=d.multiply(C,x,b);w=d.inverse(T,b)}else v=d.inverseTransformation(x,b);a(w)?(L[0]=s.near,L[1]=s.far):(L[0]=0,L[1]=s.near,L[2]=s.far);for(var E=0;E<2;++E)for(var A=0;A<4;++A){var M=i.clone(R[A],V[A]);if(a(w)){M=d.multiplyByVector(w,M,M);var F=1/M.w;t.multiplyByScalar(M,F,M),t.subtract(M,e,M),t.normalize(M,M);var N=t.dot(g,M);t.multiplyByScalar(M,L[E]/N,M),t.add(M,e,M)}else{a(s._offCenterFrustum)&&(s=s._offCenterFrustum);var U=L[E],z=L[E+1];M.x=.5*(M.x*(s.right-s.left)+s.left+s.right),M.y=.5*(M.y*(s.top-s.bottom)+s.bottom+s.top),M.z=.5*(M.z*(U-z)-U-z),M.w=1,d.multiplyByVector(v,M,M)}u[12*E+3*A]=M.x,u[12*E+3*A+1]=M.y,u[12*E+3*A+2]=M.z}},g.createGeometry=function(i){var n=i._frustumType,o=i._frustum,c=i._origin,d=i._orientation,h=i._drawNearPlane,p=i._vertexFormat,f=h?6:5,_=new Float64Array(72);g._computeNearFarPlanes(c,d,n,o,_);var y=24;_[y]=_[12],_[y+1]=_[13],_[y+2]=_[14],_[y+3]=_[0],_[y+4]=_[1],_[y+5]=_[2],_[y+6]=_[9],_[y+7]=_[10],_[y+8]=_[11],_[y+9]=_[21],_[y+10]=_[22],_[y+11]=_[23],y+=12,_[y]=_[15],_[y+1]=_[16],_[y+2]=_[17],_[y+3]=_[3],_[y+4]=_[4],_[y+5]=_[5],_[y+6]=_[0],_[y+7]=_[1],_[y+8]=_[2],_[y+9]=_[12],_[y+10]=_[13],_[y+11]=_[14],y+=12,_[y]=_[3],_[y+1]=_[4],_[y+2]=_[5],_[y+3]=_[15],_[y+4]=_[16],_[y+5]=_[17],_[y+6]=_[18],_[y+7]=_[19],_[y+8]=_[20],_[y+9]=_[6],_[y+10]=_[7],_[y+11]=_[8],y+=12,_[y]=_[6],_[y+1]=_[7],_[y+2]=_[8],_[y+3]=_[18],_[y+4]=_[19],_[y+5]=_[20],_[y+6]=_[21],_[y+7]=_[22],_[y+8]=_[23],_[y+9]=_[9],_[y+10]=_[10],_[y+11]=_[11],h||(_=_.subarray(12));var w=new l({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:_})});if(a(p.normal)||a(p.tangent)||a(p.bitangent)||a(p.st)){var x=a(p.normal)?new Float32Array(12*f):void 0,C=a(p.tangent)?new Float32Array(12*f):void 0,T=a(p.bitangent)?new Float32Array(12*f):void 0,E=a(p.st)?new Float32Array(8*f):void 0,A=D,P=I,S=O,b=t.negate(A,M),L=t.negate(P,F),R=t.negate(S,N);y=0,h&&(v(y,x,C,T,E,R,A,P),y+=12),v(y,x,C,T,E,S,b,P),y+=12,v(y,x,C,T,E,b,R,P),y+=12,v(y,x,C,T,E,L,R,b),y+=12,v(y,x,C,T,E,A,S,P),y+=12,v(y,x,C,T,E,P,S,b),a(x)&&(w.normal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:x})),a(C)&&(w.tangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:C})),a(T)&&(w.bitangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:T})),a(E)&&(w.st=new u({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:E}))}for(var V=new Uint16Array(6*f),U=0;U<f;++U){var z=6*U,B=4*U;V[z]=B,V[z+1]=B+1,V[z+2]=B+2,V[z+3]=B,V[z+4]=B+2,V[z+5]=B+3}return new s({attributes:w,indices:V,primitiveType:m.TRIANGLES,boundingSphere:e.fromVertices(_)})},g}.apply(t,n))&&(e.exports=r)},1969:function(e,t,i){var n,r;n=[i(99),i(25),i(0),i(21),i(69),i(423),i(422),i(91),i(68),i(52),i(114),i(100),i(185),i(116),i(102),i(2162),i(1948),i(2163)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this.framebuffer=void 0,this._copyDepthFramebuffer=void 0,this._clearColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._viewport=new e,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useLogDepth=void 0,this._debugGlobeDepthViewportCommand=void 0}function y(e,t,n,r){if(!i(e._debugGlobeDepthViewportCommand)||r!==e._useLogDepth){var o=new l({defines:[r?"LOG_DEPTH":""],sources:["uniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(o,{uniformMap:{u_depthTexture:function(){return e._globeDepthTexture}},owner:e}),e._useLogDepth=r}e._debugGlobeDepthViewportCommand.execute(t,n)}function w(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function x(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function C(e,t,i,n){e._colorTexture=new d({context:t,width:i,height:n,pixelFormat:r.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new c({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:p.NEAREST})}),e._depthStencilTexture=new d({context:t,width:i,height:n,pixelFormat:r.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8}),e._globeDepthTexture=new d({context:t,width:i,height:n,pixelFormat:r.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new c({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:p.NEAREST})})}function T(e,t){e.framebuffer=new a({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._copyDepthFramebuffer=new a({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:!1})}function E(e,t,n,r){var o=e._colorTexture,a=!i(o)||o.width!==n||o.height!==r;i(e.framebuffer)&&!a||(w(e),x(e),C(e,t,n,r),T(e,t))}function A(n,r,a,s,l){n._viewport.width=a,n._viewport.height=s;var c=!e.equals(n._viewport,l.viewport),d=c!==n._useScissorTest;n._useScissorTest=c,e.equals(n._scissorRectangle,l.viewport)||(n._scissorRectangle=e.clone(l.viewport,n._scissorRectangle),d=!0),i(n._rs)&&e.equals(n._viewport,n._rs.viewport)&&!d||(n._rs=u.fromCache({viewport:n._viewport,scissorTest:{enabled:n._useScissorTest,rectangle:n._scissorRectangle}})),i(n._copyDepthCommand)||(n._copyDepthCommand=r.createViewportQuadCommand(g,{uniformMap:{u_depthTexture:function(){return n._depthStencilTexture}},owner:n})),n._copyDepthCommand.framebuffer=n._copyDepthFramebuffer,i(n._copyColorCommand)||(n._copyColorCommand=r.createViewportQuadCommand(_,{uniformMap:{colorTexture:function(){return n._colorTexture}},owner:n})),n._copyDepthCommand.renderState=n._rs,n._copyColorCommand.renderState=n._rs,i(n._clearColorCommand)||(n._clearColorCommand=new o({color:new t(0,0,0,0),stencil:0,owner:n})),n._clearColorCommand.framebuffer=n.framebuffer}return v.prototype.executeDebugGlobeDepth=function(e,t,i){y(this,e,t,i)},v.prototype.update=function(e,t,i){var n=i.width,r=i.height;E(this,e,n,r),A(this,e,n,r,t),e.uniformState.globeDepthTexture=void 0},v.prototype.executeCopyDepth=function(e,t){i(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},v.prototype.executeCopyColor=function(e,t){i(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},v.prototype.clear=function(e,n,r){var o=this._clearColorCommand;i(o)&&(t.clone(r,o.color),o.execute(e,n))},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){w(this),x(this),i(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),i(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy());var e=this._debugGlobeDepthViewportCommand;return i(e)&&(e.shaderProgram=e.shaderProgram.destroy()),n(this)},v}.apply(t,n))&&(e.exports=r)},1970:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"#define SAMPLES 8\n\nuniform float delta;\nuniform float sigma;\nuniform float direction; // 0.0 for x direction, 1.0 for y direction\n\nuniform sampler2D colorTexture;\n\n#ifdef USE_STEP_SIZE\nuniform float stepSize;\n#else\nuniform vec2 step;\n#endif\n\nvarying vec2 v_textureCoordinates;\n\n//  Incremental Computation of the Gaussian:\n//  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch40.html\n\nvoid main()\n{\n    vec2 st = v_textureCoordinates;\n    vec2 dir = vec2(1.0 - direction, direction);\n\n#ifdef USE_STEP_SIZE\n    vec2 step = vec2(stepSize / czm_viewport.zw);\n#else\n    vec2 step = step;\n#endif\n\n    vec3 g;\n    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);\n    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));\n    g.z = g.y * g.y;\n\n    vec4 result = texture2D(colorTexture, st) * g.x;\n    for (int i = 1; i < SAMPLES; ++i)\n    {\n        g.xy *= g.yz;\n\n        vec2 offset = float(i) * dir * step;\n        result += texture2D(colorTexture, st - offset) * g.x;\n        result += texture2D(colorTexture, st + offset) * g.x;\n    }\n\n    gl_FragColor = result;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},1971:function(e,t,i){var n,r;n=[i(99),i(12),i(25),i(42),i(101),i(1),i(0),i(2),i(21),i(3),i(9),i(69),i(29),i(1940),i(91),i(68),i(114),i(52),i(100),i(116),i(102),i(185),i(7),i(1956)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T){"use strict";function E(t){t=o(t,o.EMPTY_OBJECT);var n=t.fragmentShader,s=o(t.textureScale,1),u=o(t.pixelFormat,d.RGBA);this._fragmentShader=n,this._uniforms=t.uniforms,this._textureScale=s,this._forcePowerOfTwo=o(t.forcePowerOfTwo,!1),this._sampleMode=o(t.sampleMode,T.NEAREST),this._pixelFormat=u,this._pixelDatatype=o(t.pixelDatatype,m.UNSIGNED_BYTE),this._clearColor=o(t.clearColor,i.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;var l=new p;l.scissorTest={enabled:!0,rectangle:a(t.scissorRectangle)?e.clone(t.scissorRectangle):new e},this._passState=l,this._ready=!1;var c=t.name;a(c)||(c=r()),this._name=c,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}function A(e,t,i){var n=t[i];return("string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData)&&e._dirtyUniforms.push(i),{get:function(){return t[i]},set:function(n){var r=t[i];t[i]=n;var o=e._actualUniforms,s=o[i];a(s)&&s!==r&&s instanceof v&&!a(e._textureCache.getStageByName(i))&&(e._texturesToRelease.push(s),delete o[i],delete o[i+"Dimensions"]),r instanceof v&&e._texturesToRelease.push(r),"string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData?e._dirtyUniforms.push(i):o[i]=n}}}function P(e,t){return function(){var i=e._actualUniforms[t];return"function"==typeof i?i():i}}function S(e,t){return function(){var i=e[t]();if(a(i))return i.dimensions}}function b(e){if(!a(e._uniformMap)){var t={},i={},r=e._uniforms,o=e._actualUniforms;for(var u in r)if(r.hasOwnProperty(u)){"function"!=typeof r[u]?(t[u]=P(e,u),i[u]=A(e,r,u)):(t[u]=r[u],i[u]=r[u]),o[u]=r[u];var l=t[u]();("string"==typeof l||l instanceof v||l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement)&&(t[u+"Dimensions"]=S(t,u))}e._uniforms={},s(e._uniforms,i),e._uniformMap=n(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}}function D(e,t){if(!a(e._command)||e._logDepthChanged||e._selectedDirty){var i=e._fragmentShader;if(a(e._selectedIdTexture)){var n=e._selectedIdTexture.width;i=i.replace(/varying\s+vec2\s+v_textureCoordinates;/g,""),i="#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nvarying vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < "+n+"; ++i) \n    { \n        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2(float(i) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n"+i}var r=new g({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[i]});e._command=t.createViewportQuadCommand(r,{uniformMap:e._uniformMap,owner:e})}}function I(e){var t,i,n=e._sampleMode;n===T.LINEAR?(t=w.LINEAR,i=y.LINEAR):(t=w.NEAREST,i=y.NEAREST);var r=e._sampler;a(r)&&r.minificationFilter===t&&r.magnificationFilter===i||(e._sampler=new _({wrapS:x.CLAMP_TO_EDGE,wrapT:x.CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:i}))}function O(e,t){return function(i){e._texturesToCreate.push({name:t,source:i})}}function M(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function F(e,t){var i,n,r,o=e._texturesToRelease,s=o.length;for(i=0;i<s;++i)n=o[i],n=n&&n.destroy();o.length=0;var u=e._texturesToCreate;for(s=u.length,i=0;i<s;++i){var l=u[i];r=l.name;var c=l.source;e._actualUniforms[r]=new v({context:t,source:c})}u.length=0;var d=e._dirtyUniforms;if(0===d.length&&!a(e._texturePromise))return void(e._ready=!0);if(0!==d.length&&!a(e._texturePromise)){s=d.length;var p=e._uniforms,m=[];for(i=0;i<s;++i){r=d[i];var f=p[r],_=e._textureCache.getStageByName(f);if(a(_))e._actualUniforms[r]=M(e,f);else if("string"==typeof f){var g=new h({url:f});m.push(g.fetchImage().then(O(e,r)))}else e._texturesToCreate.push({name:r,source:f})}d.length=0,m.length>0?(e._ready=!1,e._texturePromise=C.all(m).then(function(){e._ready=!0,e._texturePromise=void 0})):e._ready=!0}}function N(e){a(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();var t=e._textureCache;if(a(t)){var i=e._uniforms,n=e._actualUniforms;for(var r in n)n.hasOwnProperty(r)&&n[r]instanceof v&&(a(t.getStageByName(i[r]))||n[r].destroy(),e._dirtyUniforms.push(r))}}function L(e){var t=a(e._selected)?e._selected.length:0,i=a(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,a(e._selected)&&a(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):a(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&a(e._combinedSelected)){if(!a(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var r=0;r<t;++r)if(e._combinedSelected[r]!==e._combinedSelectedShadow[r])return!0}return n}function R(e,t){if(e._selectedDirty){e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;var n=e._combinedSelected;if(a(n)){var r,o,s=0,u=n.length;for(r=0;r<u;++r)o=n[r],a(o.pickIds)?s+=o.pickIds.length:a(o.pickId)&&++s;if(0===u||0===s){var l=new Uint8Array(4);return l[0]=255,l[1]=255,l[2]=255,l[3]=255,void(e._selectedIdTexture=new v({context:t,pixelFormat:d.RGBA,pixelDatatype:m.UNSIGNED_BYTE,source:{arrayBufferView:l,width:1,height:1},sampler:new _({wrapS:x.CLAMP_TO_EDGE,wrapT:x.CLAMP_TO_EDGE,minificationFilter:w.NEAREST,magnificationFilter:y.NEAREST})}))}var c,h=0,p=new Uint8Array(4*s);for(r=0;r<u;++r)if(o=n[r],a(o.pickIds))for(var f=o.pickIds,g=f.length,C=0;C<g;++C)c=f[C].color,p[h]=i.floatToByte(c.red),p[h+1]=i.floatToByte(c.green),p[h+2]=i.floatToByte(c.blue),p[h+3]=i.floatToByte(c.alpha),h+=4;else a(o.pickId)&&(c=o.pickId.color,p[h]=i.floatToByte(c.red),p[h+1]=i.floatToByte(c.green),p[h+2]=i.floatToByte(c.blue),p[h+3]=i.floatToByte(c.alpha),h+=4);e._selectedIdTexture=new v({context:t,pixelFormat:d.RGBA,pixelDatatype:m.UNSIGNED_BYTE,source:{arrayBufferView:p,width:s,height:1},sampler:new _({wrapS:x.CLAMP_TO_EDGE,wrapT:x.CLAMP_TO_EDGE,minificationFilter:w.NEAREST,magnificationFilter:y.NEAREST})})}}}s(E.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(a(this._textureCache)){var e=this._textureCache.getFramebuffer(this._name);if(a(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var V=/uniform\s+sampler2D\s+depthTexture/g;return E.prototype._isSupported=function(e){return!V.test(this._fragmentShader)||e.depthTexture},E.prototype.update=function(t,i){if(this.enabled===this._enabled||this.enabled||N(this),this._enabled=this.enabled,this._enabled&&(this._logDepthChanged=i!==this._useLogDepth,this._useLogDepth=i,this._selectedDirty=L(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=a(this._selected)?this._selected.length:0,this._parentSelectedLength=a(this._parentSelected)?this._parentSelected.length:0,R(this,t),b(this),F(this,t),D(this,t),I(this),this._selectedDirty=!1,this._ready)){var n=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=n,a(n)){var r,o=n.getColorTexture(0);o.width===t.drawingBufferWidth&&o.height===t.drawingBufferHeight||(r=this._renderState,a(r)&&o.width===r.viewport.width&&o.height===r.viewport.height||(this._renderState=f.fromCache({viewport:new e(0,0,o.width,o.height)}))),this._command.renderState=r}}},E.prototype.execute=function(e,t,i,n){if(a(this._command)&&a(this._command.framebuffer)&&this._ready&&this._enabled){this._colorTexture=t,this._depthTexture=i,this._idTexture=n,_.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);var r=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;a(r)&&(r.context=e),this._command.execute(e,r)}},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return N(this),u(this)},E}.apply(t,n))&&(e.exports=r)},1972:function(e,t,i){var n,r;n=[i(12),i(101),i(1),i(0),i(2),i(21)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(e){e=i(e,i.EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=i(e.inputPreviousStageTexture,!0);var r=e.name;n(r)||(r=t()),this._name=r,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}function s(e){var t=n(e._selected)?e._selected.length:0,i=n(e._parentSelected)?e._parentSelected:0,r=e._selected!==e._selectedShadow||t!==e._selectedLength;if(r=r||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,n(e._selected)&&n(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):n(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!r&&n(e._combinedSelected)){if(!n(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var o=0;o<t;++o)if(e._combinedSelected[o]!==e._combinedSelectedShadow[o])return!0}return r}return r(a.prototype,{ready:{get:function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)if(!e[i].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){for(var t=this._stages,i=t.length,n=0;n<i;++n)t[n].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),a.prototype._isSupported=function(e){for(var t=this._stages,i=t.length,n=0;n<i;++n)if(!t[n]._isSupported(e))return!1;return!0},a.prototype.get=function(e){return this._stages[e]},a.prototype.update=function(e,t){this._selectedDirty=s(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=n(this._selected)?this._selected.length:0,this._parentSelectedLength=n(this._parentSelected)?this._parentSelected.length:0;for(var i=this._stages,r=i.length,o=0;o<r;++o){var a=i[o];this._selectedDirty&&(a.parentSelected=this._combinedSelected),a.update(e,t)}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)e[i].destroy();return o(this)},a}.apply(t,n))&&(e.exports=r)},1973:function(e,t,i){var n,r;n=[i(25),i(0),i(9),i(21),i(423),i(422),i(100)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function u(e){for(;t(e.length);)e=e.get(e.length-1);return e.name}function l(e,i,n,r,o){if(!r.enabled||!r._isSupported(i))return o;var a=n[r.name]={};if(t(o)){a[u(e.getStageByName(o))]=!0}var s=r.uniforms;if(t(s))for(var l=Object.getOwnPropertyNames(s),c=l.length,d=0;d<c;++d){var h=s[l[d]];if("string"==typeof h){var p=e.getStageByName(h);t(p)&&(a[u(p)]=!0)}}return r.name}function c(e,i,n,r,o){if(t(r.enabled)&&!r.enabled||t(r._isSupported)&&!r._isSupported(i))return o;for(var a=!t(r.inputPreviousStageTexture)||r.inputPreviousStageTexture,s=o,d=r.length,h=0;h<d;++h){var p=r.get(h);s=t(p.length)?c(e,i,n,p,o):l(e,i,n,p,o),a&&(o=s)}if(!a)for(var m=1;m<d;++m)for(var f=u(r.get(m)),_=n[f],g=0;g<m;++g)_[u(r.get(g))]=!0;return s}function d(e,i){var n={};if(t(e.ambientOcclusion)){var r=e.ambientOcclusion,o=e.bloom,a=e.fxaa,s=c(e,i,n,r,void 0);s=c(e,i,n,o,s),s=c(e,i,n,e,s),l(e,i,n,a,s)}else c(e,i,n,e,void 0);return n}function h(i,n,r){var o,a,s=i._collection,u=s.getStageByName(n),l=u._textureScale,c=u._forcePowerOfTwo,d=u._pixelFormat,h=u._pixelDatatype,p=u._clearColor,m=i._framebuffers,f=m.length;for(o=0;o<f;++o)if(a=m[o],l===a.textureScale&&c===a.forcePowerOfTwo&&d===a.pixelFormat&&h===a.pixelDatatype&&e.equals(p,a.clearColor)){for(var _=a.stages,g=_.length,v=!1,y=0;y<g;++y)if(r[_[y]]){v=!0;break}if(!v)break}return t(a)&&o<f?(a.stages.push(n),a):(a={textureScale:l,forcePowerOfTwo:c,pixelFormat:d,pixelDatatype:h,clearColor:p,stages:[n],buffer:void 0,clear:void 0},m.push(a),a)}function p(e,t){var i=d(e._collection,t);for(var n in i)i.hasOwnProperty(n)&&(e._stageNameToFramebuffer[n]=h(e,n,i[n]))}function m(e){for(var t=e._framebuffers,i=t.length,n=0;n<i;++n){var r=t[n];r.buffer=r.buffer&&r.buffer.destroy(),r.buffer=void 0}}function f(e,t){for(var n=e._width,s=e._height,u=e._framebuffers,l=u.length,c=0;c<l;++c){var d=u[c],h=d.textureScale,p=Math.ceil(n*h),m=Math.ceil(s*h),f=Math.min(p,m);d.forcePowerOfTwo&&(i.isPowerOfTwo(f)||(f=i.nextPowerOfTwo(f)),p=f,m=f),d.buffer=new o({context:t,colorTextures:[new a({context:t,width:p,height:m,pixelFormat:d.pixelFormat,pixelDatatype:d.pixelDatatype})]}),d.clear=new r({color:d.clearColor,framebuffer:d.buffer})}}return s.prototype.updateDependencies=function(){this._updateDependencies=!0},s.prototype.update=function(e){var i=this._collection,n=this._updateDependencies,r=t(i.ambientOcclusion)&&i.ambientOcclusion.enabled&&i.ambientOcclusion._isSupported(e),o=t(i.bloom)&&i.bloom.enabled&&i.bloom._isSupported(e),a=t(i.fxaa)&&i.fxaa.enabled&&i.fxaa._isSupported(e),s=!t(i._activeStages)||i._activeStages.length>0||r||o||a;if((n||!s&&this._framebuffers.length>0)&&(m(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),n||s){0===this._framebuffers.length&&p(this,e);var u=e.drawingBufferWidth,l=e.drawingBufferHeight,c=this._width!==u||this._height!==l;(n||c)&&(this._width=u,this._height=l,this._updateDependencies=!1,m(this),f(this,e))}},s.prototype.clear=function(e){for(var t=this._framebuffers,i=0;i<0;++i)t[i].clear.execute(e)},s.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},s.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},s.prototype.getFramebuffer=function(e){var i=this._stageNameToFramebuffer[e];if(t(i))return i.buffer},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return m(this),n(this)},s}.apply(t,n))&&(e.exports=r)},1974:function(e,t,i){var n,r;n=[i(6)],void 0!==(r=function(e){"use strict";return e({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4})}.apply(t,n))&&(e.exports=r)},1975:function(e,t,i){var n,r;n=[i(99),i(38),i(760),i(17),i(10),i(41),i(24),i(27),i(25),i(150),i(42),i(221),i(1),i(0),i(2),i(21),i(3),i(39),i(128),i(71),i(9),i(20),i(424),i(747),i(69),i(59),i(771),i(34),i(423),i(61),i(749),i(60),i(422),i(47),i(1940),i(91),i(1949),i(1942),i(68),i(114),i(100),i(116),i(102),i(185),i(1947),i(220),i(1967),i(152),i(183),i(2189)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I,O,M,F,N,L,R,V,U,z,B,H,k,G,W,Y,j,X,Q,q){"use strict";function Z(e){e=h(e,h.EMPTY_OBJECT);var i=e.context;this._enabled=h(e.enabled,!0),this._softShadows=h(e.softShadows,!1),this._normalOffset=h(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=h(e.fromLightSource,!0),this.darkness=h(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=h(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var a=!0;(g.isInternetExplorer()||g.isEdge()||(g.isChrome()||g.isFirefox())&&g.isWindows()&&!i.depthTexture)&&(a=!1),this._polygonOffsetSupported=a,this._terrainBias={polygonOffset:a,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:a,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new x,this._shadowMapTexture=void 0,this._lightDirectionEC=new r,this._lightPositionEC=new o,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new me,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new t,this._isPointLight=h(e.isPointLight,!1),this._pointLightRadius=h(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&h(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?h(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new n,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new C:p(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new o,new o],this._cascadeMatrices=[new x,new x,new x,new x],this._cascadeDistances=new o;var s;s=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(s);for(var l=0;l<s;++l)this._passes[l]=new K(i);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=i.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,$(this),this._clearCommand=new b({depth:1,color:new u}),this._clearPassState=new N(i),this._size=h(e.size,2048),this.size=this._size}function K(e){this.camera=new me,this.passState=new N(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function J(e,t){return U.fromCache({cull:{enabled:!0,face:Y.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function $(e){var t=!e._usesDepthTexture;e._primitiveRenderState=J(t,e._primitiveBias),e._terrainRenderState=J(t,e._terrainBias),e._pointRenderState=J(t,e._pointBias)}function ee(e){for(var t=e._passes.length,i=0;i<t;++i){var n=e._passes[i],r=n.framebuffer;p(r)&&!r.isDestroyed()&&r.destroy(),n.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function te(){return new z({wrapS:G.CLAMP_TO_EDGE,wrapT:G.CLAMP_TO_EDGE,minificationFilter:k.NEAREST,magnificationFilter:H.NEAREST})}function ie(e,t){for(var i=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V.DEPTH_COMPONENT16}),n=new B({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.RGBA,pixelDatatype:L.UNSIGNED_BYTE,sampler:te()}),r=new M({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),o=e._passes.length,a=0;a<o;++a){var s=e._passes[a];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}function ne(e,t){for(var i=new B({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.DEPTH_STENCIL,pixelDatatype:L.UNSIGNED_INT_24_8,sampler:te()}),n=new M({context:t,depthStencilTexture:i,destroyAttachments:!1}),r=e._passes.length,o=0;o<r;++o){var a=e._passes[o];a.framebuffer=n,a.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}function re(e,t){for(var i=new R({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V.DEPTH_COMPONENT16}),n=new I({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:E.RGBA,pixelDatatype:L.UNSIGNED_BYTE,sampler:te()}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ],o=0;o<6;++o){var a=new M({context:t,depthRenderbuffer:i,colorTextures:[r[o]],destroyAttachments:!1}),s=e._passes[o];s.framebuffer=a,s.passState.framebuffer=a}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}function oe(e,t){e._isPointLight?re(e,t):e._usesDepthTexture?ne(e,t):ie(e,t)}function ae(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==S.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,$(e),ee(e),oe(e,t))}function se(e,t){p(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(ee(e),oe(e,t),ae(e,t),ue(e,t))}function ue(e,t,i){i=h(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}function le(t,i){t._size=i;var n=t._passes,r=n.length,o=t._textureSize;if(t._isPointLight){i=D.maximumCubeMapSize>=i?i:D.maximumCubeMapSize,o.x=i,o.y=i;var a=new e(0,0,i,i);n[0].passState.viewport=a,n[1].passState.viewport=a,n[2].passState.viewport=a,n[3].passState.viewport=a,n[4].passState.viewport=a,n[5].passState.viewport=a}else 1===r?(i=D.maximumTextureSize>=i?i:D.maximumTextureSize,o.x=i,o.y=i,n[0].passState.viewport=new e(0,0,i,i)):4===r&&(i=D.maximumTextureSize>=2*i?i:D.maximumTextureSize/2,o.x=2*i,o.y=2*i,n[0].passState.viewport=new e(0,0,i,i),n[1].passState.viewport=new e(i,0,i,i),n[2].passState.viewport=new e(0,i,i,i),n[3].passState.viewport=new e(i,i,i,i));t._clearPassState.viewport=new e(0,0,o.x,o.y);for(var s=0;s<r;++s){var u=n[s],l=u.passState.viewport,c=l.x/o.x,d=l.y/o.y,h=l.width/o.x,p=l.height/o.y;u.textureOffsets=new x(h,0,0,c,0,p,0,d,0,0,1,0,0,0,0,1)}}function ce(e,t){var i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=F.OVERLAY,n}function de(t,i){var n=i.context,r=i.context.drawingBufferWidth,o=i.context.drawingBufferHeight,a=.3*Math.min(r,o),s=Ce;s.x=r-a,s.y=0,s.width=a,s.height=a;var u=t._debugShadowViewCommand;p(u)||(u=ce(t,n),t._debugShadowViewCommand=u),p(u.renderState)&&e.equals(u.renderState.viewport,s)||(u.renderState=U.fromCache({viewport:e.clone(s)})),i.commandList.push(t._debugShadowViewCommand)}function he(e,t){var n=new v({geometry:new i({minimum:new r(-.5,-.5,-.5),maximum:new r(.5,.5,.5)}),attributes:{color:l.fromColor(t)}}),o=new v({geometry:new P({radius:.5}),attributes:{color:l.fromColor(t)}});return new Q({geometryInstances:[n,o],appearance:new X({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}function pe(e,t){de(e,t);var i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new j({camera:e._sceneCamera,color:u.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:u.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new j({camera:e._passes[n].camera,color:Se[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!p(e._debugLightFrustum)||e._needsUpdate){var o=e._shadowMapCamera.positionWC,a=A.IDENTITY,s=2*e._pointLightRadius,l=r.fromElements(s,s,s,be),c=x.fromTranslationQuaternionRotationScale(o,a,l,Ee);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=he(c,u.YELLOW)}e._debugLightFrustum.update(t)}else p(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new j({camera:e._shadowMapCamera,color:u.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function me(){this.viewMatrix=new x,this.inverseViewMatrix=new x,this.frustum=void 0,this.positionCartographic=new a,this.positionWC=new r,this.directionWC=r.clone(r.UNIT_Z),this.upWC=r.clone(r.UNIT_Y),this.rightWC=r.clone(r.UNIT_X),this.viewProjectionMatrix=new x}function fe(e,t){var i,n=e._shadowMapCamera,a=e._sceneCamera,s=a.frustum.near,u=a.frustum.far,l=e._numberOfCascades,c=u-s,d=u/s,h=.9,p=!1;t.shadowState.closestObjectSize<200&&(p=!0,h=.9);var m=Me,f=Ie;for(f[0]=s,f[l]=u,i=0;i<l;++i){var _=(i+1)/l,g=s*Math.pow(d,_),v=s+c*_,y=w.lerp(v,g,h);f[i+1]=y,m[i]=y-f[i]}if(p){for(i=0;i<l;++i)m[i]=Math.min(m[i],e._maximumCascadeDistances[i]);var C=f[0];for(i=0;i<l-1;++i)C+=m[i],f[i+1]=C}o.unpack(f,0,e._cascadeSplits[0]),o.unpack(f,1,e._cascadeSplits[1]),o.unpack(m,0,e._cascadeDistances);var T=n.frustum,E=T.left,A=T.right,P=T.bottom,S=T.top,b=T.near,D=T.far,I=n.positionWC,O=n.directionWC,M=n.upWC,F=a.frustum.clone(Oe),N=n.getViewProjection();for(i=0;i<l;++i){F.near=f[i],F.far=f[i+1];for(var L=x.multiply(F.projectionMatrix,a.viewMatrix,Ee),R=x.inverse(L,Ee),V=x.multiply(N,R,Ee),U=r.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Fe),z=r.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Ne),B=0;B<8;++B){var H=o.clone(Te[B],Ae[B]);x.multiplyByVector(V,H,H),r.divideByScalar(H,H.w,H),r.minimumByComponent(H,U,U),r.maximumByComponent(H,z,z)}U.x=Math.max(U.x,0),U.y=Math.max(U.y,0),U.z=0,z.x=Math.min(z.x,1),z.y=Math.min(z.y,1),z.z=Math.min(z.z,1);var k=e._passes[i],G=k.camera;G.clone(n);var W=G.frustum;W.left=E+U.x*(A-E),W.right=E+z.x*(A-E),W.bottom=P+U.y*(S-P),W.top=P+z.y*(S-P),W.near=b+U.z*(D-b),W.far=b+z.z*(D-b),k.cullingVolume=G.frustum.computeCullingVolume(I,O,M);var Y=e._cascadeMatrices[i];x.multiply(G.getViewProjection(),a.inverseViewMatrix,Y),x.multiply(k.textureOffsets,Y,Y)}}function _e(e,t){var i=e._shadowMapCamera,n=e._sceneCamera,a=x.multiply(n.frustum.projectionMatrix,n.viewMatrix,Ee),s=x.inverse(a,Ee),u=i.directionWC,l=n.directionWC,c=r.cross(u,l,Re);l=r.cross(c,u,Ve),r.normalize(l,l),r.normalize(c,c);for(var d=r.fromElements(0,0,0,Ue),h=x.computeView(d,u,l,c,Le),p=x.multiply(h,s,Ee),m=r.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Fe),f=r.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Ne),_=0;_<8;++_){var g=o.clone(Te[_],Ae[_]);x.multiplyByVector(p,g,g),r.divideByScalar(g,g.w,g),r.minimumByComponent(g,m,m),r.maximumByComponent(g,f,f)}f.z+=1e3,m.z-=10;var v=Ue;v.x=-.5*(m.x+f.x),v.y=-.5*(m.y+f.y),v.z=-f.z;var y=x.fromTranslation(v,Ee);h=x.multiply(y,h,h);var w=.5*(f.x-m.x),C=.5*(f.y-m.y),T=f.z-m.z,E=i.frustum;E.left=-w,E.right=w,E.bottom=-C,E.top=C,E.near=.01,E.far=T,x.clone(h,i.viewMatrix),x.inverse(h,i.inverseViewMatrix),x.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),r.clone(u,i.directionWC),r.clone(l,i.upWC),r.clone(c,i.rightWC)}function ge(e,t){var i=new T;i.fov=w.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(var n=0;n<6;++n){var r=e._passes[n].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=ze[n],r.upWC=Be[n],r.rightWC=He[n],x.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),x.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}function ve(e,i){var n=e._sceneCamera,o=e._shadowMapCamera,a=We;if(e._cascadesEnabled){if(n.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var s=i.mapProjection.ellipsoid.geodeticSurfaceNormal(n.positionWC,ke),u=r.negate(o.directionWC,Ge),l=r.dot(s,u),c=w.clamp(l/.1,0,1);if(e._darkness=w.lerp(1,e.darkness,c),l<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)a.center=o.positionWC,a.radius=e._pointLightRadius,e._outOfView=i.cullingVolume.computeVisibility(a)===y.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere);else{var d=o.frustum.far/2,h=r.add(o.positionWC,r.multiplyByScalar(o.directionWC,d,Ye),Ye);a.center=h,a.radius=d,e._outOfView=i.cullingVolume.computeVisibility(a)===y.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere)}}function ye(e,t){var i=t.camera,n=e._lightCamera,o=e._sceneCamera,a=e._shadowMapCamera;e._cascadesEnabled?r.clone(n.directionWC,a.directionWC):e._isPointLight?r.clone(n.positionWC,a.positionWC):a.clone(n);var s=e._lightDirectionEC;x.multiplyByPointAsVector(i.viewMatrix,a.directionWC,s),r.normalize(s,s),r.negate(s,s),x.multiplyByPoint(i.viewMatrix,a.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius;var u,l;e._fitNearFar?(u=Math.min(t.shadowState.nearPlane,e.maximumDistance),l=Math.min(t.shadowState.farPlane,e.maximumDistance+1)):(u=i.frustum.near,l=e.maximumDistance),e._sceneCamera=W.clone(i,o),i.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=u,e._sceneCamera.frustum.far=l,e._distance=l-u,ve(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}function we(e,t,i){var n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=je;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,o.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return o.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new o,combinedUniforms2:new o};return c(t,r,!1)}function xe(e,t,i,n,r,o){var a,u,l;if(p(o)&&(a=o.shaderProgram,u=o.renderState,l=o.uniformMap),o=O.shallowClone(i,o),o.castShadows=!0,o.receiveShadows=!1,!p(a)||r!==i.shaderProgram.id||t){var c=i.shaderProgram,d=i.pass===F.GLOBE,h=i.pass!==F.TRANSLUCENT,m=e._isPointLight,f=e._usesDepthTexture,_=q.getShadowCastShaderKeyword(m,d,f,h);if(a=n.shaderCache.getDerivedShaderProgram(c,_),!p(a)){var g=c.vertexShaderSource,v=c.fragmentShaderSource,y=q.createShadowCastVertexShader(g,m,d),w=q.createShadowCastFragmentShader(v,m,f,h);a=n.shaderCache.createDerivedShaderProgram(c,_,{vertexShaderSource:y,fragmentShaderSource:w,attributeLocations:c._attributeLocations})}u=e._primitiveRenderState,m?u=e._pointRenderState:d&&(u=e._terrainRenderState);i.renderState.cull.enabled||(u=s(u,!1),u.cull=s(u.cull,!1),u.cull.enabled=!1,u=U.fromCache(u)),l=we(e,i.uniformMap,d)}return o.shaderProgram=a,o.renderState=u,o.uniformMap=l,o}Z.MAXIMUM_DISTANCE=2e4,Z.prototype.debugCreateRenderStates=function(){$(this)},m(Z.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){le(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var Ce=new e,Te=new Array(8);Te[0]=new o(-1,-1,-1,1),Te[1]=new o(1,-1,-1,1),Te[2]=new o(1,1,-1,1),Te[3]=new o(-1,1,-1,1),Te[4]=new o(-1,-1,1,1),Te[5]=new o(1,-1,1,1),Te[6]=new o(1,1,1,1),Te[7]=new o(-1,1,1,1);for(var Ee=new x,Ae=new Array(8),Pe=0;Pe<8;++Pe)Ae[Pe]=new o;var Se=[u.RED,u.GREEN,u.BLUE,u.MAGENTA],be=new r;me.prototype.clone=function(e){x.clone(e.viewMatrix,this.viewMatrix),x.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),a.clone(e.positionCartographic,this.positionCartographic),r.clone(e.positionWC,this.positionWC),r.clone(e.directionWC,this.directionWC),r.clone(e.upWC,this.upWC),r.clone(e.rightWC,this.rightWC)};var De=new x(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);me.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return x.multiply(t,e,this.viewProjectionMatrix),x.multiply(De,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var Ie=new Array(5),Oe=new T,Me=new Array(4),Fe=new r,Ne=new r,Le=new x,Re=new r,Ve=new r,Ue=new r,ze=[new r(-1,0,0),new r(0,-1,0),new r(0,0,-1),new r(1,0,0),new r(0,1,0),new r(0,0,1)],Be=[new r(0,-1,0),new r(0,0,-1),new r(0,-1,0),new r(0,-1,0),new r(0,0,1),new r(0,-1,0)],He=[new r(0,0,1),new r(1,0,0),new r(-1,0,0),new r(0,0,-1),new r(1,0,0),new r(1,0,0)],ke=new r,Ge=new r,We=new t,Ye=We.center;Z.prototype.update=function(e){if(ye(this,e),this._needsUpdate)if(se(this,e.context),this._isPointLight&&ge(this,e),this._cascadesEnabled&&(_e(this,e),this._numberOfCascades>1&&fe(this,e)),this._isPointLight)this._shadowMapCullingVolume=d.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,i=t.positionWC,n=t.directionWC,r=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(i,n,r),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var o=this._sceneCamera.inverseViewMatrix;x.multiply(this._shadowMapCamera.getViewProjection(),o,this._shadowMapMatrix)}this.debugShow&&pe(this,e)},Z.prototype.updatePass=function(e,t){ue(this,e,t)};var je=new n;return Z.createReceiveDerivedCommand=function(e,t,i,n,r){p(r)||(r={});var o=e.length>0,a=t.shaderProgram,s=a.vertexShaderSource,u=a.fragmentShaderSource,l=t.pass===F.GLOBE,c=!1;if(l&&(c=t.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),t.receiveShadows&&o){var d,h;p(r.receiveCommand)&&(d=r.receiveCommand.shaderProgram,h=r.receiveCommand.uniformMap),r.receiveCommand=O.shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var m=r.receiveShaderCastShadows!==t.castShadows,f=r.receiveShaderProgramId!==t.shaderProgram.id;if(!p(d)||f||i||m){var _=q.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,c);if(d=n.shaderCache.getDerivedShaderProgram(a,_),!p(d)){var g=q.createShadowReceiveVertexShader(s,l,c),v=q.createShadowReceiveFragmentShader(u,e[0],t.castShadows,l,c);d=n.shaderCache.createDerivedShaderProgram(a,_,{vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:a._attributeLocations})}h=we(e[0],t.uniformMap,l)}r.receiveCommand.shaderProgram=d,r.receiveCommand.uniformMap=h,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},Z.createCastDerivedCommand=function(e,t,i,n,r){if(p(r)||(r={}),t.castShadows){var o=r.castCommands;p(o)||(o=r.castCommands=[]);var a=r.castShaderProgramId,s=e.length;o.length=s;for(var u=0;u<s;++u)o[u]=xe(e[u],i,t,n,a,o[u]);r.castShaderProgramId=t.shaderProgram.id}return r},Z.prototype.isDestroyed=function(){return!1},Z.prototype.destroy=function(){ee(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return f(this)},Z}.apply(t,n))&&(e.exports=r)},1976:function(e,t,i){var n,r;n=[i(25),i(0),i(21),i(69),i(423),i(422),i(91),i(1949),i(1942),i(68),i(114),i(100),i(116),i(102),i(185)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(){this._colorTexture=void 0,this._idTexture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._framebuffer=void 0,this._idFramebuffer=void 0,this._idClearColor=new e(0,0,0,0),this._clearCommand=new r({color:new e(0,0,0,0),depth:1,owner:this})}function _(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._idFramebuffer=e._idFramebuffer&&e._idFramebuffer.destroy(),e._colorTexture=e._colorTexture&&e._colorTexture.destroy(),e._idTexture=e._idTexture&&e._idTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy(),e._depthStencilIdTexture=e._depthStencilIdTexture&&e._depthStencilIdTexture.destroy(),e._depthStencilIdRenderbuffer=e._depthStencilIdRenderbuffer&&e._depthStencilIdRenderbuffer.destroy(),e._framebuffer=void 0,e._idFramebuffer=void 0,e._colorTexture=void 0,e._idTexture=void 0,e._depthStencilTexture=void 0,e._depthStencilRenderbuffer=void 0,e._depthStencilIdTexture=void 0,e._depthStencilIdRenderbuffer=void 0}return f.prototype.update=function(e,i){var r=i.width,l=i.height,f=this._colorTexture;t(f)&&f.width===r&&f.height===l||(_(this),this._colorTexture=new d({context:e,width:r,height:l,pixelFormat:n.RGBA,pixelDatatype:a.UNSIGNED_BYTE,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),this._idTexture=new d({context:e,width:r,height:l,pixelFormat:n.RGBA,pixelDatatype:a.UNSIGNED_BYTE,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),e.depthTexture?(this._depthStencilTexture=new d({context:e,width:r,height:l,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:a.UNSIGNED_INT_24_8,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})}),this._depthStencilIdTexture=new d({context:e,width:r,height:l,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:a.UNSIGNED_INT_24_8,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})})):(this._depthStencilRenderbuffer=new s({context:e,width:r,height:l,format:u.DEPTH_STENCIL}),this._depthStencilIdRenderbuffer=new s({context:e,width:r,height:l,format:u.DEPTH_STENCIL})),this._framebuffer=new o({context:e,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}),this._idFramebuffer=new o({context:e,colorTextures:[this._idTexture],depthStencilTexture:this._depthStencilIdTexture,depthStencilRenderbuffer:this._depthStencilIdRenderbuffer,destroyAttachments:!1}))},f.prototype.clear=function(t,i,n){var r=i.framebuffer;i.framebuffer=this._framebuffer,e.clone(n,this._clearCommand.color),this._clearCommand.execute(t,i),i.framebuffer=this._idFramebuffer,e.clone(this._idClearColor,this._clearCommand.color),this._clearCommand.execute(t,i),i.framebuffer=r},f.prototype.getFramebuffer=function(){return this._framebuffer},f.prototype.getIdFramebuffer=function(){return this._idFramebuffer},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return _(this),i(this)},f}.apply(t,n))&&(e.exports=r)},1977:function(e,t,i){var n,r;n=[i(9)],void 0!==(r=function(e){"use strict";var t={};return t.computePositions=function(t,i,n,r,o){var a,s=.5*t,u=-s,l=r+r,c=o?2*l:l,d=new Float64Array(3*c),h=0,p=0,m=o?3*l:0,f=o?3*(l+r):3*r;for(a=0;a<r;a++){var _=a/r*e.TWO_PI,g=Math.cos(_),v=Math.sin(_),y=g*n,w=v*n,x=g*i,C=v*i;d[p+m]=y,d[p+m+1]=w,d[p+m+2]=u,d[p+f]=x,d[p+f+1]=C,d[p+f+2]=s,p+=3,o&&(d[h++]=y,d[h++]=w,d[h++]=u,d[h++]=x,d[h++]=C,d[h++]=s)}return d},t}.apply(t,n))&&(e.exports=r)},1978:function(e,t,i){var n,r;n=[i(10),i(24),i(12),i(0),i(2),i(21),i(15),i(215),i(9),i(153),i(46),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d){"use strict";function h(i,r,o,u){this._scene=i,this._heightReference=o,this._extrudedHeightReference=u,this._positionProperty=r,this._position=new e,this._cartographicPosition=new t,this._normal=new e,this._definitionChanged=new a,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;var l=this;if(n(i.globe)&&(this._removeEventListener=i.terrainProviderChanged.addEventListener(function(){l._updateClamping()}),this._removeModeListener=i.morphComplete.addEventListener(function(){l._updateClamping()})),r.isConstant){var c=r.getValue(s.MINIMUM_VALUE,p);if(!n(c)||e.equals(c,e.ZERO)||!n(i.globe))return;this._position=e.clone(c,this._position),this._updateClamping(),this._normal=i.globe.ellipsoid.geodeticSurfaceNormal(c,this._normal)}}var p=new e,m=new t;return r(h.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),h.prototype._updateClamping=function(){function t(e){if(i.mode===c.SCENE3D){var t=a.cartesianToCartographic(e,m);u._terrainHeight=t.height}else u._terrainHeight=e.x;u.definitionChanged.raiseEvent()}n(this._removeCallbackFunc)&&this._removeCallbackFunc();var i=this._scene,r=i.globe,o=this._position;if(!n(r)||e.equals(o,e.ZERO))return void(this._terrainHeight=0);var a=r.ellipsoid,s=r._surface,u=this,l=a.cartesianToCartographic(o,this._cartographicPosition),d=r.getHeight(l);n(d)?this._terrainHeight=d:this._terrainHeight=0,this._removeCallbackFunc=s.updateHeight(l,t)},h.prototype.getValue=function(t,i){var r=d.getValueOrDefault(this._heightReference,t,l.NONE),o=d.getValueOrDefault(this._extrudedHeightReference,t,l.NONE);if(r===l.NONE&&o!==l.RELATIVE_TO_GROUND)return this._position=e.clone(e.ZERO,this._position),e.clone(e.ZERO,i);if(this._positionProperty.isConstant)return e.multiplyByScalar(this._normal,this._terrainHeight,i);var a=this._scene,s=this._positionProperty.getValue(t,p);if(!n(s)||e.equals(s,e.ZERO)||!n(a.globe))return e.clone(e.ZERO,i);if(e.equalsEpsilon(this._position,s,u.EPSILON10))return e.multiplyByScalar(this._normal,this._terrainHeight,i);this._position=e.clone(s,this._position),this._updateClamping();var c=a.globe.ellipsoid.geodeticSurfaceNormal(s,this._normal);return e.multiplyByScalar(c,this._terrainHeight,i)},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return n(this._removeEventListener)&&this._removeEventListener(),n(this._removeModeListener)&&this._removeModeListener(),n(this._removeCallbackFunc)&&this._removeCallbackFunc(),o(this)},h}.apply(t,n))&&(e.exports=r)},1979:function(e,t,i){var n,r;n=[i(10),i(1938),i(0),i(9),i(40),i(748),i(1959),i(59)],void 0!==(r=function(e,t,i,n,r,o,a,s){"use strict";function u(i,o,a,u,l){var c=e.angleBetween(e.subtract(o,i,p),e.subtract(a,i,m)),d=u===t.BEVELED?1:Math.ceil(c/n.toRadians(5))+1,h=3*d,f=new Array(h);f[h-3]=a.x,f[h-2]=a.y,f[h-1]=a.z;var _;_=l?r.fromQuaternion(s.fromAxisAngle(e.negate(i,p),c/d,b),D):r.fromQuaternion(s.fromAxisAngle(i,c/d,b),D);var g=0;o=e.clone(o,p);for(var v=0;v<d;v++)o=r.multiplyByVector(_,o,o),f[g++]=o.x,f[g++]=o.y,f[g++]=o.z;return f}function l(i){var n=v,r=y,o=w,a=i[1];r=e.fromArray(i[1],a.length-3,r),o=e.fromArray(i[0],0,o),n=e.midpoint(r,o,n);var s=u(n,r,o,t.ROUNDED,!1),l=i.length-1,c=i[l-1];return a=i[l],r=e.fromArray(c,c.length-3,r),o=e.fromArray(a,0,o),n=e.midpoint(r,o,n),[s,u(n,r,o,t.ROUNDED,!1)]}function c(t,i,n,r){var o=p;return r?o=e.add(t,i,o):(i=e.negate(i,i),o=e.add(t,i,o)),[o.x,o.y,o.z,n.x,n.y,n.z]}function d(t,i,n,r){for(var o=new Array(t.length),a=new Array(t.length),s=e.multiplyByScalar(i,n,p),u=e.negate(s,m),l=0,c=t.length-1,d=0;d<t.length;d+=3){var h=e.fromArray(t,d,f),g=e.add(h,u,_);o[l++]=g.x,o[l++]=g.y,o[l++]=g.z;var v=e.add(h,s,_);a[c--]=v.z,a[c--]=v.y,a[c--]=v.x}return r.push(o,a),r}var h={},p=new e,m=new e,f=new e,_=new e,g=[new e,new e],v=new e,y=new e,w=new e,x=new e,C=new e,T=new e,E=new e,A=new e,P=new e,S=new e,b=new s,D=new r;h.addAttribute=function(e,t,n,r){var o=t.x,a=t.y,s=t.z;i(n)&&(e[n]=o,e[n+1]=a,e[n+2]=s),i(r)&&(e[r]=s,e[r-1]=a,e[r-2]=o)};var I=new e,O=new e;return h.computePositions=function(i){var r=i.granularity,s=i.positions,h=i.ellipsoid,m=i.width/2,f=i.cornerType,_=i.saveAttributes,b=v,D=y,M=w,F=x,N=C,L=T,R=E,V=A,U=P,z=S,B=[],H=_?[]:void 0,k=_?[]:void 0,G=s[0],W=s[1];D=e.normalize(e.subtract(W,G,D),D),b=h.geodeticSurfaceNormal(G,b),F=e.normalize(e.cross(b,D,F),F),_&&(H.push(F.x,F.y,F.z),k.push(b.x,b.y,b.z)),R=e.clone(G,R),G=W,M=e.negate(D,M);var Y,j,X=[],Q=s.length;for(j=1;j<Q-1;j++){b=h.geodeticSurfaceNormal(G,b),W=s[j+1],D=e.normalize(e.subtract(W,G,D),D),N=e.normalize(e.add(D,M,N),N);var q=e.multiplyByScalar(b,e.dot(D,b),I);e.subtract(D,q,q),e.normalize(q,q);var Z=e.multiplyByScalar(b,e.dot(M,b),O);e.subtract(M,Z,Z),e.normalize(Z,Z);if(!n.equalsEpsilon(Math.abs(e.dot(q,Z)),1,n.EPSILON7)){N=e.cross(N,b,N),N=e.cross(b,N,N),N=e.normalize(N,N);var K=m/Math.max(.25,e.magnitude(e.cross(N,M,p))),J=a.angleIsGreaterThanPi(D,M,G,h);N=e.multiplyByScalar(N,K,N),J?(V=e.add(G,N,V),z=e.add(V,e.multiplyByScalar(F,m,z),z),U=e.add(V,e.multiplyByScalar(F,2*m,U),U),g[0]=e.clone(R,g[0]),g[1]=e.clone(z,g[1]),Y=o.generateArc({positions:g,granularity:r,ellipsoid:h}),B=d(Y,F,m,B),_&&(H.push(F.x,F.y,F.z),k.push(b.x,b.y,b.z)),L=e.clone(U,L),F=e.normalize(e.cross(b,D,F),F),U=e.add(V,e.multiplyByScalar(F,2*m,U),U),R=e.add(V,e.multiplyByScalar(F,m,R),R),f===t.ROUNDED||f===t.BEVELED?X.push({leftPositions:u(V,L,U,f,J)}):X.push({leftPositions:c(G,e.negate(N,N),U,J)})):(U=e.add(G,N,U),z=e.add(U,e.negate(e.multiplyByScalar(F,m,z),z),z),V=e.add(U,e.negate(e.multiplyByScalar(F,2*m,V),V),V),g[0]=e.clone(R,g[0]),g[1]=e.clone(z,g[1]),Y=o.generateArc({positions:g,granularity:r,ellipsoid:h}),B=d(Y,F,m,B),_&&(H.push(F.x,F.y,F.z),k.push(b.x,b.y,b.z)),L=e.clone(V,L),F=e.normalize(e.cross(b,D,F),F),V=e.add(U,e.negate(e.multiplyByScalar(F,2*m,V),V),V),R=e.add(U,e.negate(e.multiplyByScalar(F,m,R),R),R),f===t.ROUNDED||f===t.BEVELED?X.push({rightPositions:u(U,L,V,f,J)}):X.push({rightPositions:c(G,N,V,J)})),M=e.negate(D,M)}G=W}b=h.geodeticSurfaceNormal(G,b),g[0]=e.clone(R,g[0]),g[1]=e.clone(G,g[1]),Y=o.generateArc({positions:g,granularity:r,ellipsoid:h}),B=d(Y,F,m,B),_&&(H.push(F.x,F.y,F.z),k.push(b.x,b.y,b.z));var $;return f===t.ROUNDED&&($=l(B)),{positions:B,corners:X,lefts:H,normals:k,endPositions:$}},h}.apply(t,n))&&(e.exports=r)},1980:function(e,t,i){var n,r;n=[i(182),i(0),i(744)],void 0!==(r=function(e,t,i){"use strict";function n(t,i){this._primitives=t,this._orderedGroundPrimitives=i,this._dynamicUpdaters=new e}return n.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))},n.prototype.remove=function(e){var i=e.id,n=this._dynamicUpdaters.get(i);t(n)&&(this._dynamicUpdaters.remove(i),n.destroy())},n.prototype.update=function(e){for(var t=this._dynamicUpdaters.values,i=0,n=t.length;i<n;i++)t[i].update(e);return!0},n.prototype.removeAllPrimitives=function(){for(var e=this._dynamicUpdaters.values,t=0,i=e.length;t<i;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},n.prototype.getBoundingSphere=function(e,n){return e=this._dynamicUpdaters.get(e.id),t(e)&&t(e.getBoundingSphere)?e.getBoundingSphere(n):i.FAILED},n}.apply(t,n))&&(e.exports=r)},1981:function(e,t,i){var n,r;n=[i(10),i(9),i(40),i(59)],void 0!==(r=function(e,t,i,n){"use strict";function r(t,r,o,c,d,h,p,m,f,_){var g=t+r;e.multiplyByScalar(c,Math.cos(g),a),e.multiplyByScalar(o,Math.sin(g),s),e.add(a,s,a);var v=Math.cos(t);v*=v;var y=Math.sin(t);y*=y;var w=h/Math.sqrt(p*v+d*y),x=w/m;return n.fromAxisAngle(a,x,u),i.fromQuaternion(u,l),i.multiplyByVector(l,f,_),e.normalize(_,_),e.multiplyByScalar(_,m,_),_}var o={},a=new e,s=new e,u=new n,l=new i,c=new e,d=new e,h=new e,p=new e;o.raisePositionsToHeight=function(t,i,n){for(var r=i.ellipsoid,o=i.height,a=i.extrudedHeight,s=n?t.length/3*2:t.length/3,u=new Float64Array(3*s),l=t.length,m=n?l:0,f=0;f<l;f+=3){var _=f+1,g=f+2,v=e.fromArray(t,f,c);r.scaleToGeodeticSurface(v,v);var y=e.clone(v,d),w=r.geodeticSurfaceNormal(v,p),x=e.multiplyByScalar(w,o,h);e.add(v,x,v),n&&(e.multiplyByScalar(w,a,x),e.add(y,x,y),u[f+m]=y.x,u[_+m]=y.y,u[g+m]=y.z),u[f]=v.x,u[_]=v.y,u[g]=v.z}return u};var m=new e,f=new e,_=new e;return o.computeEllipsePositions=function(i,n,o){var a=i.semiMinorAxis,s=i.semiMajorAxis,u=i.rotation,l=i.center,p=8*i.granularity,g=a*a,v=s*s,y=s*a,w=e.magnitude(l),x=e.normalize(l,m),C=e.cross(e.UNIT_Z,l,f);C=e.normalize(C,C);var T=e.cross(x,C,_),E=1+Math.ceil(t.PI_OVER_TWO/p),A=t.PI_OVER_TWO/(E-1),P=t.PI_OVER_TWO-E*A;P<0&&(E-=Math.ceil(Math.abs(P)/A));var S,b,D,I,O,M=E*(E+2)*2,F=n?new Array(3*M):void 0,N=0,L=c,R=d,V=4*E*3,U=V-1,z=0,B=o?new Array(V):void 0;for(P=t.PI_OVER_TWO,L=r(P,u,T,C,g,y,v,w,x,L),n&&(F[N++]=L.x,F[N++]=L.y,F[N++]=L.z),o&&(B[U--]=L.z,B[U--]=L.y,B[U--]=L.x),P=t.PI_OVER_TWO-A,S=1;S<E+1;++S){if(L=r(P,u,T,C,g,y,v,w,x,L),R=r(Math.PI-P,u,T,C,g,y,v,w,x,R),n){for(F[N++]=L.x,F[N++]=L.y,F[N++]=L.z,D=2*S+2,b=1;b<D-1;++b)I=b/(D-1),O=e.lerp(L,R,I,h),F[N++]=O.x,F[N++]=O.y,F[N++]=O.z;F[N++]=R.x,F[N++]=R.y,F[N++]=R.z}o&&(B[U--]=L.z,B[U--]=L.y,B[U--]=L.x,B[z++]=R.x,B[z++]=R.y,B[z++]=R.z),P=t.PI_OVER_TWO-(S+1)*A}for(S=E;S>1;--S){if(P=t.PI_OVER_TWO-(S-1)*A,L=r(-P,u,T,C,g,y,v,w,x,L),R=r(P+Math.PI,u,T,C,g,y,v,w,x,R),n){for(F[N++]=L.x,F[N++]=L.y,F[N++]=L.z,D=2*(S-1)+2,b=1;b<D-1;++b)I=b/(D-1),O=e.lerp(L,R,I,h),F[N++]=O.x,F[N++]=O.y,F[N++]=O.z;F[N++]=R.x,F[N++]=R.y,F[N++]=R.z}o&&(B[U--]=L.z,B[U--]=L.y,B[U--]=L.x,B[z++]=R.x,B[z++]=R.y,B[z++]=R.z)}P=t.PI_OVER_TWO,L=r(-P,u,T,C,g,y,v,w,x,L);var H={};return n&&(F[N++]=L.x,F[N++]=L.y,F[N++]=L.z,H.positions=F,H.numPts=E),o&&(B[U--]=L.z,B[U--]=L.y,B[U--]=L.x,H.outerPositions=B),H},o}.apply(t,n))&&(e.exports=r)},1982:function(e,t,i){var n,r;n=[i(0),i(17),i(10),i(12),i(157),i(9),i(40),i(118)],void 0!==(r=function(e,t,i,n,r,o,a,s){"use strict";function u(e,n,r,o,a){var s=i.subtract(e,n,c),u=i.dot(r,s),l=i.dot(o,s);return t.fromElements(u,l,a)}var l={},c=new i,d=new i,h=new i,p=new i,m=new s;return l.validOutline=function(e){var t=s.fromPoints(e,m),n=t.halfAxes,r=a.getColumn(n,0,d),o=a.getColumn(n,1,h),u=a.getColumn(n,2,p),l=i.magnitude(r),c=i.magnitude(o),f=i.magnitude(u);return!(0===l&&(0===c||0===f)||0===c&&0===f)},l.computeProjectTo2DArguments=function(e,t,n,r){var o=s.fromPoints(e,m),u=o.halfAxes,l=a.getColumn(u,0,d),c=a.getColumn(u,1,h),f=a.getColumn(u,2,p),_=i.magnitude(l),g=i.magnitude(c),v=i.magnitude(f),y=Math.min(_,g,v);if(0===_&&(0===g||0===v)||0===g&&0===v)return!1;var w,x;return y!==g&&y!==v||(w=l),y===_?w=c:y===v&&(x=c),y!==_&&y!==g||(x=f),i.normalize(w,n),i.normalize(x,r),i.clone(o.center,t),!0},l.createProjectPointsTo2DFunction=function(e,t,i){return function(n){for(var r=new Array(n.length),o=0;o<n.length;o++)r[o]=u(n[o],e,t,i);return r}},l.createProjectPointTo2DFunction=function(e,t,i){return function(n,r){return u(n,e,t,i,r)}},l}.apply(t,n))&&(e.exports=r)},1983:function(e,t,i){var n,r;n=[i(182),i(10),i(25),i(150),i(0),i(154),i(1934),i(745),i(1933),i(183),i(744),i(421),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(t,i,n,o,a,s,u){this.translucent=i,this.appearanceType=n,this.depthFailAppearanceType=o,this.depthFailMaterialProperty=a,this.depthFailMaterial=void 0,this.closed=s,this.shadows=u,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[],this.invalidated=!1;var l;r(a)&&(l=a.definitionChanged.addEventListener(m.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=l}function f(e,t,i,n,r){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}function _(e,t){for(var i=e.length,n=i-1;n>=0;n--){var r=e[n];if(r.remove(t)&&0===r.updaters.length)return e.splice(n,1),r.destroy(),!0}return!1}function g(e,t,i){for(var n=!1,r=t.length,o=0;o<r;++o){var a=t[o],s=a.itemsToRemove,u=s.length;if(u>0)for(o=0;o<u;o++){var l=s[o];a.remove(l),e.add(i,l),n=!0}}return n}function v(e,t,i,n){var r,o=t.length;for(r=o-1;r>=0;r--){var a=t[r];if(a.invalidated){t.splice(r,1);for(var s=a.updaters.values,u=s.length,l=0;l<u;l++)e.add(i,s[l]);a.destroy()}}for(o=t.length,r=0;r<o;++r)n=t[r].update(i)&&n;return n}function y(e,t,i){for(var n=e.length,r=0;r<n;r++){var o=e[r];if(o.contains(t))return o.getBoundingSphere(t,i)}return c.FAILED}function w(e){for(var t=e.length,i=0;i<t;i++)e[i].destroy();e.length=0}var x=new i,C=new o,T=new o,E=t.ZERO,A=new t;return m.prototype.onMaterialChanged=function(){this.invalidated=!0},m.prototype.isMaterial=function(e){var t=this.depthFailMaterialProperty,i=e.depthFailMaterialProperty;return i===t||!!r(t)&&t.equals(i)},m.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&p.isConstant(e.distanceDisplayConditionProperty)&&p.isConstant(e.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,r,o){"isShowing"===i&&n.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},m.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);r(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t))}},m.prototype.update=function(e){var c,m=!0,f=0,_=this.primitive,g=this.primitives;if(this.createPrimitive){var v=this.geometry.values;if(v.length>0){r(_)&&(r(this.oldPrimitive)?g.remove(_):this.oldPrimitive=_);var y;r(this.depthFailAppearanceType)&&(r(this.depthFailMaterialProperty)&&(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),y=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),_=new l({show:!1,asynchronous:!0,geometryInstances:v,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:y,shadows:this.shadows}),g.add(_),m=!1}else{r(_)&&(g.remove(_),_=void 0);var w=this.oldPrimitive;r(w)&&(g.remove(w),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=_,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(r(_)&&_.ready){_.show=!0,r(this.oldPrimitive)&&(g.remove(this.oldPrimitive),this.oldPrimitive=void 0),!r(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof d||(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var P=this.updatersWithAttributes.values,S=P.length,b=this.waitingOnCreate;for(c=0;c<S;c++){var D=P[c],I=this.geometry.get(D.id),O=this.attributes.get(I.id.id);if(r(O)||(O=_.getGeometryInstanceAttributes(I.id),this.attributes.set(I.id.id,O)),!D.fillMaterialProperty.isConstant||b){var M=D.fillMaterialProperty.color,F=p.getValueOrDefault(M,e,i.WHITE,x);i.equals(O._lastColor,F)||(O._lastColor=i.clone(F,O._lastColor),O.color=n.toValue(F,O.color),(this.translucent&&255===O.color[3]||!this.translucent&&255!==O.color[3])&&(this.itemsToRemove[f++]=D))}if(r(this.depthFailAppearanceType)&&D.depthFailMaterialProperty instanceof d&&(!D.depthFailMaterialProperty.isConstant||b)){var N=D.depthFailMaterialProperty.color,L=p.getValueOrDefault(N,e,i.WHITE,x);i.equals(O._lastDepthFailColor,L)||(O._lastDepthFailColor=i.clone(L,O._lastDepthFailColor),O.depthFailColor=n.toValue(L,O.depthFailColor))}var R=D.entity.isShowing&&(D.hasConstantFill||D.isFilled(e)),V=1===O.show[0];R!==V&&(O.show=u.toValue(R,O.show));var U=D.distanceDisplayConditionProperty;if(!p.isConstant(U)){var z=p.getValueOrDefault(U,e,T,C);o.equals(z,O._lastDistanceDisplayCondition)||(O._lastDistanceDisplayCondition=o.clone(z,O._lastDistanceDisplayCondition),O.distanceDisplayCondition=a.toValue(z,O.distanceDisplayCondition))}var B=D.terrainOffsetProperty;if(!p.isConstant(B)){var H=p.getValueOrDefault(B,e,E,A);t.equals(H,O._lastOffset)||(O._lastOffset=t.clone(H,O._lastOffset),O.offset=s.toValue(H,O.offset))}}this.updateShows(_),this.waitingOnCreate=!1}else r(_)&&!_.ready&&(m=!1);return this.itemsToRemove.length=f,m},m.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var o=t[n],a=this.geometry.get(o.id),s=this.attributes.get(a.id.id);r(s)||(s=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s));var l=o.entity.isShowing;l!==(1===s.show[0])&&(s.show=u.toValue(l,s.show))}this.showsUpdated.removeAll()},m.prototype.contains=function(e){return this.updaters.contains(e.id)},m.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return c.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!r(n)||!r(n.boundingSphere)||r(n.show)&&0===n.show[0]?c.FAILED:(n.boundingSphere.clone(t),c.DONE)},m.prototype.destroy=function(){var e=this.primitive,t=this.primitives;r(e)&&t.remove(e);var i=this.oldPrimitive;r(i)&&t.remove(i),r(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},f.prototype.add=function(e,t){var i,n,r=t.createFillGeometryInstance(e);255===r.attributes.color.value[3]?(i=this._solidItems,n=!1):(i=this._translucentItems,n=!0);for(var o=i.length,a=0;a<o;a++){var s=i[a];if(s.isMaterial(t))return void s.add(t,r)}var u=new m(this._primitives,n,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);u.add(t,r),i.push(u)},f.prototype.remove=function(e){_(this._solidItems,e)||_(this._translucentItems,e)},f.prototype.update=function(e){var t=v(this,this._solidItems,e,!0);t=v(this,this._translucentItems,e,t)&&t;var i=g(this,this._solidItems,e),n=g(this,this._translucentItems,e);return(i||n)&&(t=v(this,this._solidItems,e,t)&&t,t=v(this,this._translucentItems,e,t)&&t),t},f.prototype.getBoundingSphere=function(e,t){var i=y(this._solidItems,e,t);return i===c.FAILED?y(this._translucentItems,e,t):i},f.prototype.removeAllPrimitives=function(){w(this._solidItems),w(this._translucentItems)},f}.apply(t,n))&&(e.exports=r)},1984:function(e,t,i){var n,r;n=[i(182),i(10),i(25),i(150),i(0),i(154),i(1934),i(745),i(1933),i(183),i(744),i(421),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(t,i,n,r,o,a,s){this.primitives=t,this.appearanceType=i,this.materialProperty=n,this.depthFailAppearanceType=r,this.depthFailMaterialProperty=o,this.closed=a,this.shadows=s,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(m.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e}function f(e,t,i,n,r){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}var _=new o,g=new o,v=t.ZERO,y=new t;m.prototype.onMaterialChanged=function(){this.invalidated=!0},m.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty,n=this.depthFailMaterialProperty,o=e.depthFailMaterialProperty;if(i===t&&o===n)return!0;var a=r(t)&&t.equals(i);return a=(!r(n)&&!r(o)||r(n)&&n.equals(o))&&a},m.prototype.add=function(e,t){var i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&p.isConstant(t.distanceDisplayConditionProperty)&&p.isConstant(t.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(e,i,r,o){"isShowing"===i&&n.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},m.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);r(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t))}return this.createPrimitive};var w=new i;return m.prototype.update=function(e){var c,m=!0,f=this.primitive,x=this.primitives,C=this.geometry.values;if(this.createPrimitive){if(C.length>0){r(f)&&(r(this.oldPrimitive)?x.remove(f):this.oldPrimitive=f),this.material=h.getValue(e,this.materialProperty,this.material);var T;r(this.depthFailMaterialProperty)&&(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),T=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),f=new l({show:!1,asynchronous:!0,geometryInstances:C,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:T,shadows:this.shadows}),x.add(f),m=!1}else{r(f)&&(x.remove(f),f=void 0);var E=this.oldPrimitive;r(E)&&(x.remove(E),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=f,this.createPrimitive=!1}else if(r(f)&&f.ready){f.show=!0,r(this.oldPrimitive)&&(x.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=h.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!r(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof d||(this.depthFailMaterial=h.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var A=this.updatersWithAttributes.values,P=A.length;for(c=0;c<P;c++){var S=A[c],b=S.entity,D=this.geometry.get(S.id),I=this.attributes.get(D.id.id);if(r(I)||(I=f.getGeometryInstanceAttributes(D.id),this.attributes.set(D.id.id,I)),r(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof d&&!S.depthFailMaterialProperty.isConstant){var O=S.depthFailMaterialProperty.color,M=p.getValueOrDefault(O,e,i.WHITE,w);i.equals(I._lastDepthFailColor,M)||(I._lastDepthFailColor=i.clone(M,I._lastDepthFailColor),I.depthFailColor=n.toValue(M,I.depthFailColor))}var F=b.isShowing&&(S.hasConstantFill||S.isFilled(e)),N=1===I.show[0];F!==N&&(I.show=u.toValue(F,I.show));var L=S.distanceDisplayConditionProperty;if(!p.isConstant(L)){var R=p.getValueOrDefault(L,e,g,_);o.equals(R,I._lastDistanceDisplayCondition)||(I._lastDistanceDisplayCondition=o.clone(R,I._lastDistanceDisplayCondition),I.distanceDisplayCondition=a.toValue(R,I.distanceDisplayCondition))}var V=S.terrainOffsetProperty;if(!p.isConstant(V)){var U=p.getValueOrDefault(V,e,v,y);t.equals(U,I._lastOffset)||(I._lastOffset=t.clone(U,I._lastOffset),I.offset=s.toValue(U,I.offset))}}this.updateShows(f)}else r(f)&&!f.ready&&(m=!1);return m},m.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var o=t[n],a=o.entity,s=this.geometry.get(o.id),l=this.attributes.get(s.id.id);r(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var c=a.isShowing;c!==(1===l.show[0])&&(l.show=u.toValue(c,l.show))}this.showsUpdated.removeAll()},m.prototype.contains=function(e){return this.updaters.contains(e.id)},m.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return c.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!r(n)||!r(n.boundingSphere)||r(n.show)&&0===n.show[0]?c.FAILED:(n.boundingSphere.clone(t),c.DONE)},m.prototype.destroy=function(){var e=this.primitive,t=this.primitives;r(e)&&t.remove(e);var i=this.oldPrimitive;r(i)&&t.remove(i),this.removeMaterialSubscription()},f.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var o=i[r];if(o.isMaterial(t))return void o.add(e,t)}var a=new m(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);a.add(e,t),i.push(a)},f.prototype.remove=function(e){for(var t=this._items,i=t.length,n=i-1;n>=0;n--){var r=t[n];if(r.remove(e)){0===r.updaters.length&&(t.splice(n,1),r.destroy());break}}},f.prototype.update=function(e){var t,i=this._items,n=i.length;for(t=n-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var o=r.updaters.values,a=o.length,s=0;s<a;s++)this.add(e,o[s]);r.destroy()}}var u=!0;for(t=0;t<i.length;t++)u=i[t].update(e)&&u;return u},f.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var o=i[r];if(o.contains(e))return o.getBoundingSphere(e,t)}return c.FAILED},f.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},f}.apply(t,n))&&(e.exports=r)},1985:function(e,t,i){var n,r;n=[i(24),i(0),i(426),i(9),i(291),i(748),i(155)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(e,t){return n.equalsEpsilon(e.latitude,t.latitude,n.EPSILON14)&&n.equalsEpsilon(e.longitude,t.longitude,n.EPSILON14)}function u(i,n,r,o){var a=n.length;if(!(a<2)){var u=t(o),l=t(r),h=!0,p=new Array(a),m=new Array(a),f=new Array(a),_=n[0];p[0]=_;var g=i.cartesianToCartographic(_,c);l&&(g.height=r[0]),h=h&&g.height<=0,m[0]=g.height,f[0]=u?o[0]:0;for(var v=1,y=1;y<a;++y){var w=n[y],x=i.cartesianToCartographic(w,d);l&&(x.height=r[y]),h=h&&x.height<=0,s(g,x)?g.height<x.height&&(m[v-1]=x.height):(p[v]=w,m[v]=x.height,f[v]=u?o[y]:0,e.clone(x,g),++v)}if(!(h||v<2))return p.length=v,m.length=v,f.length=v,{positions:p,topHeights:m,bottomHeights:f}}}var l={},c=new e,d=new e,h=new Array(2),p=new Array(2),m={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};return l.computePositions=function(e,s,l,c,d,f){var _=u(e,s,l,c);if(t(_)){if(s=_.positions,l=_.topHeights,c=_.bottomHeights,s.length>=3){var g=i.fromPoints(s,e),v=g.projectPointsOntoPlane(s);r.computeWindingOrder2D(v)===a.CLOCKWISE&&(s.reverse(),l.reverse(),c.reverse())}var y,w,x=s.length,C=x-2,T=n.chordLength(d,e.maximumRadius),E=m;if(E.minDistance=T,E.ellipsoid=e,f){var A,P=0;for(A=0;A<x-1;A++)P+=o.numberOfPoints(s[A],s[A+1],T)+1;y=new Float64Array(3*P),w=new Float64Array(3*P);var S=h,b=p;E.positions=S,E.height=b;var D=0;for(A=0;A<x-1;A++){S[0]=s[A],S[1]=s[A+1],b[0]=l[A],b[1]=l[A+1];var I=o.generateArc(E);y.set(I,D),b[0]=c[A],b[1]=c[A+1],w.set(o.generateArc(E),D),D+=I.length}}else E.positions=s,E.height=l,y=new Float64Array(o.generateArc(E)),E.height=c,w=new Float64Array(o.generateArc(E));return{bottomPositions:w,topPositions:y,numCorners:C}}},l}.apply(t,n))&&(e.exports=r)},2122:function(e,t,i){var n,r;n=[i(800),i(804),i(1)],void 0!==(r=function(e,t,i){"use strict";function n(n){n=i(n,i.EMPTY_OBJECT);var r=i(n.style,t.AERIAL);return new e({assetId:r})}return n}.apply(t,n))&&(e.exports=r)},2123:function(e,t,i){var n,r;n=[i(38),i(103),i(10),i(24),i(1),i(0),i(2),i(21),i(3),i(23),i(435),i(15),i(157),i(186),i(16),i(29),i(52),i(100),i(2124),i(2125),i(2126),i(7),i(2127),i(2128),i(2131),i(2132),i(46),i(184)],void 0!==(r=function(e,t,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b){"use strict";function D(e){e=o(e,c.WGS84);var t=new d({ellipsoid:e}),n=new A;this._ellipsoid=e,this._imageryLayerCollection=n,this._surfaceShaderSet=new T,this._material=void 0,this._surface=new P({tileProvider:new E({terrainProvider:t,imageryLayers:n,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new h,I(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new _({url:i(2136)}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.enableLighting=!1,this.showGroundAtmosphere=!0,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=b.RECEIVE_ONLY,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function I(e){var t=[],i=a(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),n=[x];!a(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.uniformMap=void 0:(n.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.uniformMap=e._material._uniforms),n.push(y),e._surfaceShaderSet.baseVertexShaderSource=new g({sources:[x,w],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new g({sources:n,defines:t}),e._surfaceShaderSet.material=e._material}function O(t){return function(i,n){return e.distanceSquaredTo(i.data.pickBoundingSphere,t)-e.distanceSquaredTo(n.data.pickBoundingSphere,t)}}function M(e,t){return f.contains(e.rectangle,t)?e:void 0}s(D.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tileLoadedEvent:{get:function(){return this._surface.tileProvider.tileLoadedEvent}},tilesLoaded:{get:function(){return!a(this._surface)||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),a(this._material)&&I(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,I(this))}}});var F=[],N={start:0,stop:0};D.prototype.pickWorldCoordinates=function(t,i,r){var o=i.mode,s=i.mapProjection,u=F;u.length=0;var l,c,d=this._surface._tilesToRender,h=d.length;for(c=0;c<h;++c){l=d[c];var m=l.data;if(a(m)){var f=m.pickBoundingSphere;o!==S.SCENE3D?(e.fromRectangleWithHeights2D(l.rectangle,s,m.minimumHeight,m.maximumHeight,f),n.fromElements(f.center.z,f.center.x,f.center.y,f.center)):e.clone(m.boundingSphere3D,f);var _=p.raySphere(t,f,N);a(_)&&u.push(l)}}u.sort(O(t.origin));var g;for(h=u.length,c=0;c<h&&(g=u[c].data.pick(t,i.mode,i.mapProjection,!0,r),!a(g));++c);return g},D.prototype.pickTriangle=function(t,i,r){var o=i.mode,s=i.mapProjection,u=F;u.length=0;var l,c,d=this._surface._tilesToRender,h=d.length;for(c=0;c<h;++c){l=d[c];var m=l.data;if(a(m)){var f=m.pickBoundingSphere;o!==S.SCENE3D?(e.fromRectangleWithHeights2D(l.rectangle,s,m.minimumHeight,m.maximumHeight,f),n.fromElements(f.center.z,f.center.x,f.center.y,f.center)):e.clone(m.boundingSphere3D,f);var _=p.raySphere(t,f,N);a(_)&&u.push(l)}}u.sort(O(t.origin));var g;for(h=u.length,c=0;c<h;++c)if(g=u[c].data.pickTriangle(t,i.mode,i.mapProjection,!0,r),a(g)){g.tile=u[c];break}return g};var L=new r;D.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,i),a(i)&&t.mode!==S.SCENE3D){i=n.fromElements(i.y,i.z,i.x,i);var r=t.mapProjection.unproject(i,L);i=t.globe.ellipsoid.cartographicToCartesian(r,i)}return i};var R=new n,V=new n,U=new r,z=new m;return D.prototype.getHeight=function(e){var t=this._surface._levelZeroTiles;if(a(t)){var i,r,s=t.length;for(r=0;r<s&&(i=t[r],!f.contains(i.rectangle,e));++r);if(a(i)&&f.contains(i.rectangle,e)){for(;i.renderable;)i=M(i.southwestChild,e)||M(i.southeastChild,e)||M(i.northwestChild,e)||i.northeastChild;for(;a(i)&&(!a(i.data)||!a(i.data.pickTerrain));)i=i.parent;if(a(i)){var u=this._surface._tileProvider.tilingScheme.ellipsoid,l=n.fromRadians(e.longitude,e.latitude,0,u,R),c=z,d=u.geodeticSurfaceNormal(l,c.direction),h=u.getSurfaceNormalIntersectionWithZAxis(l,11500,c.origin);if(!a(h)){var p=Math.min(o(i.data.minimumHeight,0),-11500),m=n.multiplyByScalar(d,Math.abs(p)+1,V);n.subtract(l,m,c.origin)}var _=i.data.pick(c,void 0,void 0,!1,V);if(a(_))return u.cartesianToCartographic(_,U).height}}}},D.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},D.prototype.beginFrame=function(e){var t=this._surface,i=t.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&n.ready&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;var o=this._oceanNormalMapResource,s=o.url;if(a(s)){var u=this;C(o.fetchImage(),function(t){s===u._oceanNormalMapResource.url&&(u._oceanNormalMap=u._oceanNormalMap&&u._oceanNormalMap.destroy(),u._oceanNormalMap=new v({context:e.context,source:t}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}var l=e.passes,c=e.mode;l.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=c===S.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.showGroundAtmosphere=this.showGroundAtmosphere,i.shadows=this.shadows,t.beginFrame(e))},D.prototype.render=function(e){if(this.show){a(this._material)&&this._material.update(e.context);var t=this._surface,i=e.passes;i.render&&t.render(e),i.pick&&t.render(e)}},D.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),u(this)},D}.apply(t,n))&&(e.exports=r)},2124:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#if defined(FOG) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)) || defined(GROUND_ATMOSPHERE)\nuniform float u_minimumBrightness;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogRayleighColor;\nvarying vec3 v_fogMieColor;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_imagerySplitPosition;\n    // Split to the left\n    if (split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n#ifdef APPLY_GAMMA\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n    return vec4(outColor, outAlpha);\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nvoid main()\n{\n\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_getWgs84EllipsoidEC().radii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    czm_material material = czm_getMaterial(materialInput);\n    color.xyz = mix(color.xyz, material.diffuse, material.alpha);\n#endif\n\n#if defined(ENABLE_VERTEX_LIGHTING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\n    const float fExposure = 2.0;\n    vec3 fogColor = v_fogMieColor + finalColor.rgb * v_fogRayleighColor;\n    fogColor = vec3(1.0) - exp(-fExposure * fogColor);\n#endif\n\n#ifdef FOG\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)\n    float darken = clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), u_minimumBrightness, 1.0);\n    fogColor *= darken;\n#endif\n\n    finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#endif\n\n#ifdef GROUND_ATMOSPHERE\n    if (czm_sceneMode != czm_sceneMode3D)\n    {\n        gl_FragColor = finalColor;\n        return;\n    }\n\n#if defined(PER_FRAGMENT_GROUND_ATMOSPHERE) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0));\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    ellipsoidPosition = (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n    AtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(ellipsoidPosition, true);\n\n    vec3 groundAtmosphereColor = atmosColor.mie + finalColor.rgb * atmosColor.rayleigh;\n    groundAtmosphereColor = vec3(1.0) - exp(-fExposure * groundAtmosphereColor);\n\n    fadeInDist = u_nightFadeDistance.x;\n    fadeOutDist = u_nightFadeDistance.y;\n\n    float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n    groundAtmosphereColor = mix(groundAtmosphereColor, fogColor, sunlitAtmosphereIntensity);\n#else\n    vec3 groundAtmosphereColor = fogColor;\n#endif\n\n    finalColor = vec4(mix(finalColor.rgb, groundAtmosphereColor, fade), finalColor.a);\n#endif\n\n    gl_FragColor = finalColor;\n}\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n    return vec4(imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n"}.call(t,i,t,e))&&(e.exports=n)},2125:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\n\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\n\n// Uniforms for 2D Mercator projection\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\n\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nvarying float v_slope;\nvarying float v_height;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogMieColor;\nvarying vec3 v_fogRayleighColor;\n#endif\n\n// These functions are generated at runtime.\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\n\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return u_modifiedModelViewProjection * vec4(position, 1.0);\n}\n\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\n    // The width of a tile at level 11, in radians and assuming a single root tile, is\n    //   2.0 * czm_pi / pow(2.0, 11.0)\n    // We want to just linearly interpolate the 2D position from the texture coordinates\n    // when we're at this level or higher.  The constant below is the expression\n    // above evaluated and then rounded up at the 4th significant digit.\n    const float maxTileWidth = 0.003068;\n    float positionFraction = textureCoordinates.y;\n    float southLatitude = u_southAndNorthLatitude.x;\n    float northLatitude = u_southAndNorthLatitude.y;\n    if (northLatitude - southLatitude > maxTileWidth)\n    {\n        float southMercatorY = u_southMercatorYAndOneOverHeight.x;\n        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\n\n        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\n        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\n        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n    }\n    return positionFraction;\n}\n\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\n    return textureCoordinates.y;\n}\n\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    return u_modifiedModelViewProjection * rtcPosition2D;\n}\n\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\n\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, height, textureCoordinates);\n}\n\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    // We do not do RTC while morphing, so there is potential for jitter.\n    // This is unlikely to be noticeable, though.\n    vec3 position3DWC = position + u_center3D;\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\n    return czm_modelViewProjection * morphPosition;\n}\n\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\n\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\n    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);\n    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);\n    vec3 position = vec3(xy, zh.x);\n    float height = zh.y;\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\n\n    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\n    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = compressed0.w;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#else\n    // A single float per element\n    vec3 position = position3DAndHeight.xyz;\n    float height = position3DAndHeight.w;\n    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = 0.0;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#endif\n\n    vec3 position3DWC = position + u_center3D;\n    gl_Position = getPosition(position, height, textureCoordinates);\n\n    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n    vec3 normalMC = czm_octDecode(encodedNormal);\n    v_normalMC = normalMC;\n    v_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\n    AtmosphereColor atmosFogColor = computeGroundAtmosphereFromSpace(position3DWC, false);\n    v_fogMieColor = atmosFogColor.mie;\n    v_fogRayleighColor = atmosFogColor.rayleigh;\n    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n\n#ifdef APPLY_MATERIAL\n    vec3 finalNormal = normalMC;\n    vec3 ellipsoidNormal = normalize(position3DWC.xyz);\n    v_slope = abs(dot(ellipsoidNormal, finalNormal));\n    v_height = height;\n#endif\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2126:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"/*!\n * Atmosphere code:\n *\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Atmosphere:\n //   Code:  http://sponeil.net/\n //   GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nconst float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\n\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\n\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\n\nstruct AtmosphereColor\n{\n    vec3 mie;\n    vec3 rayleigh;\n};\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nfloat scale(float fCos)\n{\n    float x = 1.0 - fCos;\n    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos, bool useSunLighting)\n{\n\tvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 v3Ray = v3Pos - czm_viewerPositionWC;\n    float fFar = length(v3Ray);\n    v3Ray /= fFar;\n\n    float fCameraHeight = length(czm_viewerPositionWC);\n    float fCameraHeight2 = fCameraHeight * fCameraHeight;\n\n    // This next line is an ANGLE workaround. It is equivalent to B = 2.0 * dot(czm_viewerPositionWC, v3Ray),\n    // which is what it should be, but there are problems at the poles.\n    float B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\n    float C = fCameraHeight2 - fOuterRadius2;\n    float fDet = max(0.0, B*B - 4.0 * C);\n    float fNear = 0.5 * (-B - sqrt(fDet));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\n    fFar -= fNear;\n    float fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\n\n    // The light angle based on the sun position would be:\n    //    dot(czm_sunDirectionWC, v3Pos) / length(v3Pos);\n    // When we want the atmosphere to be uniform over the globe so it is set to 1.0.\n    float fLightAngle = useSunLighting ? dot(czm_sunDirectionWC, v3Pos) / length(v3Pos) : 1.0;\n    float fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\n    float fCameraScale = scale(fCameraAngle);\n    float fLightScale = scale(fLightAngle);\n    float fCameraOffset = fDepth*fCameraScale;\n    float fTemp = (fLightScale + fCameraScale);\n\n    // Initialize the scattering loop variables\n    float fSampleLength = fFar / fSamples;\n    float fScaledLength = fSampleLength * fScale;\n    vec3 v3SampleRay = v3Ray * fSampleLength;\n    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 v3FrontColor = vec3(0.0);\n    vec3 v3Attenuate = vec3(0.0);\n    for(int i=0; i<nSamples; i++)\n    {\n        float fHeight = length(v3SamplePoint);\n        float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n        float fScatter = fDepth*fTemp - fCameraOffset;\n        v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\n        v3FrontColor += v3Attenuate * (fDepth * fScaledLength);\n        v3SamplePoint += v3SampleRay;\n    }\n\n    AtmosphereColor color;\n    color.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\n    color.rayleigh = v3Attenuate; // Calculate the attenuation factor for the ground\n\n    return color;\n}\n\n"}.call(t,i,t,e))&&(e.exports=n)},2127:function(e,t,i){var n,r;n=[i(0),i(21),i(772),i(77),i(452),i(46)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(e,t,i,n,r){this.numberOfDayTextures=e,this.flags=t,this.material=i,this.shaderProgram=n,this.clippingShaderState=r}function s(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function u(e){var t;switch(e){case o.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case o.SCENE2D:case o.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case o.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}function l(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}return s.prototype.getShaderProgram=function(t){var o=t.frameState,s=t.surfaceTile,c=t.numberOfDayTextures,d=t.applyBrightness,h=t.applyContrast,p=t.applyHue,m=t.applySaturation,f=t.applyGamma,_=t.applyAlpha,g=t.applySplit,v=t.showReflectiveOcean,y=t.showOceanWaves,w=t.enableLighting,x=t.showGroundAtmosphere,C=t.perFragmentGroundAtmosphere,T=t.hasVertexNormals,E=t.useWebMercatorProjection,A=t.enableFog,P=t.enableClippingPlanes,S=t.clippingPlanes,b=t.clippedByBoundaries,D=0,I="",O=s.pickTerrain.mesh.encoding;O.quantization===i.BITS12&&(D=1,I="QUANTIZATION_BITS12");var M=0,F="";s.terrainData._createdByUpsampling&&(M=1,F="DISABLE_GL_POSITION_LOG_DEPTH");var N=0,L="";b&&(N=1,L="TILE_LIMIT_RECTANGLE");var R=o.mode,V=R|d<<2|h<<3|p<<4|m<<5|f<<6|_<<7|v<<8|y<<9|w<<10|x<<11|C<<12|T<<13|E<<14|A<<15|D<<16|g<<17|P<<18|M<<19|N<<20,U=0;e(S)&&(U=P?S.clippingPlanesState:0);var z=s.surfaceShader;if(e(z)&&z.numberOfDayTextures===c&&z.flags===V&&z.material===this.material&&z.clippingShaderState===U)return z.shaderProgram;var B=this._shadersByTexturesFlags[c];if(e(B)||(B=this._shadersByTexturesFlags[c]=[]),z=B[V],!e(z)||z.material!==this.material||z.clippingShaderState!==U){var H=this.baseVertexShaderSource.clone(),k=this.baseFragmentShaderSource.clone();0!==U&&k.sources.unshift(r(S,o.context)),H.defines.push(I,F),k.defines.push("TEXTURE_UNITS "+c,L),d&&k.defines.push("APPLY_BRIGHTNESS"),h&&k.defines.push("APPLY_CONTRAST"),p&&k.defines.push("APPLY_HUE"),m&&k.defines.push("APPLY_SATURATION"),f&&k.defines.push("APPLY_GAMMA"),_&&k.defines.push("APPLY_ALPHA"),v&&(k.defines.push("SHOW_REFLECTIVE_OCEAN"),H.defines.push("SHOW_REFLECTIVE_OCEAN")),y&&k.defines.push("SHOW_OCEAN_WAVES"),w&&(T?(H.defines.push("ENABLE_VERTEX_LIGHTING"),k.defines.push("ENABLE_VERTEX_LIGHTING")):(H.defines.push("ENABLE_DAYNIGHT_SHADING"),k.defines.push("ENABLE_DAYNIGHT_SHADING"))),x&&(H.defines.push("GROUND_ATMOSPHERE"),k.defines.push("GROUND_ATMOSPHERE"),C&&k.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),H.defines.push("INCLUDE_WEB_MERCATOR_Y"),k.defines.push("INCLUDE_WEB_MERCATOR_Y"),A&&(H.defines.push("FOG"),k.defines.push("FOG")),g&&k.defines.push("APPLY_SPLIT"),P&&k.defines.push("ENABLE_CLIPPING_PLANES");for(var G="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n",W=0;W<c;++W)G+="    color = sampleAndBlend(\n        color,\n        u_dayTextures["+W+"],\n        u_dayTextureUseWebMercatorT["+W+"] ? textureCoordinates.xz : textureCoordinates.xy,\n        u_dayTextureTexCoordsRectangle["+W+"],\n        u_dayTextureTranslationAndScale["+W+"],\n        "+(_?"u_dayTextureAlpha["+W+"]":"1.0")+",\n        "+(d?"u_dayTextureBrightness["+W+"]":"0.0")+",\n        "+(h?"u_dayTextureContrast["+W+"]":"0.0")+",\n        "+(p?"u_dayTextureHue["+W+"]":"0.0")+",\n        "+(m?"u_dayTextureSaturation["+W+"]":"0.0")+",\n        "+(f?"u_dayTextureOneOverGamma["+W+"]":"0.0")+",\n        "+(g?"u_dayTextureSplit["+W+"]":"0.0")+"\n    );\n";G+="        return color;\n    }",k.sources.push(G),H.sources.push(u(R)),H.sources.push(l(E));var Y=n.fromCache({context:o.context,vertexShaderSource:H,fragmentShaderSource:k,attributeLocations:O.getAttributeLocations()});z=B[V]=new a(c,V,this.material,Y,U)}return s.surfaceShader=z,z.shaderProgram},s.prototype.destroy=function(){var i,n,r=this._shadersByTexturesFlags;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];if(!e(a))continue;for(i in a)a.hasOwnProperty(i)&&(n=a[i],e(n)&&n.shaderProgram.destroy())}return t(this)},s}.apply(t,n))&&(e.exports=r)},2128:function(e,t,i){var n,r;n=[i(38),i(760),i(17),i(10),i(41),i(24),i(25),i(150),i(42),i(1),i(0),i(2),i(21),i(3),i(15),i(128),i(290),i(49),i(71),i(9),i(20),i(118),i(289),i(54),i(16),i(771),i(772),i(1953),i(134),i(93),i(64),i(61),i(60),i(47),i(68),i(115),i(70),i(302),i(152),i(183),i(307),i(2129),i(758),i(1945),i(46),i(184)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I,O,M,F,N,L,R,V,U,z,B,H,k,G,W,Y){"use strict";function j(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.showGroundAtmosphere=!1,this.shadows=Y.RECEIVE_ONLY,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._errorEvent=new m,this._imageryLayers.layerAdded.addEventListener(j.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(j.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(j.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(j.prototype._onLayerShownOrHidden,this),this._tileLoadedEvent=new m,this._imageryLayersUpdatedEvent=new m,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new a(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=E.clone(E.MAX_VALUE)}function X(e,t){var i=e.loadingImagery;c(i)||(i=e.readyImagery);var n=t.loadingImagery;return c(n)||(n=t.readyImagery),i.imageryLayer._layerIndex-n.imageryLayer._layerIndex}function Q(e){var t=e.indexBuffer;e.destroy(),!t.isDestroyed()&&c(t.referenceCount)&&0===--t.referenceCount&&t.destroy()}function q(e,t){var i=t.creditDisplay;e._terrainProvider.ready&&c(e._terrainProvider.credit)&&i.addCredit(e._terrainProvider.credit);for(var n=e._imageryLayers,r=0,o=n.length;r<o;++r){var a=n.get(r).imageryProvider;a.ready&&c(a.credit)&&i.addCredit(a.credit)}}function Z(e,t){if(t.west<t.east)return t;var i=E.clone(t,re);return E.center(e,oe).longitude>0?i.east=y.PI:i.west=-y.PI,i}function K(e,t,i){return function(n){var r,o,a,s=-1,u=n.data.imagery,d=u.length;for(a=0;a<d;++a)if(r=u[a],o=l(r.readyImagery,r.loadingImagery),o.imageryLayer===t){s=a;break}if(-1!==s){var h=s+e;if(r=u[h],o=c(r)?l(r.readyImagery,r.loadingImagery):void 0,!c(o)||o.imageryLayer!==t)return!t._createTileImagerySkeletons(n,i,h);for(a=s;a<h;++a)u[a].freeResources();u.splice(s,e)}return!0}}function J(e,t){return{u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,i=w.multiplyByPoint(t,this.properties.rtc,de);return w.setTranslation(t,i,ae),ae},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,i=e.context.uniformState.projection,n=w.multiplyByPoint(t,this.properties.rtc,de);return w.setTranslation(t,n,se),w.multiply(i,se,se),se},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_clippingPlanes:function(){var i=t._clippingPlanes;return c(i)&&c(i.texture)?i.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){var i=t._clippingPlanes;return c(i)?w.multiply(e.context.uniformState.view,i.modelMatrix,ge):w.IDENTITY},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},properties:{initialColor:new r(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new i(65e5,9e6),nightFadeDistance:new i(1e7,4e7),center3D:void 0,rtc:new n,modifiedModelView:new w,tileRectangle:new r,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayIntensity:0,southAndNorthLatitude:new i,southMercatorYAndOneOverHeight:new i,waterMask:void 0,waterMaskTranslationAndScale:new r,minMaxHeight:new i,scaleAndBias:new w,clippingPlanesEdgeColor:a.clone(a.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new r}}}function $(e,t,i){var n=i.data;c(n.wireframeVertexArray)||c(n.terrainData)&&c(n.terrainData._mesh)&&(n.wireframeVertexArray=ee(e,n.vertexArray,n.terrainData._mesh))}function ee(e,t,i){var n={indices:i.indices,primitiveType:T.TRIANGLES};_.toWireframe(n);var r=n.indices,o=D.createIndexBuffer({context:e,typedArray:r,usage:I.STATIC_DRAW,indexDatatype:g.UNSIGNED_SHORT});return new L({context:e,attributes:t._attributes,indexBuffer:o})}function te(t,i,o){var s=i.data,l=o.creditDisplay,d=s.terrainData;if(c(d)&&c(d.credits))for(var h=d.credits,p=0,m=h.length;p<m;++p)l.addCredit(h[p]);var f=O.maximumTextureImageUnits,_=s.waterMaskTexture,g=t.hasWaterMask&&c(_),v=t.oceanNormalMap,C=g&&c(v),A=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals,S=o.fog.enabled,D=t.showGroundAtmosphere,I=Y.castShadows(t.shadows),N=Y.receiveShadows(t.shadows),L=!1;if(D){var R,V=o.mode,U=o.camera;R=V===W.SCENE2D||V===W.COLUMBUS_VIEW?U.positionCartographic.height:n.magnitude(U.positionWC);var z=t.nightFadeOutDistance;V!==W.SCENE3D&&(z-=o.mapProjection.ellipsoid.maximumRadius),L=R>z}g&&--f,C&&--f;var B=s.center,H=s.pickTerrain.mesh.encoding,G=ue,j=0,X=0,Q=0,q=0,K=!1;if(o.mode!==W.SCENE3D){var ee=o.mapProjection,te=ee.project(E.southwest(i.rectangle),he),ie=ee.project(E.northeast(i.rectangle),pe);if(G.x=te.x,G.y=te.y,G.z=ie.x,G.w=ie.y,o.mode!==W.MORPHING&&(B=ce,B.x=0,B.y=.5*(G.z+G.x),B.z=.5*(G.w+G.y),G.x-=B.y,G.y-=B.z,G.z-=B.y,G.w-=B.z),o.mode===W.SCENE2D&&H.quantization===P.BITS12){var ne=1/(Math.pow(2,12)-1)*.5,re=(G.z-G.x)*ne,oe=(G.w-G.y)*ne;G.x-=re,G.y-=oe,G.z+=re,G.w+=oe}ee instanceof b&&(j=i.rectangle.south,X=i.rectangle.north,Q=b.geodeticLatitudeToMercatorAngle(j),q=1/(b.geodeticLatitudeToMercatorAngle(X)-Q),K=!0)}var ae=ye;ae.frameState=o,ae.surfaceTile=s,ae.showReflectiveOcean=g,ae.showOceanWaves=C,ae.enableLighting=t.enableLighting,ae.showGroundAtmosphere=D,ae.perFragmentGroundAtmosphere=L,ae.hasVertexNormals=A,ae.useWebMercatorProjection=K,ae.clippedByBoundaries=s.clippedByBoundaries;var se=s.imagery,de=0,ge=se.length,we=t._renderState,xe=t._blendRenderState,Ce=we,Te=t._firstPassInitialColor,Ee=o.context;c(t._debug.boundingSphereTile)||_e();do{var Ae,Pe,Se=0;t._drawCommands.length<=t._usedDrawCommands?(Ae=new M,Ae.owner=i,Ae.cull=!1,Ae.boundingVolume=new e,Ae.orientedBoundingBox=void 0,Pe=J(o,t),t._drawCommands.push(Ae),t._uniformMaps.push(Pe)):(Ae=t._drawCommands[t._usedDrawCommands],Pe=t._uniformMaps[t._usedDrawCommands]),Ae.owner=i,++t._usedDrawCommands,i===t._debug.boundingSphereTile&&(c(s.orientedBoundingBox)?me(s.orientedBoundingBox,a.RED).update(o):c(s.boundingSphere3D)&&fe(s.boundingSphere3D,a.RED).update(o));var be=Pe.properties;r.clone(Te,be.initialColor),be.oceanNormalMap=v,be.lightingFadeDistance.x=t.lightingFadeOutDistance,be.lightingFadeDistance.y=t.lightingFadeInDistance,be.nightFadeDistance.x=t.nightFadeOutDistance,be.nightFadeDistance.y=t.nightFadeInDistance,be.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity,be.center3D=s.center,n.clone(B,be.rtc),r.clone(G,be.tileRectangle),be.southAndNorthLatitude.x=j,be.southAndNorthLatitude.y=X,be.southMercatorYAndOneOverHeight.x=Q,be.southMercatorYAndOneOverHeight.y=q;var De=le,Ie=Z(i.rectangle,t.cartographicLimitRectangle),Oe=i.rectangle,Me=1/Oe.width,Fe=1/Oe.height;De.x=(Ie.west-Oe.west)*Me,De.y=(Ie.south-Oe.south)*Fe,De.z=(Ie.east-Oe.west)*Me,De.w=(Ie.north-Oe.south)*Fe,r.clone(De,be.localizedCartographicLimitRectangle);for(var Ne=S&&y.fog(i._distance,o.fog.density)>y.EPSILON3,Le=!1,Re=!1,Ve=!1,Ue=!1,ze=!1,Be=!1,He=!1;Se<f&&de<ge;){var ke=se[de],Ge=ke.readyImagery;if(++de,c(Ge)&&0!==Ge.imageryLayer.alpha){var We=ke.useWebMercatorT?Ge.textureWebMercator:Ge.texture,Ye=Ge.imageryLayer;if(c(ke.textureTranslationAndScale)||(ke.textureTranslationAndScale=Ye._calculateTextureTranslationAndScale(i,ke)),be.dayTextures[Se]=We,be.dayTextureTranslationAndScale[Se]=ke.textureTranslationAndScale,be.dayTextureTexCoordsRectangle[Se]=ke.textureCoordinateRectangle,be.dayTextureUseWebMercatorT[Se]=ke.useWebMercatorT,be.dayTextureAlpha[Se]=Ye.alpha,Be=Be||1!==be.dayTextureAlpha[Se],be.dayTextureBrightness[Se]=Ye.brightness,Le=Le||be.dayTextureBrightness[Se]!==k.DEFAULT_BRIGHTNESS,be.dayTextureContrast[Se]=Ye.contrast,Re=Re||be.dayTextureContrast[Se]!==k.DEFAULT_CONTRAST,be.dayTextureHue[Se]=Ye.hue,Ve=Ve||be.dayTextureHue[Se]!==k.DEFAULT_HUE,be.dayTextureSaturation[Se]=Ye.saturation,Ue=Ue||be.dayTextureSaturation[Se]!==k.DEFAULT_SATURATION,be.dayTextureOneOverGamma[Se]=1/Ye.gamma,ze=ze||be.dayTextureOneOverGamma[Se]!==1/k.DEFAULT_GAMMA,be.dayTextureSplit[Se]=Ye.splitDirection,He=He||0!==be.dayTextureSplit[Se],c(Ge.credits))for(var je=Ge.credits,Xe=0,Qe=je.length;Xe<Qe;++Xe)l.addCredit(je[Xe]);++Se}}be.dayTextures.length=Se,be.waterMask=_,r.clone(s.waterMaskTranslationAndScale,be.waterMaskTranslationAndScale),be.minMaxHeight.x=H.minimumHeight,be.minMaxHeight.y=H.maximumHeight,w.clone(H.matrix,be.scaleAndBias);var qe=t._clippingPlanes,Ze=c(qe)&&qe.enabled&&i.isClipped;Ze&&(be.clippingPlanesEdgeColor=a.clone(qe.edgeColor,be.clippingPlanesEdgeColor),be.clippingPlanesEdgeWidth=qe.edgeWidth),c(t.uniformMap)&&(Pe=u(Pe,t.uniformMap)),ae.numberOfDayTextures=Se,ae.applyBrightness=Le,ae.applyContrast=Re,ae.applyHue=Ve,ae.applySaturation=Ue,ae.applyGamma=ze,ae.applyAlpha=Be,ae.applySplit=He,ae.enableFog=Ne,ae.enableClippingPlanes=Ze,ae.clippingPlanes=qe,Ae.shaderProgram=t._surfaceShaderSet.getShaderProgram(ae),Ae.castShadows=I,Ae.receiveShadows=N,Ae.renderState=Ce,Ae.primitiveType=T.TRIANGLES,Ae.vertexArray=s.vertexArray,Ae.uniformMap=Pe,Ae.pass=F.GLOBE,t._debug.wireframe&&($(Ee,t,i),c(s.wireframeVertexArray)&&(Ae.vertexArray=s.wireframeVertexArray,Ae.primitiveType=T.LINES));var Ke=Ae.boundingVolume,Je=Ae.orientedBoundingBox;o.mode!==W.SCENE3D?(e.fromRectangleWithHeights2D(i.rectangle,o.mapProjection,s.minimumHeight,s.maximumHeight,Ke),n.fromElements(Ke.center.z,Ke.center.x,Ke.center.y,Ke.center),o.mode===W.MORPHING&&(Ke=e.union(s.boundingSphere3D,Ke,Ke))):(Ae.boundingVolume=e.clone(s.boundingSphere3D,Ke),Ae.orientedBoundingBox=x.clone(s.orientedBoundingBox,Je)),o.commandList.push(Ae),Ce=xe,Te=ve}while(de<ge)}d(j.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=r.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},tileLoadedEvent:{get:function(){return this._tileLoadedEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,c(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){B.setOwner(e,this,"_clippingPlanes")}}}),j.prototype.update=function(e){this._imageryLayers._update()},j.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(X)})),q(this,e);for(var t=this._vertexArraysToDestroy,i=t.length,n=0;n<i;++n)Q(t[n]);t.length=0},j.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,i=0,n=t.length;i<n;++i){var r=t[i];c(r)&&(r.length=0)}var o=this._clippingPlanes;c(o)&&o.enabled&&o.update(e),this._usedDrawCommands=0},j.prototype.endUpdate=function(e){c(this._renderState)||(this._renderState=N.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V.LESS}}),this._blendRenderState=N.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V.LESS_OR_EQUAL},blending:R.ALPHA_BLEND}));for(var t=this._tilesToRenderByTextureCount,i=0,n=t.length;i<n;++i){var r=t[i];if(c(r))for(var o=0,a=r.length;o<a;++o)te(this,r[o],e)}},j.prototype.updateForPick=function(e){for(var t=this._drawCommands,i=0,n=this._usedDrawCommands;i<n;++i)e.commandList.push(t[i])},j.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},j.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},j.prototype.loadTile=function(e,t){H.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy);var i=this._tileLoadedEvent;t._loadedCallbacks.tileLoadedEvent=function(e){return i.raiseEvent(),!0}};var ie=new e,ne=new E,re=new E,oe=new o;j.prototype.computeTileVisibility=function(t,i,r){var o=this.computeDistanceToTile(t,i);if(t._distance=o,i.fog.enabled&&y.fog(o,i.fog.density)>=1)return S.NONE;var a=t.data,s=i.cullingVolume,u=l(a.orientedBoundingBox,a.boundingSphere3D);a.clippedByBoundaries=!1;var d=Z(t.rectangle,this.cartographicLimitRectangle),h=E.simpleIntersection(d,t.rectangle,ne);if(!c(h))return S.NONE;E.equals(h,t.rectangle)||(a.clippedByBoundaries=!0),i.mode!==W.SCENE3D&&(u=ie,e.fromRectangleWithHeights2D(t.rectangle,i.mapProjection,a.minimumHeight,a.maximumHeight,u),n.fromElements(u.center.z,u.center.x,u.center.y,u.center),i.mode===W.MORPHING&&(u=e.union(a.boundingSphere3D,u,u)));var p=this._clippingPlanes;if(c(p)&&p.enabled){var m=p.computeIntersectionWithBoundingVolume(u);if(t.isClipped=m!==v.INSIDE,m===v.OUTSIDE)return S.NONE}var f=s.computeVisibility(u);if(f===v.OUTSIDE)return S.NONE;var _=i.mode===W.SCENE3D&&i.camera.frustum instanceof C;if(i.mode===W.SCENE3D&&!_&&c(r)){var g=a.occludeePointInScaledSpace;return c(g)?r.ellipsoid.isScaledSpacePointVisible(g)?f:S.NONE:f}return f};var ae=new w,se=new w,ue=new r,le=new r,ce=new n,de=new n,he=new n,pe=new n;j.prototype.showTileThisFrame=function(e,t){for(var i=0,n=e.data.imagery,r=0,o=n.length;r<o;++r){var a=n[r];c(a.readyImagery)&&0!==a.readyImagery.imageryLayer.alpha&&++i}var s=this._tilesToRenderByTextureCount[i];c(s)||(s=[],this._tilesToRenderByTextureCount[i]=s),s.push(e);var u=this._debug;++u.tilesRendered,u.texturesRendered+=i},j.prototype.computeDistanceToTile=function(e,t){return e.data.tileBoundingRegion.distanceToCamera(t)},j.prototype.isDestroyed=function(){return!1},j.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),h(this)},j.prototype._onLayerAdded=function(e,t){if(e.show){var i=this._terrainProvider,n=this,r=e.imageryProvider,o=this._imageryLayersUpdatedEvent;r._reload=function(){e._imageryCache={},n._quadtree.forEachLoadedTile(function(t){if(!c(t._loadedCallbacks[e._layerIndex])){var n,r=t.data.imagery,o=r.length,a=-1,s=0;for(n=0;n<o;++n){var u=r[n];if(l(u.readyImagery,u.loadingImagery).imageryLayer===e)-1===a&&(a=n),++s;else if(-1!==a)break}if(-1!==a){var d=a+s;e._createTileImagerySkeletons(t,i,d)&&(t._loadedCallbacks[e._layerIndex]=K(s,e,i),t.state=G.LOADING)}}})},this._quadtree.forEachLoadedTile(function(t){e._createTileImagerySkeletons(t,i)&&(t.state=G.LOADING)}),this._layerOrderChanged=!0,o.raiseEvent()}},j.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){for(var i=t.data.imagery,n=-1,r=0,o=0,a=i.length;o<a;++o){var s=i[o],u=s.loadingImagery;if(c(u)||(u=s.readyImagery),u.imageryLayer===e)-1===n&&(n=o),s.freeResources(),++r;else if(-1!==n)break}-1!==n&&i.splice(n,r)}),c(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},j.prototype._onLayerMoved=function(e,t,i){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},j.prototype._onLayerShownOrHidden=function(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var me,fe,_e,ge=new w;!function(){function e(e){return new z({geometryInstances:e,appearance:new U({translucent:!1,flat:!0}),asynchronous:!1})}var i,r,o=new f({geometry:t.fromDimensions({dimensions:new n(2,2,2)})}),a=new f({geometry:new A({radius:1})}),u=new w;me=function(t,n){return t===i?r:(_e(),i=t,u=w.fromRotationTranslation(t.halfAxes,t.center,u),o.modelMatrix=u,o.attributes.color=s.fromColor(n),r=e(o))},fe=function(t,n){return t===i?r:(_e(),i=t,u=w.fromTranslation(t.center,u),u=w.multiplyByUniformScale(u,t.radius,u),a.modelMatrix=u,a.attributes.color=s.fromColor(n),r=e(a))},_e=function(){c(r)&&(r.destroy(),r=void 0,i=void 0)}}();var ve=new r(0,0,0,0),ye={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0};return j}.apply(t,n))&&(e.exports=r)},2129:function(e,t,i){var n,r;n=[i(38),i(10),i(41),i(1),i(0),i(2),i(157),i(69),i(91),i(114),i(100),i(116),i(102),i(185),i(306),i(1945),i(46),i(1964),i(308),i(2130)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y){"use strict";function w(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new i(0,0,1,1),this.terrainData=void 0,this.center=new t,this.vertexArray=void 0,this.minimumHeight=0,this.maximumHeight=0,this.boundingSphere3D=new e,this.boundingSphere2D=new e,this.orientedBoundingBox=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new t,this.loadedTerrain=void 0,this.upsampledTerrain=void 0,this.pickBoundingSphere=new e,this.pickTerrain=void 0,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}function x(e,i,n,o,a,s){if(e.decodePosition(o,a,s),r(i)&&i!==_.SCENE3D){var u=n.ellipsoid,l=u.cartesianToCartographic(s);n.project(l,s),t.fromElements(s.z,s.x,s.y,s)}return s}function C(e){var t,i;return r(e.parent)&&r(e.parent.data)&&(t=e.parent.data.minimumHeight,i=e.parent.data.maximumHeight),new v({rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:t,maximumHeight:i})}function T(e,t){return function(){return e.tileBoundingRegion.distanceToCamera(t)}}function E(e,t,i){var n=e.data,o=P(e);r(o)&&(n.upsampledTerrain=new y(o)),O(e,t)&&(n.loadedTerrain=new y);for(var a=0,s=i.length;a<s;++a){var u=i.get(a);u.show&&u._createTileImagerySkeletons(e,t)}}function A(e,t,i,o){var a=e.data,s=a.loadedTerrain,u=a.upsampledTerrain,l=!1;r(s)&&(s.processLoadStateMachine(t,i,e.x,e.y,e.level,e._priorityFunction),s.state>=g.RECEIVED&&(a.terrainData!==s.data&&(a.terrainData=s.data,F(t.context,a),D(e)),l=!0),s.state===g.READY?(s.publishToTile(e),r(e.data.vertexArray)&&o.push(e.data.vertexArray),e.data.vertexArray=s.vertexArray,s.vertexArray=void 0,a.pickTerrain=n(a.loadedTerrain,a.upsampledTerrain),a.loadedTerrain=void 0,a.upsampledTerrain=void 0):s.state===g.FAILED&&(a.loadedTerrain=void 0)),!l&&r(u)&&(u.processUpsampleStateMachine(t,i,e.x,e.y,e.level),u.state>=g.RECEIVED&&a.terrainData!==u.data&&(a.terrainData=u.data,i.hasWaterMask&&N(e),S(e)),u.state===g.READY?(u.publishToTile(e),r(e.data.vertexArray)&&o.push(e.data.vertexArray),e.data.vertexArray=u.vertexArray,u.vertexArray=void 0,a.pickTerrain=a.upsampledTerrain,a.upsampledTerrain=void 0):u.state===g.FAILED&&(a.upsampledTerrain=void 0))}function P(e){for(var t=e.parent;r(t)&&r(t.data)&&!r(t.data.terrainData);)t=t.parent;if(r(t)&&r(t.data))return{data:t.data.terrainData,x:t.x,y:t.y,level:t.level}}function S(e){b(e,e._southwestChild),b(e,e._southeastChild),b(e,e._northwestChild),b(e,e._northeastChild)}function b(e,t){if(r(t)&&t.state!==f.START){var i=t.data;if(r(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling())return;r(i.upsampledTerrain)&&i.upsampledTerrain.freeResources(),i.upsampledTerrain=new y({data:e.data.terrainData,x:e.x,y:e.y,level:e.level}),t.state=f.LOADING}}function D(e){var t=e.data;I(e,t,e.southwestChild),I(e,t,e.southeastChild),I(e,t,e.northwestChild),I(e,t,e.northeastChild)}function I(e,t,i){if(i.state!==f.START){var n=i.data;if(r(n.terrainData)&&!n.terrainData.wasCreatedByUpsampling())return;r(n.upsampledTerrain)&&n.upsampledTerrain.freeResources(),n.upsampledTerrain=new y({data:t.terrainData,x:e.x,y:e.y,level:e.level}),t.terrainData.isChildAvailable(e.x,e.y,i.x,i.y)&&(r(n.loadedTerrain)||(n.loadedTerrain=new y)),i.state=f.LOADING}}function O(e,t){var i=t.getTileDataAvailable(e.x,e.y,e.level);if(r(i))return i;var n=e.parent;return!r(n)||!(!r(n.data)||!r(n.data.terrainData))&&n.data.terrainData.isChildAvailable(n.x,n.y,e.x,e.y)}function M(e){var t=e.cache.tile_waterMaskData;if(!r(t)){var i=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:u.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});i.referenceCount=1;t={allWaterTexture:i,sampler:new l({wrapS:p.CLAMP_TO_EDGE,wrapT:p.CLAMP_TO_EDGE,minificationFilter:h.LINEAR,magnificationFilter:d.LINEAR}),destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function F(e,t){var n=t.waterMaskTexture;r(n)&&(--n.referenceCount,0===n.referenceCount&&n.destroy(),t.waterMaskTexture=void 0);var o=t.terrainData.waterMask;if(r(o)){var a,l=M(e),d=o.length;if(1===d){if(0===o[0])return;a=l.allWaterTexture}else{var h=Math.sqrt(d);a=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:u.UNSIGNED_BYTE,source:{width:h,height:h,arrayBufferView:o},sampler:l.sampler,flipY:!1}),a.referenceCount=0}++a.referenceCount,t.waterMaskTexture=a,i.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}}function N(e){for(var t=e.data,i=e.parent;r(i)&&!r(i.data.terrainData)||i.data.terrainData.wasCreatedByUpsampling();)i=i.parent;if(r(i)&&r(i.data.waterMaskTexture)){t.waterMaskTexture=i.data.waterMaskTexture,++t.waterMaskTexture.referenceCount;var n=i.rectangle,o=e.rectangle,a=o.width,s=o.height,u=a/n.width,l=s/n.height;t.waterMaskTranslationAndScale.x=u*(o.west-n.west)/a,t.waterMaskTranslationAndScale.y=l*(o.south-n.south)/s,t.waterMaskTranslationAndScale.z=u,t.waterMaskTranslationAndScale.w=l}}o(w.prototype,{eligibleForUnloading:{get:function(){for(var e=this.loadedTerrain,t=r(e)&&(e.state===g.RECEIVING||e.state===g.TRANSFORMING),i=this.upsampledTerrain,n=r(i)&&(i.state===g.RECEIVING||i.state===g.TRANSFORMING),o=!t&&!n,a=this.imagery,s=0,u=a.length;o&&s<u;++s){var l=a[s];o=!r(l.loadingImagery)||l.loadingImagery.state!==m.TRANSITIONING}return o}}});var L=new t,R=new t,V=new t,U=new t;return w.prototype.pick=function(e,i,n,o,s){var u=this.pickTerrain;if(r(u)){var l=u.mesh;if(r(l))for(var c=l.vertices,d=l.indices,h=l.encoding,p=d.length,m=0;m<p;m+=3){var f=d[m],_=d[m+1],g=d[m+2],v=x(h,i,n,c,f,L),y=x(h,i,n,c,_,R),w=x(h,i,n,c,g,V),C=a.rayTriangle(e,v,y,w,o,U);if(r(C))return t.clone(C,s)}}},w.prototype.pickTriangle=function(e,t,i,n){var o=this.pickTerrain;if(r(o)){var s=o.mesh;if(r(s))for(var u=s.vertices,l=s.indices,c=s.encoding,d=l.length,h=0;h<d;h+=3){var p=l[h],m=l[h+1],f=l[h+2],_=x(c,t,i,u,p,L),g=x(c,t,i,u,m,R),v=x(c,t,i,u,f,V),y=a.rayTriangle(e,_,g,v,n,U);if(r(y))return{intersection:y,v0:_,v1:g,v2:v}}}},w.prototype.freeResources=function(){r(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,r(this.loadedTerrain)&&(this.loadedTerrain.freeResources(),this.loadedTerrain=void 0),r(this.upsampledTerrain)&&(this.upsampledTerrain.freeResources(),this.upsampledTerrain=void 0),r(this.pickTerrain)&&(this.pickTerrain.freeResources(),this.pickTerrain=void 0);var e,t,i=this.imagery;for(e=0,t=i.length;e<t;++e)i[e].freeResources();this.imagery.length=0,this.freeVertexArray()},w.prototype.freeVertexArray=function(){var e;r(this.vertexArray)&&(e=this.vertexArray.indexBuffer,this.vertexArray=this.vertexArray.destroy(),!e.isDestroyed()&&r(e.referenceCount)&&0===--e.referenceCount&&e.destroy()),r(this.wireframeVertexArray)&&(e=this.wireframeVertexArray.indexBuffer,this.wireframeVertexArray=this.wireframeVertexArray.destroy(),!e.isDestroyed()&&r(e.referenceCount)&&0===--e.referenceCount&&e.destroy())},w.processStateMachine=function(e,t,i,n,o){var a=e.data;r(a)||(a=e.data=new w,a.tileBoundingRegion=C(e)),r(e._priorityFunction)||(e._priorityFunction=T(a,t)),e.state===f.START&&(E(e,i,n),e.state=f.LOADING),e.state===f.LOADING&&A(e,t,i,o);var s,u,l=r(a.vertexArray),c=!r(a.loadedTerrain)&&!r(a.upsampledTerrain),d=r(a.terrainData)&&a.terrainData.wasCreatedByUpsampling(),h=a.imagery;for(s=0,u=h.length;s<u;++s){var p=h[s];if(r(p.loadingImagery)){if(p.loadingImagery.state===m.PLACEHOLDER){var _=p.loadingImagery.imageryLayer;if(_.imageryProvider.ready){p.freeResources(),h.splice(s,1),_._createTileImagerySkeletons(e,i,s),--s,u=h.length;continue}d=!1}var g=p.processStateMachine(e,t);c=c&&g,l=l&&(g||r(p.readyImagery)),d=d&&r(p.loadingImagery)&&(p.loadingImagery.state===m.FAILED||p.loadingImagery.state===m.INVALID)}else d=!1}if(e.upsampledFromParent=d,s===u&&(l&&(e.renderable=!0),c)){var v=e._loadedCallbacks,y={};for(var x in v)v.hasOwnProperty(x)&&(v[x](e)||(y[x]=v[x]));e._loadedCallbacks=y,e.state=f.DONE,e._priorityFunction=void 0}},w}.apply(t,n))&&(e.exports=r)},2130:function(e,t,i){var n,r;n=[i(38),i(10),i(0),i(3),i(49),i(118),i(223),i(190),i(161),i(119),i(93),i(64),i(115),i(7),i(1964)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(e){this.state=m.UNLOADED,this.data=void 0,this.mesh=void 0,this.vertexArray=void 0,this.upsampleDetails=e,this.request=void 0}function _(e,t,n,r,o,c){function d(t){e.data=t,e.state=m.RECEIVED,e.request=void 0}function h(){if(e.request.state===s.CANCELLED)return e.data=void 0,e.state=m.UNLOADED,void(e.request=void 0);e.state=m.FAILED,e.request=void 0;var i="Failed to obtain terrain tile X: "+n+" Y: "+r+" Level: "+o+".";t._requestError=l.handleError(t._requestError,t,t.errorEvent,i,n,r,o,f)}function f(){var s=new a({throttle:!0,throttleByServer:!0,type:u.TERRAIN,priorityFunction:c});e.request=s,e.data=t.requestTileGeometry(n,r,o,s),i(e.data)?(e.state=m.RECEIVING,p(e.data,d,h)):(e.state=m.UNLOADED,e.request=void 0)}f()}function g(e,t,n,r,o,a){var s=n.tilingScheme,u=e.data,l=u.createMesh(s,r,o,a,t.terrainExaggeration);i(l)&&(e.state=m.TRANSFORMING,p(l,function(t){e.mesh=t,e.state=m.TRANSFORMED},function(){e.state=m.FAILED}))}function v(e,t,n,o,a,s){var u=e.mesh.vertices,l=c.createVertexBuffer({context:t,typedArray:u,usage:d.STATIC_DRAW}),p=e.mesh.encoding.getAttributes(l),f=e.mesh.indices.indexBuffers||{},_=f[t.id];if(!i(_)||_.isDestroyed()){var g=e.mesh.indices,v=2===g.BYTES_PER_ELEMENT?r.UNSIGNED_SHORT:r.UNSIGNED_INT;_=c.createIndexBuffer({context:t,typedArray:g,usage:d.STATIC_DRAW,indexDatatype:v}),_.vertexArrayDestroyable=!1,_.referenceCount=1,f[t.id]=_,e.mesh.indices.indexBuffers=f}else++_.referenceCount;e.vertexArray=new h({context:t,attributes:p,indexBuffer:_}),e.state=m.READY}return f.prototype.freeResources=function(){if(this.state=m.UNLOADED,this.data=void 0,this.mesh=void 0,i(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy(),this.vertexArray=void 0,!e.isDestroyed()&&i(e.referenceCount)&&0===--e.referenceCount&&e.destroy()}},f.prototype.publishToTile=function(i){var n=i.data,r=this.mesh;t.clone(r.center,n.center),n.minimumHeight=r.minimumHeight,n.maximumHeight=r.maximumHeight,n.boundingSphere3D=e.clone(r.boundingSphere3D,n.boundingSphere3D),n.orientedBoundingBox=o.clone(r.orientedBoundingBox,n.orientedBoundingBox),n.tileBoundingRegion.minimumHeight=r.minimumHeight,n.tileBoundingRegion.maximumHeight=r.maximumHeight,i.data.occludeePointInScaledSpace=t.clone(r.occludeePointInScaledSpace,n.occludeePointInScaledSpace)},f.prototype.processLoadStateMachine=function(e,t,i,n,r,o){this.state===m.UNLOADED&&_(this,t,i,n,r,o),this.state===m.RECEIVED&&g(this,e,t,i,n,r),this.state===m.TRANSFORMED&&v(this,e.context,t,i,n,r)},f.prototype.processUpsampleStateMachine=function(e,t,n,r,o){if(this.state===m.UNLOADED){var a=this.upsampleDetails,s=a.data,u=a.x,l=a.y,c=a.level;if(this.data=s.upsample(t.tilingScheme,u,l,c,n,r,o),!i(this.data))return;this.state=m.RECEIVING;var d=this;p(this.data,function(e){d.data=e,d.state=m.RECEIVED},function(){d.state=m.FAILED})}this.state===m.RECEIVED&&g(this,e,t,n,r,o),this.state===m.TRANSFORMED&&v(this,e.context,t,n,r,o)},f}.apply(t,n))&&(e.exports=r)},2131:function(e,t,i){var n,r;n=[i(1),i(0),i(2),i(21),i(3),i(15),i(9),i(16),i(7),i(758)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l){"use strict";function c(){this._layers=[],this.layerAdded=new o,this.layerRemoved=new o,this.layerMoved=new o,this.layerShownOrHidden=new o}function d(e,t){return e.indexOf(t)}function h(e,t,i){var n=e._layers;if(t=a.clamp(t,0,n.length-1),i=a.clamp(i,0,n.length-1),t!==i){var r=n[t];n[t]=n[i],n[i]=r,e._update(),e.layerMoved.raiseEvent(r,i,t)}}i(c.prototype,{length:{get:function(){return this._layers.length}}}),c.prototype.add=function(e,i){t(i)?this._layers.splice(i,0,e):(i=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,i)},c.prototype.addImageryProvider=function(e,t){var i=new l(e);return this.add(i,t),i},c.prototype.remove=function(t,i){i=e(i,!0);var n=this._layers.indexOf(t);return-1!==n&&(this._layers.splice(n,1),this._update(),this.layerRemoved.raiseEvent(t,n),i&&t.destroy(),!0)},c.prototype.removeAll=function(t){t=e(t,!0);for(var i=this._layers,n=0,r=i.length;n<r;n++){var o=i[n];this.layerRemoved.raiseEvent(o,n),t&&o.destroy()}this._layers=[]},c.prototype.contains=function(e){return-1!==this.indexOf(e)},c.prototype.indexOf=function(e){return this._layers.indexOf(e)},c.prototype.get=function(e){return this._layers[e]},c.prototype.raise=function(e){var t=d(this._layers,e);h(this,t,t+1)},c.prototype.lower=function(e){var t=d(this._layers,e);h(this,t,t-1)},c.prototype.raiseToTop=function(e){var t=d(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},c.prototype.lowerToBottom=function(e){var t=d(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var p=new s;return c.prototype.pickImageryLayerFeatures=function(e,i){var n=i.globe.pick(e,i);if(t(n)){for(var r,o=i.globe.ellipsoid.cartesianToCartographic(n),l=i.globe._surface._tilesToRender,c=0;!t(r)&&c<l.length;++c){var d=l[c];s.contains(d.rectangle,o)&&(r=d)}if(t(r)){for(var h=r.data.imagery,m=[],f=[],_=h.length-1;_>=0;--_){var g=h[_],v=g.readyImagery;if(t(v)){var y=v.imageryLayer.imageryProvider;if(t(y.pickFeatures)&&s.contains(v.rectangle,o)){var w=p;if(w.west=a.lerp(r.rectangle.west,r.rectangle.east,g.textureCoordinateRectangle.x-1/1024),w.east=a.lerp(r.rectangle.west,r.rectangle.east,g.textureCoordinateRectangle.z+1/1024),w.south=a.lerp(r.rectangle.south,r.rectangle.north,g.textureCoordinateRectangle.y-1/1024),w.north=a.lerp(r.rectangle.south,r.rectangle.north,g.textureCoordinateRectangle.w+1/1024),s.contains(w,o)){var x=y.pickFeatures(v.x,v.y,v.level,o.longitude,o.latitude);t(x)&&(m.push(x),f.push(v.imageryLayer))}}}}if(0!==m.length)return u.all(m,function(e){for(var i=[],n=0;n<e.length;++n){var r=e[n],a=f[n];if(t(r)&&r.length>0)for(var s=0;s<r.length;++s){var u=r[s];u.imageryLayer=a,t(u.position)||(u.position=o),i.push(u)}}return i})}}},c.prototype.queueReprojectionCommands=function(e){for(var t=this._layers,i=0,n=t.length;i<n;++i)t[i].queueReprojectionCommands(e)},c.prototype.cancelReprojections=function(){for(var e=this._layers,t=0,i=e.length;t<i;++t)e[t].cancelReprojections()},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.removeAll(!0),n(this)},c.prototype._update=function(){var e,i,n,r,o=!0,a=this._layers;for(n=0,r=a.length;n<r;++n)i=a[n],i._layerIndex=n,i.show?(i._isBaseLayer=o,o=!1):i._isBaseLayer=!1,i.show!==i._show&&(t(i._show)&&(t(e)||(e=[]),e.push(i)),i._show=i.show);if(t(e))for(n=0,r=e.length;n<r;++n)i=e[n],this.layerShownOrHidden.raiseEvent(i,i._layerIndex,i.show)},c}.apply(t,n))&&(e.exports=r)},2132:function(e,t,i){var n,r;n=[i(10),i(24),i(1),i(0),i(2),i(3),i(15),i(117),i(9),i(289),i(186),i(16),i(1953),i(2133),i(2134),i(1945),i(46),i(2135)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};var t=this._tileProvider.tilingScheme,n=t.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new g,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this.maximumScreenSpaceError=i(e.maximumScreenSpaceError,2),this.tileCacheSize=i(e.tileCacheSize,100),this._occluders=new p({ellipsoid:n}),this._tileLoadProgressEvent=new a,this._lastTileLoadQueueLength=0}function y(e){var t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,w(e);var i=e._levelZeroTiles;if(n(i))for(var r=0;r<i.length;++r){for(var o=i[r],a=o.customData,s=a.length,u=0;u<s;++u){var l=a[u];l.level=0,e._addHeightCallbacks.push(l)}i[r].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}function w(e){var t=e._debug;t.maxDepth=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}function x(e,t){var i=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;(i!==e._lastTileLoadQueueLength||e._tilesInvalidated)&&(t.afterRender.push(a.prototype.raiseEvent.bind(e._tileLoadProgressEvent,i)),e._lastTileLoadQueueLength=i);var n=e._debug;n.enableDebugOutput&&!n.suspendLodUpdate&&(n.tilesVisited===n.lastTilesVisited&&n.tilesRendered===n.lastTilesRendered&&n.tilesCulled===n.lastTilesCulled&&n.maxDepth===n.lastMaxDepth&&n.tilesWaitingForChildren===n.lastTilesWaitingForChildren||(console.log("Visited "+n.tilesVisited+", Rendered: "+n.tilesRendered+", Culled: "+n.tilesCulled+", Max Depth: "+n.maxDepth+", Waiting for children: "+n.tilesWaitingForChildren),n.lastTilesVisited=n.tilesVisited,n.lastTilesRendered=n.tilesRendered,n.lastTilesCulled=n.tilesCulled,n.lastMaxDepth=n.maxDepth,n.lastTilesWaitingForChildren=n.tilesWaitingForChildren))}function C(e,t){var i=d.center(e.rectangle,V),n=i.longitude-R.longitude,r=i.latitude-R.latitude;i=d.center(t.rectangle,V);var o=i.longitude-R.longitude,a=i.latitude-R.latitude;return n*n+r*r-(o*o+a*a)}function T(e,t){var i=e._debug;if(!i.suspendLodUpdate){e._tilesToRender.length=0;var r=e._tileProvider;if(!n(e._levelZeroTiles)){if(!r.ready)return;var o=r.tilingScheme;e._levelZeroTiles=m.createLevelZeroTiles(o)}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var a,s=e._levelZeroTiles,u=s.length>1?e._occluders:void 0;R=t.camera.positionCartographic,s.sort(C);var l,c,d=e._addHeightCallbacks,p=e._removeHeightCallbacks,f=t.frameNumber;if(d.length>0||p.length>0){for(l=0,c=s.length;l<c;++l)a=s[l],a._updateCustomData(f,d,p);d.length=0,p.length=0}for(l=0,c=s.length;l<c;++l)a=s[l],e._tileReplacementQueue.markTileRendered(a),a.renderable?r.computeTileVisibility(a,t,u)!==h.NONE?E(e,t,a):(a.needsLoading&&e._tileLoadQueueLow.push(a),++i.tilesCulled):(a.needsLoading&&e._tileLoadQueueHigh.push(a),++i.tilesWaitingForChildren)}}function E(e,t,i){var n=e._debug;if(++n.tilesVisited,e._tileReplacementQueue.markTileRendered(i),i._updateCustomData(t.frameNumber),i.level>n.maxDepth&&(n.maxDepth=i.level),D(e,t,i)<e.maximumScreenSpaceError)return i.needsLoading&&e._tileLoadQueueMedium.push(i),void O(e,i);var r=i.southwestChild,o=i.southeastChild,a=i.northwestChild,s=i.northeastChild,u=r.renderable&&o.renderable&&a.renderable&&s.renderable,l=r.upsampledFromParent&&o.upsampledFromParent&&a.upsampledFromParent&&s.upsampledFromParent;u?l?(O(e,i),A(e,t.camera.positionCartographic,r,o,a,s),i.needsLoading&&e._tileLoadQueueMedium.push(i)):(S(e,r,o,a,s,t),i.needsLoading&&e._tileLoadQueueLow.push(i)):(A(e,t.camera.positionCartographic,r,o,a,s),O(e,i),i.needsLoading&&e._tileLoadQueueLow.push(i))}function A(e,t,i,n,r,o){t.longitude<i.east?t.latitude<i.north?(P(e,i),P(e,n),P(e,r),P(e,o)):(P(e,r),P(e,i),P(e,o),P(e,n)):t.latitude<i.north?(P(e,n),P(e,i),P(e,o),P(e,r)):(P(e,o),P(e,r),P(e,n),P(e,i))}function P(e,t){e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&(t.renderable?e._tileLoadQueueLow.push(t):e._tileLoadQueueHigh.push(t))}function S(e,t,i,n,r,o){var a=o.camera.positionCartographic,s=e._tileProvider,u=e._occluders;a.longitude<t.rectangle.east?a.latitude<t.rectangle.north?(b(e,t,s,o,u),b(e,i,s,o,u),b(e,n,s,o,u),b(e,r,s,o,u)):(b(e,n,s,o,u),b(e,t,s,o,u),b(e,r,s,o,u),b(e,i,s,o,u)):a.latitude<t.rectangle.north?(b(e,i,s,o,u),b(e,t,s,o,u),b(e,r,s,o,u),b(e,n,s,o,u)):(b(e,r,s,o,u),b(e,n,s,o,u),b(e,i,s,o,u),b(e,t,s,o,u))}function b(e,t,i,n,r){i.computeTileVisibility(t,n,r)!==h.NONE?E(e,n,t):(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&e._tileLoadQueueLow.push(t))}function D(e,t,i){if(t.mode===_.SCENE2D||t.camera.frustum instanceof l)return I(e,t,i);var n=e._tileProvider.getLevelMaximumGeometricError(i.level),r=i._distance,o=t.context.drawingBufferHeight,a=t.camera.frustum.sseDenominator,s=n*o/(r*a);return t.fog.enabled&&(s-=u.fog(r,t.fog.density)*t.fog.sse),s}function I(e,t,i){var r=t.camera,o=r.frustum;n(o._offCenterFrustum)&&(o=o._offCenterFrustum);var a=t.context,s=a.drawingBufferWidth,l=a.drawingBufferHeight,c=e._tileProvider.getLevelMaximumGeometricError(i.level),d=Math.max(o.top-o.bottom,o.right-o.left)/Math.max(s,l),h=c/d;return t.fog.enabled&&t.mode!==_.SCENE2D&&(h-=u.fog(i._distance,t.fog.density)*t.fog.sse),h}function O(e,t){e._tilesToRender.push(t),++e._debug.tilesRendered}function M(e,t){var i=e._tileLoadQueueHigh,n=e._tileLoadQueueMedium,r=e._tileLoadQueueLow;if(0!==i.length||0!==n.length||0!==r.length){e._tileReplacementQueue.trimTiles(e.tileCacheSize);var o=s()+e._loadQueueTimeSlice,a=e._tileProvider;F(e,t,a,o,i),F(e,t,a,o,n),F(e,t,a,o,r)}}function F(e,t,i,n,r){for(var o=0,a=r.length;o<a&&s()<n;++o){var u=r[o];e._tileReplacementQueue.markTileRendered(u),i.loadTile(t,u)}}function N(r,o){var a=H;a.length=0;for(var u,l=r._tileToUpdateHeights,c=r._tileProvider.terrainProvider,h=s(),p=r._updateHeightsTimeSlice,m=h+p,g=o.mode,v=o.mapProjection,y=v.ellipsoid;l.length>0;){var w=l[0];if(w.state===f.DONE){var x=w.customData,C=x.length,T=!1;for(u=r._lastTileIndex;u<C;++u){var E=x[u];if(w.level>E.level){if(n(E.positionOnEllipsoidSurface)||(E.positionOnEllipsoidSurface=e.fromRadians(E.positionCartographic.longitude,E.positionCartographic.latitude,0,y)),g===_.SCENE3D){var A=y.geodeticSurfaceNormal(E.positionOnEllipsoidSurface,U.direction),P=y.getSurfaceNormalIntersectionWithZAxis(E.positionOnEllipsoidSurface,11500,U.origin);if(!n(P)){var S=Math.min(i(w.data.minimumHeight,0),-11500),b=e.multiplyByScalar(A,Math.abs(S)+1,B);e.subtract(E.positionOnEllipsoidSurface,b,U.origin)}}else t.clone(E.positionCartographic,z),z.height=-11500,v.project(z,B),e.fromElements(B.z,B.x,B.y,B),e.clone(B,U.origin),e.clone(e.UNIT_X,U.direction);var D=w.data.pick(U,g,v,!1,B);n(D)&&(E.callback(D),E.level=w.level)}else if(w.level===E.level){for(var I,O=w.children,M=O.length,F=0;F<M&&(I=O[F],!d.contains(I.rectangle,E.positionCartographic));++F);var N=c.getTileDataAvailable(I.x,I.y,I.level),L=w.parent;(n(N)&&!N||n(L)&&n(L.data)&&n(L.data.terrainData)&&!L.data.terrainData.isChildAvailable(L.x,L.y,I.x,I.y))&&E.removeFunc()}if(s()>=m){T=!0;break}}if(T){r._lastTileIndex=u;break}r._lastTileIndex=0,l.shift()}else a.push(w),l.shift(),r._lastTileIndex=0}for(u=0;u<a.length;u++)l.push(a[u])}function L(e,t){for(var i=e._tileProvider,n=e._tilesToRender,r=e._tileToUpdateHeights,o=0,a=n.length;o<a;++o){var s=n[o];i.showTileThisFrame(s,t),s._frameRendered!==t.frameNumber-1&&r.push(s),s._frameRendered=t.frameNumber}}r(v.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}}),v.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},v.prototype.forEachLoadedTile=function(e){for(var t=this._tileReplacementQueue.head;n(t);)t.state!==f.START&&e(t),t=t.replacementNext},v.prototype.forEachRenderedTile=function(e){for(var t=this._tilesToRender,i=0,n=t.length;i<n;++i)e(t[i])},v.prototype.updateHeight=function(e,t){var i=this,n={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t};return n.removeFunc=function(){for(var e=i._addHeightCallbacks,t=e.length,r=0;r<t;++r)if(e[r]===n){e.splice(r,1);break}i._removeHeightCallbacks.push(n)},i._addHeightCallbacks.push(n),n.removeFunc},v.prototype.update=function(e){n(this._tileProvider.update)&&this._tileProvider.update(e)},v.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(y(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),this._debug.suspendLodUpdate||(w(this),this._tileReplacementQueue.markStartOfRenderFrame()))},v.prototype.render=function(e){var t=e.passes,i=this._tileProvider;t.render&&(i.beginUpdate(e),T(this,e),L(this,e),i.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&i.updateForPick(e)},v.prototype.endFrame=function(e){e.passes.render&&e.mode!==_.MORPHING&&(M(this,e),N(this,e),x(this,e))},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var R,V=new t,U=new c,z=new t,B=new e,H=[];return v}.apply(t,n))&&(e.exports=r)},2133:function(e,t,i){var n,r;n=[i(10),i(2),i(447)],void 0!==(r=function(e,t,i){"use strict";function n(t){this._ellipsoid=new i(t.ellipsoid,e.ZERO)}return t(n.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),n}.apply(t,n))&&(e.exports=r)},2134:function(e,t,i){var n,r;n=[i(0),i(2),i(3),i(16),i(1945)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this._replacementPrevious=void 0,this._replacementNext=void 0,this._distance=0,this._priorityFunction=void 0,this._customData=[],this._frameUpdated=void 0,this._frameRendered=void 0,this._loadedCallbacks={},this.state=r.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function a(t){e(t)&&t.freeResources()}return o.createLevelZeroTiles=function(e){for(var t=e.getNumberOfXTilesAtLevel(0),i=e.getNumberOfYTilesAtLevel(0),n=new Array(t*i),r=0,a=0;a<i;++a)for(var s=0;s<t;++s)n[r++]=new o({tilingScheme:e,x:s,y:a,level:0});return n},o.prototype._updateCustomData=function(t,i,r){var o,a,s,u=this.customData;if(e(i)&&e(r)){for(u=u.filter(function(e){return-1===r.indexOf(e)}),this._customData=u,s=this._rectangle,o=0;o<i.length;++o)a=i[o],n.contains(s,a.positionCartographic)&&u.push(a);this._frameUpdated=t}else{var l=this._parent;if(e(l)&&this._frameUpdated!==l._frameUpdated){u.length=0,s=this._rectangle;var c=l.customData;for(o=0;o<c.length;++o)a=c[o],n.contains(s,a.positionCartographic)&&u.push(a);this._frameUpdated=l._frameUpdated}}},t(o.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return e(this._southwestChild)||(this._southwestChild=new o({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return e(this._southeastChild)||(this._southeastChild=new o({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return e(this._northwestChild)||(this._northwestChild=new o({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return e(this._northeastChild)||(this._northeastChild=new o({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<r.DONE}},eligibleForUnloading:{get:function(){var t=!0;return e(this.data)&&(t=this.data.eligibleForUnloading,e(t)||(t=!0)),t}}}),o.prototype.freeResources=function(){this.state=r.START,this.renderable=!1,this.upsampledFromParent=!1,e(this.data)&&e(this.data.freeResources)&&this.data.freeResources(),a(this._southwestChild),this._southwestChild=void 0,a(this._southeastChild),this._southeastChild=void 0,a(this._northwestChild),this._northwestChild=void 0,a(this._northeastChild),this._northeastChild=void 0},o}.apply(t,n))&&(e.exports=r)},2135:function(e,t,i){var n,r;n=[i(0)],void 0!==(r=function(e){"use strict";function t(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function i(e,t){var i=t.replacementPrevious,n=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=n),t===e.head?e.head=n:i.replacementNext=n,t===e.tail?e.tail=i:n.replacementPrevious=i,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}return t.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},t.prototype.trimTiles=function(t){for(var n=this.tail,r=!0;r&&e(this._lastBeforeStartOfFrame)&&this.count>t&&e(n);){r=n!==this._lastBeforeStartOfFrame;var o=n.replacementPrevious;n.eligibleForUnloading&&(n.freeResources(),i(this,n)),n=o}},t.prototype.markTileRendered=function(t){var n=this.head;return n===t?void(t===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=t.replacementNext)):(++this.count,e(n)?((e(t.replacementPrevious)||e(t.replacementNext))&&i(this,t),t.replacementPrevious=void 0,t.replacementNext=n,n.replacementPrevious=t,void(this.head=t)):(t.replacementPrevious=void 0,t.replacementNext=void 0,this.head=t,void(this.tail=t)))},t}.apply(t,n))&&(e.exports=r)},2136:function(e,t,i){e.exports=i.p+"4fff67aa927fc4ecb16298f61b0cf84a.jpg"},2137:function(e,t,i){var n,r;n=[i(103),i(10),i(1),i(0),i(2),i(21),i(23),i(2138),i(40),i(20),i(1965),i(50),i(2141),i(295)],void 0!==(r=function(e,t,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(e){e=n(e,n.EMPTY_OBJECT);var t=e.textureUrl;r(t)||(t=i(2144)),this.show=n(e.show,!0),this.textureUrl=t,this._ellipsoid=n(e.ellipsoid,s.MOON),this.onlySunLighting=n(e.onlySunLighting,!0),this._ellipsoidPrimitive=new p({radii:this.ellipsoid.radii,material:m.fromType(m.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new u}o(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var _=new l,g=new l,v=new t,y=[];return f.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var i=e.time;r(h.computeIcrfToFixedMatrix(i,_))||h.computeTemeToPseudoFixedMatrix(i,_);var n=this._axes.evaluate(i,g);l.transpose(n,n),l.multiply(_,n,n);var o=d.computeMoonPositionInEarthInertialFrame(i,v);l.multiplyByVector(_,o,o),c.fromRotationTranslation(n,o,t.modelMatrix);var a=e.commandList;return e.commandList=y,y.length=0,t.update(e),e.commandList=a,1===y.length?y[0]:void 0}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),a(this)},f}.apply(t,n))&&(e.exports=r)},2138:function(e,t,i){var n,r;n=[i(10),i(0),i(2139),i(36),i(9),i(40),i(59)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(e){t(e)&&"function"==typeof e||(e=i.ComputeMoon),this._computeFunction=e}function u(i,n,a){var s=l;s.x=Math.cos(i+r.PI_OVER_TWO),s.y=Math.sin(i+r.PI_OVER_TWO),s.z=0;var u=Math.cos(n),h=d;h.x=u*Math.cos(i),h.y=u*Math.sin(i),h.z=Math.sin(n);var p=e.cross(h,s,c);return t(a)||(a=new o),a[0]=s.x,a[1]=p.x,a[2]=h.x,a[3]=s.y,a[4]=p.y,a[5]=h.y,a[6]=s.z,a[7]=p.z,a[8]=h.z,a}var l=new e,c=new e,d=new e,h=new o,p=new a;return s.prototype.evaluate=function(i,s){t(i)||(i=n.now());var l=this._computeFunction(i),c=u(l.rightAscension,l.declination,s),d=r.zeroToTwoPi(l.rotation),m=a.fromAxisAngle(e.UNIT_Z,d,p),f=o.fromQuaternion(a.conjugate(m,m),h);return o.multiply(f,c,c)},s}.apply(t,n))&&(e.exports=r)},2139:function(e,t,i){var n,r;n=[i(0),i(2140),i(36),i(9),i(187)],void 0!==(r=function(e,t,i,n,r){"use strict";var o={},a=-.0529921,s=-.1059842,u=13.0120009,l=13.3407154,c=26.4057084,d=13.064993,h=1.7484877,p=new i;return o.ComputeMoon=function(o,m){e(o)||(o=i.now()),p=i.addSeconds(o,32.184,p);var f=i.totalDays(p)-2451545,_=f/r.DAYS_PER_JULIAN_CENTURY,g=(125.045+a*f)*n.RADIANS_PER_DEGREE,v=(250.089+s*f)*n.RADIANS_PER_DEGREE,y=(260.008+u*f)*n.RADIANS_PER_DEGREE,w=(176.625+l*f)*n.RADIANS_PER_DEGREE,x=(357.529+.9856003*f)*n.RADIANS_PER_DEGREE,C=(311.589+c*f)*n.RADIANS_PER_DEGREE,T=(134.963+d*f)*n.RADIANS_PER_DEGREE,E=(276.617+.3287146*f)*n.RADIANS_PER_DEGREE,A=(34.226+h*f)*n.RADIANS_PER_DEGREE,P=(15.134+-.1589763*f)*n.RADIANS_PER_DEGREE,S=(119.743+.0036096*f)*n.RADIANS_PER_DEGREE,b=(239.961+.1643573*f)*n.RADIANS_PER_DEGREE,D=(25.053+12.9590088*f)*n.RADIANS_PER_DEGREE,I=Math.sin(g),O=Math.sin(v),M=Math.sin(y),F=Math.sin(w),N=Math.sin(x),L=Math.sin(C),R=Math.sin(T),V=Math.sin(E),U=Math.sin(A),z=Math.sin(P),B=Math.sin(S),H=Math.sin(b),k=Math.sin(D),G=Math.cos(g),W=Math.cos(v),Y=Math.cos(y),j=Math.cos(w),X=Math.cos(x),Q=Math.cos(C),q=Math.cos(T),Z=Math.cos(E),K=Math.cos(A),J=Math.cos(P),$=Math.cos(S),ee=Math.cos(b),te=Math.cos(D),ie=(269.9949+.0031*_-3.8787*I-.1204*O+.07*M-.0172*F+.0072*L-.0052*z+.0043*k)*n.RADIANS_PER_DEGREE,ne=(66.5392+.013*_+1.5419*G+.0239*W-.0278*Y+.0068*j-.0029*Q+9e-4*q+8e-4*J-9e-4*te)*n.RADIANS_PER_DEGREE,re=(38.3213+13.17635815*f-1.4e-12*f*f+3.561*I+.1208*O-.0642*M+.0158*F+.0252*N-.0066*L-.0047*R-.0046*V+.0028*U+.0052*z+.004*B+.0019*H-.0044*k)*n.RADIANS_PER_DEGREE,oe=(13.17635815-2*f*1.4e-12+3.561*G*a+.1208*W*s-.0642*Y*u+.0158*j*l+.0252*X*.9856003-.0066*Q*c-.0047*q*d-.0046*Z*.3287146+.0028*K*h+.0052*J*-.1589763+.004*$*.0036096+.0019*ee*.1643573-.0044*te*12.9590088)/86400*n.RADIANS_PER_DEGREE;return e(m)||(m=new t),m.rightAscension=ie,m.declination=ne,m.rotation=re,m.rotationRate=oe,m},o}.apply(t,n))&&(e.exports=r)},2140:function(e,t,i){var n;void 0!==(n=function(){"use strict";function e(e,t,i,n){this.rightAscension=e,this.declination=t,this.rotation=i,this.rotationRate=n}return e}.call(t,i,t,e))&&(e.exports=n)},2141:function(e,t,i){var n,r;n=[i(38),i(1946),i(10),i(42),i(1),i(0),i(21),i(3),i(20),i(181),i(64),i(60),i(47),i(68),i(77),i(52),i(115),i(2142),i(2143),i(70),i(220),i(295),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(t){t=r(t,r.EMPTY_OBJECT),this.center=i.clone(r(t.center,i.ZERO)),this._center=new i,this.radii=i.clone(t.radii),this._radii=new i,this._oneOverEllipsoidRadiiSquared=new i,this._boundingSphere=new e,this.modelMatrix=u.clone(r(t.modelMatrix,u.IDENTITY)),this._modelMatrix=new u,this._computedModelMatrix=new u,this.show=r(t.show,!0),this.material=r(t.material,x.fromType(x.ColorType)),this._material=void 0,this._translucent=void 0,this.id=t.id,this._id=void 0,this.debugShowBoundingVolume=r(t.debugShowBoundingVolume,!1),this.onlySunLighting=r(t.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=r(t.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new d({owner:r(t._owner,this)}),this._pickCommand=new d({owner:r(t._owner,this),pickOnly:!0});var n=this;this._uniforms={u_radii:function(){return n.radii},u_oneOverEllipsoidRadiiSquared:function(){return n._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return n._pickId.color}}}function E(e){var n=e.cache.ellipsoidPrimitive_vertexArray;if(o(n))return n;var r=t.createGeometry(t.fromDimensions({dimensions:new i(2,2,2),vertexFormat:l.POSITION_ONLY}));return n=_.fromGeometry({context:e,geometry:r,attributeLocations:A,bufferUsage:c.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=n,n}var A={position:0},P="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n";return T.prototype.update=function(t){if(this.show&&t.mode===C.SCENE3D&&o(this.center)&&o(this.radii)){var r=t.context,a=this.material.isTranslucent(),s=this._translucent!==a;o(this._rs)&&!s||(this._translucent=a,this._rs=p.fromCache({cull:{enabled:!0,face:w.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!a&&r.fragmentDepth,blending:a?y.ALPHA_BLEND:void 0})),o(this._va)||(this._va=E(r));var l=!1,c=this.radii;if(!i.equals(this._radii,c)){i.clone(c,this._radii);var d=this._oneOverEllipsoidRadiiSquared;d.x=1/(c.x*c.x),d.y=1/(c.y*c.y),d.z=1/(c.z*c.z),l=!0}u.equals(this.modelMatrix,this._modelMatrix)&&i.equals(this.center,this._center)||(u.clone(this.modelMatrix,this._modelMatrix),i.clone(this.center,this._center),u.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),l=!0),l&&(i.clone(i.ZERO,this._boundingSphere.center),this._boundingSphere.radius=i.maximumComponent(c),e.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));var _=this._material!==this.material;this._material=this.material,this._material.update(r);var x=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var T=t.useLogDepth,S=this._useLogDepth!==T;this._useLogDepth=T;var b,D,I=this._colorCommand;(_||x||s||S)&&(b=new f({sources:[v]}),D=new f({sources:[this.material.shaderSource,g]}),this.onlySunLighting&&D.defines.push("ONLY_SUN_LIGHTING"),!a&&r.fragmentDepth&&D.defines.push("WRITE_DEPTH"),this._useLogDepth&&(b.defines.push("LOG_DEPTH","DISABLE_GL_POSITION_LOG_DEPTH"),D.defines.push("LOG_DEPTH"),D.sources.push(P)),this._sp=m.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:b,fragmentShaderSource:D,attributeLocations:A}),I.vertexArray=this._va,I.renderState=this._rs,I.shaderProgram=this._sp,I.uniformMap=n(this._uniforms,this.material._uniforms),I.executeInClosestFrustum=a);var O=t.commandList,M=t.passes;if(M.render&&(I.boundingVolume=this._boundingSphere,I.debugShowBoundingVolume=this.debugShowBoundingVolume,I.modelMatrix=this._computedModelMatrix,I.pass=a?h.TRANSLUCENT:h.OPAQUE,O.push(I)),M.pick){var F=this._pickCommand;o(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=r.createPickId({primitive:this,id:this.id})),(_||x||!o(this._pickSP)||S)&&(b=new f({sources:[v]}),D=new f({sources:[this.material.shaderSource,g],pickColorQualifier:"uniform"}),this.onlySunLighting&&D.defines.push("ONLY_SUN_LIGHTING"),!a&&r.fragmentDepth&&D.defines.push("WRITE_DEPTH"),this._useLogDepth&&(b.defines.push("LOG_DEPTH"),D.defines.push("LOG_DEPTH"),D.sources.push(P)),this._pickSP=m.replaceCache({context:r,shaderProgram:this._pickSP,vertexShaderSource:b,fragmentShaderSource:D,attributeLocations:A}),F.vertexArray=this._va,F.renderState=this._rs,F.shaderProgram=this._pickSP,F.uniformMap=n(n(this._uniforms,this._pickUniforms),this.material._uniforms),F.executeInClosestFrustum=a),F.boundingVolume=this._boundingSphere,F.modelMatrix=this._computedModelMatrix,F.pass=a?h.TRANSLUCENT:h.OPAQUE,O.push(F)}}},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),a(this)},T}.apply(t,n))&&(e.exports=r)},2142:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\n\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\n\nvarying vec3 v_positionEC;\n\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\n    vec3 positionEC = czm_pointAlongRay(ray, intersection);\n    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\n    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\n    vec3 sphericalNormal = normalize(positionMC / u_radii);\n    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates\n    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordiantes\n\n    vec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\n    vec3 positionToEyeEC = -positionEC;\n\n    czm_materialInput materialInput;\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = (positionMC + u_radii) / u_radii;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef ONLY_SUN_LIGHTING\n    return czm_private_phong(normalize(positionToEyeEC), material);\n#else\n    return czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n\nvoid main()\n{\n    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii\n    // in the vertex shader. Only when it is larger than some constant, march along the ray.\n    // Otherwise perform one intersection test which will be the common case.\n\n    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.\n    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test\n    // may cause false negatives. This will discard fragments before marching the ray forward.\n    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\n    vec3 direction = normalize(v_positionEC);\n    vec3 ellipsoidCenter = czm_modelView[3].xyz;\n\n    float t1 = -1.0;\n    float t2 = -1.0;\n\n    float b = -2.0 * dot(direction, ellipsoidCenter);\n    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\n\n    float discriminant = b * b - 4.0 * c;\n    if (discriminant >= 0.0) {\n        t1 = (-b - sqrt(discriminant)) * 0.5;\n        t2 = (-b + sqrt(discriminant)) * 0.5;\n    }\n\n    if (t1 < 0.0 && t2 < 0.0) {\n        discard;\n    }\n\n    float t = min(t1, t2);\n    if (t < 0.0) {\n        t = 0.0;\n    }\n\n    // March ray forward to intersection with larger sphere and find\n    // actual intersection point with ellipsoid.\n    czm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\n    czm_ray ray = czm_ray(t * direction, direction);\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\n\n    if (czm_isEmpty(intersection))\n    {\n        discard;\n    }\n\n    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.\n    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\n\n    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.\n    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\n\n    gl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\n    gl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;\n    vec3 positionEC = czm_pointAlongRay(ray, t);\n    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n#ifdef LOG_DEPTH\n    czm_writeLogDepth(1.0 + positionCC.w);\n#else\n    float z = positionCC.z / positionCC.w;\n\n    float n = czm_depthRange.near;\n    float f = czm_depthRange.far;\n\n    gl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n#endif\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2143:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec3 position;\n\nuniform vec3 u_radii;\n\nvarying vec3 v_positionEC;\n\nvoid main()\n{\n    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.\n    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,\n    // but doing it here allows us to change the radii without rewriting the vertex data, and\n    // allows all ellipsoids to reuse the same vertex data.\n    vec4 p = vec4(u_radii * position, 1.0);\n\n    v_positionEC = (czm_modelView * p).xyz;     // position in eye coordinates\n    gl_Position = czm_modelViewProjection * p;  // position in clip coordinates\n\n    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums\n    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the\n    // ellipsoid (does not write depth) that was rendered in the farther frustum.\n    //\n    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates\n    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering\n    // the ellipsoid in the closest frustum to the viewer.\n    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n\n    czm_vertexLogDepth();\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2144:function(e,t,i){e.exports=i.p+"b592e228bf0641d6b4f0b79e664177ab.jpg"},2145:function(e,t,i){var n,r;n=[i(293),i(99),i(38),i(1946),i(17),i(10),i(24),i(12),i(25),i(150),i(101),i(221),i(1),i(0),i(2),i(94),i(21),i(3),i(1954),i(15),i(72),i(128),i(290),i(71),i(36),i(9),i(20),i(2146),i(2147),i(289),i(424),i(747),i(437),i(69),i(186),i(438),i(1933),i(104),i(50),i(423),i(2148),i(2149),i(61),i(60),i(422),i(47),i(91),i(77),i(52),i(100),i(2152),i(1947),i(163),i(802),i(1967),i(2155),i(2158),i(2159),i(2160),i(2161),i(1969),i(2164),i(2165),i(1955),i(2166),i(152),i(2167),i(2168),i(183),i(1957),i(46),i(427),i(2186),i(2187),i(1975),i(2190),i(762),i(2193)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I,O,M,F,N,L,R,V,U,z,B,H,k,G,W,Y,j,X,Q,q,Z,K,J,$,ee,te,ie,ne,re,oe,ae,se,ue,le,ce,de,he,pe,me,fe,_e,ge,ve,ye,we,xe,Ce,Te){"use strict";function Ee(e){e=h(e,h.EMPTY_OBJECT);var i=e.canvas,n=e.contextOptions,r=e.creditContainer,o=e.creditViewport,a=p(r),s=new H(i,n);a||(r=document.createElement("div"),r.style.position="absolute",r.style.bottom="0",r.style["text-shadow"]="0 0 2px #000000",r.style.color="#ffffff",r.style["font-size"]="10px",r.style["padding-right"]="5px",i.parentNode.appendChild(r)),p(o)||(o=i.parentNode),this._id=c(),this._jobScheduler=new ue,this._frameState=new oe(s,new $(r," • ",o),this._jobScheduler),this._frameState.scene3DOnly=h(e.scene3DOnly,!1),this._removeCreditContainer=!a,this._creditContainer=r,this._canvas=i,this._context=s,this._computeEngine=new B(s),this._globe=void 0,this._primitives=new fe,this._groundPrimitives=new fe,this._logDepthBuffer=s.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new Ce,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=h(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new te,this._clearColorCommand=new z({color:new u,stencil:0,owner:this}),this._depthClearCommand=new z({depth:1,owner:this}),this._stencilClearCommand=new z({stencil:0}),this._depthOnlyRenderStateCache={},this._pickRenderStateCache={},this._transitioner=new ve(this),this._preUpdate=new y,this._postUpdate=new y,this._renderError=new y,this._preRender=new y,this._postRender=new y,this._pickPositionCache={},this._pickPositionCacheDirty=!1,this._minimumDisableDepthTestDistance=0,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new y,this.morphComplete=new y,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=u.clone(u.BLACK),this._mode=_e.SCENE3D,this._mapProjection=p(e.mapProjection)?e.mapProjection:new w,this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowGlobeDepth=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new re,this._sunCamera=new K(this),this.shadowMap=new we({context:s,lightCamera:this._sunCamera,enabled:h(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=u.clone(u.WHITE),this._actualInvertClassificationColor=u.clone(this._invertClassificationColor),this._invertClassification=new se,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new pe,this._brdfLutGenerator=new Z,this._terrainExaggeration=h(e.terrainExaggeration,1),this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new ye(this),this._mapMode2D=h(e.mapMode2D,le.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=h(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=h(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=L.requestCompletedEvent.addEventListener(yt(this)),this._removeTaskProcessorListenerCallback=V.taskCompletedEvent.addEventListener(yt(this)),this._removeGlobeCallbacks=[];var l=new t(0,0,s.drawingBufferWidth,s.drawingBufferHeight),d=new K(this);this._logDepthBuffer&&(d.frustum.near=.1,d.frustum.far=1e10);var m=new t(0,0,1,1),f=new K(this);f.frustum=new D({width:.01,aspectRatio:1,near:.1}),this._view=new Te(this,d,l),this._pickOffscreenView=new Te(this,f,m),this._defaultView=new Te(this,d,l),this._view=this._defaultView,De(this,0,E.now()),this.initializeFrame()}function Ae(e,t){for(var i=0;i<e._removeGlobeCallbacks.length;++i)e._removeGlobeCallbacks[i]();e._removeGlobeCallbacks.length=0;var n=[];p(t)&&(n.push(t.imageryLayersUpdatedEvent.addEventListener(yt(e))),n.push(t.terrainProviderChanged.addEventListener(yt(e)))),e._removeGlobeCallbacks=n}function Pe(e,t,i){var n=e._frameState,r=e._context,o=e._view.oit,a=n.shadowState.lightShadowMaps,s=n.shadowState.lightShadowsEnabled,u=t.derivedCommands;s&&t.receiveShadows&&(u.shadows=we.createReceiveDerivedCommand(a,t,i,r,u.shadows)),p(t.pickId)&&(u.picking=ie.createPickDerivedCommand(e,t,r,u.picking)),t.pass===Y.TRANSLUCENT&&p(o)&&o.isSupported()&&(s&&t.receiveShadows?(u.oit=p(u.oit)?u.oit:{},u.oit.shadows=o.createDerivedCommands(u.shadows.receiveCommand,r,u.oit.shadows)):u.oit=o.createDerivedCommands(t,r,u.oit)),t.pickOnly||(u.depth=ie.createDepthOnlyDerivedCommand(e,t,r,u.depth)),u.originalCommand=t}function Se(e){var t=e.globe;if(e._mode===_e.SCENE3D&&p(t)&&t.show){var i=t.ellipsoid;return xt.radius=i.minimumRadius,wt=b.fromBoundingSphere(xt,e.camera.positionWC,wt)}}function be(e){e.render=!1,e.pick=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1}function De(e,t,i){var n=e.camera,r=e._frameState;r.commandList.length=0,r.shadowMaps.length=0,r.brdfLutGenerator=e._brdfLutGenerator,r.environmentMap=e.skyBox&&e.skyBox._cubeMap,r.mode=e._mode,r.morphTime=e.morphTime,r.mapProjection=e.mapProjection,r.frameNumber=t,r.time=E.clone(i,r.time),r.camera=n,r.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),r.occluder=Se(e),r.terrainExaggeration=e._terrainExaggeration,r.minimumDisableDepthTestDistance=e._minimumDisableDepthTestDistance,r.invertClassification=e.invertClassification,r.useLogDepth=e._logDepthBuffer&&!(e.camera.frustum instanceof D||e.camera.frustum instanceof I),e._actualInvertClassificationColor=u.clone(e.invertClassificationColor,e._actualInvertClassificationColor),se.isTranslucencySupported(e._context)||(e._actualInvertClassificationColor.alpha=1),r.invertClassificationColor=e._actualInvertClassificationColor,p(e.globe)?r.maximumScreenSpaceError=e.globe.maximumScreenSpaceError:r.maximumScreenSpaceError=2,be(r.passes)}function Ie(e){var t={},i=e.vertexAttributes;for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n].index);return t}function Oe(e,t,i){var n=t.context,r=h(i,e.shaderProgram),o=r.fragmentShaderSource.clone(),a=[];o.sources=o.sources.map(function(e){e=Q.replaceMain(e,"czm_Debug_main");for(var t,i=/gl_FragData\[(\d+)\]/g;null!==(t=i.exec(e));)-1===a.indexOf(t[1])&&a.push(t[1]);return e});var s,l=a.length,c="void main() \n{ \n    czm_Debug_main(); \n";if(t.debugShowCommands){p(e._debugColor)||(e._debugColor=u.fromRandom());var d=e._debugColor;if(l>0)for(s=0;s<l;++s)c+="    gl_FragData["+a[s]+"].rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n";else c+="    gl_FragColor.rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n"}if(t.debugShowFrustums){var m=1&e.debugOverlappingFrustums?"1.0":"0.0",f=2&e.debugOverlappingFrustums?"1.0":"0.0",_=4&e.debugOverlappingFrustums?"1.0":"0.0";if(l>0)for(s=0;s<l;++s)c+="    gl_FragData["+a[s]+"].rgb *= vec3("+m+", "+f+", "+_+"); \n";else c+="    gl_FragColor.rgb *= vec3("+m+", "+f+", "+_+"); \n"}c+="}",o.sources.push(c);var g=Ie(r);return X.fromCache({context:n,vertexShaderSource:r.vertexShaderSource,fragmentShaderSource:o,attributeLocations:g})}function Me(e,t,i){var n=G.shallowClone(e);n.shaderProgram=Oe(e,t),n.execute(t.context,i),n.shaderProgram.destroy()}function Fe(e,t,i,r){var a=t._frameState,s=a.context,u=e.boundingVolume;p(t._debugVolume)&&t._debugVolume.destroy();var c,d=o.clone(u.center);if(a.mode!==_e.SCENE3D){d=P.multiplyByPoint(Tt,d,d);var h=a.mapProjection,m=h.unproject(d);d=h.ellipsoid.cartographicToCartesian(m)}if(p(u.radius)){var f=u.radius;c=C.toWireframe(v.createGeometry(new v({radii:new o(f,f,f),vertexFormat:de.FLAT_VERTEX_FORMAT}))),t._debugVolume=new me({geometryInstances:new x({geometry:c,modelMatrix:P.fromTranslation(d),attributes:{color:new l(1,0,0,1)}}),appearance:new de({flat:!0,translucent:!1}),asynchronous:!1})}else{var _=u.halfAxes;c=C.toWireframe(n.createGeometry(n.fromDimensions({dimensions:new o(2,2,2),vertexFormat:de.FLAT_VERTEX_FORMAT}))),t._debugVolume=new me({geometryInstances:new x({geometry:c,modelMatrix:P.fromRotationTranslation(_,d,new P),attributes:{color:new l(1,0,0,1)}}),appearance:new de({flat:!0,translucent:!1}),asynchronous:!1})}var g=a.commandList,y=a.commandList=[];if(t._debugVolume.update(a),e=y[0],a.useLogDepth){e=ie.createLogDepthCommand(e,s).command}var w;p(r)&&(w=i.framebuffer,i.framebuffer=r),e.execute(s,i),p(w)&&(i.framebuffer=w),a.commandList=g}function Ne(e,t,i,n,r){var o=t._frameState;if(!p(t.debugCommandFilter)||t.debugCommandFilter(e)){if(e instanceof z)return void e.execute(i,n);e.debugShowBoundingVolume&&p(e.boundingVolume)&&Fe(e,t,n,r),o.useLogDepth&&p(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);var a=o.passes;if(a.pick||a.depth){if(a.pick&&!a.depth&&p(e.derivedCommands.picking))return e=e.derivedCommands.picking.pickCommand,void e.execute(i,n);if(p(e.derivedCommands.depth))return e=e.derivedCommands.depth.depthOnlyCommand,void e.execute(i,n)}if(t.debugShowCommands||t.debugShowFrustums)return void Me(e,t,n);o.shadowState.lightShadowsEnabled&&e.receiveShadows&&p(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(i,n):e.execute(i,n)}}function Le(e,t,i,n){var r=t._frameState,o=e.derivedCommands;p(o)&&(r.useLogDepth&&p(o.logDepth)&&(e=o.logDepth.command),o=e.derivedCommands,p(o.picking)?(e=o.picking.pickCommand,e.execute(i,n)):p(o.depth)&&(e=o.depth.depthOnlyCommand,e.execute(i,n)))}function Re(e,t,i){return t.boundingVolume.distanceSquaredTo(i)-e.boundingVolume.distanceSquaredTo(i)}function Ve(e,t,i){return e.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)+A.EPSILON12}function Ue(e,t,i,n,r){var o=e.context;S(n,Re,e.camera.positionWC),p(r)&&t(r.unclassifiedCommand,e,o,i);for(var a=n.length,s=0;s<a;++s)t(n[s],e,o,i)}function ze(e,t,i,n,r){var o=e.context;S(n,Ve,e.camera.positionWC),p(r)&&t(r.unclassifiedCommand,e,o,i);for(var a=n.length,s=0;s<a;++s)t(n[s],e,o,i)}function Be(e,t){var i=e._view.debugGlobeDepths,n=i[t];return!p(n)&&e.context.depthTexture&&(n=new ae,i[t]=n),n}function He(e,t){var i=e._view.pickDepths,n=i[t];return p(n)||(n=new he,i[t]=n),n}function ke(e,t){var i=e.camera,n=e.context,r=n.uniformState;r.updateCamera(i);var o;o=p(i.frustum.fov)?i.frustum.clone(Et):p(i.frustum.infiniteProjectionMatrix)?i.frustum.clone(At):p(i.frustum.width)?i.frustum.clone(Pt):i.frustum.clone(St),o.near=i.frustum.near,o.far=i.frustum.far,r.updateFrustum(o),r.updatePass(Y.ENVIRONMENT);var a=e._frameState.passes,s=a.pick,u=e._environmentState,l=e._view,c=u.renderTranslucentDepthForPick,d=u.useWebVR;if(!s){var h=u.skyBoxCommand;if(p(h)&&Ne(h,e,n,t),u.isSkyAtmosphereVisible&&Ne(u.skyAtmosphereCommand,e,n,t),u.isSunVisible&&(u.sunDrawCommand.execute(n,t),e.sunBloom&&!d)){var m;m=u.useGlobeDepthFramebuffer?l.globeDepth.framebuffer:u.usePostProcess?l.sceneFramebuffer.getFramebuffer():u.originalFramebuffer,e._sunPostProcess.execute(n),e._sunPostProcess.copy(n,m),t.framebuffer=m}u.isMoonVisible&&u.moonCommand.execute(n,t)}var f;u.useOIT?(p(e._executeOITFunction)||(e._executeOITFunction=function(e,t,i,n,r){l.oit.executeCommands(e,t,i,n,r)}),f=e._executeOITFunction):f=a.render?Ue:ze;for(var _,g=u.clearGlobeDepth,v=u.useDepthPlane,y=e._depthClearCommand,w=e._stencilClearCommand,x=e._depthPlane,C=u.usePostProcessSelected,T=i.position.z,E=l.frustumCommandsList,A=E.length,P=0;P<A;++P){var S=A-P-1,b=E[S];e.mode===_e.SCENE2D?(i.position.z=T-b.near+1,o.far=Math.max(1,b.far-b.near),o.near=1,r.update(e.frameState),r.updateFrustum(o)):(o.near=0!==S?b.near*e.opaqueFrustumNearOffset:b.near,o.far=b.far,r.updateFrustum(o));var D,I=e.debugShowGlobeDepth?Be(e,S):l.globeDepth;e.debugShowGlobeDepth&&p(I)&&u.useGlobeDepthFramebuffer&&(I.update(n,t,l.viewport),I.clear(n,t,e._clearColorCommand.color),D=t.framebuffer,t.framebuffer=I.framebuffer),y.execute(n,t),n.stencilBuffer&&w.execute(n,t),r.updatePass(Y.GLOBE);var O=b.commands[Y.GLOBE],M=b.indices[Y.GLOBE];for(_=0;_<M;++_)Ne(O[_],e,n,t);for(p(I)&&u.useGlobeDepthFramebuffer&&(I.update(n,t,l.viewport),I.executeCopyDepth(n,t)),e.debugShowGlobeDepth&&p(I)&&u.useGlobeDepthFramebuffer&&(t.framebuffer=D),r.updatePass(Y.TERRAIN_CLASSIFICATION),O=b.commands[Y.TERRAIN_CLASSIFICATION],M=b.indices[Y.TERRAIN_CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t);for(r.updatePass(Y.CLASSIFICATION),O=b.commands[Y.CLASSIFICATION],M=b.indices[Y.CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t);if(g&&y.execute(n,t),!u.useInvertClassification||s){for(r.updatePass(Y.CESIUM_3D_TILE),O=b.commands[Y.CESIUM_3D_TILE],M=b.indices[Y.CESIUM_3D_TILE],_=0;_<M;++_)Ne(O[_],e,n,t);for(r.updatePass(Y.CESIUM_3D_TILE_CLASSIFICATION),O=b.commands[Y.CESIUM_3D_TILE_CLASSIFICATION],M=b.indices[Y.CESIUM_3D_TILE_CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t);for(r.updatePass(Y.CLASSIFICATION),O=b.commands[Y.CLASSIFICATION],M=b.indices[Y.CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t)}else{e._invertClassification.clear(n,t);var F=t.framebuffer;for(t.framebuffer=e._invertClassification._fbo,r.updatePass(Y.CESIUM_3D_TILE),O=b.commands[Y.CESIUM_3D_TILE],M=b.indices[Y.CESIUM_3D_TILE],_=0;_<M;++_)Ne(O[_],e,n,t);for(r.updatePass(Y.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),O=b.commands[Y.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],M=b.indices[Y.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],_=0;_<M;++_)Ne(O[_],e,n,t);for(t.framebuffer=F,e._invertClassification.executeClassified(n,t),1===e.frameState.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(n,t),M>0&&n.stencilBuffer&&w.execute(n,t),r.updatePass(Y.CESIUM_3D_TILE_CLASSIFICATION),O=b.commands[Y.CESIUM_3D_TILE_CLASSIFICATION],M=b.indices[Y.CESIUM_3D_TILE_CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t);for(r.updatePass(Y.CLASSIFICATION),O=b.commands[Y.CLASSIFICATION],M=b.indices[Y.CLASSIFICATION],_=0;_<M;++_)Ne(O[_],e,n,t)}for(M>0&&n.stencilBuffer&&w.execute(n,t),g&&v&&x.execute(n,t),r.updatePass(Y.OPAQUE),O=b.commands[Y.OPAQUE],M=b.indices[Y.OPAQUE],_=0;_<M;++_)Ne(O[_],e,n,t);0!==S&&e.mode!==_e.SCENE2D&&(o.near=b.near,r.updateFrustum(o));var N;if(!s&&u.useInvertClassification&&e.frameState.invertClassificationColor.alpha<1&&(N=e._invertClassification),r.updatePass(Y.TRANSLUCENT),O=b.commands[Y.TRANSLUCENT],O.length=b.indices[Y.TRANSLUCENT],f(e,Ne,t,O,N),n.depthTexture&&e.useDepthPicking&&(u.useGlobeDepthFramebuffer||c)){var L=c?t.framebuffer.depthStencilTexture:I.framebuffer.depthStencilTexture,R=He(e,S);R.update(n,L),R.executeCopyDepth(n,t)}if(!s&&C){var V=t.framebuffer;for(t.framebuffer=l.sceneFramebuffer.getIdFramebuffer(),o.near=0!==S?b.near*e.opaqueFrustumNearOffset:b.near,o.far=b.far,r.updateFrustum(o),r.updatePass(Y.GLOBE),O=b.commands[Y.GLOBE],M=b.indices[Y.GLOBE],_=0;_<M;++_)Le(O[_],e,n,t);for(g&&(y.framebuffer=t.framebuffer,y.execute(n,t),y.framebuffer=void 0),g&&v&&x.execute(n,t),r.updatePass(Y.CESIUM_3D_TILE),O=b.commands[Y.CESIUM_3D_TILE],M=b.indices[Y.CESIUM_3D_TILE],_=0;_<M;++_)Le(O[_],e,n,t);for(r.updatePass(Y.OPAQUE),O=b.commands[Y.OPAQUE],M=b.indices[Y.OPAQUE],_=0;_<M;++_)Le(O[_],e,n,t);for(r.updatePass(Y.TRANSLUCENT),O=b.commands[Y.TRANSLUCENT],M=b.indices[Y.TRANSLUCENT],_=0;_<M;++_)Le(O[_],e,n,t);t.framebuffer=V}}}function Ge(e){e.context.uniformState.updatePass(Y.COMPUTE);var t=e._environmentState.sunComputeCommand;p(t)&&t.execute(e._computeEngine);for(var i=e._computeCommandList,n=i.length,r=0;r<n;++r)i[r].execute(e._computeEngine)}function We(e,t){e.context.uniformState.updatePass(Y.OVERLAY);for(var i=e.context,n=e._overlayCommandList,r=n.length,o=0;o<r;++o)n[o].execute(i,t)}function Ye(e,t,i){for(var n=i.shadowMapCullingVolume,r=i.isPointLight,o=i.passes,a=o.length,s=t.length,u=0;u<s;++u){var l=t[u];if(e.updateDerivedCommands(l),l.castShadows&&(l.pass===Y.GLOBE||l.pass===Y.CESIUM_3D_TILE||l.pass===Y.OPAQUE||l.pass===Y.TRANSLUCENT)&&e.isVisible(l,n))if(r)for(var c=0;c<a;++c)o[c].commandList.push(l);else if(1===a)o[0].commandList.push(l);else for(var d=!1,h=a-1;h>=0;--h){var p=o[h].cullingVolume;if(e.isVisible(l,p))o[h].commandList.push(l),d=!0;else if(d)break}}}function je(e){var t=e.frameState,i=t.shadowState.shadowMaps,n=i.length;if(t.shadowState.shadowsEnabled)for(var r=e.context,o=r.uniformState,a=0;a<n;++a){var s=i[a];if(!s.outOfView){var u,l=s.passes,c=l.length;for(u=0;u<c;++u)l[u].commandList.length=0;var d=e.frameState.commandList;for(Ye(e,d,s),u=0;u<c;++u){var h=s.passes[u];o.updateCamera(h.camera),s.updatePass(r,u);for(var p=h.commandList.length,m=0;m<p;++m){var f=h.commandList[m];o.updatePass(f.pass),Ne(f.derivedCommands.shadows.castCommands[a],e,r,h.passState)}}}}}function Xe(e,t,i){var n=e._frameState,r=n.mode;e._environmentState.useWebVR?Qe(e,t,i):r!==_e.SCENE2D||e._mapMode2D===le.ROTATE?Ze(!0,e,t,i):(tt(e,t,i),qe(e,t))}function Qe(e,t,i){var n=e._view,r=n.camera,a=e._environmentState,s=a.renderTranslucentDepthForPick;tt(e,t,i),s||et(e),n.createPotentiallyVisibleSet(e),s||(Ge(e),je(e));var u=t.viewport;u.x=0,u.y=0,u.width=.5*u.width;var l=K.clone(r,e._cameraVR);l.frustum=r.frustum;var c=r.frustum.near,d=c*h(e.focalLength,5),p=h(e.eyeSeparation,d/30),m=o.multiplyByScalar(l.right,.5*p,bt);r.frustum.aspectRatio=u.width/u.height;var f=.5*p*c/d;o.add(l.position,m,r.position),r.frustum.xOffset=f,ke(e,t),u.x=u.width,o.subtract(l.position,m,r.position),r.frustum.xOffset=-f,ke(e,t),K.clone(l,r)}function qe(e,i){var n=e.context,r=e.frameState,a=e.camera,s=i.viewport,u=t.clone(s,Rt);i.viewport=u;var l=Dt,c=It;e.mapProjection.project(l,c);var d=o.clone(a.position,Ot),h=P.clone(a.transform,Ft),p=a.frustum.clone();a._setTransform(P.IDENTITY);var m=P.computeViewportTransformation(u,0,1,Mt),f=a.frustum.projectionMatrix,_=a.positionWC.y,g=o.fromElements(A.sign(_)*c.x-_,0,-a.positionWC.x,Nt),v=U.pointToGLWindowCoordinates(f,m,g,Lt);v.x=Math.floor(v.x);var y=u.x,w=u.width;if(0===_||v.x<=y||v.x>=y+w)Ze(!0,e,i);else if(Math.abs(y+.5*w-v.x)<1)u.width=v.x-u.x,a.position.x*=A.sign(a.position.x),a.frustum.right=0,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!0,e,i),u.x=v.x,a.position.x=-a.position.x,a.frustum.right=-a.frustum.left,a.frustum.left=0,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!1,e,i);else if(v.x>y+.5*w){u.width=v.x-y;var x=a.frustum.right;a.frustum.right=c.x-_,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!0,e,i),u.x=v.x,u.width=y+w-v.x,a.position.x=-a.position.x,a.frustum.left=-a.frustum.right,a.frustum.right=x-2*a.frustum.right,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!1,e,i)}else{u.x=v.x,u.width=y+w-v.x;var C=a.frustum.left;a.frustum.left=-c.x-_,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!0,e,i),u.x=y,u.width=v.x-y,a.position.x=-a.position.x,a.frustum.right=-a.frustum.left,a.frustum.left=C-2*a.frustum.left,r.cullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),n.uniformState.update(r),Ze(!1,e,i)}a._setTransform(h),o.clone(d,a.position),a.frustum=p.clone(),i.viewport=s}function Ze(e,t,i,n){var r=t._environmentState,o=t._view,a=r.renderTranslucentDepthForPick;e||a||(t.frameState.commandList.length=0),a||et(t),o.createPotentiallyVisibleSet(t),e&&(p(n)&&tt(t,i,n),a||(Ge(t),je(t))),ke(t,i)}function Ke(e){var t=e._frameState,i=e._view,n=e._environmentState,r=t.passes.render,o=t.passes.offscreen,a=e.skyAtmosphere,s=e.globe;if(!r||e._mode!==_e.SCENE2D&&i.camera.frustum instanceof D)n.skyAtmosphereCommand=void 0,n.skyBoxCommand=void 0,n.sunDrawCommand=void 0,n.sunComputeCommand=void 0,n.moonCommand=void 0;else{p(a)&&p(s)&&(a.setDynamicAtmosphereColor(s.enableLighting),n.isReadyForAtmosphere=n.isReadyForAtmosphere||s._surface._tilesToRender.length>0),n.skyAtmosphereCommand=p(a)?a.update(t):void 0,n.skyBoxCommand=p(e.skyBox)?e.skyBox.update(t):void 0;var u=p(e.sun)?e.sun.update(t,i.passState):void 0;n.sunDrawCommand=p(u)?u.drawCommand:void 0,n.sunComputeCommand=p(u)?u.computeCommand:void 0,n.moonCommand=p(e.moon)?e.moon.update(t):void 0}var l=n.clearGlobeDepth=p(s)&&(!s.depthTestAgainstTerrain||e.mode===_e.SCENE2D);(n.useDepthPlane=l&&e.mode===_e.SCENE3D)&&e._depthPlane.update(t),n.renderTranslucentDepthForPick=!1,n.useWebVR=e._useWebVR&&e.mode!==_e.SCENE2D&&!o;for(var c=t.mode===_e.SCENE3D?t.occluder:void 0,d=t.cullingVolume,h=Ct.planes,m=0;m<5;++m)h[m]=d.planes[m];d=Ct,n.isSkyAtmosphereVisible=p(n.skyAtmosphereCommand)&&n.isReadyForAtmosphere,n.isSunVisible=e.isVisible(n.sunDrawCommand,d,c),n.isMoonVisible=e.isVisible(n.moonCommand,d,c)}function Je(e){var t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new ee({camera:e.camera,updateOnChange:!1}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),p(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}function $e(e){var t=e._frameState,i=t.shadowMaps,n=i.length,r=n>0&&!t.passes.pick&&e.mode===_e.SCENE3D;if(r!==t.shadowState.shadowsEnabled&&(++t.shadowState.lastDirtyTime,t.shadowState.shadowsEnabled=r),t.shadowState.lightShadowsEnabled=!1,r){for(var o=0;o<n;++o)if(i[o]!==t.shadowState.shadowMaps[o]){++t.shadowState.lastDirtyTime;break}t.shadowState.shadowMaps.length=0,t.shadowState.lightShadowMaps.length=0;for(var a=0;a<n;++a){var s=i[a];s.update(t),t.shadowState.shadowMaps.push(s),s.fromLightSource&&(t.shadowState.lightShadowMaps.push(s),t.shadowState.lightShadowsEnabled=!0),s.dirty&&(++t.shadowState.lastDirtyTime,s.dirty=!1)}}}function et(e){var t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),Je(e),$e(e),e._globe&&e._globe.render(t)}function tt(e,t,i){var n=e._context,r=e._frameState,o=e._environmentState,a=e._view,s=e._frameState.passes,l=s.pick,c=o.useWebVR;o.originalFramebuffer=t.framebuffer,p(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!c?e._sunPostProcess=new xe:p(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!p(e.sun)&&p(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);var d=e._clearColorCommand;u.clone(i,d.color),d.execute(n,t);var h=o.useGlobeDepthFramebuffer=p(a.globeDepth);h&&(a.globeDepth.update(n,t,a.viewport),a.globeDepth.clear(n,t,i));var m=a.oit,f=o.useOIT=!l&&p(m)&&m.isSupported();f&&(m.update(n,t,a.globeDepth.framebuffer),m.clear(n,t,i),o.useOIT=m.isSupported());var _=e.postProcessStages,g=o.usePostProcess=!l&&(_.length>0||_.ambientOcclusion.enabled||_.fxaa.enabled||_.bloom.enabled);if(o.usePostProcessSelected=!1,g&&(a.sceneFramebuffer.update(n,a.viewport),a.sceneFramebuffer.clear(n,t,i),_.update(n,r.useLogDepth),_.clear(n),g=o.usePostProcess=_.ready,o.usePostProcessSelected=g&&_.hasSelected),o.isSunVisible&&e.sunBloom&&!c?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(n,t,i)):h?t.framebuffer=a.globeDepth.framebuffer:g&&(t.framebuffer=a.sceneFramebuffer.getFramebuffer()),p(t.framebuffer)&&d.execute(n,t),o.useInvertClassification=!l&&p(t.framebuffer)&&e.invertClassification){var v;if(1===e.frameState.invertClassificationColor.alpha&&o.useGlobeDepthFramebuffer&&(v=a.globeDepth.framebuffer),p(v)||n.depthTexture){if(e._invertClassification.previousFramebuffer=v,e._invertClassification.update(n),e._invertClassification.clear(n,t),e.frameState.invertClassificationColor.alpha<1&&f){var y=e._invertClassification.unclassifiedCommand,w=y.derivedCommands;w.oit=m.createDerivedCommands(y,n,w.oit)}}else o.useInvertClassification=!1}}function it(e,t){var i=e._context,n=e._frameState,r=e._environmentState,o=e._view,a=r.useOIT,s=r.useGlobeDepthFramebuffer,u=r.usePostProcess,l=r.originalFramebuffer,c=s?o.globeDepth.framebuffer:void 0,d=o.sceneFramebuffer.getFramebuffer(),p=o.sceneFramebuffer.getIdFramebuffer();if(a&&(t.framebuffer=u?d:l,o.oit.execute(i,t)),u){var m=d;s&&!a&&(m=c);var f=e.postProcessStages,_=m.getColorTexture(0),g=p.getColorTexture(0),v=h(c,d).depthStencilTexture;f.execute(i,_,v,g),f.copy(i,l)}a||u||!s||(t.framebuffer=l,o.globeDepth.executeCopyColor(i,t));var y=n.useLogDepth;if(e.debugShowGlobeDepth&&s){Be(e,e.debugShowDepthFrustum-1).executeDebugGlobeDepth(i,t,y)}if(e.debugShowPickDepth&&s){He(e,e.debugShowDepthFrustum-1).executeDebugPickDepth(i,t,y)}}function nt(e){for(var t=e._frameState.afterRender,i=0,n=t.length;i<n;++i)t[i](),e.requestRender();t.length=0}function rt(e,t){if(e.debugShowFramesPerSecond){if(!p(e._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer";e._canvas.parentNode.appendChild(i);var n=new ce({container:i});e._performanceDisplay=n,e._performanceContainer=i}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else p(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}function ot(e){var t=e._frameState;p(e.globe)&&e.globe.update(t),t.creditDisplay.update()}function at(e,i){e._pickPositionCacheDirty=!0;var n=e.context,r=n.uniformState,a=e._frameState,s=e._defaultView;e._view=s,De(e,A.incrementWrap(a.frameNumber,15e6,1),i),a.passes.render=!0,a.passes.postProcess=e.postProcessStages.hasSelected;var l=h(e.backgroundColor,u.BLACK);a.backgroundColor=l,a.creditDisplay.beginFrame(),e.fog.update(a),r.update(a);var c=e.shadowMap;p(c)&&c.enabled&&(o.negate(r.sunDirectionWC,e._sunCamera.direction),a.shadowMaps.push(c)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var d=s.viewport;d.x=0,d.y=0,d.width=n.drawingBufferWidth,d.height=n.drawingBufferHeight;var m=s.passState;m.framebuffer=void 0,m.blendingEnabled=void 0,m.scissorTest=void 0,m.viewport=t.clone(d,m.viewport),p(e.globe)&&e.globe.beginFrame(a),Ke(e),Xe(e,m,l),it(e,m),m.framebuffer=void 0,We(e,m),p(e.globe)&&(e.globe.endFrame(a),e.globe.tilesLoaded||(e._renderRequested=!0)),a.creditDisplay.endFrame(),n.endFrame()}function st(e,t,i){try{i(e,t)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}function ut(e,t,i,n,r){var a=e.camera,s=a.frustum;p(s._offCenterFrustum)&&(s=s._offCenterFrustum);var u=2*(t.x-r.x)/r.width-1;u*=.5*(s.right-s.left);var l=2*(r.height-t.y-r.y)/r.height-1;l*=.5*(s.top-s.bottom);var c=P.clone(a.transform,Ht);a._setTransform(P.IDENTITY);var d=o.clone(a.position,Ut);o.multiplyByScalar(a.right,u,zt),o.add(zt,d,d),o.multiplyByScalar(a.up,l,zt),o.add(zt,d,d),a._setTransform(c),e.mode===_e.SCENE2D&&o.fromElements(d.z,d.x,d.y,d);var h=s.getPixelDimensions(r.width,r.height,1,Bt),m=Vt;return m.right=.5*h.x,m.left=-m.right,m.top=.5*h.y,m.bottom=-m.top,m.near=s.near,m.far=s.far,m.computeCullingVolume(d,a.directionWC,a.upWC)}function lt(e,t,i,n,r){var o=e.camera,a=o.frustum,s=a.near,u=Math.tan(.5*a.fovy),l=a.aspectRatio*u,c=2*(t.x-r.x)/r.width-1,d=2*(r.height-t.y-r.y)/r.height-1,h=c*s*l,p=d*s*u,m=a.getPixelDimensions(r.width,r.height,1,Bt),f=m.x*i*.5,_=m.y*n*.5,g=kt;return g.top=p+_,g.bottom=p-_,g.right=h+f,g.left=h-f,g.near=s,g.far=a.far,g.computeCullingVolume(o.positionWC,o.directionWC,o.upWC)}function ct(e,t,i,n,r){var o=e.camera.frustum;return o instanceof D||o instanceof I?ut(e,t,i,n,r):lt(e,t,i,n,r)}function dt(e,i){var n=e._context,r=e._frameState,o=e._environmentState,a=e._defaultView;e._view=a;var s=a.viewport;s.x=0,s.y=0,s.width=n.drawingBufferWidth,s.height=n.drawingBufferHeight;var u=a.passState;u.viewport=t.clone(s,u.viewport),be(r.passes),r.passes.pick=!0,r.passes.depth=!0,r.cullingVolume=ct(e,i,1,1,s),Ke(e),o.renderTranslucentDepthForPick=!0,u=a.pickDepthFramebuffer.update(n,i,s),Xe(e,u,jt),it(e,u),n.endFrame()}function ht(e,t){return!(!p(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function pt(e,t,i){var n,r,o=[],a=[],s=[],u=[];p(e)||(e=Number.MAX_VALUE);for(var l=t();p(l);){var c=l.object,d=l.position;if(p(d)&&!p(c)){o.push(l);break}if(!p(c)||!p(c.primitive))break;if(!ht(c,i)&&(o.push(l),0>=--e))break;var h=c.primitive,m=!1;"function"==typeof h.getGeometryInstanceAttributes&&p(c.id)&&(r=h.getGeometryInstanceAttributes(c.id),p(r)&&p(r.show)&&(m=!0,r.show=R.toValue(!1,r.show),s.push(r))),c instanceof J&&(m=!0,c.show=!1,u.push(c)),m||(h.show=!1,a.push(h)),l=t()}for(n=0;n<a.length;++n)a[n].show=!0;for(n=0;n<s.length;++n)r=s[n],r.show=R.toValue(!0,r.show);for(n=0;n<u.length;++n)u[n].show=!0;return o}function mt(e,t){var i=e.direction,n=o.mostOrthogonalAxis(i,qt),r=o.cross(i,n,qt),a=o.cross(i,r,Zt);t.position=e.origin,t.direction=i,t.up=a,t.right=r}function ft(e,i){var n=e._context,r=n.uniformState,o=e._frameState,a=e._pickOffscreenView;e._view=a,mt(i,a.camera),Yt=t.clone(a.viewport,Yt);var s=a.pickFramebuffer.begin(Yt,a.viewport);e._jobScheduler.disableThisFrame(),De(e,o.frameNumber,o.time),o.invertClassification=!1,o.passes.pick=!0,o.passes.offscreen=!0,r.update(o),Ke(e,a),Xe(e,s,jt),it(e,s);var u,l=a.pickFramebuffer.end(n);if(e._context.depthTexture)for(var c=a.frustumCommandsList.length,d=0;d<c;++d){var h=He(e,d),m=h.getDepth(n,0,0);if(m>0&&m<1){var f=a.frustumCommandsList[d],_=f.near*(0!==d?e.opaqueFrustumNearOffset:1),g=f.far,v=_+m*(g-_);u=N.getPoint(i,v);break}}if(e._view=e._defaultView,n.endFrame(),nt(e),p(l)||p(u))return{object:l,position:u}}function _t(e,t,i,n){return pt(i,function(){return ft(e,t)},n)}function gt(t,i){var n=t.globe,r=p(n)?n.ellipsoid:t.mapProjection.ellipsoid,s=e._defaultMaxTerrainHeight,u=r.geodeticSurfaceNormalCartographic(i,Jt),l=a.toCartesian(i,r,Kt),c=$t;c.origin=l,c.direction=u;var d=new N;return N.getPoint(c,s,d.origin),o.negate(u,d.direction),d}function vt(e,t){var i=e.globe,n=p(i)?i.ellipsoid:e.mapProjection.ellipsoid;return gt(e,a.fromCartesian(t,n,ei))}var yt=function(e){return function(){e.frameState.afterRender.push(function(){e.requestRender()})}};m(Ee.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return k.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return k.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,Ae(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(p(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(p(this.globe))return this.globe.terrainProvider},set:function(e){p(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(p(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===_e.SCENE2D?this.morphTo2D(0):e===_e.SCENE3D?this.morphTo3D(0):e===_e.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new K(this),p(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new ne(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0,this._defaultView.updateFrustums=!0)}},opaqueFrustumNearOffset:{get:function(){return this._frameState.useLogDepth?.9:.9999}}}),Ee.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1},Ee.prototype.updateDerivedCommands=function(e){if(p(e.derivedCommands)){var t=this._frameState,i=this._context,n=!1,r=t.shadowState.lastDirtyTime;e.lastDirtyTime!==r&&(e.lastDirtyTime=r,e.dirty=!0,n=!0);var o=t.useLogDepth,a=e.derivedCommands,s=p(a.logDepth),u=p(a.originalCommand),l=o&&!s,c=!o&&!u;if(e.dirty=e.dirty||l||c,e.dirty){e.dirty=!1;var d=t.shadowState.shadowMaps;t.shadowState.shadowsEnabled&&e.castShadows&&(a.shadows=we.createCastDerivedCommand(d,e,n,i,a.shadows)),(s||l)&&(a.logDepth=ie.createLogDepthCommand(e,i,a.logDepth),Pe(this,a.logDepth.command,n)),(u||c)&&Pe(this,e,n)}}};var wt,xt=new i,Ct=new d;Ee.prototype.isVisible=function(e,t,i){return p(e)&&(!p(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==T.OUTSIDE&&(!p(i)||!e.boundingVolume.isOccluded(i)))};var Tt=new P(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);Tt=P.inverseTransformation(Tt,Tt);var Et=new O,At=new M,Pt=new D,St=new I,bt=new o,Dt=new a(Math.PI,A.PI_OVER_TWO),It=new o,Ot=new o,Mt=new P,Ft=new P,Nt=new o,Lt=new o,Rt=new t;Ee.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms()),this._tweens.update(),this._screenSpaceCameraController.update(),p(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()},Ee.prototype.render=function(e){p(e)||(e=E.now()),this._jobScheduler.resetBudgets(),this._preUpdate.raiseEvent(this,e),st(this,e,ot),this._postUpdate.raiseEvent(this,e);var t=this._view.checkForCameraUpdates(this),i=!this.requestRenderMode||this._renderRequested||t||this._logDepthBufferDirty||this.mode===_e.MORPHING;if(!i&&p(this.maximumRenderTimeChange)&&p(this._lastRenderTime)){var n=Math.abs(E.secondsDifference(this._lastRenderTime,e));i=i||n>this.maximumRenderTimeChange}i&&(this._lastRenderTime=E.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._preRender.raiseEvent(this,e),st(this,e,at),L.update()),rt(this,i),nt(this),i&&this._postRender.raiseEvent(this,e)},Ee.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},Ee.prototype.requestRender=function(){this._renderRequested=!0},Ee.prototype.clampLineWidth=function(e){return Math.max(k.minimumAliasedLineWidth,Math.min(e,k.maximumAliasedLineWidth))};var Vt=new I,Ut=new o,zt=new o,Bt=new r,Ht=new P,kt=new M,Gt=3,Wt=3,Yt=new t(0,0,Gt,Wt),jt=new u(0,0,0,0),Xt=new r;Ee.prototype.pick=function(e,i,n){Gt=h(i,3),Wt=h(n,Gt);var r=this._context,o=r.uniformState,a=this._frameState,s=this._defaultView;this._view=s;var u=s.viewport;u.x=0,u.y=0,u.width=r.drawingBufferWidth,u.height=r.drawingBufferHeight;var l=s.passState;l.viewport=t.clone(u,l.viewport);var c=ge.transformWindowToDrawingBuffer(this,e,Xt);this._jobScheduler.disableThisFrame(),De(this,a.frameNumber,a.time),a.cullingVolume=ct(this,c,Gt,Wt,u),a.invertClassification=!1,a.passes.pick=!0,o.update(a),Ke(this),Yt.x=c.x-.5*(Gt-1),Yt.y=this.drawingBufferHeight-c.y-.5*(Wt-1),Yt.width=Gt,Yt.height=Wt,l=s.pickFramebuffer.begin(Yt,s.viewport),Xe(this,l,jt),it(this,l);var d=s.pickFramebuffer.end(Yt);return r.endFrame(),nt(this),d},Ee.prototype.pickPositionWorldCoordinates=function(e,t){if(this.useDepthPicking){var i=e.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(i))return o.clone(this._pickPositionCache[i],t);var n=this._context,r=n.uniformState,a=this._defaultView;this._view=a;var s=ge.transformWindowToDrawingBuffer(this,e,Xt);this.pickTranslucentDepth?dt(this,s):Ke(this),s.y=this.drawingBufferHeight-s.y;var u,l=this.camera;u=p(l.frustum.fov)?l.frustum.clone(Et):p(l.frustum.infiniteProjectionMatrix)?l.frustum.clone(At):p(l.frustum.width)?l.frustum.clone(Pt):l.frustum.clone(St);for(var c=a.frustumCommandsList,d=c.length,h=0;h<d;++h){var m=He(this,h),f=m.getDepth(n,s.x,s.y);if(f>0&&f<1){var _,g=c[h];return this.mode===_e.SCENE2D?(_=l.position.z,l.position.z=_-g.near+1,u.far=Math.max(1,g.far-g.near),u.near=1,r.update(this.frameState),r.updateFrustum(u)):(u.near=g.near*(0!==h?this.opaqueFrustumNearOffset:1),u.far=g.far,r.updateFrustum(u)),t=ge.drawingBufferToWgs84Coordinates(this,s,f,t),this.mode===_e.SCENE2D&&(l.position.z=_,r.update(this.frameState)),this._pickPositionCache[i]=o.clone(t),t}}this._pickPositionCache[i]=void 0}};var Qt=new a;Ee.prototype.pickPosition=function(e,t){if(t=this.pickPositionWorldCoordinates(e,t),p(t)&&this.mode!==_e.SCENE3D){o.fromElements(t.y,t.z,t.x,t);var i=this.mapProjection,n=i.ellipsoid,r=i.unproject(t,Qt);n.cartographicToCartesian(r,t)}return t},Ee.prototype.drillPick=function(e,t,i,n){var r=this;return pt(t,function(){var t=r.pick(e,i,n);if(p(t))return{object:t}}).map(function(e){return e.object})};var qt=new o,Zt=new o;Ee.prototype.pickFromRay=function(e,t){var i=_t(this,e,1,t);if(i.length>0)return i[0]},Ee.prototype.drillPickFromRay=function(e,t,i){return _t(this,e,t,i)};var Kt=new o,Jt=new o,$t=new N,ei=new a;return Ee.prototype.sampleHeight=function(e,t){var i=gt(this,e),n=this.pickFromRay(i,t);if(p(n)){var r=n.position,o=this.globe,s=p(o)?o.ellipsoid:this.mapProjection.ellipsoid;return a.fromCartesian(r,s,ei).height}},Ee.prototype.clampToHeight=function(e,t,i){var n=vt(this,e),r=this.pickFromRay(n,t);if(p(r))return o.clone(r.position,i)},Ee.prototype.cartesianToCanvasCoordinates=function(e,t){return ge.wgs84ToWindowCoordinates(this,e,t)},Ee.prototype.completeMorph=function(){this._transitioner.completeMorph()},Ee.prototype.morphTo2D=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphTo2D(e,t)},Ee.prototype.morphToColumbusView=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphToColumbusView(e,t)},Ee.prototype.morphTo3D=function(e){var t,i=this.globe;t=p(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=h(e,2),this._transitioner.morphTo3D(e,t)},Ee.prototype.isDestroyed=function(){return!1},Ee.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),p(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(var e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,_(this)},Ee}.apply(t,n))&&(e.exports=r)},2146:function(e,t,i){var n,r;n=[i(0),i(3)],void 0!==(r=function(e,t){"use strict";function i(e,t,i,n,r,s){var u,l,c=r-n+1,d=s-r,h=o,p=a;for(u=0;u<c;++u)h[u]=e[n+u];for(l=0;l<d;++l)p[l]=e[r+l+1];u=0,l=0;for(var m=n;m<=s;++m){var f=h[u],_=p[l];u<c&&(l>=d||t(f,_,i)<=0)?(e[m]=f,++u):l<d&&(e[m]=_,++l)}}function n(e,t,r,o,a){if(!(o>=a)){var s=Math.floor(.5*(o+a));n(e,t,r,o,s),n(e,t,r,s+1,a),i(e,t,r,o,s,a)}}function r(e,t,i){var r=e.length,s=Math.ceil(.5*r);o.length=s,a.length=s,n(e,t,i,0,r-1),o.length=0,a.length=0}var o=[],a=[];return r}.apply(t,n))&&(e.exports=r)},2147:function(e,t,i){var n,r;n=[i(38),i(10),i(1),i(0),i(2),i(3),i(23),i(9),i(16),i(1953)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l){"use strict";function c(e,i){this._occluderPosition=t.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=i}var d=new t;r(c.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){e=t.clone(e,this._cameraPosition);var i,n,r,o=t.subtract(this._occluderPosition,e,d),a=t.magnitudeSquared(o),s=this._occluderRadius*this._occluderRadius;if(a>s){i=Math.sqrt(a-s),a=1/Math.sqrt(a),n=t.multiplyByScalar(o,a,d);var u=i*i*a;r=t.add(e,t.multiplyByScalar(n,u,d),d)}else i=Number.MAX_VALUE;this._horizonDistance=i,this._horizonPlaneNormal=n,this._horizonPlanePosition=r,this._cameraPosition=e}}}),c.fromBoundingSphere=function(e,i,r){return n(r)?(t.clone(e.center,r._occluderPosition),r._occluderRadius=e.radius,r.cameraPosition=i,r):new c(e,i)};var h=new t;c.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var i=t.subtract(e,this._occluderPosition,h),n=this._occluderRadius;if((n=t.magnitudeSquared(i)-n*n)>0)return n=Math.sqrt(n)+this._horizonDistance,i=t.subtract(e,this._cameraPosition,i),n*n>t.magnitudeSquared(i)}return!1};var p=new t;c.prototype.isBoundingSphereVisible=function(e){var i=t.clone(e.center,p),n=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var r=t.subtract(i,this._occluderPosition,h),o=this._occluderRadius-n;if(o=t.magnitudeSquared(r)-o*o,n<this._occluderRadius)return o>0&&(o=Math.sqrt(o)+this._horizonDistance,r=t.subtract(i,this._cameraPosition,r),o*o+n*n>t.magnitudeSquared(r));if(o>0){r=t.subtract(i,this._cameraPosition,r);var a=t.magnitudeSquared(r),s=this._occluderRadius*this._occluderRadius,u=n*n;return(this._horizonDistance*this._horizonDistance+s)*u>a*s||(o=Math.sqrt(o)+this._horizonDistance)*o+u>a}return!0}return!1};var m=new t;c.prototype.computeVisibility=function(e){var i=t.clone(e.center),n=e.radius;if(n>this._occluderRadius)return l.FULL;if(this._horizonDistance!==Number.MAX_VALUE){var r=t.subtract(i,this._occluderPosition,m),o=this._occluderRadius-n,a=t.magnitudeSquared(r);if((o=a-o*o)>0){o=Math.sqrt(o)+this._horizonDistance,r=t.subtract(i,this._cameraPosition,r);var s=t.magnitudeSquared(r);return o*o+n*n<s?l.NONE:(o=this._occluderRadius+n,(o=a-o*o)>0?(o=Math.sqrt(o)+this._horizonDistance,s<o*o+n*n?l.FULL:l.PARTIAL):(r=t.subtract(i,this._horizonPlanePosition,r),t.dot(r,this._horizonPlaneNormal)>-n?l.PARTIAL:l.FULL))}}return l.NONE};var f=new t;c.computeOccludeePoint=function(e,i,n){var r=t.clone(i),o=t.clone(e.center),a=e.radius,s=n.length,u=t.normalize(t.subtract(r,o,f),f),l=-t.dot(u,o),d=c._anyRotationVector(o,u,l),h=c._horizonToPlaneNormalDotProduct(e,u,l,d,n[0]);if(h){for(var p,m=1;m<s;++m){if(!(p=c._horizonToPlaneNormalDotProduct(e,u,l,d,n[m])))return;p<h&&(h=p)}if(!(h<.0017453283658983088)){var _=a/h;return t.add(o,t.multiplyByScalar(u,_,f),f)}}};var _=[];c.computeOccludeePointFromRectangle=function(n,r){r=i(r,a.WGS84);var o=u.subsample(n,r,0,_),s=e.fromPoints(o),l=t.ZERO;if(!t.equals(l,s.center))return c.computeOccludeePoint(new e(l,r.minimumRadius),s.center,o)};var g=new t;c._anyRotationVector=function(e,i,n){var r=t.abs(i,g),o=r.x>r.y?0:1;(0===o&&r.z>r.x||1===o&&r.z>r.y)&&(o=2);var a,s=new t;0===o?(r.x=e.x,r.y=e.y+1,r.z=e.z+1,a=t.UNIT_X):1===o?(r.x=e.x+1,r.y=e.y,r.z=e.z+1,a=t.UNIT_Y):(r.x=e.x+1,r.y=e.y+1,r.z=e.z,a=t.UNIT_Z);var u=(t.dot(i,r)+n)/-t.dot(i,a);return t.normalize(t.subtract(t.add(r,t.multiplyByScalar(a,u,s),r),e,r),r)};var v=new t;c._rotationVector=function(e,i,n,r,o){var a=t.subtract(r,e,v);if(a=t.normalize(a,a),t.dot(i,a)<.9999999847691291){var u=t.cross(i,a,a);if(t.magnitude(u)>s.EPSILON13)return t.normalize(u,new t)}return o};var y=new t,w=new t,x=new t,C=new t;return c._horizonToPlaneNormalDotProduct=function(e,i,n,r,o){var a=t.clone(o,y),s=t.clone(e.center,w),u=e.radius,l=t.subtract(s,a,x),c=t.magnitudeSquared(l),d=u*u;if(c<d)return!1;var h=c-d,p=Math.sqrt(h),m=Math.sqrt(c),f=1/m,_=p*f,g=_*p;l=t.normalize(l,l);var v=t.add(a,t.multiplyByScalar(l,g,C),C),T=Math.sqrt(h-g*g),E=this._rotationVector(s,i,n,a,r),A=t.fromElements(E.x*E.x*l.x+(E.x*E.y-E.z)*l.y+(E.x*E.z+E.y)*l.z,(E.x*E.y+E.z)*l.x+E.y*E.y*l.y+(E.y*E.z-E.x)*l.z,(E.x*E.z-E.y)*l.x+(E.y*E.z+E.x)*l.y+E.z*E.z*l.z,y);A=t.normalize(A,A);var P=t.multiplyByScalar(A,T,y);E=t.normalize(t.subtract(t.add(v,P,x),s,x),x);var S=t.dot(i,E);E=t.normalize(t.subtract(t.subtract(v,P,E),s,E),E);var b=t.dot(i,E);return S<b?S:b},c}.apply(t,n))&&(e.exports=r)},2148:function(e,t,i){var n,r;n=[i(99),i(12),i(25),i(0),i(21),i(3),i(54),i(1966),i(423),i(60),i(422),i(68),i(77)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h){"use strict";function p(e){this._context=e}function m(e,t){return new c({context:e,colorTextures:[t],destroyAttachments:!1})}function f(e,t){return h.fromCache({context:e,vertexShaderSource:s,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}function _(t,i){return n(g)&&g.viewport.width===t&&g.viewport.height===i||(g=d.fromCache({viewport:new e(0,0,t,i)})),g}var g,v=new l({primitiveType:a.TRIANGLES}),y=new u({color:new i(0,0,0,0)});return p.prototype.execute=function(e){n(e.preExecute)&&e.preExecute(e);var t=e.outputTexture,i=t.width,r=t.height,o=this._context,a=n(e.vertexArray)?e.vertexArray:o.getViewportQuadVertexArray(),s=n(e.shaderProgram)?e.shaderProgram:f(o,e.fragmentShaderSource),u=m(o,t),l=_(i,r),c=e.uniformMap,d=y;d.framebuffer=u,d.renderState=l,d.execute(o);var h=v;h.vertexArray=a,h.renderState=l,h.shaderProgram=s,h.uniformMap=c,h.framebuffer=u,h.execute(o),u.destroy(),e.persists||(s.destroy(),n(e.vertexArray)&&a.destroy()),n(e.postExecute)&&e.postExecute(t)},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){return r(this)},p}.apply(t,n))&&(e.exports=r)},2149:function(e,t,i){var n,r;n=[i(12),i(27),i(25),i(31),i(101),i(1),i(0),i(2),i(21),i(3),i(76),i(90),i(20),i(69),i(54),i(26),i(34),i(1966),i(64),i(423),i(61),i(749),i(60),i(1940),i(91),i(68),i(2150),i(77),i(100),i(2151),i(115)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I){"use strict";function O(e,t){var i="WebGL Error:  ";switch(t){case e.INVALID_ENUM:i+="INVALID_ENUM";break;case e.INVALID_VALUE:i+="INVALID_VALUE";break;case e.INVALID_OPERATION:i+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+="Unknown ("+t+")"}return i}function M(e,t,i,n){for(var r=O(e,n)+": "+t.name+"(",o=0;o<i.length;++o)0!==o&&(r+=", "),r+=i[o];return r+=");"}function F(e,t,i){var n=e.getError();if(n!==e.NO_ERROR)throw new f(M(e,t,i,n))}function N(e,t,i){return{get:function(){var n=e[t];return i(e,"get: "+t,n),e[t]},set:function(n){e[t]=n,i(e,"set: "+t,n)}}}function L(e,t){if(!a(t))return e;var i={};for(var n in e){var r=e[n];r instanceof Function?i[n]=function(i){return function(){var n=i.apply(e,arguments);return t(e,i,arguments),n}}(r):Object.defineProperty(i,n,N(e,n,t))}return i}function R(e,t){for(var i=t.length,n=0;n<i;++n){var r=e.getExtension(t[n]);if(r)return r}}function V(e,n){if("undefined"==typeof WebGLRenderingContext)throw new f("The browser does not support WebGL.  Visit http://get.webgl.org.");this._canvas=e,n=t(n,!0),n=o(n,{}),n.allowTextureFilterAnisotropic=o(n.allowTextureFilterAnisotropic,!0);var s=o(n.webgl,{});s.alpha=o(s.alpha,!1),s.stencil=o(s.stencil,!0);var u,l=o(n.requestWebgl2,!1)&&"undefined"!=typeof WebGL2RenderingContext,c=!1,d=n.getWebGLStub;if(a(d))u=d(e,s);else if(l&&(u=e.getContext("webgl2",s)||e.getContext("experimental-webgl2",s)||void 0,a(u)&&(c=!0)),a(u)||(u=e.getContext("webgl",s)||e.getContext("experimental-webgl",s)||void 0),!a(u))throw new f("The browser supports WebGL, but initialization failed.");this._originalGLContext=u,this._gl=u,this._webgl2=c,this._id=r(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new P(this);var h=u;this._stencilBits=h.getParameter(h.STENCIL_BITS),w._maximumCombinedTextureImageUnits=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS),w._maximumCubeMapSize=h.getParameter(h.MAX_CUBE_MAP_TEXTURE_SIZE),w._maximumFragmentUniformVectors=h.getParameter(h.MAX_FRAGMENT_UNIFORM_VECTORS),w._maximumTextureImageUnits=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS),w._maximumRenderbufferSize=h.getParameter(h.MAX_RENDERBUFFER_SIZE),w._maximumTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),w._maximumVaryingVectors=h.getParameter(h.MAX_VARYING_VECTORS),w._maximumVertexAttributes=h.getParameter(h.MAX_VERTEX_ATTRIBS),w._maximumVertexTextureImageUnits=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w._maximumVertexUniformVectors=h.getParameter(h.MAX_VERTEX_UNIFORM_VECTORS);var p=h.getParameter(h.ALIASED_LINE_WIDTH_RANGE);w._minimumAliasedLineWidth=p[0],w._maximumAliasedLineWidth=p[1];var m=h.getParameter(h.ALIASED_POINT_SIZE_RANGE);w._minimumAliasedPointSize=m[0],w._maximumAliasedPointSize=m[1];var g=h.getParameter(h.MAX_VIEWPORT_DIMS);w._maximumViewportWidth=g[0],w._maximumViewportHeight=g[1];var v=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT);w._highpFloatSupported=0!==v.precision;var y=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_INT);w._highpIntSupported=0!==y.rangeMax,this._antialias=h.getContextAttributes().antialias,this._standardDerivatives=!!R(h,["OES_standard_derivatives"]),this._blendMinmax=!!R(h,["EXT_blend_minmax"]),this._elementIndexUint=!!R(h,["OES_element_index_uint"]),this._depthTexture=!!R(h,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!R(h,["EXT_frag_depth"]),this._debugShaders=R(h,["WEBGL_debug_shaders"]),this._textureFloat=!!R(h,["OES_texture_float"]),this._textureHalfFloat=!!R(h,["OES_texture_half_float"]),this._textureFloatLinear=!!R(h,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!R(h,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!R(h,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._colorBufferHalfFloat=!!R(h,["EXT_color_buffer_half_float"]),this._s3tc=!!R(h,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!R(h,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._etc1=!!R(h,["WEBGL_compressed_texture_etc1"]);var x=n.allowTextureFilterAnisotropic?R(h,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;this._textureFilterAnisotropic=x,w._maximumTextureFilterAnisotropy=a(x)?h.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1;var C,E,S,b,I,O,M,F,N,L;if(c){var V=this;C=function(){return V._gl.createVertexArray()},E=function(e){V._gl.bindVertexArray(e)},S=function(e){V._gl.deleteVertexArray(e)},b=function(e,t,i,n,r){h.drawElementsInstanced(e,t,i,n,r)},I=function(e,t,i,n){h.drawArraysInstanced(e,t,i,n)},O=function(e,t){h.vertexAttribDivisor(e,t)},M=function(e){h.drawBuffers(e)}}else F=R(h,["OES_vertex_array_object"]),a(F)&&(C=function(){return F.createVertexArrayOES()},E=function(e){F.bindVertexArrayOES(e)},S=function(e){F.deleteVertexArrayOES(e)}),N=R(h,["ANGLE_instanced_arrays"]),a(N)&&(b=function(e,t,i,n,r){N.drawElementsInstancedANGLE(e,t,i,n,r)},I=function(e,t,i,n){N.drawArraysInstancedANGLE(e,t,i,n)},O=function(e,t){N.vertexAttribDivisorANGLE(e,t)}),L=R(h,["WEBGL_draw_buffers"]),a(L)&&(M=function(e){L.drawBuffersWEBGL(e)});this.glCreateVertexArray=C,this.glBindVertexArray=E,this.glDeleteVertexArray=S,this.glDrawElementsInstanced=b,this.glDrawArraysInstanced=I,this.glVertexAttribDivisor=O,this.glDrawBuffers=M,this._vertexArrayObject=!!F,this._instancedArrays=!!N,this._drawBuffers=!!L,w._maximumDrawBuffers=this.drawBuffers?h.getParameter(_.MAX_DRAW_BUFFERS):1,w._maximumColorAttachments=this.drawBuffers?h.getParameter(_.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new i(0,0,0,0),this._clearDepth=1,this._clearStencil=0;var U=new D,z=new T(this),B=A.fromCache();this._defaultPassState=z,this._defaultRenderState=B,this._defaultTexture=void 0,this._defaultCubeMap=void 0,this._us=U,this._currentRenderState=B,this._currentPassState=z,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(var H=0;H<w._maximumVertexAttributes;H++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=n,this.cache={},A.apply(h,B,z)}function U(e){}function z(e,t,i,n){var r=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=i,A.partialApply(e._gl,r,t,o,i,n)}function B(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var i=Y;if(a(t))t._bind(),U(e),i=t._getActiveColorAttachments();else{var n=e._gl;n.bindFramebuffer(n.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(i)}}function H(e,t,i,n,r){B(e,t),z(e,r,i,!1),n._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,n.maximumTextureUnitIndex)}function k(e,t,i,n){var r=t._primitiveType,s=t._vertexArray,u=t._offset,l=t._count,c=t.instanceCount;e._us.model=o(t._modelMatrix,h.IDENTITY),i._setUniforms(n,e._us,e.validateShaderProgram),s._bind();var d=s.indexBuffer;a(d)?(u*=d.bytesPerIndex,l=o(l,d.numberOfIndices),0===c?e._gl.drawElements(r,l,d.indexDatatype,u):e.glDrawElementsInstanced(r,l,d.indexDatatype,u,c)):(l=o(l,s.numberOfVertices),0===c?e._gl.drawArrays(r,u,l):e.glDrawArraysInstanced(r,u,l,c)),s._unBind()}function G(e,t,i){this._pickObjects=e,this.key=t,this.color=i}var W={};s(V.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=L(this._originalGLContext,e?F:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new b({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new x({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return W}}});var Y;"undefined"!=typeof WebGLRenderingContext&&(Y=[_.BACK]);var j=new y;V.prototype.clear=function(e,t){e=o(e,j),t=o(t,this._defaultPassState);var n=this._gl,r=0,s=e.color,u=e.depth,l=e.stencil;a(s)&&(i.equals(this._clearColor,s)||(i.clone(s,this._clearColor),n.clearColor(s.red,s.green,s.blue,s.alpha)),r|=n.COLOR_BUFFER_BIT),a(u)&&(u!==this._clearDepth&&(this._clearDepth=u,n.clearDepth(u)),r|=n.DEPTH_BUFFER_BIT),a(l)&&(l!==this._clearStencil&&(this._clearStencil=l,n.clearStencil(l)),r|=n.STENCIL_BUFFER_BIT),z(this,o(e.renderState,this._defaultRenderState),t,!0),B(this,o(e.framebuffer,t.framebuffer)),n.clear(r)},V.prototype.draw=function(e,t,i,n){t=o(t,this._defaultPassState);var r=o(e._framebuffer,t.framebuffer),a=o(e._renderState,this._defaultRenderState);i=o(i,e._shaderProgram),n=o(n,e._uniformMap),H(this,r,t,i,a),k(this,e,i,n)},V.prototype.endFrame=function(){var e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);var t=Y;this.drawBuffers&&this.glDrawBuffers(t);var i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var n=0;n<i;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},V.prototype.readPixels=function(e){var t=this._gl;e=o(e,o.EMPTY_OBJECT);var i=Math.max(o(e.x,0),0),n=Math.max(o(e.y,0),0),r=o(e.width,t.drawingBufferWidth),s=o(e.height,t.drawingBufferHeight),u=e.framebuffer,l=E.UNSIGNED_BYTE;a(u)&&u.numberOfColorAttachments>0&&(l=u.getColorTexture(0).pixelDatatype);var c=p.createTypedArray(p.RGBA,l,r,s);return B(this,u),t.readPixels(i,n,r,s,p.RGBA,l,c),c};var X={position:0,textureCoordinates:1};return V.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!a(e)){var t=new c({attributes:{position:new d({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new d({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:m.TRIANGLES});e=I.fromGeometry({context:this,geometry:t,attributeLocations:X,bufferUsage:v.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},V.prototype.createViewportQuadCommand=function(e,t){return t=o(t,o.EMPTY_OBJECT),new C({vertexArray:this.getViewportQuadVertexArray(),primitiveType:m.TRIANGLES,renderState:t.renderState,shaderProgram:S.fromCache({context:this,vertexShaderSource:g,fragmentShaderSource:e,attributeLocations:X}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},V.prototype.getObjectByPickColor=function(e){return this._pickObjects[e.toRgba()]},s(G.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),G.prototype.destroy=function(){delete this._pickObjects[this.key]},V.prototype.createPickId=function(e){++this._nextPickColor[0];var t=this._nextPickColor[0];if(0===t)throw new f("Out of unique Pick IDs.");return this._pickObjects[t]=e,new G(this._pickObjects,t,i.fromRgba(t))},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){var e=this.cache;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];a(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),u(this)},V}.apply(t,n))&&(e.exports=r)},2150:function(e,t,i){var n,r;n=[i(0),i(2),i(21),i(77),i(52)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function a(e,t){for(var i=t.derivedKeywords,n=i.length,r=0;r<n;++r){var o=i[r]+t.keyword;a(e,e._shaders[o])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}return t(o.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),o.prototype.replaceShaderProgram=function(t){return e(t.shaderProgram)&&t.shaderProgram.destroy(),this.getShaderProgram(t)},o.prototype.getShaderProgram=function(t){var i=t.vertexShaderSource,o=t.fragmentShaderSource,a=t.attributeLocations;"string"==typeof i&&(i=new r({sources:[i]})),"string"==typeof o&&(o=new r({sources:[o]}));var s,u=i.createCombinedVertexShader(this._context),l=o.createCombinedFragmentShader(this._context),c=u+l+JSON.stringify(a);if(e(this._shaders[c]))s=this._shaders[c],delete this._shadersToRelease[c];else{var d=this._context,h=new n({gl:d._gl,logShaderCompilation:d.logShaderCompilation,debugShaders:d.debugShaders,vertexShaderSource:i,vertexShaderText:u,fragmentShaderSource:o,fragmentShaderText:l,attributeLocations:a});s={cache:this,shaderProgram:h,keyword:c,derivedKeywords:[],count:0},h._cachedShader=s,this._shaders[c]=s,++this._numberOfShaders}return++s.count,s.shaderProgram},o.prototype.getDerivedShaderProgram=function(t,i){var n=t._cachedShader,r=i+n.keyword,o=this._shaders[r];if(e(o))return o.shaderProgram},o.prototype.createDerivedShaderProgram=function(e,t,i){var o=e._cachedShader,a=t+o.keyword,s=i.vertexShaderSource,u=i.fragmentShaderSource,l=i.attributeLocations;"string"==typeof s&&(s=new r({sources:[s]})),"string"==typeof u&&(u=new r({sources:[u]}));var c=this._context,d=s.createCombinedVertexShader(c),h=u.createCombinedFragmentShader(c),p=new n({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:s,vertexShaderText:d,fragmentShaderSource:u,fragmentShaderText:h,attributeLocations:l}),m={cache:this,shaderProgram:p,keyword:a,derivedKeywords:[],count:0};return o.derivedKeywords.push(t),p._cachedShader=m,this._shaders[a]=m,p},o.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];a(this,i),--this._numberOfShaders}this._shadersToRelease={}},o.prototype.releaseShaderProgram=function(t){if(e(t)){var i=t._cachedShader;i&&0==--i.count&&(this._shadersToRelease[i.keyword]=i)}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){var e=this._shaders;for(var t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return i(this)},o}.apply(t,n))&&(e.exports=r)},2151:function(e,t,i){var n,r;n=[i(99),i(17),i(10),i(41),i(24),i(25),i(1),i(0),i(2),i(135),i(9),i(40),i(20),i(289),i(1965),i(50),i(46),i(114)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(){this.globeDepthTexture=void 0,this._viewport=new e,this._viewportCartesian4=new n,this._viewportDirty=!1,this._viewportOrthographicMatrix=h.clone(h.IDENTITY),this._viewportTransformation=h.clone(h.IDENTITY),this._model=h.clone(h.IDENTITY),this._view=h.clone(h.IDENTITY),this._inverseView=h.clone(h.IDENTITY),this._projection=h.clone(h.IDENTITY),this._infiniteProjection=h.clone(h.IDENTITY),this._entireFrustum=new t,this._currentFrustum=new t,this._frustumPlanes=new n,this._log2FarDistance=void 0,this._log2FarPlusOne=void 0,this._log2NearDistance=void 0,this._frameState=void 0,this._temeToPseudoFixed=d.clone(h.IDENTITY),this._view3DDirty=!0,this._view3D=new h,this._inverseView3DDirty=!0,this._inverseView3D=new h,this._inverseModelDirty=!0,this._inverseModel=new h,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new d,this._viewRotation=new d,this._inverseViewRotation=new d,this._viewRotation3D=new d,this._inverseViewRotation3D=new d,this._inverseProjectionDirty=!0,this._inverseProjection=new h,this._modelViewDirty=!0,this._modelView=new h,this._modelView3DDirty=!0,this._modelView3D=new h,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new h,this._inverseModelViewDirty=!0,this._inverseModelView=new h,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new h,this._viewProjectionDirty=!0,this._viewProjection=new h,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new h,this._modelViewProjectionDirty=!0,this._modelViewProjection=new h,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new h,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new h,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new h,this._normalDirty=!0,this._normal=new d,this._normal3DDirty=!0,this._normal3D=new d,this._inverseNormalDirty=!0,this._inverseNormal=new d,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new d,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new l,this._cameraPosition=new i,this._sunPositionWC=new i,this._sunPositionColumbusView=new i,this._sunDirectionWC=new i,this._sunDirectionEC=new i,this._moonDirectionEC=new i,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._cameraDirection=new i,this._cameraRight=new i,this._cameraUp=new i,this._frustum2DWidth=0,this._eyeHeight2D=new t,this._resolutionScale=1,this._orthographicIn3D=!1,this._backgroundColor=new o,this._brdfLut=new g,this._environmentMap=new g,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._imagerySplitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}function y(e,t){h.clone(t,e._view),h.getRotation(t,e._viewRotation),e._view3DDirty=!0,e._inverseView3DDirty=!0,e._modelViewDirty=!0,e._modelView3DDirty=!0,e._modelViewRelativeToEyeDirty=!0,e._inverseModelViewDirty=!0,e._inverseModelView3DDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0,e._modelViewInfiniteProjectionDirty=!0,e._normalDirty=!0,e._inverseNormalDirty=!0,e._normal3DDirty=!0,e._inverseNormal3DDirty=!0}function w(e,t){h.clone(t,e._inverseView),h.getRotation(t,e._inverseViewRotation)}function x(e,t){h.clone(t,e._projection),e._inverseProjectionDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0}function C(e,t){h.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}function T(e,t){i.clone(t.positionWC,e._cameraPosition),i.clone(t.directionWC,e._cameraDirection),i.clone(t.rightWC,e._cameraRight),i.clone(t.upWC,e._cameraUp),e._encodedCameraPositionMCDirty=!0}function E(e,t){s(f.computeIcrfToFixedMatrix(t.time,j))||(j=f.computeTemeToPseudoFixedMatrix(t.time,j));var n=m.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);d.multiplyByVector(j,n,n),i.normalize(n,e._sunDirectionWC),n=d.multiplyByVector(e.viewRotation3D,n,e._sunDirectionEC),i.normalize(n,n),n=m.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),d.multiplyByVector(j,n,n),d.multiplyByVector(e.viewRotation3D,n,n),i.normalize(n,n);var r=t.mapProjection,o=r.ellipsoid,a=o.cartesianToCartographic(e._sunPositionWC,X);r.project(a,e._sunPositionColumbusView)}function A(e){if(e._viewportDirty){var t=e._viewport;h.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),h.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}function P(e){e._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===_.SCENE2D||e._mode===_.MORPHING||e._orthographicIn3D?h.clone(h.ZERO,e._inverseProjection):h.inverse(e._projection,e._inverseProjection))}function S(e){e._modelViewDirty&&(e._modelViewDirty=!1,h.multiplyTransformation(e._view,e._model,e._modelView))}function b(e){e._modelView3DDirty&&(e._modelView3DDirty=!1,h.multiplyTransformation(e.view3D,e._model,e._modelView3D))}function D(e){e._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,h.inverse(e.modelView,e._inverseModelView))}function I(e){e._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,h.inverse(e.modelView3D,e._inverseModelView3D))}function O(e){e._viewProjectionDirty&&(e._viewProjectionDirty=!1,h.multiply(e._projection,e._view,e._viewProjection))}function M(e){e._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,h.inverse(e.viewProjection,e._inverseViewProjection))}function F(e){e._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,h.multiply(e._projection,e.modelView,e._modelViewProjection))}function N(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;var t=e.modelView,i=e._modelViewRelativeToEye;i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=0,i[13]=0,i[14]=0,i[15]=t[15]}}function L(e){e._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,h.inverse(e.modelViewProjection,e._inverseModelViewProjection))}function R(e){e._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,h.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye))}function V(e){e._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,h.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection))}function U(e){if(e._normalDirty){e._normalDirty=!1;var t=e._normal;h.getRotation(e.inverseModelView,t),d.transpose(t,t)}}function z(e){if(e._normal3DDirty){e._normal3DDirty=!1;var t=e._normal3D;h.getRotation(e.inverseModelView3D,t),d.transpose(t,t)}}function B(e){e._inverseNormalDirty&&(e._inverseNormalDirty=!1,h.getRotation(e.inverseModelView,e._inverseNormal))}function H(e){e._inverseNormal3DDirty&&(e._inverseNormal3DDirty=!1,h.getRotation(e.inverseModelView3D,e._inverseNormal3D))}function k(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,h.multiplyByPoint(e.inverseModel,e._cameraPosition,Q),l.fromCartesian(Q,e._encodedCameraPositionMC))}function G(e,t,n,r,o,a,u,l){var d=q;d.x=e.y,d.y=e.z,d.z=e.x;var p=Z;p.x=n.y,p.y=n.z,p.z=n.x;var m=K;m.x=r.y,m.y=r.z,m.z=r.x;var g=J;g.x=t.y,g.y=t.z,g.z=t.x,a===_.SCENE2D&&(d.z=.5*o);var v=u.unproject(d,$);v.longitude=c.clamp(v.longitude,-Math.PI,Math.PI),v.latitude=c.clamp(v.latitude,-c.PI_OVER_TWO,c.PI_OVER_TWO);var y=u.ellipsoid,w=y.cartographicToCartesian(v,ee),x=f.eastNorthUpToFixedFrame(w,y,te);return h.multiplyByPointAsVector(x,p,p),h.multiplyByPointAsVector(x,m,m),h.multiplyByPointAsVector(x,g,g),s(l)||(l=new h),l[0]=p.x,l[1]=m.x,l[2]=-g.x,l[3]=0,l[4]=p.y,l[5]=m.y,l[6]=-g.y,l[7]=0,l[8]=p.z,l[9]=m.z,l[10]=-g.z,l[11]=0,l[12]=-i.dot(p,w),l[13]=-i.dot(m,w),l[14]=i.dot(g,w),l[15]=1,l}function W(e){e._view3DDirty&&(e._mode===_.SCENE3D?h.clone(e._view,e._view3D):G(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),h.getRotation(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function Y(e){e._inverseView3DDirty&&(h.inverseTransformation(e.view3D,e._inverseView3D),h.getRotation(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}u(v.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!e.equals(t,this._viewport)){e.clone(t,this._viewport);var i=this._viewport,n=this._viewportCartesian4;n.x=i.x,n.y=i.y,n.z=i.width,n.w=i.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return A(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return A(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){h.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,h.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,h.getRotation(this.inverseModel,e),d.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return W(this),this._view3D}},viewRotation:{get:function(){return W(this),this._viewRotation}},viewRotation3D:{get:function(){return W(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return Y(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return Y(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){return P(this),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){return S(this),this._modelView}},modelView3D:{get:function(){return b(this),this._modelView3D}},modelViewRelativeToEye:{get:function(){return N(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){return D(this),this._inverseModelView}},inverseModelView3D:{get:function(){return I(this),this._inverseModelView3D}},viewProjection:{get:function(){return O(this),this._viewProjection}},inverseViewProjection:{get:function(){return M(this),this._inverseViewProjection}},modelViewProjection:{get:function(){return F(this),this._modelViewProjection}},inverseModelViewProjection:{get:function(){return L(this),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){return R(this),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){return V(this),this._modelViewInfiniteProjection}},normal:{get:function(){return U(this),this._normal}},normal3D:{get:function(){return z(this),this._normal3D}},inverseNormal:{get:function(){return B(this),this._inverseNormal}},inverseNormal3D:{get:function(){return H(this),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},log2FarDistance:{get:function(){return this._log2FarDistance}},log2FarPlusOne:{get:function(){return this._log2FarPlusOne}},log2NearDistance:{get:function(){return this._log2NearDistance}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){return k(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return k(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}}});var j=new d,X=new r;v.prototype.updateCamera=function(e){y(this,e.viewMatrix),w(this,e.inverseViewMatrix),T(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==_.SCENE2D&&e.frustum instanceof p},v.prototype.updateFrustum=function(e){x(this,e.projectionMatrix),s(e.infiniteProjectionMatrix)&&C(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._log2FarDistance=2/c.log2(e.far+1),this._log2FarPlusOne=c.log2(e.far+1),this._log2NearDistance=c.log2(e.near),s(e._offCenterFrustum)&&(e=e._offCenterFrustum),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},v.prototype.updatePass=function(e){this._pass=e},v.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var i=e.camera;this.updateCamera(i),e.mode===_.SCENE2D?(this._frustum2DWidth=i.frustum.right-i.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),E(this,e);var n=e.brdfLutGenerator,r=s(n)?n.colorTexture:void 0;this._brdfLut=r,this._environmentMap=a(e.environmentMap,e.context.defaultCubeMap),this._fogDensity=e.fog.density,this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=f.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._imagerySplitPosition=e.imagerySplitPosition*e.context.drawingBufferWidth;var u,l=i.frustum.fov,c=this._viewport;u=c.height>c.width?2*Math.tan(.5*l)/c.height:2*Math.tan(.5*l)/c.width,this._geometricToleranceOverMeter=u*e.maximumScreenSpaceError,o.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};var Q=new i,q=new i,Z=new i,K=new i,J=new i,$=new r,ee=new i,te=new h;return v}.apply(t,n))&&(e.exports=r)},2152:function(e,t,i){var n,r;n=[i(99),i(0),i(2),i(21),i(69),i(422),i(91),i(68),i(114),i(100),i(116),i(102),i(185),i(2153)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(){this._framebuffer=void 0,this._colorTexture=void 0,this._drawCommand=void 0}function f(t,i){var n=t._framebuffer,r=i.createViewportQuadCommand(p,{framebuffer:n,renderState:s.fromCache({viewport:new e(0,0,256,256)})});t._drawCommand=r}function _(e,t){var i=new l({context:t,width:256,height:256,pixelFormat:r.RGBA,pixelDatatype:a.UNSIGNED_BYTE,sampler:new u({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:d.NEAREST,magnificationFilter:c.NEAREST})});e._colorTexture=i;var n=new o({context:t,colorTextures:[i],destroyAttachments:!1});e._framebuffer=n}return i(m.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),m.prototype.update=function(e){if(!t(this._colorTexture)){var i=e.context;_(this,i),f(this,i),this._drawCommand.execute(i),this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),n(this)},m}.apply(t,n))&&(e.exports=r)},2153:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\n    float a = roughness * roughness;\n    float phi = 2.0 * M_PI * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nfloat G1_Smith(float NdotV, float k)\n{\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\n    float k = roughness * roughness / 2.0;\n    return G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\n\nvec2 integrateBrdf(float roughness, float NdotV)\n{\n    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\n    float A = 0.0;\n    float B = 0.0;\n    const int NumSamples = 1024;\n    for (int i = 0; i < NumSamples; i++)\n    {\n        vec2 xi = hammersley2D(i, NumSamples);\n        vec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\n        vec3 L = 2.0 * dot(V, H) * H - V;\n        float NdotL = clamp(L.z, 0.0, 1.0);\n        float NdotH = clamp(H.z, 0.0, 1.0);\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\n        if (NdotL > 0.0)\n        {\n            float G = G_Smith(roughness, NdotV, NdotL);\n            float G_Vis = G * VdotH / (NdotH * NdotV);\n            float Fc = pow(1.0 - VdotH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n    return vec2(A, B) / float(NumSamples);\n}\n\nvoid main()\n{\n    gl_FragColor = vec4(integrateBrdf(1.0 - v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2154:function(e,t,i){var n,r;n=[i(38),i(10),i(12),i(31),i(1),i(0),i(1968),i(76),i(90),i(129),i(289),i(747),i(54),i(59)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(e){var i,n,o=e.frustum,a=e.orientation,s=e.origin,u=r(e._drawNearPlane,!0);o instanceof d?(i=f,n=d.packedLength):o instanceof c&&(i=_,n=c.packedLength),this._frustumType=i,this._frustum=o.clone(),this._origin=t.clone(s),this._orientation=p.clone(a),this._drawNearPlane=u,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+n+t.packedLength+p.packedLength}var f=0,_=1;m.pack=function(e,i,n){n=r(n,0);var o=e._frustumType,a=e._frustum;return i[n++]=o,o===f?(d.pack(a,i,n),n+=d.packedLength):(c.pack(a,i,n),n+=c.packedLength),t.pack(e._origin,i,n),n+=t.packedLength,p.pack(e._orientation,i,n),n+=p.packedLength,i[n]=e._drawNearPlane?1:0,i};var g=new d,v=new c,y=new p,w=new t;return m.unpack=function(e,i,n){i=r(i,0);var a,s=e[i++];s===f?(a=d.unpack(e,i,g),i+=d.packedLength):(a=c.unpack(e,i,v),i+=c.packedLength);var u=t.unpack(e,i,w);i+=t.packedLength;var l=p.unpack(e,i,y);i+=p.packedLength;var h=1===e[i];if(!o(n))return new m({frustum:a,origin:u,orientation:l,_drawNearPlane:h});var _=s===n._frustumType?n._frustum:void 0;return n._frustum=a.clone(_),n._frustumType=s,n._origin=t.clone(u,n._origin),n._orientation=p.clone(l,n._orientation),n._drawNearPlane=h,n},m.createGeometry=function(t){var i=t._frustumType,r=t._frustum,o=t._origin,c=t._orientation,d=t._drawNearPlane,p=new Float64Array(24);a._computeNearFarPlanes(o,c,i,r,p);for(var m,f,_=new l({position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:p})}),g=d?2:1,v=new Uint16Array(8*(g+1)),y=d?0:1;y<2;++y)m=d?8*y:0,f=4*y,v[m]=f,v[m+1]=f+1,v[m+2]=f+1,v[m+3]=f+2,v[m+4]=f+2,v[m+5]=f+3,v[m+6]=f+3,v[m+7]=f;for(y=0;y<2;++y)m=8*(g+y),f=4*y,v[m]=f,v[m+1]=f+4,v[m+2]=f+1,v[m+3]=f+5,v[m+4]=f+2,v[m+5]=f+6,v[m+6]=f+3,v[m+7]=f+7;return new s({attributes:_,indices:v,primitiveType:h.LINES,boundingSphere:e.fromVertices(p)})},m}.apply(t,n))&&(e.exports=r)},2155:function(e,t,i){var n,r;n=[i(38),i(10),i(31),i(0),i(39),i(76),i(90),i(54),i(64),i(60),i(47),i(68),i(77),i(52),i(115),i(2156),i(2157),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1}function y(e,i){var n=e.radii,r=i.camera.positionWC,o=t.multiplyComponents(e.oneOverRadii,r,x),a=t.magnitude(o),s=t.normalize(o,C),u=t.normalize(t.cross(t.UNIT_Z,o,T),T),l=t.normalize(t.cross(s,u,E),E),c=Math.sqrt(t.magnitudeSquared(o)-1),d=t.multiplyByScalar(s,1/a,x),h=c/a,p=t.multiplyByScalar(u,h,C),m=t.multiplyByScalar(l,h,T),f=t.add(d,m,E);t.subtract(f,p,f),t.multiplyComponents(n,f,f),t.pack(f,w,0);var _=t.subtract(d,m,E);t.subtract(_,p,_),t.multiplyComponents(n,_,_),t.pack(_,w,3);var g=t.add(d,m,E);t.add(g,p,g),t.multiplyComponents(n,g,g),t.pack(g,w,6);var v=t.subtract(d,m,E);return t.add(v,p,v),t.multiplyComponents(n,v,v),t.pack(v,w,9),w}var w=r.supportsTypedArrays()?new Float32Array(12):[],x=new t,C=new t,T=new t,E=new t;return v.prototype.update=function(r){if(this._mode=r.mode,r.mode===g.SCENE3D){var v=r.context,w=r.mapProjection.ellipsoid,x=r.useLogDepth;if(n(this._command)||(this._rs=d.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new l({renderState:this._rs,boundingVolume:new e(t.ZERO,w.maximumRadius),pass:c.OPAQUE,owner:this})),!n(this._sp)||this._useLogDepth!==x){this._useLogDepth=x;var C=new p({sources:[_]}),T=new p({sources:[f]});if(x){T.sources.push("#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),T.defines.push("LOG_DEPTH"),C.defines.push("LOG_DEPTH"),C.defines.push("DISABLE_GL_POSITION_LOG_DEPTH")}this._sp=h.replaceCache({shaderProgram:this._sp,context:v,vertexShaderSource:C,fragmentShaderSource:T,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}var E=y(w,r);if(n(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(E);else{var A=new o({attributes:{position:new a({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:E})},indices:[0,1,2,2,1,3],primitiveType:s.TRIANGLES});this._va=m.fromGeometry({context:v,geometry:A,attributeLocations:{position:0},bufferUsage:u.DYNAMIC_DRAW}),this._command.vertexArray=this._va}}},v.prototype.execute=function(e,t){this._mode===g.SCENE3D&&this._command.execute(e,t)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()},v}.apply(t,n))&&(e.exports=r)},2156:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec4 positionEC;\n\nvoid main()\n{\n    // TODO: make arbitrary ellipsoid\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n\n    vec3 direction = normalize(positionEC.xyz);\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\n    if (!czm_isEmpty(intersection))\n    {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n    }\n    else\n    {\n        discard;\n    }\n\n    czm_writeLogDepth();\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2157:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec4 position;\n\nvarying vec4 positionEC;\n\nvoid main()\n{\n    positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n\n    czm_vertexLogDepth();\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2158:function(e,t,i){var n,r;n=[i(1),i(0),i(60),i(68),i(52)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(){}function a(e,i){var n=e.shaderCache.getDerivedShaderProgram(i,"depthOnly");if(!t(n)){var o,a=i._attributeLocations,s=i.fragmentShaderSource,u=!1,l=s.sources,c=l.length;for(o=0;o<c;++o)if(d.test(l[o])||h.test(l[o])){u=!0;break}var p=!1,m=s.defines;for(c=m.length,o=0;o<c;++o)if("LOG_DEPTH"===m[o]){p=!0;break}var f;u||p?!u&&p&&(f="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeLogDepth(); \n} \n",s=new r({defines:["LOG_DEPTH"],sources:[f]})):(f="void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n",s=new r({sources:[f]})),n=e.shaderCache.createDerivedShaderProgram(i,"depthOnly",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}return n}function s(e,i){var r=e._depthOnlyRenderStateCache,o=r[i.id];if(!t(o)){var a=n.getState(i);a.depthMask=!0,a.colorMask={red:!1,green:!1,blue:!1,alpha:!1},o=n.fromCache(a),r[i.id]=o}return o}function u(e,i){var n=e.shaderCache.getDerivedShaderProgram(i,"logDepth");if(!t(n)){var o=i._attributeLocations,a=i.vertexShaderSource.clone(),s=i.fragmentShaderSource.clone();a.defines=t(a.defines)?a.defines.slice(0):[],a.defines.push("LOG_DEPTH"),s.defines=t(s.defines)?s.defines.slice(0):[],s.defines.push("LOG_DEPTH");var u,l,c=!1,d=a.sources,h=d.length;for(u=0;u<h;++u)if(m.test(d[u])){c=!0;break}if(!c){for(u=0;u<h;++u)d[u]=r.replaceMain(d[u],"czm_log_depth_main");l="\n\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_vertexLogDepth(); \n} \n",d.push(l)}var _=!0;for(c=!1,d=s.sources,h=d.length,u=0;u<h;++u)p.test(d[u])&&(c=!0),f.test(d[u])&&(_=!1);var g="";if(_&&(g+="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),!c){for(u=0;u<h;u++)d[u]=r.replaceMain(d[u],"czm_log_depth_main");g+="\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_writeLogDepth(); \n} \n"}d.push(g),n=e.shaderCache.createDerivedShaderProgram(i,"logDepth",{vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:o})}return n}function l(e,i,n){var o=e.shaderCache.getDerivedShaderProgram(i,"pick");if(!t(o)){for(var a=i._attributeLocations,s=i.fragmentShaderSource,u=s.sources,l=u.length,c="void main() \n{ \n    czm_non_pick_main(); \n    if (gl_FragColor.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = "+n+"; \n} \n",d=new Array(l+1),h=0;h<l;++h)d[h]=r.replaceMain(u[h],"czm_non_pick_main");d[l]=c,s=new r({sources:d,defines:s.defines}),o=e.shaderCache.createDerivedShaderProgram(i,"pick",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}return o}function c(e,i){var r=e._pickRenderStateCache,o=r[i.id];if(!t(o)){var a=n.getState(i);a.blending.enabled=!1,a.depthMask=!0,o=n.fromCache(a),r[i.id]=o}return o}var d=/\bgl_FragDepthEXT\b/,h=/\bdiscard\b/;o.createDepthOnlyDerivedCommand=function(e,n,r,o){t(o)||(o={});var u,l;return t(o.depthOnlyCommand)&&(u=o.depthOnlyCommand.shaderProgram,l=o.depthOnlyCommand.renderState),o.depthOnlyCommand=i.shallowClone(n,o.depthOnlyCommand),t(u)&&o.shaderProgramId===n.shaderProgram.id?(o.depthOnlyCommand.shaderProgram=u,o.depthOnlyCommand.renderState=l):(o.depthOnlyCommand.shaderProgram=a(r,n.shaderProgram),o.depthOnlyCommand.renderState=s(e,n.renderState),o.shaderProgramId=n.shaderProgram.id),o};var p=/\s+czm_writeLogDepth\(/,m=/\s+czm_vertexLogDepth\(/,f=/\s*#extension\s+GL_EXT_frag_depth\s*:\s*enable/;return o.createLogDepthCommand=function(e,n,r){t(r)||(r={});var o;return t(r.command)&&(o=r.command.shaderProgram),r.command=i.shallowClone(e,r.command),t(o)&&r.shaderProgramId===e.shaderProgram.id?r.command.shaderProgram=o:(r.command.shaderProgram=u(n,e.shaderProgram),r.shaderProgramId=e.shaderProgram.id),r},o.createPickDerivedCommand=function(e,n,r,o){t(o)||(o={});var a,s;return t(o.pickCommand)&&(a=o.pickCommand.shaderProgram,s=o.pickCommand.renderState),o.pickCommand=i.shallowClone(n,o.pickCommand),t(a)&&o.shaderProgramId===n.shaderProgram.id?(o.pickCommand.shaderProgram=a,o.pickCommand.renderState=s):(o.pickCommand.shaderProgram=l(r,n.shaderProgram,n.pickId),o.pickCommand.renderState=c(e,n.renderState),o.shaderProgramId=n.shaderProgram.id),o},o}.apply(t,n))&&(e.exports=r)},2159:function(e,t,i){var n,r;n=[i(0),i(21),i(3),i(9),i(40),i(59)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(t){function i(t){var i=t.alpha;if(!e(i))return r._alpha=void 0,r._beta=void 0,void(r._gamma=void 0);r._alpha=n.toRadians(i),r._beta=n.toRadians(t.beta),r._gamma=n.toRadians(t.gamma)}this._scene=t,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;var r=this;window.addEventListener("deviceorientation",i,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",i,!1)}}function s(e,t,i,n){var a=e.direction,s=e.right,d=e.up,h=o.fromAxisAngle(a,i,l),p=o.fromAxisAngle(s,n,u),m=o.multiply(p,h,p),f=o.fromAxisAngle(d,t,l);o.multiply(f,m,m);var _=r.fromQuaternion(m,c);r.multiplyByVector(_,s,s),r.multiplyByVector(_,d,d),r.multiplyByVector(_,a,a)}var u=new o,l=new o,c=new r;return a.prototype.update=function(){if(e(this._alpha)){e(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);var t=this._lastAlpha-this._alpha,i=this._lastBeta-this._beta,n=this._lastGamma-this._gamma;s(this._scene.camera,-t,i,n),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this._removeListener(),t(this)},a}.apply(t,n))&&(e.exports=r)},2160:function(e,t,i){var n,r;n=[i(10),i(0),i(9),i(46)],void 0!==(r=function(e,t,i,n){"use strict";function r(){this.enabled=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.1}function o(e){var t=a,i=t.length;if(e<t[0])return h=0;if(e>t[i-1])return h=i-2;if(e>=t[h]){if(h+1<i&&e<t[h+1])return h;if(h+2<i&&e<t[h+2])return++h}else if(h-1>=0&&e>=t[h-1])return--h;var n;for(n=0;n<i-2&&!(e>=t[n]&&e<t[n+1]);++n);return h=n}for(var a=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],s=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7],u=0;u<s.length;++u)s[u]*=1e6;for(var l=s[1],c=s[s.length-1],d=0;d<s.length;++d)s[d]=(s[d]-c)/(l-c);var h=0,p=new e;return r.prototype.update=function(r){if(r.fog.enabled=this.enabled){var u=r.camera,d=u.positionCartographic;if(!t(d)||d.height>8e5||r.mode!==n.SCENE3D)return void(r.fog.enabled=!1);var h=d.height,m=o(h),f=i.clamp((h-a[m])/(a[m+1]-a[m]),0,1),_=i.lerp(s[m],s[m+1],f),g=1e6*this.density;_=_*(g-g/l*c)*1e-6;var v=e.normalize(u.positionWC,p);_*=1-Math.abs(e.dot(u.directionWC,v)),r.fog.density=_,r.fog.sse=this.screenSpaceErrorFactor,r.fog.minimumBrightness=this.minimumBrightness}},r}.apply(t,n))&&(e.exports=r)},2161:function(e,t,i){var n,r;n=[i(46)],void 0!==(r=function(e){"use strict";function t(t,i,n){this.context=t,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.mode=e.SCENE3D,this.morphTime=e.getMorphTime(e.SCENE3D),this.frameNumber=0,this.time=void 0,this.jobScheduler=n,this.mapProjection=void 0,this.camera=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=i,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.shadowState={shadowsEnabled:!0,lightShadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.imagerySplitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1}return t}.apply(t,n))&&(e.exports=r)},2162:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2163:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_depthTexture, v_textureCoordinates).r);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2164:function(e,t,i){var n,r;n=[i(25),i(0),i(2),i(21),i(69),i(423),i(422),i(91),i(68),i(114),i(52),i(100),i(116),i(102),i(185),i(1948),i(70),i(304),i(305)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v){"use strict";function y(){this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._texture=void 0,this._classifiedTexture=void 0,this._depthStencilTexture=void 0,this._fbo=void 0,this._fboClassified=void 0,this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new o({color:new e(0,0,0,0),owner:this}),this._clearCommand=new o({color:new e(0,0,0,0),depth:1,stencil:0});var t=this;this._uniformMap={colorTexture:function(){return t._texture},depthTexture:function(){return t._depthStencilTexture},classifiedTexture:function(){return t._classifiedTexture}}}i(y.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}}),y.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};var w={depthMask:!1,stencilTest:{enabled:!0,frontFunction:g.EQUAL,frontOperation:{fail:v.KEEP,zFail:v.KEEP,zPass:v.KEEP},backFunction:g.NEVER,reference:0,mask:15},blending:_.ALPHA_BLEND},x={depthMask:!1,stencilTest:{enabled:!0,frontFunction:g.NOT_EQUAL,frontOperation:{fail:v.KEEP,zFail:v.KEEP,zPass:v.KEEP},backFunction:g.NEVER,reference:0,mask:15},blending:_.ALPHA_BLEND},C={depthMask:!0,depthTest:{enabled:!0},blending:_.ALPHA_BLEND};return y.prototype.update=function(e){var i=this._texture,n=!t(i)||this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;var o=e.drawingBufferWidth,_=e.drawingBufferHeight,g=!t(i)||i.width!==o||i.height!==_;if((g||n)&&(this._texture=this._texture&&this._texture.destroy(),this._classifiedTexture=this._classifiedTexture&&this._classifiedTexture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._texture=new d({context:e,width:o,height:_,pixelFormat:r.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new l({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.LINEAR,magnificationFilter:h.LINEAR})}),t(this._previousFramebuffer)||(this._classifiedTexture=new d({context:e,width:o,height:_,pixelFormat:r.RGBA,pixelDatatype:s.UNSIGNED_BYTE,sampler:new l({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.LINEAR,magnificationFilter:h.LINEAR})}),this._depthStencilTexture=new d({context:e,width:o,height:_,pixelFormat:r.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8}))),!t(this._fbo)||g||n){this._fbo=this._fbo&&this._fbo.destroy(),this._fboClassified=this._fboClassified&&this._fboClassified.destroy();var v,y;t(this._previousFramebuffer)?(v=this._previousFramebuffer.depthStencilTexture,y=this._previousFramebuffer.depthStencilRenderbuffer):v=this._depthStencilTexture,this._fbo=new a({context:e,colorTextures:[this._texture],depthStencilTexture:v,depthStencilRenderbuffer:y,destroyAttachments:!1}),t(this._previousFramebuffer)||(this._fboClassified=new a({context:e,colorTextures:[this._classifiedTexture],depthStencilTexture:v,destroyAttachments:!1}))}if(t(this._rsUnclassified)||(this._rsUnclassified=u.fromCache(w),this._rsClassified=u.fromCache(x),this._rsDefault=u.fromCache(C)),!t(this._unclassifiedCommand)||n){t(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());var T=t(this._previousFramebuffer)?"uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    gl_FragColor = color * czm_invertClassificationColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n":"#extension GL_EXT_frag_depth : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform sampler2D classifiedTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture2D(classifiedTexture, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    gl_FragColor = color * highlightColor;\n    gl_FragDepthEXT = texture2D(depthTexture, v_textureCoordinates).r;\n}\n",E=new c({defines:["UNCLASSIFIED"],sources:[T]}),A=new c({sources:[T]});this._unclassifiedCommand=e.createViewportQuadCommand(E,{renderState:t(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(A,{renderState:t(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),t(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),t(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(f,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},y.prototype.clear=function(e,i){var n=i.framebuffer;t(this._previousFramebuffer)?(i.framebuffer=this._fbo,this._clearColorCommand.execute(e,i)):(i.framebuffer=this._fbo,this._clearCommand.execute(e,i),i.framebuffer=this._fboClassified,this._clearCommand.execute(e,i)),i.framebuffer=n},y.prototype.executeClassified=function(e,i){if(!t(this._previousFramebuffer)){var n=i.framebuffer;i.framebuffer=this._fboClassified,this._translucentCommand.execute(e,i),i.framebuffer=n}this._classifiedCommand.execute(e,i)},y.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._texture=this._texture&&this._texture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),t(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),n(this)},y}.apply(t,n))&&(e.exports=r)},2165:function(e,t,i){var n,r;n=[i(0),i(2),i(3),i(117),i(794)],void 0!==(r=function(e,t,i,n,r){"use strict";function o(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function a(t){var i=new Array(r.NUMBER_OF_JOB_TYPES);i[r.TEXTURE]=new o(e(t)?t[r.TEXTURE]:10),i[r.PROGRAM]=new o(e(t)?t[r.PROGRAM]:10),i[r.BUFFER]=new o(e(t)?t[r.BUFFER]:30);var n,a=i.length,s=0;for(n=0;n<a;++n)s+=i[n].total;var u=new Array(a);for(n=0;n<a;++n)u[n]=!1;this._totalBudget=s,this._totalUsedThisFrame=0,this._budgets=i,this._executedThisFrame=u}return t(o.prototype,{total:{get:function(){return this._total}}}),a.getTimestamp=n,t(a.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),a.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},a.prototype.resetBudgets=function(){for(var e=this._budgets,t=e.length,i=0;i<t;++i){var n=e[i];n.starvedLastFrame=n.starvedThisFrame,n.starvedThisFrame=!1,n.usedThisFrame=0,n.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},a.prototype.execute=function(e,t){var i=this._budgets,n=i[t],r=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&r)return n.starvedThisFrame=!0,!1;var o;if(n.usedThisFrame+n.stolenFromMeThisFrame>=n.total){var s,u=i.length;for(s=0;s<u&&(o=i[s],!(o.usedThisFrame+o.stolenFromMeThisFrame<o.total)||o.starvedLastFrame);++s);if(s===u&&r)return!1;r&&(n.starvedThisFrame=!0)}var l=a.getTimestamp();e.execute();var c=a.getTimestamp()-l;return this._totalUsedThisFrame+=c,o?o.stolenFromMeThisFrame+=c:n.usedThisFrame+=c,this._executedThisFrame[t]=!0,!0},a}.apply(t,n))&&(e.exports=r)},2166:function(e,t,i){var n,r;n=[i(1),i(0),i(2),i(21),i(3),i(117),i(436)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(t){t=e(t,e.EMPTY_OBJECT);var i=a(t.container);this._container=i;var n=document.createElement("div");n.className="cesium-performanceDisplay";var r=document.createElement("div");r.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),r.appendChild(this._fpsText);var s=document.createElement("div");s.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),s.appendChild(this._msText),n.appendChild(s),n.appendChild(r),this._container.appendChild(n),this._lastFpsSampleTime=o(),this._lastMsSampleTime=o(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;var u=document.createElement("div");u.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),u.appendChild(this._throttledText),n.appendChild(u)}return i(s.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),s.prototype.update=function(t){var i=o(),n=e(t,!0);this._fpsFrameCount++;var r=i-this._lastFpsSampleTime;if(r>1e3){var a="N/A";n&&(a=1e3*this._fpsFrameCount/r|0),this._fpsText.nodeValue=a+" FPS",this._lastFpsSampleTime=i,this._fpsFrameCount=0}this._msFrameCount++;var s=i-this._lastMsSampleTime;if(s>200){var u="N/A";n&&(u=(s/this._msFrameCount).toFixed(2)),this._msText.nodeValue=u+" MS",this._lastMsSampleTime=i,this._msFrameCount=0}},s.prototype.destroy=function(){return n(this)},s}.apply(t,n))&&(e.exports=r)},2167:function(e,t,i){var n,r;n=[i(41),i(0),i(21),i(69),i(422),i(91),i(68),i(52),i(100)],void 0!==(r=function(e,t,i,n,r,o,a,s,u){"use strict";function l(){this._framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._useLogDepth=void 0,this._debugPickDepthViewportCommand=void 0}function c(e,i,n,r){if(!t(e._debugPickDepthViewportCommand)||r!==e._useLogDepth){var o=new s({defines:[r?"LOG_DEPTH":""],sources:["uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugPickDepthViewportCommand=i.createViewportQuadCommand(o,{uniformMap:{u_texture:function(){return e._depthTexture}},owner:e}),e._useLogDepth=r}e._debugPickDepthViewportCommand.execute(i,n)}function d(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function h(e){e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy()}function p(e,t,i,r){e._depthTexture=new u({context:t,width:i,height:r,pixelFormat:n.RGBA,pixelDatatype:o.UNSIGNED_BYTE})}function m(e,t,i,n){d(e),h(e),p(e,t,i,n),e._framebuffer=new r({context:t,colorTextures:[e._depthTexture],destroyAttachments:!1})}function f(e,i,n){var r=n.width,o=n.height,a=e._depthTexture,s=!t(a)||a.width!==r||a.height!==o;t(e._framebuffer)&&!s||m(e,i,r,o)}function _(e,i,n){if(!t(e._copyDepthCommand)){e._copyDepthCommand=i.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{renderState:a.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e})}e._textureToCopy=n,e._copyDepthCommand.framebuffer=e._framebuffer}l.prototype.executeDebugPickDepth=function(e,t,i){c(this,e,t,i)},l.prototype.update=function(e,t){f(this,e,t),_(this,e,t)};var g=new e,v=new e(1,1/255,1/65025,1/16581375);return l.prototype.getDepth=function(t,i,n){var r=t.readPixels({x:i,y:n,width:1,height:1,framebuffer:this._framebuffer}),o=e.unpack(r,0,g);return e.divideByScalar(o,255,o),e.dot(o,v)},l.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return d(this),h(this),this._copyDepthCommand.shaderProgram=t(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy(),i(this)},l}.apply(t,n))&&(e.exports=r)},2168:function(e,t,i){var n,r;n=[i(136),i(12),i(1),i(0),i(2),i(21),i(3),i(69),i(91),i(114),i(100),i(116),i(102),i(185),i(1948),i(2169),i(1973)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(){var e=f.createFXAAStage(),t=f.createAmbientOcclusionStage(),i=f.createBloomStage();t.enabled=!1,i.enabled=!1;var r=new _(this),o={},a=x;for(a.push(e,t,i);a.length>0;){var s=a.pop();o[s.name]=s,s._textureCache=r;var u=s.length;if(n(u))for(var l=0;l<u;++l)a.push(s.get(l))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;var c=this;t.uniforms.randomTexture=function(){return c._randomTexture},this._ao=t,this._bloom=i,this._fxaa=e,this._lastLength=void 0,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._fxaaEnabled=void 0,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=o,this._textureCache=r}function v(e){if(e._stagesRemoved){e._stagesRemoved=!1;for(var t=[],i=e._stages,n=i.length,r=0,o=0;r<n;++r){var a=i[r];a&&(a._index=o++,t.push(a))}e._stages=t}}function y(e){for(;n(e.length);)e=e.get(e.length-1);return e.outputTexture}function w(e,t,i,r,o){if(n(e.execute))return void e.execute(t,i,r,o);var a,s=e.length;if(e.inputPreviousStageTexture)for(w(e.get(0),t,i,r,o),a=1;a<s;++a)w(e.get(a),t,y(e.get(a-1)),r,o);else for(a=0;a<s;++a)w(e.get(a),t,i,r,o)}var x=[];return r(g.prototype,{ready:{get:function(){for(var e=!1,t=this._stages,i=t.length,n=i-1;n>=0;--n){var r=t[n];e=e||r.ready&&r.enabled}var o=this._fxaa,a=this._ao,s=this._bloom;return e=e||o.ready&&o.enabled,e=e||a.ready&&a.enabled,e=e||s.ready&&s.enabled}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return v(this),this._stages.length}},outputTexture:{get:function(){var e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);for(var t=this._stages,i=t.length,r=i-1;r>=0;--r){var o=t[r];if(n(o)&&o.ready&&o.enabled)return this.getOutputTexture(o.name)}var a=this._bloom;if(a.enabled&&a.ready)return this.getOutputTexture(a.name);var s=this._ao;return s.enabled&&s.ready?this.getOutputTexture(s.name):void 0}},hasSelected:{get:function(){for(var t=e(this._stages);t.length>0;){var i=t.pop();if(n(i.selected))return!0;var r=i.length;if(n(r))for(var o=0;o<r;++o)t.push(i.get(o))}return!1}}}),g.prototype.add=function(e){var t=this._stageNames,i=x;for(i.push(e);i.length>0;){var r=i.pop();t[r.name]=r,r._textureCache=this._textureCache;var o=r.length;if(n(o))for(var a=0;a<o;++a)i.push(r.get(a))}var s=this._stages;return e._index=s.length,s.push(e),this._textureCacheDirty=!0,e},g.prototype.remove=function(e){if(!this.contains(e))return!1;var t=this._stageNames,i=x;for(i.push(e);i.length>0;){var r=i.pop();delete t[r.name];var o=r.length;if(n(o))for(var a=0;a<o;++a)i.push(r.get(a))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},g.prototype.contains=function(e){return n(e)&&n(e._index)&&e._textureCache===this._textureCache},g.prototype.get=function(e){return v(this),this._stages[e]},g.prototype.removeAll=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)this.remove(e[i]);e.length=0},g.prototype.getStageByName=function(e){return this._stageNames[e]},g.prototype.update=function(e,t){v(this);var i=this._activeStages,r=this._activeStages=this._previousActiveStages;this._previousActiveStages=i;var o,a,m=this._stages,f=r.length=m.length,_=0;for(o=0;o<f;++o)a=m[o],a.ready&&a.enabled&&a._isSupported(e)&&(r[_++]=a);r.length=_;var g=_!==i.length;if(!g)for(o=0;o<_;++o)if(r[o]!==i[o]){g=!0;break}var y=this._ao,w=this._bloom,x=this._fxaa,C=y.enabled&&y._isSupported(e),T=w.enabled&&w._isSupported(e),E=x.enabled&&x._isSupported(e);if((g||this._textureCacheDirty||_!==this._lastLength||C!==this._aoEnabled||T!==this._bloomEnabled||E!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._lastLength=_,this._aoEnabled=C,this._bloomEnabled=T,this._fxaaEnabled=E,this._textureCacheDirty=!1),n(this._randomTexture)&&!C&&(this._randomTexture.destroy(),this._randomTexture=void 0),!n(this._randomTexture)&&C){f=196608;var A=new Uint8Array(f);for(o=0;o<f;o+=3)A[o]=Math.floor(255*Math.random());this._randomTexture=new c({context:e,pixelFormat:s.RGB,pixelDatatype:u.UNSIGNED_BYTE,source:{arrayBufferView:A,width:256,height:256},sampler:new l({wrapS:p.REPEAT,wrapT:p.REPEAT,minificationFilter:h.NEAREST,magnificationFilter:d.NEAREST})})}for(this._textureCache.update(e),x.update(e,t),y.update(e,t),w.update(e,t),f=m.length,o=0;o<f;++o)m[o].update(e,t)},g.prototype.clear=function(e){this._textureCache.clear(e)},g.prototype.getOutputTexture=function(e){var t=this.getStageByName(e);if(n(t))return y(t)},g.prototype.execute=function(e,t,i,n){var r=this._activeStages,o=r.length,a=this._fxaa,s=this._ao,u=this._bloom,l=s.enabled&&s._isSupported(e),c=u.enabled&&u._isSupported(e),d=a.enabled&&a._isSupported(e);if(d||l||c||0!==o){var h=t;l&&s.ready&&(w(s,e,h,i,n),h=y(s)),c&&u.ready&&(w(u,e,h,i,n),h=y(u));var p=h;if(o>0){w(r[0],e,h,i,n);for(var m=1;m<o;++m)w(r[m],e,y(r[m-1]),i,n);p=y(r[o-1])}d&&a.ready&&w(a,e,p,i,n)}},g.prototype.copy=function(e,t){if(!n(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(m,{uniformMap:{colorTexture:function(){return i.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),o(this)},g}.apply(t,n))&&(e.exports=r)},2169:function(e,t,i){var n,r;n=[i(103),i(101),i(25),i(0),i(2),i(94),i(21),i(23),i(2171),i(2172),i(2173),i(2174),i(2175),i(2176),i(2177),i(2170),i(2178),i(2179),i(1970),i(2180),i(2181),i(2182),i(2183),i(1971),i(1972),i(1956)],void 0!==(r=function(e,t,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P){"use strict";function S(e){var t="#define USE_STEP_SIZE\n"+y,i=new E({name:e+"_x_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:P.LINEAR}),n=new E({name:e+"_y_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:P.LINEAR}),r={};return o(r,{delta:{get:function(){return i.uniforms.delta},set:function(e){var t=i.uniforms,r=n.uniforms;t.delta=r.delta=e}},sigma:{get:function(){return i.uniforms.sigma},set:function(e){var t=i.uniforms,r=n.uniforms;t.sigma=r.sigma=e}},stepSize:{get:function(){return i.uniforms.stepSize},set:function(e){var t=i.uniforms,r=n.uniforms;t.stepSize=r.stepSize=e}}}),new A({name:e,stages:[i,n],uniforms:r})}function b(e){if(!r(e))return D.createEdgeDetectionStage();for(var t=new A({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),i={},n="",o="",a=0;a<e.length;++a)n+="uniform sampler2D edgeTexture"+a+"; \n",o+="        vec4 edge"+a+" = texture2D(edgeTexture"+a+", v_textureCoordinates); \n        if (edge"+a+".a > 0.0) \n        { \n            color = edge"+a+"; \n            break; \n        } \n",i["edgeTexture"+a]=e[a].name;var s=n+"varying vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < "+e.length+"; i++) \n    { \n"+o+"    } \n    gl_FragColor = color; \n} \n",u=new E({name:"czm_edge_detection_combine",fragmentShader:s,uniforms:i});return new A({name:"czm_edge_detection_composite",stages:[t,u]})}var D={};D.createBlurStage=function(){return S("czm_blur")},D.createDepthOfFieldStage=function(){var e=S("czm_depth_of_field_blur"),t=new E({name:"czm_depth_of_field_composite",fragmentShader:f,uniforms:{focalDistance:5,blurTexture:e.name}}),i={};return o(i,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new A({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:i})},D.isDepthOfFieldSupported=function(e){return e.context.depthTexture},D.createEdgeDetectionStage=function(){var e=t();return new E({name:"czm_edge_detection_"+e,fragmentShader:g,uniforms:{length:.25,color:n.clone(n.BLACK)}})},D.isEdgeDetectionSupported=function(e){return e.context.depthTexture},D.createSilhouetteStage=function(e){var t=b(e),i=new E({name:"czm_silhouette_color_edges",fragmentShader:C,uniforms:{silhouetteTexture:t.name}});return new A({name:"czm_silhouette",stages:[t,i],inputPreviousStageTexture:!1,uniforms:t.uniforms})},D.isSilhouetteSupported=function(e){return e.context.depthTexture},D.createBloomStage=function(){var e=new E({name:"czm_bloom_contrast_bias",fragmentShader:m,uniforms:{contrast:128,brightness:-.3}}),t=S("czm_bloom_blur"),i=new A({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),n=new E({name:"czm_bloom_generate_composite",fragmentShader:h,uniforms:{glowOnly:!1,bloomTexture:i.name}}),r={};return o(r,{glowOnly:{get:function(){return n.uniforms.glowOnly},set:function(e){n.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new A({name:"czm_bloom",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},D.createAmbientOcclusionStage=function(){var e=new E({name:"czm_ambient_occlusion_generate",fragmentShader:l,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=S("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;var i=new A({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),n=new E({name:"czm_ambient_occlusion_composite",fragmentShader:c,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:i.name}}),r={};return o(r,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return n.uniforms.ambientOcclusionOnly},set:function(e){n.uniforms.ambientOcclusionOnly=e}}}),new A({name:"czm_ambient_occlusion",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},D.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var I="#define FXAA_QUALITY_PRESET 39 \n"+T+"\n"+v;return D.createFXAAStage=function(){return new E({name:"czm_FXAA",fragmentShader:I,sampleMode:P.LINEAR})},D.createBlackAndWhiteStage=function(){return new E({name:"czm_black_and_white",fragmentShader:d,uniforms:{gradations:5}})},D.createBrightnessStage=function(){return new E({name:"czm_brightness",fragmentShader:p,uniforms:{brightness:.5}})},D.createNightVisionStage=function(){return new E({name:"czm_night_vision",fragmentShader:x})},D.createDepthViewStage=function(){return new E({name:"czm_depth_view",fragmentShader:_})},D.createLensFlareStage=function(){return new E({name:"czm_lens_flare",fragmentShader:w,uniforms:{dirtTexture:i(2184),starTexture:i(2185),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,earthRadius:u.WGS84.maximumRadius}})},D}.apply(t,n))&&(e.exports=r)},2170:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    gl_FragColor = vec4(vec3(depth), 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2171:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D randomTexture;\nuniform sampler2D depthTexture;\nuniform float intensity;\nuniform float bias;\nuniform float lengthCap;\nuniform float stepSize;\nuniform float frustumLength;\n\nvarying vec2 v_textureCoordinates;\n\nvec4 clipToEye(vec2 uv, float depth)\n{\n    vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n    vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);\n    posEC = posEC / posEC.w;\n    return posEC;\n}\n\n//Reconstruct Normal Without Edge Removation\nvec3 getNormalXEdge(vec3 posInCamera, float depthU, float depthD, float depthL, float depthR, vec2 pixelSize)\n{\n    vec4 posInCameraUp = clipToEye(v_textureCoordinates - vec2(0.0, pixelSize.y), depthU);\n    vec4 posInCameraDown = clipToEye(v_textureCoordinates + vec2(0.0, pixelSize.y), depthD);\n    vec4 posInCameraLeft = clipToEye(v_textureCoordinates - vec2(pixelSize.x, 0.0), depthL);\n    vec4 posInCameraRight = clipToEye(v_textureCoordinates + vec2(pixelSize.x, 0.0), depthR);\n\n    vec3 up = posInCamera.xyz - posInCameraUp.xyz;\n    vec3 down = posInCameraDown.xyz - posInCamera.xyz;\n    vec3 left = posInCamera.xyz - posInCameraLeft.xyz;\n    vec3 right = posInCameraRight.xyz - posInCamera.xyz;\n\n    vec3 DX = length(left) < length(right) ? left : right;\n    vec3 DY = length(up) < length(down) ? up : down;\n\n    return normalize(cross(DY, DX));\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = clipToEye(v_textureCoordinates, depth);\n\n    if (posInCamera.z > frustumLength)\n    {\n        gl_FragColor = vec4(1.0);\n        return;\n    }\n\n    vec2 pixelSize = 1.0 / czm_viewport.zw;\n    float depthU = czm_readDepth(depthTexture, v_textureCoordinates- vec2(0.0, pixelSize.y));\n    float depthD = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(0.0, pixelSize.y));\n    float depthL = czm_readDepth(depthTexture, v_textureCoordinates- vec2(pixelSize.x, 0.0));\n    float depthR = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(pixelSize.x, 0.0));\n    vec3 normalInCamera = getNormalXEdge(posInCamera.xyz, depthU, depthD, depthL, depthR, pixelSize);\n\n    float ao = 0.0;\n    vec2 sampleDirection = vec2(1.0, 0.0);\n    float gapAngle = 90.0 * czm_radiansPerDegree;\n\n    // RandomNoise\n    float randomVal = texture2D(randomTexture, v_textureCoordinates).x;\n\n    float inverseViewportWidth = 1.0 / czm_viewport.z;\n    float inverseViewportHeight = 1.0 / czm_viewport.w;\n\n    //Loop for each direction\n    for (int i = 0; i < 4; i++)\n    {\n        float newGapAngle = gapAngle * (float(i) + randomVal);\n        float cosVal = cos(newGapAngle);\n        float sinVal = sin(newGapAngle);\n\n        //Rotate Sampling Direction\n        vec2 rotatedSampleDirection = vec2(cosVal * sampleDirection.x - sinVal * sampleDirection.y, sinVal * sampleDirection.x + cosVal * sampleDirection.y);\n        float localAO = 0.0;\n        float localStepSize = stepSize;\n\n        //Loop for each step\n        for (int j = 0; j < 6; j++)\n        {\n            vec2 directionWithStep = vec2(rotatedSampleDirection.x * localStepSize * inverseViewportWidth, rotatedSampleDirection.y * localStepSize * inverseViewportHeight);\n            vec2 newCoords = directionWithStep + v_textureCoordinates;\n\n            //Exception Handling\n            if(newCoords.x > 1.0 || newCoords.y > 1.0 || newCoords.x < 0.0 || newCoords.y < 0.0)\n            {\n                break;\n            }\n\n            float stepDepthInfo = czm_readDepth(depthTexture, newCoords);\n            vec4 stepPosInCamera = clipToEye(newCoords, stepDepthInfo);\n            vec3 diffVec = stepPosInCamera.xyz - posInCamera.xyz;\n            float len = length(diffVec);\n\n            if (len > lengthCap)\n            {\n                break;\n            }\n\n            float dotVal = clamp(dot(normalInCamera, normalize(diffVec)), 0.0, 1.0 );\n            float weight = len / lengthCap;\n            weight = 1.0 - weight * weight;\n\n            if (dotVal < bias)\n            {\n                dotVal = 0.0;\n            }\n\n            localAO = max(localAO, dotVal * weight);\n            localStepSize += stepSize;\n        }\n        ao += localAO;\n    }\n\n    ao /= 4.0;\n    ao = 1.0 - clamp(ao, 0.0, 1.0);\n    ao = pow(ao, intensity);\n    gl_FragColor = vec4(vec3(ao), 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2172:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D ambientOcclusionTexture;\nuniform bool ambientOcclusionOnly;\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 color = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 ao = texture2D(ambientOcclusionTexture, v_textureCoordinates).rgb;\n    gl_FragColor.rgb = ambientOcclusionOnly ? ao : ao * color;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2173:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float gradations;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        gl_FragColor = vec4(rgb, 1.0);\n        return;\n    }\n#endif\n    float luminance = czm_luminance(rgb);\n    float darkness = luminance * gradations;\n    darkness = (darkness - fract(darkness)) / gradations;\n    gl_FragColor = vec4(vec3(darkness), 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2174:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D bloomTexture;\nuniform bool  glowOnly;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 bloom = texture2D(bloomTexture, v_textureCoordinates);\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    gl_FragColor = glowOnly ? bloom : bloom + color;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2175:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float brightness;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 target = vec3(0.0);\n    gl_FragColor = vec4(mix(target, rgb, brightness), 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2176:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform float contrast;\nuniform float brightness;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 sceneColor = texture2D(colorTexture, v_textureCoordinates).xyz;\n    sceneColor = czm_RGBToHSB(sceneColor);\n    sceneColor.z += brightness;\n    sceneColor = czm_HSBToRGB(sceneColor);\n\n    float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\n    sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);\n    gl_FragColor = vec4(sceneColor, 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2177:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D blurTexture;\nuniform sampler2D depthTexture;\nuniform float focalDistance;\n\nvarying vec2 v_textureCoordinates;\n\nvec4 toEye(vec2 uv, float depth)\n{\n   vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n   vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n   posInCamera = posInCamera / posInCamera.w;\n   return posInCamera;\n}\n\nfloat computeDepthBlur(float depth)\n{\n    float f;\n    if (depth < focalDistance)\n    {\n        f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);\n    }\n    else\n    {\n        f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);\n        f = pow(f, 0.1);\n    }\n    f *= f;\n    f = clamp(f, 0.0, 1.0);\n    return pow(f, 0.5);\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = toEye(v_textureCoordinates, depth);\n    float d = computeDepthBlur(-posInCamera.z);\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), texture2D(blurTexture, v_textureCoordinates), d);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2178:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D depthTexture;\nuniform float length;\nuniform vec4 color;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float directions[3];\n    directions[0] = -1.0;\n    directions[1] = 0.0;\n    directions[2] = 1.0;\n\n    float scalars[3];\n    scalars[0] = 3.0;\n    scalars[1] = 10.0;\n    scalars[2] = 3.0;\n\n    float padx = 1.0 / czm_viewport.z;\n    float pady = 1.0 / czm_viewport.w;\n\n#ifdef CZM_SELECTED_FEATURE\n    bool selected = false;\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        selected = selected || czm_selected(vec2(-padx, dir * pady));\n        selected = selected || czm_selected(vec2(padx, dir * pady));\n        selected = selected || czm_selected(vec2(dir * padx, -pady));\n        selected = selected || czm_selected(vec2(dir * padx, pady));\n        if (selected)\n        {\n            break;\n        }\n    }\n    if (!selected)\n    {\n        gl_FragColor = vec4(color.rgb, 0.0);\n        return;\n    }\n#endif\n\n    float horizEdge = 0.0;\n    float vertEdge = 0.0;\n\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        float scale = scalars[i];\n\n        horizEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;\n        horizEdge += texture2D(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;\n\n        vertEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;\n        vertEdge += texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;\n    }\n\n    float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);\n    gl_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2179:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec2 v_textureCoordinates;\n\nuniform sampler2D colorTexture;\n\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\nvoid main()\n{\n    vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;\n    vec4 color = FxaaPixelShader(\n        v_textureCoordinates,\n        colorTexture,\n        fxaaQualityRcpFrame,\n        fxaaQualitySubpix,\n        fxaaQualityEdgeThreshold,\n        fxaaQualityEdgeThresholdMin);\n    float alpha = texture2D(colorTexture, v_textureCoordinates).a;\n    gl_FragColor = vec4(color.rgb, alpha);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2180:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D dirtTexture;\nuniform sampler2D starTexture;\nuniform vec2 dirtTextureDimensions;\nuniform float distortion;\nuniform float ghostDispersal;\nuniform float haloWidth;\nuniform float earthRadius;\nuniform float intensity;\n\nvarying vec2 v_textureCoordinates;\n\n// whether it is in space or not\n// 6500000.0 is Emprical value\n#define DISTANCE_TO_SPACE 6500000.0\n\n// return ndc from world coordinate biased earthRadius\nvec4 getNDCFromWC(vec3 WC, float earthRadius)\n{\n    vec4 positionEC = czm_view * vec4(WC, 1.0);\n    positionEC = vec4(positionEC.x + earthRadius , positionEC.y, positionEC.z, 1.0);\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n}\n\n// Check if current pixel is included Earth\n// if then mask it gradually\nfloat isInEarth(vec2 texcoord, vec2 sceneSize)\n{\n    vec2 NDC = texcoord * 2.0 - 1.0;\n    vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);\n    vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);\n    NDC.xy -= earthPosSC.xy;\n\n    float X = abs(NDC.x) * sceneSize.x;\n    float Y = abs(NDC.y) * sceneSize.y;\n\n    return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));\n}\n\n// For Chromatic effect\nvec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)\n{\n    vec2 sceneSize = czm_viewport.zw;\n    vec3 color;\n    if(isSpace)\n    {\n        color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture2D(tex, texcoord + direction * distortion.r).r;\n        color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture2D(tex, texcoord + direction * distortion.g).g;\n        color.b = isInEarth(texcoord  + direction * distortion.b, sceneSize) * texture2D(tex, texcoord + direction * distortion.b).b;\n    }\n    else\n    {\n        color.r = texture2D(tex, texcoord + direction * distortion.r).r;\n        color.g = texture2D(tex, texcoord + direction * distortion.g).g;\n        color.b = texture2D(tex, texcoord + direction * distortion.b).b;\n    }\n    return vec4(clamp(color, 0.0, 1.0), 0.0);\n}\n\nvoid main(void)\n{\n    vec4 originalColor = texture2D(colorTexture, v_textureCoordinates);\n    vec3 rgb = originalColor.rgb;\n    bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;\n\n    // Sun position\n    vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    vec4 sunPositionEC = czm_view * sunPos;\n    vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);\n    sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);\n\n    // If sun is not in the screen space, use original color.\n    if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))\n    {\n        // Lens flare is disabled when not in space until #5932 is fixed.\n        //    https://github.com/AnalyticalGraphicsInc/cesium/issues/5932\n        gl_FragColor = originalColor;\n        return;\n    }\n\n    vec2 texcoord = -v_textureCoordinates + vec2(1.0);\n    vec2 texelSize = 1.0 / czm_viewport.zw;\n    vec3 distortionVec = vec3(-texelSize.x * distortion, 0.0, texelSize.x * distortion);\n\n    // ghost vector to image centre:\n    vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;\n    vec3 direction = normalize(vec3(ghostVec, 0.0));\n\n    // sample ghosts:\n    vec4 result = vec4(0.0);\n    vec4 ghost = vec4(0.0);\n    for (int i = 0; i < 4; ++i)\n    {\n        vec2 offset = fract(texcoord + ghostVec * float(i));\n        // Only bright spots from the centre of the source image\n        ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);\n    }\n    result += ghost;\n\n    // sample halo\n    vec2 haloVec = normalize(ghostVec) * haloWidth;\n    float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n    weightForHalo = pow(1.0 - weightForHalo, 5.0);\n\n    result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;\n\n    vec2 dirtTexCoords = (v_textureCoordinates * czm_viewport.zw) / dirtTextureDimensions;\n    if (dirtTexCoords.x > 1.0)\n    {\n        dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);\n    }\n    if (dirtTexCoords.y > 1.0)\n    {\n        dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);\n    }\n    result += texture2D(dirtTexture, dirtTexCoords);\n\n    // Rotating starburst texture's coordinate\n    // dot(czm_view[0].xyz, vec3(0.0, 0.0, 1.0)) + dot(czm_view[1].xyz, vec3(0.0, 1.0, 0.0))\n    float camrot = czm_view[0].z + czm_view[1].y;\n    float cosValue = cos(camrot);\n    float sinValue = sin(camrot);\n    mat3 rotation = mat3(\n        cosValue, -sinValue, 0.0,\n        sinValue, cosValue, 0.0,\n        0.0, 0.0, 1.0\n    );\n\n    vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);\n    vec3 st2 = vec3((rotation * st1).xy, 1.0);\n    vec3 st3 = st2 * 0.5 + vec3(0.5);\n    vec2 lensStarTexcoord = st3.xy;\n    float weightForLensFlare = length(vec3(sunPos.xy, 0.0));\n    float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);\n\n    if (!isSpace)\n    {\n        result *= oneMinusWeightForLensFlare * intensity * 0.2;\n    }\n    else\n    {\n        result *= oneMinusWeightForLensFlare * intensity;\n        result *= texture2D(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;\n    }\n\n    result += texture2D(colorTexture, v_textureCoordinates);\n\n    gl_FragColor = result;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2181:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\n\nvarying vec2 v_textureCoordinates;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;\n    vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    gl_FragColor = vec4((noiseValue + rgb) * green, 1.0);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2182:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D silhouetteTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 silhouetteColor = texture2D(silhouetteTexture, v_textureCoordinates);\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    gl_FragColor = mix(color, silhouetteColor, silhouetteColor.a);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2183:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"/**\n * @license\n * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *  * Neither the name of NVIDIA CORPORATION nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples\n// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h\n\n// Steps used to integrate into Cesium:\n// * The following defines are set:\n//       #define FXAA_PC 1\n//       #define FXAA_WEBGL_1 1\n//       #define FXAA_GREEN_AS_LUMA 1\n//       #define FXAA_EARLY_EXIT 1\n//       #define FXAA_GLSL_120 1\n// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.\n// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace\n//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.\n// * There are no implicit conversions from ivec* to vec* so replace:\n//       #define FxaaInt2 ivec2\n//           with\n//       #define FxaaInt2 vec2\n// * The texture2DLod function is only available in vertex shaders so replace:\n//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n//           with\n//       #define FxaaTexTop(t, p) texture2D(t, p)\n//       #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.\n// * The following parameters to FxaaPixelShader are unused and can be removed:\n//       fxaaConsolePosPos\n//       fxaaConsoleRcpFrameOpt\n//       fxaaConsoleRcpFrameOpt2\n//       fxaaConsole360RcpFrameOpt2\n//       fxaaConsoleEdgeSharpness\n//       fxaaConsoleEdgeThreshold\n//       fxaaConsoleEdgeThresholdMi\n//       fxaaConsole360ConstDir\n\n//\n// Choose the quality preset.\n// This needs to be compiled into the shader as it effects code.\n// Best option to include multiple presets is to\n// in each shader define the preset, then include this file.\n//\n// OPTIONS\n// -----------------------------------------------------------------------\n// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n// 39       - no dither, very expensive\n//\n// NOTES\n// -----------------------------------------------------------------------\n// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n// 13 = about same speed as FXAA 3.9 and better than 12\n// 23 = closest to FXAA 3.9 visually and performance wise\n//  _ = the lowest digit is directly related to performance\n// _  = the highest digit is directly related to style\n//\n//#define FXAA_QUALITY_PRESET 12\n\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {___a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        return rgbyM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2184:function(e,t,i){e.exports=i.p+"c6ab0a71c7048eb83585b34bd32f4ee0.jpg"},2185:function(e,t,i){e.exports=i.p+"27faaa4b21b2a66ac3496b20640e571f.jpg"},2186:function(e,t,i){var n,r;n=[i(10),i(24),i(12),i(0),i(21),i(294),i(9),i(20),i(289),i(424),i(747),i(186),i(432),i(222),i(50),i(1947),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}function v(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new h(e._scene.canvas,!1);var i=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=i,e._morphHandler.setInputAction(i,p.LEFT_DOWN),e._morphHandler.setInputAction(i,p.MIDDLE_DOWN),e._morphHandler.setInputAction(i,p.RIGHT_DOWN),e._morphHandler.setInputAction(i,p.WHEEL)}}function y(e){for(var t=e._currentTweens,i=0;i<t.length;++i)t[i].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}function w(e,t){var i=e._scene,n=i.camera,r=j,o=r.position,a=r.direction,u=r.up,l=i.mapProjection.unproject(n.position,Q);t.cartographicToCartesian(l,o);var c=t.scaleToGeodeticSurface(o,q),d=m.eastNorthUpToFixedFrame(c,t,Z);return s.multiplyByPointAsVector(d,n.direction,a),s.multiplyByPointAsVector(d,n.up,u),r}function x(t,i,n,r){function a(t){T(c,p,t.time,l.position),T(d,m,t.time,l.direction),T(h,_,t.time,l.up),e.cross(l.direction,l.up,l.right),e.normalize(l.right,l.right)}i*=.5;var u=t._scene,l=u.camera,c=e.clone(l.position,K),d=e.clone(l.direction,J),h=e.clone(l.up,$),p=s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,n.position,ee),m=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,n.direction,te),_=s.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,n.up,ie),g=u.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:a,complete:function(){I(t,u,0,1,i,r)}});t._currentTweens.push(g)}function C(t,i,n){i/=3;var r,o=t._scene,s=o.camera;i>0?(r=j,e.fromDegrees(0,0,5*n.maximumRadius,n,r.position),e.negate(r.position,r.direction),e.normalize(r.direction,r.direction),e.clone(e.UNIT_Z,r.up)):(s.position.z=s.frustum.right-s.frustum.left,r=w(t,n));var u;t._morphToOrthographic?(u=ne,u.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,u.width=s.frustum.right-s.frustum.left):(u=X,u.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,u.fov=a.toRadians(60)),r.frustum=u;var l=O(r);v(t,l);var c;c=t._morphToOrthographic?function(){x(t,i,r,l)}:function(){S(t,i,r,function(){x(t,i,r,l)})},i>0?(o._mode=_.SCENE2D,s.flyTo({duration:i,destination:e.fromDegrees(0,0,5*n.maximumRadius,n,se),complete:function(){o._mode=_.MORPHING,c()}})):c()}function T(t,i,n,r){return e.lerp(t,i,n,r)}function E(e,t,i,n,r){function s(e){c.frustum.fov=a.lerp(d,h,e.time);var t=p/Math.tan(.5*c.frustum.fov);n(c,t)}var l=e._scene,c=l.camera;if(!(c.frustum instanceof u)){var d=c.frustum.fov,h=.5*a.RADIANS_PER_DEGREE,p=i.position.z*Math.tan(.5*d);c.frustum.far=p/Math.tan(.5*h)+1e7;var m=l.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:s,complete:function(){c.frustum=i.frustum.clone(),r(e)}});e._currentTweens.push(m)}}function A(t,i){function r(t){T(c,_,t.time,l.position),T(d,p,t.time,l.direction),T(h,m,t.time,l.up),e.cross(l.direction,l.up,l.right),e.normalize(l.right,l.right),l._adjustOrthographicFrustum(!0)}function a(e,t){e.position.z=t}i*=.5;var u=t._scene,l=u.camera,c=e.clone(l.position,ce),d=e.clone(l.direction,de),h=e.clone(l.up,he),p=e.negate(e.UNIT_Z,me),m=e.clone(e.UNIT_Y,fe),_=pe;if(i>0)e.clone(e.ZERO,pe),_.z=5*u.mapProjection.ellipsoid.maximumRadius;else{e.clone(c,pe);var g=ge;s.multiplyByPoint(f.TRANSFORM_2D,c,g.origin),s.multiplyByPointAsVector(f.TRANSFORM_2D,d,g.direction);var y=u.globe;if(n(y)){var w=y.pickWorldCoordinates(g,u,ve);n(w)&&(s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,w,_),_.z+=e.distance(c,_))}}var x=_e;x.right=.5*_.z,x.left=-x.right,x.top=x.right*(u.drawingBufferHeight/u.drawingBufferWidth),x.bottom=-x.top;var C=ye;C.position=_,C.direction=p,C.up=m,C.frustum=x;var A=M(C);v(t,A);var P=u.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:r,complete:function(){E(t,i,C,a,A)}});t._currentTweens.push(P)}function P(t,i,r){function o(e,t){e.position.x=t}function a(){E(t,i,c,o,T)}i*=.5;var u=t._scene,l=u.camera,c=xe;if(i>0)e.clone(e.ZERO,c.position),c.position.z=5*r.maximumRadius,e.negate(e.UNIT_Z,c.direction),e.clone(e.UNIT_Y,c.up);else{r.cartesianToCartographic(l.positionWC,we),u.mapProjection.project(we,c.position),e.negate(e.UNIT_Z,c.direction),e.clone(e.UNIT_Y,c.up);var d=Ee;e.clone(c.position2D,d.origin);var h=e.clone(l.directionWC,d.direction),p=r.scaleToGeodeticSurface(l.positionWC,Pe),_=m.eastNorthUpToFixedFrame(p,r,Ae);s.inverseTransformation(_,_),s.multiplyByPointAsVector(_,h,h),s.multiplyByPointAsVector(f.TRANSFORM_2D,h,h);var g=u.globe;if(n(g)){var y=g.pickWorldCoordinates(d,u,Te);if(n(y)){var w=e.distance(c.position2D,y);y.x+=w,e.clone(y,c.position2D)}}}s.multiplyByPoint(f.TRANSFORM_2D,c.position,c.position2D),s.multiplyByPointAsVector(f.TRANSFORM_2D,c.direction,c.direction2D),s.multiplyByPointAsVector(f.TRANSFORM_2D,c.up,c.up2D);var x=c.frustum;x.right=.5*c.position.z,x.left=-x.right,x.top=x.right*(u.drawingBufferHeight/u.drawingBufferWidth),x.bottom=-x.top;var C=Ce;s.multiplyByPoint(f.TRANSFORM_2D_INVERSE,c.position2D,C.position),e.clone(c.direction,C.direction),e.clone(c.up,C.up),C.frustum=x;var T=M(C);v(t,T),D(t,i,c,a)}function S(e,t,i,n){function r(e){u.frustum.fov=a.lerp(d,c,e.time),u.position.z=h/Math.tan(.5*u.frustum.fov)}var s=e._scene,u=s.camera,l=u.frustum.right-u.frustum.left;u.frustum=i.frustum.clone();var c=u.frustum.fov,d=.5*a.RADIANS_PER_DEGREE,h=l*Math.tan(.5*c);u.frustum.far=h/Math.tan(.5*d)+1e7,u.frustum.fov=d;var p=s.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:r,complete:function(){n(e)}});e._currentTweens.push(p)}function b(t,i,n,r){function a(){function a(t){T(h,l,t.time,u.position),T(p,c,t.time,u.direction),T(m,d,t.time,u.up),e.cross(u.direction,u.up,u.right),e.normalize(u.right,u.right)}u.frustum=n.frustum.clone();var h=e.clone(u.position,re),p=e.clone(u.direction,oe),m=e.clone(u.up,ae);h.z=l.z;var f=s.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:a,complete:function(){r(t)}});t._currentTweens.push(f)}i*=.5;var s=t._scene,u=s.camera,l=e.clone(n.position,se),c=e.clone(n.direction,ue),d=e.clone(n.up,le);s._mode=_.MORPHING,t._morphToOrthographic?a():S(t,0,n,a)}function D(t,i,n,r){function a(t){T(l,h,t.time,u.position),T(c,p,t.time,u.direction),T(d,m,t.time,u.up),e.cross(u.direction,u.up,u.right),e.normalize(u.right,u.right),u._adjustOrthographicFrustum(!0)}var s=t._scene,u=s.camera,l=e.clone(u.position,re),c=e.clone(u.direction,oe),d=e.clone(u.up,ae),h=e.clone(n.position2D,se),p=e.clone(n.direction2D,ue),m=e.clone(n.up2D,le),f=s.tweens.add({duration:i,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:a,complete:function(){I(t,s,1,0,i,r)}});t._currentTweens.push(f)}function I(e,t,i,r,a,s){var u={object:t,property:"morphTime",startValue:i,stopValue:r,duration:a,easingFunction:o.QUARTIC_OUT};n(s)&&(u.complete=function(){s(e)});var l=t.tweens.addProperty(u);e._currentTweens.push(l)}function O(t){return function(i){var r=i._scene;r._mode=_.SCENE3D,r.morphTime=_.getMorphTime(_.SCENE3D),y(i);var o=r.camera;(i._previousMode!==_.MORPHING||i._morphCancelled)&&(i._morphCancelled=!1,e.clone(t.position,o.position),e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),o.frustum=t.frustum.clone());var a=o.frustum;r.frameState.useLogDepth&&(a.near=.1,a.far=1e10);var s=n(i._completeMorph);i._completeMorph=void 0,r.camera.update(r.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.SCENE3D,s)}}function M(t){return function(i){var r=i._scene;r._mode=_.SCENE2D,r.morphTime=_.getMorphTime(_.SCENE2D),y(i);var o=r.camera;e.clone(t.position,o.position),o.position.z=2*r.mapProjection.ellipsoid.maximumRadius,e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),o.frustum=t.frustum.clone();var a=n(i._completeMorph);i._completeMorph=void 0,r.camera.update(r.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.SCENE2D,a)}}function F(t){return function(i){var r=i._scene;r._mode=_.COLUMBUS_VIEW,r.morphTime=_.getMorphTime(_.COLUMBUS_VIEW),y(i);var o=r.camera;(i._previousModeMode!==_.MORPHING||i._morphCancelled)&&(i._morphCancelled=!1,e.clone(t.position,o.position),e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right));var a=o.frustum;r.frameState.useLogDepth&&(a.near=.1,a.far=1e10);var s=n(i._completeMorph);i._completeMorph=void 0,r.camera.update(r.mode),i._scene.morphComplete.raiseEvent(i,i._previousMode,_.COLUMBUS_VIEW,s)}}g.prototype.completeMorph=function(){n(this._completeMorph)&&this._completeMorph()},g.prototype.morphTo2D=function(e,t){n(this._completeMorph)&&this._completeMorph();var i=this._scene;this._previousMode=i.mode,this._morphToOrthographic=i.camera.frustum instanceof u,this._previousMode!==_.SCENE2D&&this._previousMode!==_.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,_.SCENE2D,!0),i._mode=_.MORPHING,i.camera._setTransform(s.IDENTITY),this._previousMode===_.COLUMBUS_VIEW?A(this,e):P(this,e,t),0===e&&n(this._completeMorph)&&this._completeMorph())};var N=new e,L=new e,R=new e,V=new e,U=new e,z=new e,B=new e,H=new t,k=new s,G=new c,W=new u,Y={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};g.prototype.morphToColumbusView=function(t,i){n(this._completeMorph)&&this._completeMorph();var r=this._scene;if(this._previousMode=r.mode,this._previousMode!==_.COLUMBUS_VIEW&&this._previousMode!==_.MORPHING){this._scene.morphStart.raiseEvent(this,this._previousMode,_.COLUMBUS_VIEW,!0),r.camera._setTransform(s.IDENTITY);var o=N,u=L,l=R;if(t>0)o.x=0,o.y=-1,o.z=1,o=e.multiplyByScalar(e.normalize(o,o),5*i.maximumRadius,o),e.negate(e.normalize(o,u),u),e.cross(e.UNIT_X,u,l);else{var c=r.camera;if(this._previousMode===_.SCENE2D)e.clone(c.position,o),o.z=c.frustum.right-c.frustum.left,e.negate(e.UNIT_Z,u),e.clone(e.UNIT_Y,l);else{e.clone(c.positionWC,o),e.clone(c.directionWC,u),e.clone(c.upWC,l);var d=i.scaleToGeodeticSurface(o,B),h=m.eastNorthUpToFixedFrame(d,i,k);s.inverseTransformation(h,h),r.mapProjection.project(i.cartesianToCartographic(o,H),o),s.multiplyByPointAsVector(h,u,u),s.multiplyByPointAsVector(h,l,l)}}var p;this._morphToOrthographic?(p=W,p.width=r.camera.frustum.right-r.camera.frustum.left,p.aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight):(p=G,p.aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight,p.fov=a.toRadians(60));var g=Y;g.position=o,g.direction=u,g.up=l,g.frustum=p;var y=F(g);v(this,y),this._previousMode===_.SCENE2D?b(this,t,g,y):(g.position2D=s.multiplyByPoint(f.TRANSFORM_2D,o,V),g.direction2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,u,U),g.up2D=s.multiplyByPointAsVector(f.TRANSFORM_2D,l,z),r._mode=_.MORPHING,D(this,t,g,y)),0===t&&n(this._completeMorph)&&this._completeMorph()}};var j={position:new e,direction:new e,up:new e,frustum:void 0},X=new c;g.prototype.morphTo3D=function(t,i){n(this._completeMorph)&&this._completeMorph();var r=this._scene;if(this._previousMode=r.mode,this._previousMode!==_.SCENE3D&&this._previousMode!==_.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,_.SCENE3D,!0),r._mode=_.MORPHING,r.camera._setTransform(s.IDENTITY),this._previousMode===_.SCENE2D)C(this,t,i);else{var o;t>0?(o=j,e.fromDegrees(0,0,5*i.maximumRadius,i,o.position),e.negate(o.position,o.direction),e.normalize(o.direction,o.direction),e.clone(e.UNIT_Z,o.up)):o=w(this,i);var l,c=r.camera;c.frustum instanceof u?l=c.frustum.clone():(l=X,l.aspectRatio=r.drawingBufferWidth/r.drawingBufferHeight,l.fov=a.toRadians(60)),o.frustum=l;var d=O(o);v(this,d),x(this,t,o,d)}0===t&&n(this._completeMorph)&&this._completeMorph()}},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return y(this),r(this)};var Q=new t,q=new e,Z=new s,K=new e,J=new e,$=new e,ee=new e,te=new e,ie=new e,ne=new u,re=new e,oe=new e,ae=new e,se=new e,ue=new e,le=new e,ce=new e,de=new e,he=new e,pe=new e,me=new e,fe=new e,_e=new l,ge=new d,ve=new e,ye={position:void 0,direction:void 0,up:void 0,frustum:void 0},we=new t,xe={position:new e,direction:new e,up:new e,position2D:new e,direction2D:new e,up2D:new e,frustum:new l},Ce={position:new e,direction:new e,up:new e,frustum:void 0},Te=new e,Ee=new d,Ae=new s,Pe=new e;return g}.apply(t,n))&&(e.exports=r)},2187:function(e,t,i){var n,r;n=[i(17),i(10),i(41),i(24),i(1),i(0),i(21),i(3),i(23),i(761),i(157),i(62),i(298),i(9),i(40),i(20),i(289),i(79),i(59),i(186),i(50),i(2188),i(1974),i(1955),i(46),i(427),i(762)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P){"use strict";function S(i){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=C.LEFT_DRAG,this.zoomEventTypes=[C.RIGHT_DRAG,C.WHEEL,C.PINCH],this.rotateEventTypes=C.LEFT_DRAG,this.tiltEventTypes=[C.MIDDLE_DRAG,C.PINCH,{eventType:C.LEFT_DRAG,modifier:h.CTRL},{eventType:C.RIGHT_DRAG,modifier:h.CTRL}],this.lookEventTypes={eventType:C.LEFT_DRAG,modifier:h.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=i,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new x(i.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._tweens=new P,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new e(-1,-1),this._tiltCenter=new t,this._rotateMousePosition=new e(-1,-1),this._rotateStartPosition=new t,this._strafeStartPosition=new t,this._zoomMouseStart=new e(-1,-1),this._zoomWorldPosition=new t,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._rotatingZoom=!1;var r=i.mapProjection;this._maxCoord=r.project(new n(Math.PI,p.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3}function b(e,t){if(e<0)return 0;var i=25*(1-t);return Math.exp(-i*e)}function D(t){return e.equalsEpsilon(t.startPosition,t.endPosition,p.EPSILON14)}function I(t,i,n,r,a,s,u){var l=s[u];o(l)||(l=s[u]={startPosition:new e,endPosition:new e,motion:new e,active:!1});var c=t.getButtonPressTime(i,n),d=t.getButtonReleaseTime(i,n),h=c&&d&&(d.getTime()-c.getTime())/1e3,p=new Date,m=d&&(p.getTime()-d.getTime())/1e3;if(c&&d&&h<te){var f=b(m,r);if(l.active)l.startPosition=e.clone(l.endPosition,l.startPosition),l.endPosition=e.multiplyByScalar(l.motion,f,l.endPosition),l.endPosition=e.add(l.startPosition,l.endPosition,l.endPosition),l.motion=e.clone(e.ZERO,l.motion);else{var _=t.getLastMovement(i,n);if(!o(_)||D(_))return;l.motion.x=.5*(_.endPosition.x-_.startPosition.x),l.motion.y=.5*(_.endPosition.y-_.startPosition.y),l.startPosition=e.clone(_.startPosition,l.startPosition),l.endPosition=e.multiplyByScalar(l.motion,f,l.endPosition),l.endPosition=e.add(l.startPosition,l.endPosition,l.endPosition),l.active=!0}if(isNaN(l.endPosition.x)||isNaN(l.endPosition.y)||e.distance(l.startPosition,l.endPosition)<.5)return void(l.active=!1);if(!t.isButtonDown(i,n)){a(s,t.getStartMousePosition(i,n),l)}}else l.active=!1}function O(e,t,i,n,r,a){if(o(i)){var s=e._aggregator;d(i)||(ie[0]=i,i=ie);for(var u=i.length,l=0;l<u;++l){var c=i[l],h=o(c.eventType)?c.eventType:c,p=c.modifier,m=s.isMoving(h,p)&&s.getMovement(h,p),f=s.getStartMousePosition(h,p);e.enableInputs&&t&&(m?n(e,f,m):r<1&&I(s,h,p,r,n,e,a))}}}function M(i,n,r,a,s,u){var l=1;o(u)&&(l=p.clamp(Math.abs(u),.25,1));var c=i.minimumZoomDistance*l,d=i.maximumZoomDistance,h=s-c,m=a*h;m=p.clamp(m,i._minimumZoomRate,i._maximumZoomRate);var f=r.endPosition.y-r.startPosition.y,g=f/i._scene.canvas.clientHeight;g=Math.min(g,i.maximumMovementRatio);var v=m*g;if(!(v>0&&Math.abs(s-c)<1||v<0&&Math.abs(s-d)<1)){s-v<c?v=s-c-1:s-v>d&&(v=s-d);var y=i._scene,w=y.camera,x=y.mode,C=Pe.orientation;if(C.heading=w.heading,C.pitch=w.pitch,C.roll=w.roll,w.frustum instanceof _)return void(Math.abs(v)>0&&(w.zoomIn(v),w._adjustOrthographicFrustum()));var T,P=e.equals(n,i._zoomMouseStart),S=i._zoomingOnVector,b=i._rotatingZoom;if(P||(i._zoomMouseStart=e.clone(n,i._zoomMouseStart),o(i._globe)&&(x===E.SCENE2D?(T=w.getPickRay(n,ne).origin,T=t.fromElements(T.y,T.z,T.x)):T=U(i,n,re)),o(T)?(i._useZoomWorldPosition=!0,i._zoomWorldPosition=t.clone(T,i._zoomWorldPosition)):i._useZoomWorldPosition=!1,S=i._zoomingOnVector=!1,b=i._rotatingZoom=!1),!i._useZoomWorldPosition)return void w.zoomIn(v);var D=x===E.COLUMBUS_VIEW;if(w.positionCartographic.height<2e6&&(b=!0),!P||b){if(x===E.SCENE2D){var I=i._zoomWorldPosition,O=w.position;if(!t.equals(I,O)&&w.positionCartographic.height<2*i._maxCoord.x){var M=w.position.x,F=t.subtract(I,O,ae);t.normalize(F,F);var N=t.distance(I,O)*v/(.5*w.getMagnitude());w.move(F,.5*N),(w.position.x<0&&M>0||w.position.x>0&&M<0)&&(T=w.getPickRay(n,ne).origin,T=t.fromElements(T.y,T.z,T.x),i._zoomWorldPosition=t.clone(T,i._zoomWorldPosition))}}else if(x===E.SCENE3D){var L=t.normalize(w.position,he);if(w.positionCartographic.height<3e3&&Math.abs(t.dot(w.direction,L))<.6)D=!0;else{var R=y.canvas,V=se;V.x=R.clientWidth/2,V.y=R.clientHeight/2;var z=U(i,V,ue);if(o(z)&&w.positionCartographic.height<1e6){var B=me;t.clone(w.position,B);var H=i._zoomWorldPosition,k=pe;if(k=t.normalize(H,k),t.dot(k,L)<0)return;var G=Ce,W=ge;t.clone(w.direction,W),t.add(B,t.multiplyByScalar(W,1e3,Te),G);var Y=ve,j=ye;t.subtract(H,B,Y),t.normalize(Y,j);var X=t.dot(L,j);if(X>=0)return void(i._zoomMouseStart.x=-1);var Q=Math.acos(-X),q=t.magnitude(B),Z=t.magnitude(H),K=q-v,J=t.magnitude(Y),$=Math.asin(p.clamp(J/Z*Math.sin(Q),-1,1)),ee=Math.asin(p.clamp(K/Z*Math.sin(Q),-1,1)),te=$-ee+Q,ie=fe;t.normalize(B,ie);var Se=_e;Se=t.cross(j,ie,Se),Se=t.normalize(Se,Se),t.normalize(t.cross(ie,Se,Te),W),t.multiplyByScalar(t.normalize(G,Te),t.magnitude(G)-v,G),t.normalize(B,B),t.multiplyByScalar(B,K,B);var be=we;t.multiplyByScalar(t.add(t.multiplyByScalar(ie,Math.cos(te)-1,Ee),t.multiplyByScalar(W,Math.sin(te),Ae),Te),K,be),t.add(B,be,B),t.normalize(G,ie),t.normalize(t.cross(ie,Se,Te),W);var De=xe;return t.multiplyByScalar(t.add(t.multiplyByScalar(ie,Math.cos(te)-1,Ee),t.multiplyByScalar(W,Math.sin(te),Ae),Te),t.magnitude(G),De),t.add(G,De,G),t.clone(B,w.position),t.normalize(t.subtract(G,B,Te),w.direction),t.clone(w.direction,w.direction),t.cross(w.direction,w.up,w.right),t.cross(w.right,w.direction,w.up),void w.setView(Pe)}if(o(z)){var Ie=t.normalize(z,le),Oe=t.normalize(i._zoomWorldPosition,ce),Me=t.dot(Oe,Ie);if(Me>0&&Me<1){var Fe=p.acosClamped(Me),Ne=t.cross(Oe,Ie,de),Le=Math.abs(Fe)>p.toRadians(20)?.75*w.positionCartographic.height:w.positionCartographic.height-v,Re=v/Le;w.rotate(Ne,Fe*Re)}}else D=!0}}i._rotatingZoom=!D}if(!P&&D||S){var Ve,Ue=A.wgs84ToWindowCoordinates(y,i._zoomWorldPosition,oe);Ve=x!==E.COLUMBUS_VIEW&&e.equals(n,i._zoomMouseStart)&&o(Ue)?w.getPickRay(Ue,ne):w.getPickRay(n,ne);var ze=Ve.direction;x!==E.COLUMBUS_VIEW&&x!==E.SCENE2D||t.fromElements(ze.y,ze.z,ze.x,ze),w.move(ze,v),i._zoomingOnVector=!0}else w.zoomIn(v);w.setView(Pe)}}function F(e,i,n){var r=e._scene,o=r.camera,a=o.getPickRay(n.startPosition,Se).origin,s=o.getPickRay(n.endPosition,be).origin;a=t.fromElements(a.y,a.z,a.x,a),s=t.fromElements(s.y,s.z,s.x,s);var u=t.subtract(a,s,De),l=t.magnitude(u);l>0&&(t.normalize(u,u),o.move(u,l))}function N(e,t,i){o(i.distance)&&(i=i.distance);var n=e._scene,r=n.camera;M(e,t,i,e._zoomFactor,r.getMagnitude())}function L(t,i,n){if(o(n.angleAndHeight))return void R(t,i,n.angleAndHeight);var r=t._scene,a=r.camera,s=r.canvas,u=s.clientWidth,l=s.clientHeight,c=Ie;c.x=2/u*n.startPosition.x-1,c.y=2/l*(l-n.startPosition.y)-1,c=e.normalize(c,c);var d=Oe;d.x=2/u*n.endPosition.x-1,d.y=2/l*(l-n.endPosition.y)-1,d=e.normalize(d,d);var h=p.acosClamped(c.x);c.y<0&&(h=p.TWO_PI-h);var m=p.acosClamped(d.x);d.y<0&&(m=p.TWO_PI-m);var f=m-h;a.twistRight(f)}function R(e,t,i){var n=e._rotateFactor*e._rotateRateRangeAdjustment;n>e._maximumRotateRate&&(n=e._maximumRotateRate),n<e._minimumRotateRate&&(n=e._minimumRotateRate);var r=e._scene,o=r.camera,a=r.canvas,s=(i.endPosition.x-i.startPosition.x)/a.clientWidth;s=Math.min(s,e.maximumMovementRatio);var u=n*s*Math.PI*4;o.twistRight(u)}function V(e){var t=e._scene.mapMode2D===T.ROTATE;f.equals(f.IDENTITY,e._scene.camera.transform)?(O(e,e.enableTranslate,e.translateEventTypes,F,e.inertiaTranslate,"_lastInertiaTranslateMovement"),O(e,e.enableZoom,e.zoomEventTypes,N,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&O(e,e.enableRotate,e.tiltEventTypes,L,e.inertiaSpin,"_lastInertiaTiltMovement")):(O(e,e.enableZoom,e.zoomEventTypes,N,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&O(e,e.enableRotate,e.translateEventTypes,L,e.inertiaSpin,"_lastInertiaSpinMovement"))}function U(e,i,n){var r=e._scene,a=e._globe,s=r.camera;if(o(a)){var u;r.pickPositionSupported&&(u=r.pickPositionWorldCoordinates(i,Fe));var l=s.getPickRay(i,Me),c=a.pickWorldCoordinates(l,r,Ne);return(o(u)?t.distance(u,s.positionWC):Number.POSITIVE_INFINITY)<(o(c)?t.distance(c,s.positionWC):Number.POSITIVE_INFINITY)?t.clone(u,n):t.clone(c,n)}}function z(i,n,r){if(t.equals(n,i._translateMousePosition)||(i._looking=!1),t.equals(n,i._strafeMousePosition)||(i._strafing=!1),i._looking)return void $(i,n,r);if(i._strafing)return void Y(i,n,r);var a,s=i._scene,u=s.camera,l=e.clone(r.startPosition,ke),d=e.clone(r.endPosition,Ge),h=u.getPickRay(l,Le),m=t.clone(t.ZERO,Be),f=t.UNIT_X;if(u.position.z<i._minimumPickingTerrainHeight&&(a=U(i,l,Ve),o(a)&&(m.x=a.x)),m.x>u.position.z&&o(a))return t.clone(a,i._strafeStartPosition),i._strafing=!0,Y(i,n,r),void(i._strafeMousePosition=e.clone(n,i._strafeMousePosition));var _=g.fromPointNormal(m,f,He);h=u.getPickRay(l,Le);var v=c.rayPlane(h,_,Ve),y=u.getPickRay(d,Re),w=c.rayPlane(y,_,Ue);if(!o(v)||!o(w))return i._looking=!0,$(i,n,r),void e.clone(n,i._translateMousePosition);var x=t.subtract(v,w,ze),C=x.x;x.x=x.y,x.y=x.z,x.z=C;var T=t.magnitude(x);T>p.EPSILON6&&(t.normalize(x,x),u.move(x,T))}function B(t,i,n){if(o(n.angleAndHeight)&&(n=n.angleAndHeight),e.equals(i,t._tiltCenterMousePosition)||(t._tiltCVOffMap=!1,t._looking=!1),t._looking)return void $(t,i,n);var r=t._scene,a=r.camera,s=t._maxCoord,u=Math.abs(a.position.x)-s.x<0&&Math.abs(a.position.y)-s.y<0;t._tiltCVOffMap||!u||a.position.z>t._minimumPickingTerrainHeight?(t._tiltCVOffMap=!0,H(t,i,n)):k(t,i,n)}function H(i,n,r){var a=i._scene,s=a.camera,l=a.canvas,c=We;c.x=l.clientWidth/2,c.y=l.clientHeight/2;var d,h=s.getPickRay(c,Ye),m=t.UNIT_X,_=h.origin,g=h.direction,v=t.dot(m,g);if(Math.abs(v)>p.EPSILON6&&(d=-t.dot(m,_)/v),!o(d)||d<=0)return i._looking=!0,$(i,n,r),void e.clone(n,i._tiltCenterMousePosition);var y=t.multiplyByScalar(g,d,je);t.add(_,y,y);var x=a.mapProjection,C=x.ellipsoid;t.fromElements(y.y,y.z,y.x,y);var T=x.unproject(y,$e);C.cartographicToCartesian(T,y);var E=w.eastNorthUpToFixedFrame(y,C,Qe),A=i._globe,P=i._ellipsoid;i._globe=void 0,i._ellipsoid=u.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var S=f.clone(s.transform,et);s._setTransform(E),X(i,n,r,t.UNIT_Z),s._setTransform(S),i._globe=A,i._ellipsoid=P;var b=P.maximumRadius;i._rotateFactor=1/b,i._rotateRateRangeAdjustment=b}function k(i,n,r){var a,s,l=i._scene,d=l.camera,h=t.UNIT_X;if(e.equals(n,i._tiltCenterMousePosition))a=t.clone(i._tiltCenter,je);else{if(d.position.z<i._minimumPickingTerrainHeight&&(a=U(i,n,je)),!o(a)){s=d.getPickRay(n,Ye);var _,y=s.origin,x=s.direction,C=t.dot(h,x);if(Math.abs(C)>p.EPSILON6&&(_=-t.dot(h,y)/C),!o(_)||_<=0)return i._looking=!0,$(i,n,r),void e.clone(n,i._tiltCenterMousePosition);a=t.multiplyByScalar(x,_,je),t.add(y,a,a)}e.clone(n,i._tiltCenterMousePosition),t.clone(a,i._tiltCenter)}var T=l.canvas,E=We;E.x=T.clientWidth/2,E.y=i._tiltCenterMousePosition.y,s=d.getPickRay(E,Ye);var A=t.clone(t.ZERO,Ze);A.x=a.x;var P=g.fromPointNormal(A,h,Ke),S=c.rayPlane(s,P,Xe),b=d._projection,D=b.ellipsoid;t.fromElements(a.y,a.z,a.x,a);var I=b.unproject(a,$e);D.cartographicToCartesian(I,a);var O,M=w.eastNorthUpToFixedFrame(a,D,Qe);o(S)?(t.fromElements(S.y,S.z,S.x,S),I=b.unproject(S,$e),D.cartographicToCartesian(I,S),O=w.eastNorthUpToFixedFrame(S,D,qe)):O=M;var F=i._globe,N=i._ellipsoid;i._globe=void 0,i._ellipsoid=u.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var L=t.UNIT_Z,R=f.clone(d.transform,et);d._setTransform(M);var V=t.cross(t.UNIT_Z,t.normalize(d.position,Je),Je),z=t.dot(d.right,V);if(X(i,n,r,L,!1,!0),d._setTransform(O),z<0){r.startPosition.y>r.endPosition.y&&(L=void 0);var B=d.constrainedAxis;d.constrainedAxis=void 0,X(i,n,r,L,!0,!1),d.constrainedAxis=B}else X(i,n,r,L,!0,!1);if(o(d.constrainedAxis)){var H=t.cross(d.direction,d.constrainedAxis,nt);t.equalsEpsilon(H,t.ZERO,p.EPSILON6)||(t.dot(H,d.right)<0&&t.negate(H,H),t.cross(H,d.direction,d.up),t.cross(d.direction,d.up,d.right),t.normalize(d.up,d.up),t.normalize(d.right,d.right))}d._setTransform(R),i._globe=F,i._ellipsoid=N;var k=N.maximumRadius;i._rotateFactor=1/k,i._rotateRateRangeAdjustment=k;var G=t.clone(d.positionWC,Je);if(d._adjustHeightForTerrain(),!t.equals(d.positionWC,G)){d._setTransform(O),d.worldToCameraCoordinatesPoint(G,G);var W=t.magnitudeSquared(G);t.magnitudeSquared(d.position)>W&&(t.normalize(d.position,d.position),t.multiplyByScalar(d.position,Math.sqrt(W),d.position));var Y=t.angleBetween(G,d.position),j=t.cross(G,d.position,G);t.normalize(j,j);var Q=v.fromAxisAngle(j,Y,tt),q=m.fromQuaternion(Q,it);m.multiplyByVector(q,d.direction,d.direction),m.multiplyByVector(q,d.up,d.up),t.cross(d.direction,d.up,d.right),t.cross(d.right,d.direction,d.up),d._setTransform(R)}}function G(e,i,n){o(n.distance)&&(n=n.distance);var r=e._scene,a=r.camera,s=r.canvas,u=rt;u.x=s.clientWidth/2,u.y=s.clientHeight/2;var l,c=a.getPickRay(u,ot);a.position.z<e._minimumPickingTerrainHeight&&(l=U(e,u,at));var d;if(o(l))d=t.distance(c.origin,l);else{var h=t.UNIT_X,p=c.origin,m=c.direction;d=-t.dot(h,p)/t.dot(h,m)}M(e,i,n,e._zoomFactor,d)}function W(e){var t=e._scene,i=t.camera;if(f.equals(f.IDENTITY,i.transform)){var n=e._tweens;if(e._aggregator.anyButtonDown&&n.removeAll(),O(e,e.enableTilt,e.tiltEventTypes,B,e.inertiaSpin,"_lastInertiaTiltMovement"),O(e,e.enableTranslate,e.translateEventTypes,z,e.inertiaTranslate,"_lastInertiaTranslateMovement"),O(e,e.enableZoom,e.zoomEventTypes,G,e.inertiaZoom,"_lastInertiaZoomMovement"),O(e,e.enableLook,e.lookEventTypes,$),!(e._aggregator.anyButtonDown||o(e._lastInertiaZoomMovement)&&e._lastInertiaZoomMovement.active||o(e._lastInertiaTranslateMovement)&&e._lastInertiaTranslateMovement.active||n.contains(e._tween))){var r=i.createCorrectPositionTween(e.bounceAnimationTime);o(r)&&(e._tween=n.add(r))}n.update()}else O(e,e.enableRotate,e.rotateEventTypes,X,e.inertiaSpin,"_lastInertiaSpinMovement"),O(e,e.enableZoom,e.zoomEventTypes,q,e.inertiaZoom,"_lastInertiaZoomMovement")}function Y(e,i,n){var r=e._scene,a=r.camera,s=U(e,n.startPosition,dt);if(o(s)){var u=n.endPosition,l=a.getPickRay(u,st),d=t.clone(a.direction,ct);r.mode===E.COLUMBUS_VIEW&&t.fromElements(d.z,d.x,d.y,d);var h=g.fromPointNormal(s,d,ut),p=c.rayPlane(l,h,lt);o(p)&&(d=t.subtract(s,p,d),r.mode===E.COLUMBUS_VIEW&&t.fromElements(d.y,d.z,d.x,d),t.add(a.position,d,a.position))}}function j(i,n,r){var a=i._scene,s=a.camera;if(!f.equals(s.transform,f.IDENTITY))return void X(i,n,r);var l,c,d,h,p=i._ellipsoid.geodeticSurfaceNormal(s.position,_t),m=i._ellipsoid.cartesianToCartographic(s.positionWC,pt).height,_=i._globe,g=!1;if(o(_)&&m<i._minimumPickingTerrainHeight&&(h=U(i,r.startPosition,dt),o(h))){var v=s.getPickRay(r.startPosition,Me),y=i._ellipsoid.geodeticSurfaceNormal(h);g=Math.abs(t.dot(v.direction,y))<.05,g&&!i._looking&&(i._rotating=!1,i._strafing=!0)}if(e.equals(n,i._rotateMousePosition))return void(i._looking?$(i,n,r,p):i._rotating?X(i,n,r):i._strafing?(t.clone(h,i._strafeStartPosition),Y(i,n,r)):(l=t.magnitude(i._rotateStartPosition),c=mt,c.x=c.y=c.z=l,d=u.fromCartesian3(c,ft),Q(i,n,r,d)));i._looking=!1,i._rotating=!1,i._strafing=!1,o(_)&&m<i._minimumPickingTerrainHeight?o(h)?t.magnitude(s.position)<t.magnitude(h)?(t.clone(h,i._strafeStartPosition),i._strafing=!0,Y(i,n,r)):(l=t.magnitude(h),c=mt,c.x=c.y=c.z=l,d=u.fromCartesian3(c,ft),Q(i,n,r,d),t.clone(h,i._rotateStartPosition)):(i._looking=!0,$(i,n,r,p)):o(s.pickEllipsoid(r.startPosition,i._ellipsoid,ht))?(Q(i,n,r,i._ellipsoid),t.clone(ht,i._rotateStartPosition)):m>i._minimumTrackBallHeight?(i._rotating=!0,X(i,n,r)):(i._looking=!0,$(i,n,r,p)),e.clone(n,i._rotateMousePosition)}function X(e,i,n,a,s,u){s=r(s,!1),u=r(u,!1);var l=e._scene,c=l.camera,d=l.canvas,h=c.constrainedAxis;o(a)&&(c.constrainedAxis=a);var p=t.magnitude(c.position),m=e._rotateFactor*(p-e._rotateRateRangeAdjustment);m>e._maximumRotateRate&&(m=e._maximumRotateRate),m<e._minimumRotateRate&&(m=e._minimumRotateRate);var f=(n.startPosition.x-n.endPosition.x)/d.clientWidth,_=(n.startPosition.y-n.endPosition.y)/d.clientHeight;f=Math.min(f,e.maximumMovementRatio),_=Math.min(_,e.maximumMovementRatio);var g=m*f*Math.PI*2,v=m*_*Math.PI;s||c.rotateRight(g),u||c.rotateUp(v),c.constrainedAxis=h}function Q(i,n,r,a){var s=i._scene,u=s.camera,l=e.clone(r.startPosition,Tt),c=e.clone(r.endPosition,Et),d=u.pickEllipsoid(l,a,gt),h=u.pickEllipsoid(c,a,vt);if(!o(d)||!o(h))return i._rotating=!0,void X(i,n,r);if(d=u.worldToCameraCoordinates(d,d),h=u.worldToCameraCoordinates(h,h),o(u.constrainedAxis)){var m=u.constrainedAxis,f=t.mostOrthogonalAxis(m,yt);t.cross(f,m,f),t.normalize(f,f);var _=t.cross(m,f,wt),g=t.magnitude(d),v=t.dot(m,d),y=Math.acos(v/g),w=t.multiplyByScalar(m,v,xt);t.subtract(d,w,w),t.normalize(w,w);var x=t.magnitude(h),C=t.dot(m,h),T=Math.acos(C/x),E=t.multiplyByScalar(m,C,Ct);t.subtract(h,E,E),t.normalize(E,E);var A=Math.acos(t.dot(w,f));t.dot(w,_)<0&&(A=p.TWO_PI-A);var P=Math.acos(t.dot(E,f));t.dot(E,_)<0&&(P=p.TWO_PI-P);var S,b=A-P;S=t.equalsEpsilon(m,u.position,p.EPSILON2)?u.right:t.cross(m,u.position,yt);var D,I=t.cross(m,S,yt),O=t.dot(I,t.subtract(d,m,wt)),M=t.dot(I,t.subtract(h,m,wt));D=O>0&&M>0?T-y:O>0&&M<=0?t.dot(u.position,m)>0?-y-T:y+T:y-T,u.rotateRight(b),u.rotateUp(D)}else{t.normalize(d,d),t.normalize(h,h);var F=t.dot(d,h),N=t.cross(d,h,yt);if(F<1&&!t.equalsEpsilon(N,t.ZERO,p.EPSILON14)){var L=Math.acos(F);u.rotate(N,L)}}}function q(e,i,n){o(n.distance)&&(n=n.distance);var r=e._ellipsoid,a=e._scene,s=a.camera,u=a.canvas,l=rt;l.x=u.clientWidth/2,l.y=u.clientHeight/2;var c,d=s.getPickRay(l,ot),h=r.cartesianToCartographic(s.position,Pt).height;h<e._minimumPickingTerrainHeight&&(c=U(e,l,at));var p;p=o(c)?t.distance(d.origin,c):h;var m=t.normalize(s.position,At);M(e,i,n,e._zoomFactor,p,t.dot(m,s.direction))}function Z(t,i,n){var r=t._scene,a=r.camera;if(f.equals(a.transform,f.IDENTITY)){if(o(n.angleAndHeight)&&(n=n.angleAndHeight),e.equals(i,t._tiltCenterMousePosition)||(t._tiltOnEllipsoid=!1,t._looking=!1),t._looking){return void $(t,i,n,t._ellipsoid.geodeticSurfaceNormal(a.position,Vt))}var s=t._ellipsoid,u=s.cartesianToCartographic(a.position,Rt);t._tiltOnEllipsoid||u.height>t._minimumCollisionTerrainHeight?(t._tiltOnEllipsoid=!0,K(t,i,n)):J(t,i,n)}}function K(i,n,r){var a=i._ellipsoid,s=i._scene,l=s.camera,d=.25*i.minimumZoomDistance,h=a.cartesianToCartographic(l.positionWC,Ut).height;if(!(h-d-1<p.EPSILON3&&r.endPosition.y-r.startPosition.y<0)){var m=s.canvas,_=St;_.x=m.clientWidth/2,_.y=m.clientHeight/2;var g,v=l.getPickRay(_,bt),x=c.rayEllipsoid(v,a);if(o(x))g=y.getPoint(v,x.start,Dt);else{if(!(h>i._minimumTrackBallHeight)){i._looking=!0;return $(i,n,r,i._ellipsoid.geodeticSurfaceNormal(l.position,Vt)),void e.clone(n,i._tiltCenterMousePosition)}var C=c.grazingAltitudeLocation(v,a);if(!o(C))return;var T=a.cartesianToCartographic(C,Rt);T.height=0,g=a.cartographicToCartesian(T,Dt)}var E=w.eastNorthUpToFixedFrame(g,a,Ot),A=i._globe,P=i._ellipsoid;i._globe=void 0,i._ellipsoid=u.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var S=f.clone(l.transform,Ft);l._setTransform(E),X(i,n,r,t.UNIT_Z),l._setTransform(S),i._globe=A,i._ellipsoid=P;var b=P.maximumRadius;i._rotateFactor=1/b,i._rotateRateRangeAdjustment=b}}function J(i,n,r){var a,s,l,d=i._ellipsoid,h=i._scene,_=h.camera;if(e.equals(n,i._tiltCenterMousePosition))a=t.clone(i._tiltCenter,Dt);else{if(a=U(i,n,Dt),!o(a)){if(s=_.getPickRay(n,bt),l=c.rayEllipsoid(s,d),!o(l)){if(d.cartesianToCartographic(_.position,Rt).height<=i._minimumTrackBallHeight){i._looking=!0;$(i,n,r,i._ellipsoid.geodeticSurfaceNormal(_.position,Vt)),e.clone(n,i._tiltCenterMousePosition)}return}a=y.getPoint(s,l.start,Dt)}e.clone(n,i._tiltCenterMousePosition),t.clone(a,i._tiltCenter)}var g=h.canvas,x=St;x.x=g.clientWidth/2,x.y=i._tiltCenterMousePosition.y,s=_.getPickRay(x,bt);var C=t.magnitude(a),T=t.fromElements(C,C,C,mt),E=u.fromCartesian3(T,ft);if(l=c.rayEllipsoid(s,E),o(l)){var A=t.magnitude(s.origin)>C?l.start:l.stop,P=y.getPoint(s,A,It),S=w.eastNorthUpToFixedFrame(a,d,Ot),b=w.eastNorthUpToFixedFrame(P,E,Mt),D=i._globe,I=i._ellipsoid;i._globe=void 0,i._ellipsoid=u.UNIT_SPHERE,i._rotateFactor=1,i._rotateRateRangeAdjustment=1;var O=t.UNIT_Z,M=f.clone(_.transform,Ft);_._setTransform(S);var F=t.cross(P,_.positionWC,nt),N=t.dot(_.rightWC,F);if(X(i,n,r,O,!1,!0),_._setTransform(b),N<0){r.startPosition.y>r.endPosition.y&&(O=void 0);var L=_.constrainedAxis;_.constrainedAxis=void 0,X(i,n,r,O,!0,!1),_.constrainedAxis=L}else X(i,n,r,O,!0,!1);if(o(_.constrainedAxis)){var R=t.cross(_.direction,_.constrainedAxis,nt);t.equalsEpsilon(R,t.ZERO,p.EPSILON6)||(t.dot(R,_.right)<0&&t.negate(R,R),t.cross(R,_.direction,_.up),t.cross(_.direction,_.up,_.right),t.normalize(_.up,_.up),t.normalize(_.right,_.right))}_._setTransform(M),i._globe=D,i._ellipsoid=I;var V=I.maximumRadius;i._rotateFactor=1/V,i._rotateRateRangeAdjustment=V;var z=t.clone(_.positionWC,nt);if(_._adjustHeightForTerrain(),!t.equals(_.positionWC,z)){_._setTransform(b),_.worldToCameraCoordinatesPoint(z,z);var B=t.magnitudeSquared(z);t.magnitudeSquared(_.position)>B&&(t.normalize(_.position,_.position),t.multiplyByScalar(_.position,Math.sqrt(B),_.position));var H=t.angleBetween(z,_.position),k=t.cross(z,_.position,z);t.normalize(k,k);var G=v.fromAxisAngle(k,H,Nt),W=m.fromQuaternion(G,Lt);m.multiplyByVector(W,_.direction,_.direction),m.multiplyByVector(W,_.up,_.up),t.cross(_.direction,_.up,_.right),t.cross(_.right,_.direction,_.up),_._setTransform(M)}}}function $(e,i,n,a){var s=e._scene,u=s.camera,l=zt;l.x=n.startPosition.x,l.y=0;var c=Bt;c.x=n.endPosition.x,c.y=0;var d,h,m=u.getPickRay(l,Ht),f=u.getPickRay(c,kt),g=0;u.frustum instanceof _?(d=m.origin,h=f.origin,t.add(u.direction,d,d),t.add(u.direction,h,h),t.subtract(d,u.position,d),t.subtract(h,u.position,h),t.normalize(d,d),t.normalize(h,h)):(d=m.direction,h=f.direction);var v=t.dot(d,h);v<1&&(g=Math.acos(v)),g=n.startPosition.x>n.endPosition.x?-g:g;var y=e._horizontalRotationAxis;if(o(a)?u.look(a,-g):o(y)?u.look(y,-g):u.lookLeft(g),l.x=0,l.y=n.startPosition.y,c.x=0,c.y=n.endPosition.y,m=u.getPickRay(l,Ht),f=u.getPickRay(c,kt),g=0,u.frustum instanceof _?(d=m.origin,h=f.origin,t.add(u.direction,d,d),t.add(u.direction,h,h),t.subtract(d,u.position,d),t.subtract(h,u.position,h),t.normalize(d,d),t.normalize(h,h)):(d=m.direction,h=f.direction),v=t.dot(d,h),v<1&&(g=Math.acos(v)),g=n.startPosition.y>n.endPosition.y?-g:g,a=r(a,y),o(a)){var w=u.direction,x=t.negate(a,Gt),C=t.equalsEpsilon(w,a,p.EPSILON2),T=t.equalsEpsilon(w,x,p.EPSILON2);if(C||T)(C&&g<0||T&&g>0)&&u.look(u.right,-g);else{v=t.dot(w,a);var E=p.acosClamped(v);g>0&&g>E&&(g=E-p.EPSILON4),v=t.dot(w,x),E=p.acosClamped(v),g<0&&-g>E&&(g=-E+p.EPSILON4);var A=t.cross(a,w,Wt);u.look(A,g)}}else u.lookUp(g)}function ee(e){O(e,e.enableRotate,e.rotateEventTypes,j,e.inertiaSpin,"_lastInertiaSpinMovement"),O(e,e.enableZoom,e.zoomEventTypes,q,e.inertiaZoom,"_lastInertiaZoomMovement"),O(e,e.enableTilt,e.tiltEventTypes,Z,e.inertiaSpin,"_lastInertiaTiltMovement"),O(e,e.enableLook,e.lookEventTypes,$)}var te=.4,ie=[],ne=new y,re=new t,oe=new e,ae=new t,se=new e,ue=new t,le=new t,ce=new t,de=new t,he=new t,pe=new t,me=new t,fe=new t,_e=new t,ge=new t,ve=new t,ye=new t,we=new t,xe=new t,Ce=new t,Te=new t,Ee=new t,Ae=new t,Pe={orientation:new l},Se=new y,be=new y,De=new t,Ie=new e,Oe=new e,Me=new y,Fe=new t,Ne=new t,Le=new y,Re=new y,Ve=new t,Ue=new t,ze=new t,Be=new t,He=new g(t.UNIT_X,0),ke=new e,Ge=new e,We=new e,Ye=new y,je=new t,Xe=new t,Qe=new f,qe=new f,Ze=new t,Ke=new g(t.UNIT_X,0),Je=new t,$e=new n,et=new f,tt=new v,it=new m,nt=new t,rt=new e,ot=new y,at=new t,st=new y,ut=new g(t.UNIT_X,0),lt=new t,ct=new t,dt=new t,ht=new t,pt=new n,mt=new t,ft=new u,_t=new t,gt=i.clone(i.UNIT_W),vt=i.clone(i.UNIT_W),yt=new t,wt=new t,xt=new t,Ct=new t,Tt=new e,Et=new e,At=new t,Pt=new n,St=new e,bt=new y,Dt=new t,It=new t,Ot=new f,Mt=new f,Ft=new f,Nt=new v,Lt=new m,Rt=new n,Vt=new t,Ut=new n,zt=new e,Bt=new e,Ht=new y,kt=new y,Gt=new t,Wt=new t;return S.prototype.update=function(){f.equals(this._scene.camera.transform,f.IDENTITY)?(this._globe=this._scene.globe,this._ellipsoid=o(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=u.UNIT_SPHERE),this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration,this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e,this._rotateRateRangeAdjustment=e;var i=this._scene,n=i.mode;n===E.SCENE2D?V(this):n===E.COLUMBUS_VIEW?(this._horizontalRotationAxis=t.UNIT_Z,W(this)):n===E.SCENE3D&&(this._horizontalRotationAxis=void 0,ee(this)),this._aggregator.reset()},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),a(this)},S}.apply(t,n))&&(e.exports=r)},2188:function(e,t,i){var n,r;n=[i(17),i(0),i(2),i(21),i(3),i(298),i(9),i(432),i(222),i(1974)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l){"use strict";function c(e,i){var n=e;return t(i)&&(n+="+"+i),n}function d(t,i){e.clone(t.distance.startPosition,i.distance.startPosition),e.clone(t.distance.endPosition,i.distance.endPosition),e.clone(t.angleAndHeight.startPosition,i.angleAndHeight.startPosition),e.clone(t.angleAndHeight.endPosition,i.angleAndHeight.endPosition)}function h(i,n,r){var o=c(l.PINCH,n),a=i._update,s=i._isDown,h=i._eventStartPosition,p=i._pressTime,m=i._releaseTime;a[o]=!0,s[o]=!1,h[o]=new e;var f=i._movement[o];t(f)||(f=i._movement[o]={}),f.distance={startPosition:new e,endPosition:new e},f.angleAndHeight={startPosition:new e,endPosition:new e},f.prevAngle=0,i._eventHandler.setInputAction(function(t){i._buttonsDown++,s[o]=!0,p[o]=new Date,e.lerp(t.position1,t.position2,.5,h[o])},u.PINCH_START,n),i._eventHandler.setInputAction(function(){i._buttonsDown=Math.max(i._buttonsDown-1,0),s[o]=!1,m[o]=new Date},u.PINCH_END,n),i._eventHandler.setInputAction(function(t){if(s[o]){a[o]?(d(t,f),a[o]=!1,f.prevAngle=f.angleAndHeight.startPosition.x):(e.clone(t.distance.endPosition,f.distance.endPosition),e.clone(t.angleAndHeight.endPosition,f.angleAndHeight.endPosition));for(var i=f.angleAndHeight.endPosition.x,n=f.prevAngle,u=2*Math.PI;i>=n+Math.PI;)i-=u;for(;i<n-Math.PI;)i+=u;f.angleAndHeight.endPosition.x=-i*r.clientWidth/12,f.angleAndHeight.startPosition.x=-n*r.clientWidth/12}},u.PINCH_MOVE,n)}function p(i,n){var r=c(l.WHEEL,n),o=i._update;o[r]=!0;var s=i._movement[r];t(s)||(s=i._movement[r]={}),s.startPosition=new e,s.endPosition=new e,i._eventHandler.setInputAction(function(t){var i=15*a.toRadians(t);o[r]?(e.clone(e.ZERO,s.startPosition),s.endPosition.x=0,s.endPosition.y=i,o[r]=!1):s.endPosition.y=s.endPosition.y+i},u.WHEEL,n)}function m(i,n,r){var o=c(r,n),a=i._isDown,s=i._eventStartPosition,d=i._pressTime,h=i._releaseTime;a[o]=!1,s[o]=new e;var p=i._lastMovement[o];t(p)||(p=i._lastMovement[o]={startPosition:new e,endPosition:new e,valid:!1});var m,f;r===l.LEFT_DRAG?(m=u.LEFT_DOWN,f=u.LEFT_UP):r===l.RIGHT_DRAG?(m=u.RIGHT_DOWN,f=u.RIGHT_UP):r===l.MIDDLE_DRAG&&(m=u.MIDDLE_DOWN,f=u.MIDDLE_UP),i._eventHandler.setInputAction(function(t){i._buttonsDown++,p.valid=!1,a[o]=!0,d[o]=new Date,e.clone(t.position,s[o])},m,n),i._eventHandler.setInputAction(function(){i._buttonsDown=Math.max(i._buttonsDown-1,0),a[o]=!1,h[o]=new Date},f,n)}function f(t,i){e.clone(t.startPosition,i.startPosition),e.clone(t.endPosition,i.endPosition)}function _(i,n){var r=i._update,o=i._movement,a=i._lastMovement,s=i._isDown;for(var d in l)if(l.hasOwnProperty(d)){var h=l[d];if(t(h)){var p=c(h,n);r[p]=!0,t(i._lastMovement[p])||(i._lastMovement[p]={startPosition:new e,endPosition:new e,valid:!1}),t(i._movement[p])||(i._movement[p]={startPosition:new e,endPosition:new e})}}i._eventHandler.setInputAction(function(u){for(var d in l)if(l.hasOwnProperty(d)){var h=l[d];if(t(h)){var p=c(h,n);s[p]&&(r[p]?(f(o[p],a[p]),a[p].valid=!0,f(u,o[p]),r[p]=!1):e.clone(u.endPosition,o[p].endPosition))}}e.clone(u.endPosition,i._currentMousePosition)},u.MOUSE_MOVE,n)}function g(i){this._eventHandler=new s(i,!0),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new e,p(this,void 0),h(this,void 0,i),m(this,void 0,l.LEFT_DRAG),m(this,void 0,l.RIGHT_DRAG),m(this,void 0,l.MIDDLE_DRAG),_(this,void 0);for(var n in o)if(o.hasOwnProperty(n)){var r=o[n];t(r)&&(p(this,r),h(this,r,i),m(this,r,l.LEFT_DRAG),m(this,r,l.RIGHT_DRAG),m(this,r,l.MIDDLE_DRAG),_(this,r))}}return i(g.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[c(l.WHEEL)]&&this._update[c(l.WHEEL,o.SHIFT)]&&this._update[c(l.WHEEL,o.CTRL)]&&this._update[c(l.WHEEL,o.ALT)]);return this._buttonsDown>0||e}}}),g.prototype.isMoving=function(e,t){var i=c(e,t);return!this._update[i]},g.prototype.getMovement=function(e,t){var i=c(e,t);return this._movement[i]},g.prototype.getLastMovement=function(e,t){var i=c(e,t),n=this._lastMovement[i];if(n.valid)return n},g.prototype.isButtonDown=function(e,t){var i=c(e,t);return this._isDown[i]},g.prototype.getStartMousePosition=function(e,t){if(e===l.WHEEL)return this._currentMousePosition;var i=c(e,t);return this._eventStartPosition[i]},g.prototype.getButtonPressTime=function(e,t){var i=c(e,t);return this._pressTime[i]},g.prototype.getButtonReleaseTime=function(e,t){var i=c(e,t);return this._releaseTime[i]},g.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),n(this)},g}.apply(t,n))&&(e.exports=r)},2189:function(e,t,i){var n,r;n=[i(0),i(52)],void 0!==(r=function(e,t){"use strict";function i(){}return i.getShadowCastShaderKeyword=function(e,t,i,n){return"castShadow "+e+" "+t+" "+i+" "+n},i.createShadowCastVertexShader=function(i,n,r){var o=i.defines.slice(0),a=i.sources.slice(0);o.push("SHADOW_MAP"),r&&o.push("GENERATE_POSITION");var s=t.findPositionVarying(i),u=e(s);if(n&&!u){for(var l=a.length,c=0;c<l;++c)a[c]=t.replaceMain(a[c],"czm_shadow_cast_main");a.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new t({defines:o,sources:a})},i.createShadowCastFragmentShader=function(i,n,r,o){var a=i.defines.slice(0),s=i.sources.slice(0),u=t.findPositionVarying(i),l=e(u);l||(u="v_positionEC");for(var c=s.length,d=0;d<c;++d)s[d]=t.replaceMain(s[d],"czm_shadow_cast_main");var h="";return n&&(l||(h+="varying vec3 v_positionEC; \n"),h+="uniform vec4 shadowMap_lightPositionEC; \n"),h+=o?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",h+=n?"    float distance = length("+u+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":r?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",h+="} \n",s.push(h),new t({defines:a,sources:s})},i.getShadowReceiveShaderKeyword=function(e,t,i,n){return"receiveShadow "+e._usesDepthTexture+e._polygonOffsetSupported+e._isPointLight+e._isSpotLight+(e._numberOfCascades>1)+e.debugCascadeColors+e.softShadows+t+i+n},i.createShadowReceiveVertexShader=function(e,i,n){var r=e.defines.slice(0),o=e.sources.slice(0);return r.push("SHADOW_MAP"),i&&(n?r.push("GENERATE_POSITION_AND_NORMAL"):r.push("GENERATE_POSITION")),new t({defines:r,sources:o})},i.createShadowReceiveFragmentShader=function(i,n,r,o,a){for(var s=t.findNormalVarying(i),u=!o&&e(s)||o&&a,l=t.findPositionVarying(i),c=e(l),d=n._usesDepthTexture,h=n._polygonOffsetSupported,p=n._isPointLight,m=n._isSpotLight,f=n._numberOfCascades>1,_=n.debugCascadeColors,g=n.softShadows,v=p?n._pointBias:o?n._terrainBias:n._primitiveBias,y=i.defines.slice(0),w=i.sources.slice(0),x=w.length,C=0;C<x;++C)w[C]=t.replaceMain(w[C],"czm_shadow_receive_main");p?y.push("USE_CUBE_MAP_SHADOW"):d&&y.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!p&&y.push("USE_SOFT_SHADOWS"),f&&r&&o&&(u?y.push("ENABLE_VERTEX_LIGHTING"):y.push("ENABLE_DAYNIGHT_SHADING")),r&&v.normalShading&&u&&(y.push("USE_NORMAL_SHADING"),v.normalShadingSmooth>0&&y.push("USE_NORMAL_SHADING_SMOOTH"));var T="";T+=p?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n";var E;return E=c?"    return vec4("+l+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n",T+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+E+"} \nvec3 getNormalEC() \n{ \n"+(u?"    return normalize("+s+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(v.normalOffset&&u?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",T+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",T+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",o?T+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":h||(T+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),T+=p?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":m?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":f?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(_?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",T+="    gl_FragColor.rgb *= visibility; \n} \n",w.push(T),new t({defines:y,sources:w})},i}.apply(t,n))&&(e.exports=r)},2190:function(e,t,i){var n,r;n=[i(99),i(17),i(41),i(0),i(21),i(9),i(20),i(50),i(2192),i(2191),i(1970),i(1948),i(1971),i(1972),i(1956),i(1973),i(1976)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(){this._sceneFramebuffer=new _;var e=new Array(6);e[0]=new h({fragmentShader:d,textureScale:.125,forcePowerOfTwo:!0,sampleMode:m.LINEAR});var i=e[1]=new h({fragmentShader:l,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:.125,forcePowerOfTwo:!0}),n=this;this._delta=1,this._sigma=2,this._blurStep=new t,e[2]=new h({fragmentShader:c,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:0},textureScale:.125,forcePowerOfTwo:!0}),e[3]=new h({fragmentShader:c,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:1},textureScale:.125,forcePowerOfTwo:!0}),e[4]=new h({fragmentShader:d,sampleMode:m.LINEAR}),this._uCenter=new t,this._uRadius=void 0,e[5]=new h({fragmentShader:u,uniforms:{center:function(){return n._uCenter},radius:function(){return n._uRadius},colorTexture2:function(){return n._sceneFramebuffer.getFramebuffer().getColorTexture(0)}}}),this._stages=new p({stages:e});for(var r=new f(this),o=e.length,a=0;a<o;++a)e[a]._textureCache=r;this._textureCache=r,this.length=e.length}function v(i,n,r){var u=n.uniformState,l=u.sunPositionWC,c=u.view,d=u.viewProjection,h=u.projection,p=a.computeViewportTransformation(r,0,1,C),m=a.multiplyByPoint(c,l,y),f=s.pointToGLWindowCoordinates(d,p,l,w);m.x+=o.SOLAR_RADIUS;var _=s.pointToGLWindowCoordinates(h,p,m,m),g=30*t.magnitude(t.subtract(_,f,_))*2,v=x;v.x=g,v.y=g,i._uCenter=t.clone(f,i._uCenter),i._uRadius=.15*Math.max(v.x,v.y);var T=n.drawingBufferWidth,E=n.drawingBufferHeight,A=i._stages,P=A.get(0),S=P.outputTexture.width,b=P.outputTexture.height,D=new e;D.width=S,D.height=b,p=a.computeViewportTransformation(D,0,1,C),f=s.pointToGLWindowCoordinates(d,p,l,w),v.x*=S/T,v.y*=b/E;var I=P.scissorRectangle;I.x=Math.max(f.x-.5*v.x,0),I.y=Math.max(f.y-.5*v.y,0),I.width=Math.min(v.x,T),I.height=Math.min(v.y,E);for(var O=1;O<4;++O)e.clone(I,A.get(O).scissorRectangle)}g.prototype.get=function(e){return this._stages.get(e)},g.prototype.getStageByName=function(e){for(var t=this._stages.length,i=0;i<t;++i){var n=this._stages.get(i);if(n.name===e)return n}};var y=new i,w=new t,x=new t,C=new a;return g.prototype.clear=function(e,t,i){this._sceneFramebuffer.clear(e,t,i),this._textureCache.clear(e)},g.prototype.update=function(e){var t=e.context,i=e.viewport,n=this._sceneFramebuffer;n.update(t,i);var r=n.getFramebuffer();return this._textureCache.update(t),this._stages.update(t,!1),v(this,t,i),r},g.prototype.execute=function(e){var t=this._sceneFramebuffer.getFramebuffer().getColorTexture(0),i=this._stages,n=i.length;i.get(0).execute(e,t);for(var r=1;r<n;++r)i.get(r).execute(e,i.get(r-1).outputTexture)},g.prototype.copy=function(e,t){if(!n(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(d,{uniformMap:{colorTexture:function(){return i._stages.get(i._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),r(this)},g}.apply(t,n))&&(e.exports=r)},2191:function(e,t,i){var n;void 0!==(n=function(){"use strict";return'uniform sampler2D colorTexture;\n\nuniform float avgLuminance;\nuniform float threshold;\nuniform float offset;\n\nvarying vec2 v_textureCoordinates;\n\nfloat key(float avg)\n{\n    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\n    return max(0.0, guess) + 0.1;\n}\n\n// See section 9. "The bright-pass filter" of Realtime HDR Rendering\n// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf\n\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    vec3 xyz = czm_RGBToXYZ(color.rgb);\n    float luminance = xyz.r;\n\n    float scaledLum = key(avgLuminance) * luminance / avgLuminance;\n    float brightLum = max(scaledLum - threshold, 0.0);\n    float brightness = brightLum / (offset + brightLum);\n\n    xyz.r = brightness;\n    gl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n'}.call(t,i,t,e))&&(e.exports=n)},2192:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D colorTexture;\nuniform sampler2D colorTexture2;\n\nuniform vec2 center;\nuniform float radius;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color0 = texture2D(colorTexture, v_textureCoordinates);\n    vec4 color1 = texture2D(colorTexture2, v_textureCoordinates);\n\n    float x = length(gl_FragCoord.xy - center) / radius;\n    float t = smoothstep(0.5, 0.8, x);\n    gl_FragColor = mix(color0 + color1, color1, t);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2193:function(e,t,i){var n,r;n=[i(99),i(10),i(221),i(0),i(117),i(301),i(9),i(20),i(289),i(424),i(423),i(47),i(1940),i(1947),i(2194),i(1969),i(2195),i(2198),i(2199),i(1976),i(46),i(1975)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x){"use strict";function C(t,i,n){var r=t.context,o=[],a=i.frustum.near,s=i.frustum.far,u=t.logarithmicDepthBuffer?t.logarithmicDepthFarToNearRatio:t.farToNearRatio;A(a,s,u,Math.ceil(Math.log(s/a)/Math.log(u)),t.logarithmicDepthBuffer,o,!1,void 0);var l;r.depthTexture&&(l=new f);var c;t._useOIT&&r.depthTexture&&(c=new _(r));var d=new h(r);d.viewport=e.clone(n),this.camera=i,this._cameraClone=p.clone(i),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=n,this.passState=d,this.pickFramebuffer=new v(r),this.pickDepthFramebuffer=new g,this.sceneFramebuffer=new y,this.globeDepth=l,this.oit=c,this.pickDepths=[],this.debugGlobeDepths=[],this.frustumCommandsList=o,this.debugFrustumStatistics=void 0,this.updateFrustums=!1}function T(e,t){var i=Math.max(Math.abs(e.x),Math.abs(t.x)),n=Math.max(Math.abs(e.y),Math.abs(t.y)),r=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.max(Math.max(i,n),r)}function E(e,i,n){var r=1/Math.max(1,T(e.position,i.position));return t.multiplyByScalar(e.position,r,S),t.multiplyByScalar(i.position,r,b),t.equalsEpsilon(S,b,n)&&t.equalsEpsilon(e.direction,i.direction,n)&&t.equalsEpsilon(e.up,i.up,n)&&t.equalsEpsilon(e.right,i.right,n)&&s.equalsEpsilon(e.transform,i.transform,n)&&e.frustum.equalsEpsilon(i.frustum,n)}function A(e,t,i,r,o,a,s,u){a.length=r;for(var l=0;l<r;++l){var c,d;s?(c=Math.min(t-u,e+l*u),d=Math.min(t,c+u)):(c=Math.max(e,Math.pow(i,l)*e),d=i*c,o||(d=Math.min(t,d)));var h=a[l];n(h)?(h.near=c,h.far=d):h=a[l]=new m(c,d)}}function P(e,t,i,r){e.debugShowFrustums&&(i.debugOverlappingFrustums=0);for(var o=t.frustumCommandsList,a=o.length,s=0;s<a;++s){var u=o[s],l=u.near,c=u.far;if(!(r.start>c)){if(r.stop<l)break;var d=i.pass,h=u.indices[d]++;if(u.commands[d][h]=i,e.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<s),i.executeInClosestFrustum)break}}if(e.debugShowFrustums){var p=t.debugFrustumStatistics.commandsInFrustums;p[i.debugOverlappingFrustums]=n(p[i.debugOverlappingFrustums])?p[i.debugOverlappingFrustums]+1:1,++t.debugFrustumStatistics.totalCommands}e.updateDerivedCommands(i)}var S=new t,b=new t;C.prototype.checkForCameraUpdates=function(e){var t=this.camera,i=this._cameraClone;return E(t,i,a.EPSILON15)?(this._cameraStartFired&&r()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=r(),p.clone(t,i),!0)};var D=new i,I=new o;return C.prototype.createPotentiallyVisibleSet=function(e){var t=e.frameState,i=t.camera,r=i.directionWC,o=i.positionWC,s=e._computeCommandList,u=e._overlayCommandList,l=t.commandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});for(var h=this.frustumCommandsList,p=h.length,m=d.NUMBER_OF_PASSES,f=0;f<p;++f)for(var _=0;_<m;++_)h[f].indices[_]=0;s.length=0,u.length=0;for(var g=Number.MAX_VALUE,v=-Number.MAX_VALUE,y=!1,C=t.shadowState.shadowsEnabled,T=Number.MAX_VALUE,E=-Number.MAX_VALUE,S=Number.MAX_VALUE,b=t.mode===w.SCENE3D?t.occluder:void 0,O=t.cullingVolume,M=D.planes,F=0;F<5;++F)M[F]=O.planes[F];O=D;for(var N=l.length,L=0;L<N;++L){var R=l[L],V=R.pass;if(V===d.COMPUTE)s.push(R);else if(V===d.OVERLAY)u.push(R);else{var U=R.boundingVolume;if(n(U)){if(!e.isVisible(R,O,b))continue;if(I=U.computePlaneDistances(o,r,I),g=Math.min(g,I.start),v=Math.max(v,I.stop),C&&R.receiveShadows&&I.start<x.MAXIMUM_DISTANCE&&!(V===d.GLOBE&&I.start<-100&&I.stop>100)){var z=I.stop-I.start;V!==d.GLOBE&&I.start<100&&(S=Math.min(S,z)),T=Math.min(T,I.start),E=Math.max(E,I.stop)}}else I.start=i.frustum.near,I.stop=i.frustum.far,y=!(R instanceof c);P(e,this,R,I)}}y?(g=i.frustum.near,v=i.frustum.far):(g=Math.min(Math.max(g,i.frustum.near),i.frustum.far),v=Math.max(Math.min(v,i.frustum.far),g),C&&(T=Math.min(Math.max(T,i.frustum.near),i.frustum.far),E=Math.max(Math.min(E,i.frustum.far),T))),C&&(t.shadowState.nearPlane=T,t.shadowState.farPlane=E,t.shadowState.closestObjectSize=S);var B,H=e.mode===w.SCENE2D,k=t.useLogDepth,G=k?e.logarithmicDepthFarToNearRatio:e.farToNearRatio;H?(v=Math.min(v,i.position.z+e.nearToFarDistance2D),g=Math.min(g,v),B=Math.ceil(Math.max(1,v-g)/e.nearToFarDistance2D)):B=Math.ceil(Math.log(v/g)/Math.log(G)),(this.updateFrustums||g!==Number.MAX_VALUE&&(B!==p||0!==h.length&&(g<h[0].near||v>h[p-1].far&&(k||!a.equalsEpsilon(v,h[p-1].far,a.EPSILON8)))))&&(this.updateFrustums=!1,A(g,v,G,B,k,h,H,e.nearToFarDistance2D),this.createPotentiallyVisibleSet(e));var W=t.frustumSplits;W.length=B+1;for(var Y=0;Y<B;++Y)W[Y]=h[Y].near,Y===B-1&&(W[Y+1]=h[Y].far)},C.prototype.destroy=function(){this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy();var e,t,i=this.pickDepths,n=this.debugGlobeDepths;for(t=i.length,e=0;e<t;++e)i[e].destroy();for(t=n.length,e=0;e<t;++e)n[e].destroy()},C}.apply(t,n))&&(e.exports=r)},2194:function(e,t,i){var n,r;n=[i(1),i(47)],void 0!==(r=function(e,t){"use strict";function i(i,n){this.near=e(i,0),this.far=e(n,0);for(var r=t.NUMBER_OF_PASSES,o=new Array(r),a=new Array(r),s=0;s<r;++s)o[s]=[],a[s]=0;this.commands=o,this.indices=a}return i}.apply(t,n))&&(e.exports=r)},2195:function(e,t,i){var n,r;n=[i(99),i(25),i(0),i(21),i(69),i(34),i(423),i(60),i(422),i(91),i(68),i(52),i(100),i(2196),i(2197),i(776),i(777)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(i){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var n=i.colorBufferFloat&&i.depthTexture;this._translucentMRTSupport=i.drawBuffers&&n,this._translucentMultipassSupport=!this._translucentMRTSupport&&n,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new a({color:new t(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new a({color:new t(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new a({color:new t(0,0,0,0),owner:this}),this._alphaClearCommand=new a({color:new t(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new e,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0}function v(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function y(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function w(e){v(e),y(e)}function x(e,t,i,n){v(e),e._accumulationTexture=new h({context:t,width:i,height:n,pixelFormat:r.RGBA,pixelDatatype:l.FLOAT});var o=new Float32Array(i*n*4);e._revealageTexture=new h({context:t,pixelFormat:r.RGBA,pixelDatatype:l.FLOAT,source:{arrayBufferView:o,width:i,height:n},flipY:!1})}function C(e,t){y(e);var i=o.FRAMEBUFFER_COMPLETE,n=!0;if(e._translucentMRTSupport&&(e._translucentFBO=new u({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new u({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===i&&e._adjustTranslucentFBO.status===i||(y(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO=new u({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new u({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new u({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new u({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var r=e._translucentFBO.status===i,a=e._alphaFBO.status===i,s=e._adjustTranslucentFBO.status===i,l=e._adjustAlphaFBO.status===i;r&&a&&s&&l||(w(e),e._translucentMultipassSupport=!1,n=!1)}return n}function T(e,t,n,r){var o=n[r.id];if(!i(o)){var a=c.getState(r);a.depthMask=!1,a.blending=t,o=c.fromCache(a),n[r.id]=o}return o}function E(e,t,i){return T(t,F,e._translucentRenderStateCache,i)}function A(e,t,i){return T(t,N,e._translucentRenderStateCache,i)}function P(e,t,i){return T(t,L,e._alphaRenderStateCache,i)}function S(e,t,n,r){var o=e.shaderCache.getDerivedShaderProgram(t,n);if(!i(o)){var a=t._attributeLocations,s=t.fragmentShaderSource.clone();s.sources=s.sources.map(function(e){return e=d.replaceMain(e,"czm_translucent_main"),e=e.replace(/gl_FragColor/g,"czm_gl_FragColor"),e=e.replace(/\bdiscard\b/g,"czm_discard = true"),e=e.replace(/czm_phong/g,"czm_translucentPhong")}),s.sources.splice(0,0,(-1!==r.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),s.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+r+"}\n"),o=e.shaderCache.createDerivedShaderProgram(t,n,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}return o}function b(e,t){return S(e,t,"translucentMRT",R)}function D(e,t){return S(e,t,"translucentMultipass",V)}function I(e,t){return S(e,t,"alphaMultipass",U)}function O(e,t,n,r,o,a){var s,u,l,c=t.context,d=t.frameState.useLogDepth,h=r.framebuffer,p=o.length,m=t.frameState.shadowState.lightShadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(c,r),r.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(c,r);var f=e._opaqueFBO;for(r.framebuffer=e._translucentFBO,l=0;l<p;++l)s=o[l],s=d?s.derivedCommands.logDepth.command:s,u=m&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,n(u,t,c,r,f);for(i(a)&&(s=a.unclassifiedCommand,u=m&&s.receiveShadows?s.derivedCommands.oit.shadows.translucentCommand:s.derivedCommands.oit.translucentCommand,n(u,t,c,r,f)),r.framebuffer=e._alphaFBO,l=0;l<p;++l)s=o[l],s=d?s.derivedCommands.logDepth.command:s,u=m&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,n(u,t,c,r,f);i(a)&&(s=a.unclassifiedCommand,u=m&&s.receiveShadows?s.derivedCommands.oit.shadows.alphaCommand:s.derivedCommands.oit.alphaCommand,n(u,t,c,r,f)),r.framebuffer=h}function M(e,t,n,r,o,a){var s=t.context,u=t.frameState.useLogDepth,l=r.framebuffer,c=o.length,d=t.frameState.shadowState.lightShadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(s,r);var h=e._opaqueFBO;r.framebuffer=e._translucentFBO;for(var p,m,f=0;f<c;++f)p=o[f],p=u?p.derivedCommands.logDepth.command:p,m=d&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,n(m,t,s,r,h);i(a)&&(p=a.unclassifiedCommand,m=d&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,n(m,t,s,r,h)),r.framebuffer=l}g.prototype.update=function(t,n,r){if(this.isSupported()){this._opaqueFBO=r,this._opaqueTexture=r.getColorTexture(0),this._depthStencilTexture=r.depthStencilTexture;var o=this._opaqueTexture.width,a=this._opaqueTexture.height,s=this._accumulationTexture,u=!i(s)||s.width!==o||s.height!==a;if(u&&x(this,t,o,a),i(this._translucentFBO)&&!u||C(this,t)){var l,h,f=this;i(this._compositeCommand)||(l=new d({sources:[m]}),this._translucentMRTSupport&&l.defines.push("MRT"),h={u_opaque:function(){return f._opaqueTexture},u_accumulation:function(){return f._accumulationTexture},u_revealage:function(){return f._revealageTexture}},this._compositeCommand=t.createViewportQuadCommand(l,{uniformMap:h,owner:this})),i(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(l=new d({defines:["MRT"],sources:[p]}),h={u_bgColor:function(){return f._translucentMRTClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(l,{uniformMap:h,owner:this})):this._translucentMultipassSupport&&(l=new d({sources:[p]}),h={u_bgColor:function(){return f._translucentMultipassClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(l,{uniformMap:h,owner:this}),h={u_bgColor:function(){return f._alphaClearCommand.color},u_depthTexture:function(){return f._depthStencilTexture}},this._adjustAlphaCommand=t.createViewportQuadCommand(l,{uniformMap:h,owner:this}))),this._viewport.width=o,this._viewport.height=a;var _=!e.equals(this._viewport,n.viewport),g=_!==this._useScissorTest;this._useScissorTest=_,e.equals(this._scissorRectangle,n.viewport)||(this._scissorRectangle=e.clone(n.viewport,this._scissorRectangle),g=!0),i(this._rs)&&e.equals(this._viewport,this._rs.viewport)&&!g||(this._rs=c.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),i(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),i(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var F={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ONE,functionDestinationRgb:_.ONE,functionSourceAlpha:_.ZERO,functionDestinationAlpha:_.ONE_MINUS_SOURCE_ALPHA},N={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ONE,functionDestinationRgb:_.ONE,functionSourceAlpha:_.ONE,functionDestinationAlpha:_.ONE},L={enabled:!0,color:new t(0,0,0,0),equationRgb:f.ADD,equationAlpha:f.ADD,functionSourceRgb:_.ZERO,functionDestinationRgb:_.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:_.ZERO,functionDestinationAlpha:_.ONE_MINUS_SOURCE_ALPHA},R="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",V="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",U="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";return g.prototype.createDerivedCommands=function(e,t,n){if(i(n)||(n={}),this._translucentMRTSupport){var r,o;i(n.translucentCommand)&&(r=n.translucentCommand.shaderProgram,o=n.translucentCommand.renderState),n.translucentCommand=s.shallowClone(e,n.translucentCommand),i(r)&&n.shaderProgramId===e.shaderProgram.id?(n.translucentCommand.shaderProgram=r,n.translucentCommand.renderState=o):(n.translucentCommand.shaderProgram=b(t,e.shaderProgram),n.translucentCommand.renderState=E(this,t,e.renderState),n.shaderProgramId=e.shaderProgram.id)}else{var a,u,l,c;i(n.translucentCommand)&&(a=n.translucentCommand.shaderProgram,u=n.translucentCommand.renderState,l=n.alphaCommand.shaderProgram,c=n.alphaCommand.renderState),n.translucentCommand=s.shallowClone(e,n.translucentCommand),n.alphaCommand=s.shallowClone(e,n.alphaCommand),i(a)&&n.shaderProgramId===e.shaderProgram.id?(n.translucentCommand.shaderProgram=a,n.translucentCommand.renderState=u,n.alphaCommand.shaderProgram=l,n.alphaCommand.renderState=c):(n.translucentCommand.shaderProgram=D(t,e.shaderProgram),n.translucentCommand.renderState=A(this,t,e.renderState),n.alphaCommand.shaderProgram=I(t,e.shaderProgram),n.alphaCommand.renderState=P(this,t,e.renderState),n.shaderProgramId=e.shaderProgram.id)}return n},g.prototype.executeCommands=function(e,t,i,n,r){if(this._translucentMRTSupport)return void M(this,e,t,i,n,r);O(this,e,t,i,n,r)},g.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},g.prototype.clear=function(e,i,n){var r=i.framebuffer;i.framebuffer=this._opaqueFBO,t.clone(n,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,i),i.framebuffer=this._translucentFBO,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,i),this._translucentMultipassSupport&&(i.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,i)),i.framebuffer=r},g.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return w(this),i(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),i(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),i(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),n(this)},g}.apply(t,n))&&(e.exports=r)},2196:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\n\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    if (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n    {\n#ifdef MRT\n        gl_FragData[0] = u_bgColor;\n        gl_FragData[1] = vec4(u_bgColor.a);\n#else\n        gl_FragColor = u_bgColor;\n#endif\n        return;\n    }\n    \n    discard;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2197:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"/**\n * Compositing for Weighted Blended Order-Independent Transparency. See:\n * - http://jcgt.org/published/0002/02/09/\n * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html\n */\n\nuniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 opaque = texture2D(u_opaque, v_textureCoordinates);\n    vec4 accum = texture2D(u_accumulation, v_textureCoordinates);\n    float r = texture2D(u_revealage, v_textureCoordinates).r;\n\n#ifdef MRT\n    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\n    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\n\n    gl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n\n    if (opaque != czm_backgroundColor)\n    {\n        gl_FragColor.a = 1.0;\n    }\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2198:function(e,t,i){var n,r;n=[i(99),i(25),i(1),i(0),i(21),i(69),i(422),i(1940),i(91),i(1949),i(1942),i(100)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d){"use strict";function h(){this._depthStencilTexture=void 0,this._framebuffer=void 0,this._passState=void 0}function p(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy()}function m(t,i){var n=i.drawingBufferWidth,r=i.drawingBufferHeight;t._depthStencilTexture=new d({context:i,width:n,height:r,pixelFormat:o.DEPTH_STENCIL,pixelDatatype:u.UNSIGNED_INT_24_8}),t._framebuffer=new a({context:i,depthStencilTexture:t._depthStencilTexture,destroyAttachments:!1});var l=new s(i);l.blendingEnabled=!1,l.scissorTest={enabled:!0,rectangle:new e},l.viewport=new e,t._passState=l}return h.prototype.update=function(e,t,i){var r=i.width,o=i.height;n(this._framebuffer)&&r===this._depthStencilTexture.width&&o===this._depthStencilTexture.height||(p(this),m(this,e));var a=this._framebuffer,s=this._passState;return s.framebuffer=a,s.viewport.width=r,s.viewport.height=o,s.scissorTest.rectangle.x=t.x,s.scissorTest.rectangle.y=o-t.y,s.scissorTest.rectangle.width=1,s.scissorTest.rectangle.height=1,s},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return p(this),r(this)},h}.apply(t,n))&&(e.exports=r)},2199:function(e,t,i){var n,r;n=[i(99),i(25),i(1),i(0),i(21),i(422),i(1940),i(1949),i(1942),i(100)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l){"use strict";function c(t){var i=new a(t);i.blendingEnabled=!1,i.scissorTest={enabled:!0,rectangle:new e},i.viewport=new e,this._context=t,this._fb=void 0,this._passState=i,this._width=0,this._height=0}c.prototype.begin=function(t,i){var r=this._context,a=i.width,c=i.height;return e.clone(t,this._passState.scissorTest.rectangle),n(this._fb)&&this._width===a&&this._height===c||(this._width=a,this._height=c,this._fb=this._fb&&this._fb.destroy(),this._fb=new o({context:r,colorTextures:[new l({context:r,width:a,height:c})],depthStencilRenderbuffer:new s({context:r,width:a,height:c,format:u.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=a,this._passState.viewport.height=c,this._passState};var d=new t;return c.prototype.end=function(e){for(var r=i(e.width,1),o=i(e.height,1),a=this._context,s=a.readPixels({x:e.x,y:e.y,width:r,height:o,framebuffer:this._fb}),u=Math.max(r,o),l=u*u,c=Math.floor(.5*r),h=Math.floor(.5*o),p=0,m=0,f=0,_=-1,g=0;g<l;++g){if(-c<=p&&p<=c&&-h<=m&&m<=h){var v=4*((h-m)*r+p+c);d.red=t.byteToFloat(s[v]),d.green=t.byteToFloat(s[v+1]),d.blue=t.byteToFloat(s[v+2]),d.alpha=t.byteToFloat(s[v+3]);var y=a.getObjectByPickColor(d);if(n(y))return y}if(p===m||p<0&&-p===m||p>0&&p===1-m){var w=f;f=-_,_=w}p+=f,m+=_}},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),r(this)},c}.apply(t,n))&&(e.exports=r)},2200:function(e,t,i){var n,r;n=[i(10),i(41),i(1),i(0),i(2),i(21),i(23),i(1954),i(290),i(9),i(181),i(64),i(60),i(68),i(77),i(52),i(115),i(2201),i(2202),i(70),i(220),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x){"use strict";function C(n){n=i(n,a.WGS84),this.show=!0,this._ellipsoid=n,this._command=new h({owner:this}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._spSkyFromSpaceColorCorrect=void 0,this._spSkyFromAtmosphereColorCorrect=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new e;var r=new t;r.w=0,r.y=e.maximumComponent(e.multiplyByScalar(n.radii,1.025,new e)),r.z=n.maximumRadius,this._cameraAndRadiiAndDynamicAtmosphereColor=r;var o=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return o._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){return o._hueSaturationBrightness.x=o.hueShift,o._hueSaturationBrightness.y=o.saturationShift,o._hueSaturationBrightness.z=o.brightnessShift,o._hueSaturationBrightness}}}function T(e){return!(l.equalsEpsilon(e.hueShift,0,l.EPSILON7)&&l.equalsEpsilon(e.saturationShift,0,l.EPSILON7)&&l.equalsEpsilon(e.brightnessShift,0,l.EPSILON7))}return r(C.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),C.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0},C.prototype.update=function(t){if(this.show){var i=t.mode;if((i===x.SCENE3D||i===x.MORPHING)&&t.passes.render){var r=this._command;if(!n(r.vertexArray)){var o=t.context,a=s.createGeometry(new s({radii:e.multiplyByScalar(this._ellipsoid.radii,1.025,new e),slicePartitions:256,stackPartitions:256,vertexFormat:c.POSITION_ONLY}));r.vertexArray=_.fromGeometry({context:o,geometry:a,attributeLocations:u.createAttributeLocations(a),bufferUsage:d.STATIC_DRAW}),r.renderState=p.fromCache({cull:{enabled:!0,face:w.FRONT},blending:y.ALPHA_BLEND,depthMask:!1});var l=new f({defines:["SKY_FROM_SPACE"],sources:[v]});this._spSkyFromSpace=m.fromCache({context:o,vertexShaderSource:l,fragmentShaderSource:g}),l=new f({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphere=m.fromCache({context:o,vertexShaderSource:l,fragmentShaderSource:g})}var h=T(this);if(h&&(!n(this._spSkyFromSpaceColorCorrect)||!n(this._spSkyFromAtmosphereColorCorrect))){var C=t.context,E=new f({defines:["SKY_FROM_SPACE"],sources:[v]}),A=new f({defines:["COLOR_CORRECT"],sources:[g]});this._spSkyFromSpaceColorCorrect=m.fromCache({context:C,vertexShaderSource:E,fragmentShaderSource:A}),E=new f({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphereColorCorrect=m.fromCache({context:C,vertexShaderSource:E,fragmentShaderSource:A})}var P=t.camera.positionWC,S=e.magnitude(P);return this._cameraAndRadiiAndDynamicAtmosphereColor.x=S,S>this._cameraAndRadiiAndDynamicAtmosphereColor.y?r.shaderProgram=h?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace:r.shaderProgram=h?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere,r}}},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy(),o(this)},C}.apply(t,n))&&(e.exports=r)},2201:function(e,t,i){var n;void 0!==(n=function(){"use strict";return'/**\n * @license\n * Copyright (c) 2000-2005, Sean O\'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\nconst float g = -0.95;\nconst float g2 = g * g;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\n\nvoid main (void)\n{\n    // Extra normalize added for Android\n    float cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\n    float rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\n\n    const float exposure = 2.0;\n\n    vec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\n    rgb = vec3(1.0) - exp(-exposure * rgb);\n\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n\n    // Alter alpha based on how close the viewer is to the ground (1.0 = on ground, 0.0 = at edge of atmosphere)\n    float atmosphereAlpha = clamp((u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.x) / (u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.z), 0.0, 1.0);\n\n    // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n    float nightAlpha = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), 0.0, 1.0) : 1.0;\n    atmosphereAlpha *= pow(nightAlpha, 0.5);\n\n    gl_FragColor = vec4(rgb, mix(rgb.b, 1.0, atmosphereAlpha) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n'}.call(t,i,t,e))&&(e.exports=n)},2202:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"/**\n * @license\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nattribute vec4 position;\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n    5.60204474633241,  // Red = 1.0 / Math.pow(0.650, 4.0)\n    9.473284437923038, // Green = 1.0 / Math.pow(0.570, 4.0)\n    19.643802610477206); // Blue = 1.0 / Math.pow(0.475, 4.0)\nconst float rayleighScaleDepth = 0.25;\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\n\nfloat scale(float cosAngle)\n{\n    float x = 1.0 - cosAngle;\n    return rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nvoid main(void)\n{\n    // Unpack attributes\n    float cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\n    float outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\n    float innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 positionV3 = position.xyz;\n    vec3 ray = positionV3 - czm_viewerPositionWC;\n    float far = length(ray);\n    ray /= far;\n    float atmosphereScale = 1.0 / (outerRadius - innerRadius);\n\n#ifdef SKY_FROM_SPACE\n    // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)\n    float B = 2.0 * dot(czm_viewerPositionWC, ray);\n    float C = cameraHeight * cameraHeight - outerRadius * outerRadius;\n    float det = max(0.0, B*B - 4.0 * C);\n    float near = 0.5 * (-B - sqrt(det));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC + ray * near;\n    far -= near;\n    float startAngle = dot(ray, start) / outerRadius;\n    float startDepth = exp(-1.0 / rayleighScaleDepth );\n    float startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC;\n    float height = length(start);\n    float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\n    float startAngle = dot(ray, start) / height;\n    float startOffset = depth*scale(startAngle);\n#endif\n\n    // Initialize the scattering loop variables\n    float sampleLength = far / fSamples;\n    float scaledLength = sampleLength * atmosphereScale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\n    lightDir = normalize(lightDir);\n\n    for(int i=0; i<nSamples; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\n        float fLightAngle = dot(lightDir, samplePoint) / height;\n        float fCameraAngle = dot(ray, samplePoint) / height;\n        float fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\n        vec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n\n    // Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n    v_mieColor = frontColor * KmESun;\n    v_rayleighColor = frontColor * (InvWavelength * KrESun);\n    v_toCamera = czm_viewerPositionWC - positionV3;\n    gl_Position = czm_modelViewProjection * position;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2203:function(e,t,i){var n,r;n=[i(1946),i(10),i(1),i(0),i(21),i(3),i(290),i(20),i(181),i(64),i(749),i(60),i(2204),i(68),i(77),i(115),i(2205),i(2206),i(70),i(46)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y){"use strict";function w(e){this.sources=e.sources,this._sources=void 0,this.show=i(e.show,!0),this._command=new d({modelMatrix:s.clone(s.IDENTITY),owner:this}),this._cubeMap=void 0}return w.prototype.update=function(i){var r=this;if(this.show&&(i.mode===y.SCENE3D||i.mode===y.MORPHING)&&i.passes.render){var o=i.context;if(this._sources!==this.sources){this._sources=this.sources;var s=this.sources;"string"==typeof s.positiveX?h(o,this._sources).then(function(e){r._cubeMap=r._cubeMap&&r._cubeMap.destroy(),r._cubeMap=e}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new c({context:o,source:s}))}var d=this._command;if(!n(d.vertexArray)){d.uniformMap={u_cubeMap:function(){return r._cubeMap}};var w=e.createGeometry(e.fromDimensions({dimensions:new t(2,2,2),vertexFormat:u.POSITION_ONLY})),x=a.createAttributeLocations(w);d.vertexArray=f.fromGeometry({context:o,geometry:w,attributeLocations:x,bufferUsage:l.STATIC_DRAW}),d.shaderProgram=m.fromCache({context:o,vertexShaderSource:g,fragmentShaderSource:_,attributeLocations:x}),d.renderState=p.fromCache({blending:v.ALPHA_BLEND})}if(n(this._cubeMap))return d}},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),r(this)},w}.apply(t,n))&&(e.exports=r)},2204:function(e,t,i){var n,r;n=[i(12),i(0),i(3),i(29),i(7),i(749)],void 0!==(r=function(e,t,i,n,r,o){"use strict";function a(e,t){var i=[n.createIfNeeded(t.positiveX).fetchImage(),n.createIfNeeded(t.negativeX).fetchImage(),n.createIfNeeded(t.positiveY).fetchImage(),n.createIfNeeded(t.negativeY).fetchImage(),n.createIfNeeded(t.positiveZ).fetchImage(),n.createIfNeeded(t.negativeZ).fetchImage()];return r.all(i,function(t){return new o({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})})}return a}.apply(t,n))&&(e.exports=r)},2205:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform samplerCube u_cubeMap;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 rgb = textureCube(u_cubeMap, normalize(v_texCoord)).rgb;\n    gl_FragColor = vec4(rgb, czm_morphTime);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2206:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec3 position;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n    gl_Position = czm_projection * vec4(p, 1.0);\n    v_texCoord = position.xyz;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2207:function(e,t,i){var n,r;n=[i(38),i(17),i(10),i(41),i(31),i(0),i(2),i(21),i(49),i(9),i(20),i(69),i(54),i(93),i(64),i(790),i(60),i(68),i(77),i(100),i(115),i(2208),i(2209),i(2210),i(70),i(46),i(427)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P){"use strict";function S(){this.show=!0,this._drawCommand=new _({primitiveType:h.TRIANGLES,boundingVolume:new e,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new e,this._boundingVolume2D=new e,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1;var t=this;this._uniformMap={u_texture:function(){return t._texture},u_size:function(){return t._size}}}a(S.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var b=new t,D=new t,I=new n,O=new n;return S.prototype.update=function(n,a){if(this.show){var s=n.mode;if(s!==A.SCENE2D&&s!==A.MORPHING&&n.passes.render){var h=n.context,_=a.viewport.width,S=a.viewport.height;if(!o(this._texture)||_!==this._drawingBufferWidth||S!==this._drawingBufferHeight||this._glowFactorDirty){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=_,this._drawingBufferHeight=S,this._glowFactorDirty=!1;var M=Math.max(_,S);M=Math.pow(2,Math.ceil(Math.log(M)/Math.log(2))-2),M=Math.max(1,M),this._texture=new y({context:h,width:M,height:M,pixelFormat:d.RGBA}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var F=this,N={u_glowLengthTS:function(){return F._glowLengthTS},u_radiusTS:function(){return F._radiusTS}};this._commands.computeCommand=new f({fragmentShaderSource:C,outputTexture:this._texture,uniformMap:N,persists:!1,owner:this,postExecute:function(){F._commands.computeCommand=void 0}})}var L=this._drawCommand;if(!o(L.vertexArray)){var R={direction:0},V=new Uint8Array(8);V[0]=0,V[1]=0,V[2]=255,V[3]=0,V[4]=255,V[5]=255,V[6]=0,V[7]=255;var U=p.createVertexBuffer({context:h,typedArray:V,usage:m.STATIC_DRAW}),z=[{index:R.direction,vertexBuffer:U,componentsPerAttribute:2,normalize:!0,componentDatatype:r.UNSIGNED_BYTE}],B=p.createIndexBuffer({context:h,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:m.STATIC_DRAW,indexDatatype:u.UNSIGNED_SHORT});L.vertexArray=new w({context:h,attributes:z,indexBuffer:B}),L.shaderProgram=v.fromCache({context:h,vertexShaderSource:T,fragmentShaderSource:x,attributeLocations:R}),L.renderState=g.fromCache({blending:E.ALPHA_BLEND}),L.uniformMap=this._uniformMap}var H=h.uniformState.sunPositionWC,k=h.uniformState.sunPositionColumbusView,G=this._boundingVolume,W=this._boundingVolume2D;i.clone(H,G.center),W.center.x=k.z,W.center.y=k.x,W.center.z=k.y,G.radius=l.SOLAR_RADIUS+l.SOLAR_RADIUS*this._glowLengthTS,W.radius=G.radius,s===A.SCENE3D?e.clone(G,L.boundingVolume):s===A.COLUMBUS_VIEW&&e.clone(W,L.boundingVolume);var Y=P.computeActualWgs84Position(n,H,O),j=i.magnitude(i.subtract(Y,n.camera.position,O)),X=h.uniformState.projection,Q=I;Q.x=0,Q.y=0,Q.z=-j,Q.w=1;var q=c.multiplyByVector(X,Q,O),Z=P.clipToGLWindowCoordinates(a.viewport,q,b);Q.x=l.SOLAR_RADIUS;var K=c.multiplyByVector(X,Q,O),J=P.clipToGLWindowCoordinates(a.viewport,K,D);return this._size=Math.ceil(t.magnitude(t.subtract(J,Z,O))),this._size=2*this._size*(1+2*this._glowLengthTS),this._commands}}},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),s(this)},S}.apply(t,n))&&(e.exports=r)},2208:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform sampler2D u_texture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2209:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"uniform float u_glowLengthTS;\nuniform float u_radiusTS;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 rotate(vec2 p, vec2 direction)\n{\n    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\n\nvec4 addBurst(vec2 position, vec2 direction)\n{\n    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\n    float radius = length(rotatedPosition);\n    float burst = 1.0 - smoothstep(0.0, 0.55, radius);\n\n    return vec4(burst);\n}\n\nvoid main()\n{\n    vec2 position = v_textureCoordinates - vec2(0.5);\n    float radius = length(position);\n    float surface = step(radius, u_radiusTS);\n    vec4 color = vec4(1.0, 1.0, surface + 0.2, surface);\n\n    float glow = 1.0 - smoothstep(0.0, 0.55, radius);\n    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\n\n    vec4 burst = vec4(0.0);\n\n    // The following loop has been manually unrolled for speed, to\n    // avoid sin() and cos().\n    //\n    //for (float i = 0.4; i < 3.2; i += 1.047) {\n    //    vec2 direction = vec2(sin(i), cos(i));\n    //    burst += 0.4 * addBurst(position, direction);\n    //\n    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));\n    //    burst += 0.3 * addBurst(position, direction);\n    //}\n\n    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106));  // angle == 0.4\n    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348));  // angle == 0.4 + 1.047\n    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754));  // angle == 0.4 + 1.047 * 2.0\n\n    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924));  // angle == 0.4 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239));  // angle == 0.4 + 1.047 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678));  // angle == 0.4 + 1.047 * 2.0 - 0.08\n\n    // End of manual loop unrolling.\n\n    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\n    \n    gl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2210:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec2 direction;\n\nuniform float u_size;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    vec4 position;\n    if (czm_morphTime == 1.0)\n    {\n        position = vec4(czm_sunPositionWC, 1.0);\n    }\n    else\n    {\n        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    }\n    \n    vec4 positionEC = czm_view * position;\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    \n    vec2 halfSize = vec2(u_size * 0.5);\n    halfSize *= ((direction * 2.0) - 1.0);\n    \n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\n    \n    v_textureCoordinates = direction;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2211:function(e,t,i){function n(e){return i(r(e))}function r(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./tycho2t3_80_mx.jpg":2212,"./tycho2t3_80_my.jpg":2213,"./tycho2t3_80_mz.jpg":2214,"./tycho2t3_80_px.jpg":2215,"./tycho2t3_80_py.jpg":2216,"./tycho2t3_80_pz.jpg":2217};n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id=2211},2212:function(e,t,i){e.exports=i.p+"aa1788b9411f5c1262a1e34dc560fc3f.jpg"},2213:function(e,t,i){e.exports=i.p+"1e6c4242b78b7717e8ffce219d09a402.jpg"},2214:function(e,t,i){e.exports=i.p+"2f4b61fff1fc654b6a75d19448eeef25.jpg"},2215:function(e,t,i){e.exports=i.p+"c4725d18f3c291232a047310254e85f2.jpg"},2216:function(e,t,i){e.exports=i.p+"c7fdec957e0d7d159977a6f405a40738.jpg"},2217:function(e,t,i){e.exports=i.p+"e4caa789e1de589c08641109a9a59131.jpg"},2218:function(e,t,i){var n,r;n=[i(1),i(0),i(2),i(21),i(12),i(3),i(1957)],void 0!==(r=function(e,t,i,n,r,o,a){"use strict";function s(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}return i(s.prototype,{length:{get:function(){return this._length}}}),s.prototype.add=function(i,n){n=e(n,0);var r=this._collections[n];if(!t(r)){r=new a({destroyPrimitives:!1}),r._zIndex=n,this._collections[n]=r;for(var o=this._collectionsArray,s=0;s<o.length&&o[s]._zIndex<n;)s++;o.splice(s,0,r)}return r.add(i),this._length++,i._zIndex=n,i},s.prototype.set=function(e,t){return t===e._zIndex?e:(this.remove(e,!0),this.add(e,t),e)},s.prototype.remove=function(e,t){if(this.contains(e)){var i,n=e._zIndex,r=this._collections[n];return i=t?r.remove(e):r.removeAndDestroy(e),i&&this._length--,0===r.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(r),1),this._collections[n]=void 0,r.destroy()),i}return!1},s.prototype.removeAll=function(){for(var e=this._collectionsArray,t=0;t<e.length;t++){var i=e[t];i.destroyPrimitives=!0,i.destroy()}this._collections={},this._collectionsArray=[],this._length=0},s.prototype.contains=function(e){if(!t(e))return!1;var i=this._collections[e._zIndex];return t(i)&&i.contains(e)},s.prototype.update=function(e){if(this.show)for(var t=this._collectionsArray,i=0;i<t.length;i++)t[i].update(e)},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this.removeAll(),n(this)},s}.apply(t,n))&&(e.exports=r)},2219:function(e,t,i){var n,r;n=[i(182),i(99),i(17),i(10),i(25),i(0),i(21),i(3),i(154),i(218),i(153),i(158),i(132),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function _(t,i){i.collectionChanged.addEventListener(_.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function g(e,t,i){o(e)&&(e.billboard=void 0,i.removeBillboard(t))}var v=r.WHITE,y=n.ZERO,w=c.NONE,x=i.ZERO,C=n.ZERO,T=d.CENTER,E=h.CENTER,A=new n,P=new r,S=new n,b=new i,D=new l,I=new l,O=new l,M=new t,F=new u;return _.prototype.update=function(e){for(var t=this._items.values,i=this._cluster,n=0,r=t.length;n<r;n++){var a,s,u=t[n],l=u.entity,c=l._billboard,d=u.billboard,h=l.isShowing&&l.isAvailable(e)&&m.getValueOrDefault(c._show,e,!0);if(h&&(s=m.getValueOrUndefined(l._position,e,A),a=m.getValueOrUndefined(c._image,e),h=o(s)&&o(a)),h){m.isConstant(l._position)||(i._clusterDirty=!0),o(d)||(d=i.getBillboard(l),d.id=l,d.image=void 0,u.billboard=d),d.show=h,o(d.image)&&u.textureValue===a||(d.image=a,u.textureValue=a),d.position=s,d.color=m.getValueOrDefault(c._color,e,v,P),d.eyeOffset=m.getValueOrDefault(c._eyeOffset,e,y,S),d.heightReference=m.getValueOrDefault(c._heightReference,e,w),d.pixelOffset=m.getValueOrDefault(c._pixelOffset,e,x,b),d.scale=m.getValueOrDefault(c._scale,e,1),d.rotation=m.getValueOrDefault(c._rotation,e,0),d.alignedAxis=m.getValueOrDefault(c._alignedAxis,e,C),d.horizontalOrigin=m.getValueOrDefault(c._horizontalOrigin,e,T),d.verticalOrigin=m.getValueOrDefault(c._verticalOrigin,e,E),d.width=m.getValueOrUndefined(c._width,e),d.height=m.getValueOrUndefined(c._height,e),d.scaleByDistance=m.getValueOrUndefined(c._scaleByDistance,e,D),d.translucencyByDistance=m.getValueOrUndefined(c._translucencyByDistance,e,I),d.pixelOffsetScaleByDistance=m.getValueOrUndefined(c._pixelOffsetScaleByDistance,e,O),d.sizeInMeters=m.getValueOrDefault(c._sizeInMeters,e,!1),d.distanceDisplayCondition=m.getValueOrUndefined(c._distanceDisplayCondition,e,F),d.disableDepthTestDistance=m.getValueOrUndefined(c._disableDepthTestDistance,e);var p=m.getValueOrUndefined(c._imageSubRegion,e,M);o(p)&&d.setImageSubRegion(d._imageId,p)}else g(u,l,i)}return!0},_.prototype.getBoundingSphere=function(e,t){var i=this._items.get(e.id);if(!o(i)||!o(i.billboard))return p.FAILED;var r=i.billboard;if(r.heightReference===c.NONE)t.center=n.clone(r.position,t.center);else{if(!o(r._clampedPosition))return p.PENDING;t.center=n.clone(r._clampedPosition,t.center)}return t.radius=0,p.DONE},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(_.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return a(this)},_.prototype._onCollectionChanged=function(e,t,i,n){var r,a,s=this._items,u=this._cluster;for(r=t.length-1;r>-1;r--)a=t[r],o(a._billboard)&&o(a._position)&&s.set(a.id,new f(a));for(r=n.length-1;r>-1;r--)a=n[r],o(a._billboard)&&o(a._position)?s.contains(a.id)||s.set(a.id,new f(a)):(g(s.get(a.id),a,u),s.remove(a.id));for(r=i.length-1;r>-1;r--)a=i[r],g(s.get(a.id),a,u),s.remove(a.id)},_}.apply(t,n))&&(e.exports=r)},2220:function(e,t,i){var n,r;n=[i(182),i(38),i(12),i(1),i(0),i(21),i(15),i(217),i(159),i(1935),i(152),i(184),i(744),i(2230),i(421),i(2231),i(2221),i(1980),i(2234),i(2237),i(156),i(2238),i(2241),i(2246),i(2249),i(1983),i(1984),i(2250),i(2251),i(2255),i(2256)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I){"use strict";function O(e,t){function i(e){r.raiseEvent(e)}this.entity=e,this.scene=t;for(var n=new Array(N.length),r=new a,o=new s,u=0;u<n.length;u++){var l=new N[u](e,t);o.add(l.geometryChanged,i),n[u]=l}this.updaters=n,this.geometryChanged=r,this.eventHelper=o,this._removeEntitySubscription=e.definitionChanged.addEventListener(O.prototype._onEntityPropertyChanged,this)}function M(t,i,r,o){r=n(r,t.primitives),o=n(o,t.groundPrimitives),this._scene=t,this._primitives=r,this._groundPrimitives=o,this._entityCollection=void 0,this._addedObjects=new e,this._removedObjects=new e,this._changedObjects=new e;var a=d.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*a),this._closedColorBatches=new Array(2*a),this._closedMaterialBatches=new Array(2*a),this._openColorBatches=new Array(2*a),this._openMaterialBatches=new Array(2*a);var s=w.supportsMaterialsforEntitiesOnTerrain(t);this._supportsMaterialsforEntitiesOnTerrain=s;var h;for(h=0;h<a;++h)this._outlineBatches[h]=new D(r,t,h,!1),this._outlineBatches[a+h]=new D(r,t,h,!0),this._closedColorBatches[h]=new A(r,c,void 0,!0,h,!0),this._closedColorBatches[a+h]=new A(r,c,void 0,!0,h,!1),this._closedMaterialBatches[h]=new P(r,l,void 0,!0,h,!0),this._closedMaterialBatches[a+h]=new P(r,l,void 0,!0,h,!1),this._openColorBatches[h]=new A(r,c,void 0,!1,h,!0),this._openColorBatches[a+h]=new A(r,c,void 0,!1,h,!1),this._openMaterialBatches[h]=new P(r,l,void 0,!1,h,!0),this._openMaterialBatches[a+h]=new P(r,l,void 0,!1,h,!1);var p=u.NUMBER_OF_CLASSIFICATION_TYPES,m=new Array(p),f=[];if(s){for(m[u.TERRAIN]=new b(o,c),h=0;h<p;++h)h!==u.TERRAIN&&(m[h]=new S(o,h));f[0]=new b(o,l),this._groundTerrainMaterialBatch=f[0]}else for(h=0;h<p;++h)m[h]=new S(o,h);this._groundColorBatches=m,this._dynamicBatch=new g(r,o),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,f,this._dynamicBatch),this._subscriptions=new e,this._updaterSets=new e,this._entityCollection=i,i.collectionChanged.addEventListener(M.prototype._onCollectionChanged,this),this._onCollectionChanged(i,i.values,F)}var F=[],N=[p,_,f,v,y,x,C,T,E,I];O.prototype._onEntityPropertyChanged=function(e,t,i,n){for(var r=this.updaters,o=0;o<r.length;o++)r[o]._onEntityPropertyChanged(e,t,i,n)},O.prototype.forEach=function(e){for(var t=this.updaters,i=0;i<t.length;i++)e(t[i])},O.prototype.destroy=function(){this.eventHelper.removeAll();for(var e=this.updaters,t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),o(this)},M.prototype.update=function(e){var t,i,n,r,o=this._addedObjects,a=o.values,s=this._removedObjects,u=s.values,l=this._changedObjects,c=l.values,d=this;for(t=c.length-1;t>-1;t--)i=c[t],n=i.id,r=this._updaterSets.get(n),r.entity===i?r.forEach(function(t){d._removeUpdater(t),d._insertUpdaterIntoBatch(e,t)}):(u.push(i),a.push(i));for(t=u.length-1;t>-1;t--)i=u[t],n=i.id,r=this._updaterSets.get(n),r.forEach(this._removeUpdater.bind(this)),r.destroy(),this._updaterSets.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=a.length-1;t>-1;t--)i=a[t],n=i.id,r=new O(i,this._scene),this._updaterSets.set(n,r),r.forEach(function(t){d._insertUpdaterIntoBatch(e,t)}),this._subscriptions.set(n,r.geometryChanged.addEventListener(M._onGeometryChanged,this));o.removeAll(),s.removeAll(),l.removeAll();var h=!0,p=this._batches,m=p.length;for(t=0;t<m;t++)h=p[t].update(e)&&h;return h};var L=[],R=new t;return M.prototype.getBoundingSphere=function(e,i){for(var n=L,r=R,o=0,a=h.DONE,s=this._batches,u=s.length,l=e.id,c=this._updaterSets.get(l).updaters,d=0;d<c.length;d++)for(var p=c[d],m=0;m<u;m++){if((a=s[m].getBoundingSphere(p,r))===h.PENDING)return h.PENDING;a===h.DONE&&(n[o]=t.clone(r,n[o]),o++)}return 0===o?h.FAILED:(n.length=o,t.fromBoundingSpheres(n,i),h.DONE)},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(M.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var e,t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();return this._subscriptions.removeAll(),o(this)},M.prototype._removeUpdater=function(e){for(var t=this._batches,i=t.length,n=0;n<i;n++)t[n].remove(e)},M.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic)return void this._dynamicBatch.add(e,t);var i;(t.outlineEnabled||t.fillEnabled)&&(i=t.shadowsProperty.getValue(e));var n=d.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&(r(t.terrainOffsetProperty)?this._outlineBatches[n+i].add(e,t):this._outlineBatches[i].add(e,t)),t.fillEnabled)if(t.onTerrain){var o=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof m?this._groundColorBatches[o].add(e,t):this._groundTerrainMaterialBatch.add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof m?r(t.terrainOffsetProperty)?this._closedColorBatches[n+i].add(e,t):this._closedColorBatches[i].add(e,t):r(t.terrainOffsetProperty)?this._closedMaterialBatches[n+i].add(e,t):this._closedMaterialBatches[i].add(e,t):t.fillMaterialProperty instanceof m?r(t.terrainOffsetProperty)?this._openColorBatches[n+i].add(e,t):this._openColorBatches[i].add(e,t):r(t.terrainOffsetProperty)?this._openMaterialBatches[n+i].add(e,t):this._openMaterialBatches[i].add(e,t)},M._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,n=e.entity,o=n.id;r(t.get(o))||r(i.get(o))||i.set(o,n)},M.prototype._onCollectionChanged=function(e,t,i){var n,r,o,a=this._addedObjects,s=this._removedObjects,u=this._changedObjects;for(n=i.length-1;n>-1;n--)o=i[n],r=o.id,a.remove(r)||(s.set(r,o),u.remove(r));for(n=t.length-1;n>-1;n--)o=t[n],r=o.id,s.remove(r)?u.set(r,o):a.set(r,o)},M}.apply(t,n))&&(e.exports=r)},2221:function(e,t,i){var n,r;n=[i(10),i(12),i(25),i(150),i(2222),i(2223),i(0),i(2),i(3),i(1934),i(128),i(151),i(215),i(745),i(1933),i(153),i(1935),i(152),i(1958),i(421),i(1937),i(1936),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function E(e,t){x.call(this,{entity:e,scene:t,geometryOptions:new T(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function A(e,t,i){w.call(this,e,t,i)}var P=e.ZERO,S=new e,b=new e,D=new i;return a(Object.create)&&(E.prototype=Object.create(x.prototype),E.prototype.constructor=E),s(E.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),E.prototype.createFillGeometryInstance=function(e){var t=this._entity,o=t.isAvailable(e),s=new m(o&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),u=this._distanceDisplayConditionProperty.getValue(e),d=l.fromDistanceDisplayCondition(u),h={show:s,distanceDisplayCondition:d,color:void 0,offset:void 0};if(this._materialProperty instanceof y){var f;a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(f=this._materialProperty.color.getValue(e,D)),a(f)||(f=i.WHITE),h.color=n.fromColor(f)}return a(this._options.offsetAttribute)&&(h.offset=p.fromCartesian3(C.getValueOrDefault(this._terrainOffsetProperty,e,P,S))),new c({id:t,geometry:new r(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:h})},E.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,r=t.isAvailable(e),s=C.getValueOrDefault(this._outlineColorProperty,e,i.BLACK,D),u=this._distanceDisplayConditionProperty.getValue(e),d={show:new m(r&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u),offset:void 0};return a(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(C.getValueOrDefault(this._terrainOffsetProperty,e,P,S))),new c({id:t,geometry:new o(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:d})},E.prototype._computeCenter=function(e,t){return C.getValueOrUndefined(this._entity.position,e,t)},E.prototype._isHidden=function(e,t){return!a(e.position)||!a(t.length)||!a(t.topRadius)||!a(t.bottomRadius)||x.prototype._isHidden.call(this,e,t)},E.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&C.isConstant(e.orientation)&&t.length.isConstant&&t.topRadius.isConstant&&t.bottomRadius.isConstant&&C.isConstant(t.slices)&&C.isConstant(t.outlineWidth)&&C.isConstant(t.numberOfVerticalLines))},E.prototype._setStaticOptions=function(e,t){var i=C.getValueOrDefault(t.heightReference,h.MINIMUM_VALUE,f.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat,n.length=t.length.getValue(h.MINIMUM_VALUE),n.topRadius=t.topRadius.getValue(h.MINIMUM_VALUE),n.bottomRadius=t.bottomRadius.getValue(h.MINIMUM_VALUE),n.slices=C.getValueOrUndefined(t.slices,h.MINIMUM_VALUE),n.numberOfVerticalLines=C.getValueOrUndefined(t.numberOfVerticalLines,h.MINIMUM_VALUE),n.offsetAttribute=i!==f.NONE?d.ALL:void 0},E.prototype._onEntityPropertyChanged=v,E.DynamicGeometryUpdater=A,a(Object.create)&&(A.prototype=Object.create(w.prototype),A.prototype.constructor=A),A.prototype._isHidden=function(e,t,i){var n=this._options,r=C.getValueOrUndefined(e.position,i,b);return!a(r)||!a(n.length)||!a(n.topRadius)||!a(n.bottomRadius)||w.prototype._isHidden.call(this,e,t,i)},A.prototype._setOptions=function(e,t,i){var n=C.getValueOrDefault(t.heightReference,i,f.NONE),r=this._options;r.length=C.getValueOrUndefined(t.length,i),r.topRadius=C.getValueOrUndefined(t.topRadius,i),r.bottomRadius=C.getValueOrUndefined(t.bottomRadius,i),r.slices=C.getValueOrUndefined(t.slices,i),r.numberOfVerticalLines=C.getValueOrUndefined(t.numberOfVerticalLines,i),r.offsetAttribute=n!==f.NONE?d.ALL:void 0},E}.apply(t,n))&&(e.exports=r)},2222:function(e,t,i){var n,r;n=[i(130),i(38),i(17),i(10),i(31),i(1977),i(1),i(0),i(3),i(76),i(90),i(129),i(151),i(49),i(9),i(54),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){e=a(e,a.EMPTY_OBJECT);var t=e.length,i=e.topRadius,n=e.bottomRadius,r=a(e.vertexFormat,_.DEFAULT),o=a(e.slices,128);this._length=t,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=_.clone(r),this._slices=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}var v=new i,y=new n,w=new n,x=new n,C=new n;g.packedLength=_.packedLength+5,g.pack=function(e,t,i){return i=a(i,0),_.pack(e._vertexFormat,t,i),i+=_.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=a(e._offsetAttribute,-1),t};var T=new _,E={vertexFormat:T,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};g.unpack=function(e,t,i){t=a(t,0);var n=_.unpack(e,t,T);t+=_.packedLength;var r=e[t++],o=e[t++],u=e[t++],l=e[t++],c=e[t];return s(i)?(i._vertexFormat=_.clone(n,i._vertexFormat),i._length=r,i._topRadius=o,i._bottomRadius=u,i._slices=l,i._offsetAttribute=-1===c?void 0:c,i):(E.length=r,E.topRadius=o,E.bottomRadius=u,E.slices=l,E.offsetAttribute=-1===c?void 0:c,new g(E))},g.createGeometry=function(a){var u=a._length,_=a._topRadius,g=a._bottomRadius,T=a._vertexFormat,E=a._slices;if(!(u<=0||_<0||g<0||0===_&&0===g)){var A,P=E+E,S=E+P,b=P+P,D=o.computePositions(u,_,g,E,!0),I=T.st?new Float32Array(2*b):void 0,O=T.normal?new Float32Array(3*b):void 0,M=T.tangent?new Float32Array(3*b):void 0,F=T.bitangent?new Float32Array(3*b):void 0,N=T.normal||T.tangent||T.bitangent;if(N){var L=T.tangent||T.bitangent,R=0,V=0,U=0,z=Math.atan2(g-_,u),B=y;B.z=Math.sin(z);var H=Math.cos(z),k=x,G=w;for(A=0;A<E;A++){var W=A/E*m.TWO_PI,Y=H*Math.cos(W),j=H*Math.sin(W);N&&(B.x=Y,B.y=j,L&&(k=n.normalize(n.cross(n.UNIT_Z,B,k),k)),T.normal&&(O[R++]=B.x,O[R++]=B.y,O[R++]=B.z,O[R++]=B.x,O[R++]=B.y,O[R++]=B.z),T.tangent&&(M[V++]=k.x,M[V++]=k.y,M[V++]=k.z,M[V++]=k.x,M[V++]=k.y,M[V++]=k.z),T.bitangent&&(G=n.normalize(n.cross(B,k,G),G),F[U++]=G.x,F[U++]=G.y,F[U++]=G.z,F[U++]=G.x,F[U++]=G.y,F[U++]=G.z))}for(A=0;A<E;A++)T.normal&&(O[R++]=0,O[R++]=0,O[R++]=-1),T.tangent&&(M[V++]=1,M[V++]=0,M[V++]=0),T.bitangent&&(F[U++]=0,F[U++]=-1,F[U++]=0);for(A=0;A<E;A++)T.normal&&(O[R++]=0,O[R++]=0,O[R++]=1),T.tangent&&(M[V++]=1,M[V++]=0,M[V++]=0),T.bitangent&&(F[U++]=0,F[U++]=1,F[U++]=0)}var X=12*E-12,Q=p.createTypedArray(b,X),q=0,Z=0;for(A=0;A<E-1;A++)Q[q++]=Z,Q[q++]=Z+2,Q[q++]=Z+3,Q[q++]=Z,Q[q++]=Z+3,Q[q++]=Z+1,Z+=2;for(Q[q++]=P-2,Q[q++]=0,Q[q++]=1,Q[q++]=P-2,Q[q++]=1,Q[q++]=P-1,A=1;A<E-1;A++)Q[q++]=P+A+1,Q[q++]=P+A,Q[q++]=P;for(A=1;A<E-1;A++)Q[q++]=S,Q[q++]=S+A,Q[q++]=S+A+1;var K=0;if(T.st){var J=Math.max(_,g);for(A=0;A<b;A++){var $=n.fromArray(D,3*A,C);I[K++]=($.x+J)/(2*J),I[K++]=($.y+J)/(2*J)}}var ee=new d;T.position&&(ee.position=new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:D})),T.normal&&(ee.normal=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:O})),T.tangent&&(ee.tangent=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:M})),T.bitangent&&(ee.bitangent=new c({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:F})),T.st&&(ee.st=new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:I})),v.x=.5*u,v.y=Math.max(g,_);var te=new t(n.ZERO,i.magnitude(v));if(s(a._offsetAttribute)){u=D.length;var ie=new Uint8Array(u/3),ne=a._offsetAttribute===h.NONE?0:1;e(ie,ne),ee.applyOffset=new c({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:1,values:ie})}return new l({attributes:ee,indices:Q,primitiveType:f.TRIANGLES,boundingSphere:te,offsetAttribute:a._offsetAttribute})}};var A;return g.getUnitCylinder=function(){return s(A)||(A=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:_.POSITION_ONLY}))),A},g}.apply(t,n))&&(e.exports=r)},2223:function(e,t,i){var n,r;n=[i(130),i(38),i(17),i(10),i(12),i(31),i(1977),i(1),i(0),i(3),i(76),i(90),i(129),i(151),i(49),i(54)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f){"use strict";function _(e){e=s(e,s.EMPTY_OBJECT);var t=e.length,i=e.topRadius,n=e.bottomRadius,r=s(e.slices,128),o=Math.max(s(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=i,this._bottomRadius=n,this._slices=r,this._numberOfVerticalLines=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}var g=new i;_.packedLength=6,_.pack=function(e,t,i){return i=s(i,0),t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i++]=e._numberOfVerticalLines,t[i]=s(e._offsetAttribute,-1),t};var v={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};return _.unpack=function(e,t,i){t=s(t,0);var n=e[t++],r=e[t++],o=e[t++],a=e[t++],l=e[t++],c=e[t];return u(i)?(i._length=n,i._topRadius=r,i._bottomRadius=o,i._slices=a,i._numberOfVerticalLines=l,i._offsetAttribute=-1===c?void 0:c,i):(v.length=n,v.topRadius=r,v.bottomRadius=o,v.slices=a,v.numberOfVerticalLines=l,v.offsetAttribute=-1===c?void 0:c,new _(v))},_.createGeometry=function(r){var s=r._length,l=r._topRadius,_=r._bottomRadius,v=r._slices,y=r._numberOfVerticalLines;if(!(s<=0||l<0||_<0||0===l&&0===_)){var w,x=2*v,C=a.computePositions(s,l,_,v,!1),T=2*v;if(y>0){var E=Math.min(y,v);w=Math.round(v/E),T+=E}var A,P=m.createTypedArray(x,2*T),S=0;for(A=0;A<v-1;A++)P[S++]=A,P[S++]=A+1,P[S++]=A+v,P[S++]=A+1+v;if(P[S++]=v-1,P[S++]=0,P[S++]=v+v-1,P[S++]=v,y>0)for(A=0;A<v;A+=w)P[S++]=A,P[S++]=A+v;var b=new h;b.position=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:C}),g.x=.5*s,g.y=Math.max(_,l);var D=new t(n.ZERO,i.magnitude(g));if(u(r._offsetAttribute)){s=C.length;var I=new Uint8Array(s/3),O=r._offsetAttribute===p.NONE?0:1;e(I,O),b.applyOffset=new d({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:I})}return new c({attributes:b,indices:P,primitiveType:f.LINES,boundingSphere:D,offsetAttribute:r._offsetAttribute})}},_}.apply(t,n))&&(e.exports=r)},2224:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2225:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2226:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2227:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2228:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2229:function(e,t,i){var n;void 0!==(n=function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}.call(t,i,t,e))&&(e.exports=n)},2230:function(e,t,i){var n,r;n=[i(1946),i(760),i(10),i(12),i(25),i(150),i(0),i(2),i(3),i(1934),i(128),i(151),i(215),i(745),i(1933),i(153),i(1935),i(152),i(1958),i(421),i(1937),i(1936),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function E(e,t){x.call(this,{entity:e,scene:t,geometryOptions:new T(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function A(e,t,i){w.call(this,e,t,i)}var P=i.ZERO,S=new i,b=new i,D=new r;return a(Object.create)&&(E.prototype=Object.create(x.prototype),E.prototype.constructor=E),s(E.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),E.prototype.createFillGeometryInstance=function(t){var i=this._entity,n=i.isAvailable(t),s=new m(n&&i.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),u=this._distanceDisplayConditionProperty.getValue(t),d=l.fromDistanceDisplayCondition(u),h={show:s,distanceDisplayCondition:d,color:void 0,offset:void 0};if(this._materialProperty instanceof y){var f;a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(f=this._materialProperty.color.getValue(t,D)),a(f)||(f=r.WHITE),h.color=o.fromColor(f)}return a(this._options.offsetAttribute)&&(h.offset=p.fromCartesian3(C.getValueOrDefault(this._terrainOffsetProperty,t,P,S))),new c({id:i,geometry:e.fromDimensions(this._options),modelMatrix:i.computeModelMatrixForHeightReference(t,i.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:h})},E.prototype.createOutlineGeometryInstance=function(e){var i=this._entity,n=i.isAvailable(e),s=C.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,D),u=this._distanceDisplayConditionProperty.getValue(e),d={show:new m(n&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:o.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u),offset:void 0};return a(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(C.getValueOrDefault(this._terrainOffsetProperty,e,P,S))),new c({id:i,geometry:t.fromDimensions(this._options),modelMatrix:i.computeModelMatrixForHeightReference(e,i.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:d})},E.prototype._computeCenter=function(e,t){return C.getValueOrUndefined(this._entity.position,e,t)},E.prototype._isHidden=function(e,t){return!a(t.dimensions)||!a(e.position)||x.prototype._isHidden.call(this,e,t)},E.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&C.isConstant(e.orientation)&&t.dimensions.isConstant&&C.isConstant(t.outlineWidth))},E.prototype._setStaticOptions=function(e,t){var i=C.getValueOrDefault(t.heightReference,h.MINIMUM_VALUE,f.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof y?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat,n.dimensions=t.dimensions.getValue(h.MINIMUM_VALUE,n.dimensions),n.offsetAttribute=i!==f.NONE?d.ALL:void 0},E.prototype._onEntityPropertyChanged=v,E.DynamicGeometryUpdater=A,a(Object.create)&&(A.prototype=Object.create(w.prototype),A.prototype.constructor=A),A.prototype._isHidden=function(e,t,i){var n=C.getValueOrUndefined(e.position,i,b),r=this._options.dimensions;return!a(n)||!a(r)||w.prototype._isHidden.call(this,e,t,i)},A.prototype._setOptions=function(e,t,i){var n=C.getValueOrDefault(t.heightReference,i,f.NONE),r=this._options;r.dimensions=C.getValueOrUndefined(t.dimensions,i,r.dimensions),r.offsetAttribute=n!==f.NONE?d.ALL:void 0},E}.apply(t,n))&&(e.exports=r)},2231:function(e,t,i){var n,r;n=[i(293),i(10),i(12),i(25),i(150),i(2232),i(2233),i(0),i(3),i(1934),i(128),i(151),i(215),i(745),i(16),i(1933),i(746),i(153),i(1935),i(152),i(421),i(1937),i(1936),i(1950),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E){"use strict";function A(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function P(e,t){T.call(this,{entity:e,scene:t,geometryOptions:new A(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function S(e,t,i){x.call(this,e,t,i)}var b=new n,D=t.ZERO,I=new t,O=new m;return s(Object.create)&&(P.prototype=Object.create(T.prototype),P.prototype.constructor=P),P.prototype.createFillGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),a={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:l.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof w){var u;s(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(u=this._materialProperty.color.getValue(e,b)),s(u)||(u=n.WHITE),a.color=r.fromColor(u)}return s(this._options.offsetAttribute)&&(a.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,D,I))),new c({id:t,geometry:new o(this._options),attributes:a})},P.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),o=E.getValueOrDefault(this._outlineColorProperty,e,n.BLACK,b),u={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return s(this._options.offsetAttribute)&&(u.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,D,I))),new c({id:t,geometry:new a(this._options),attributes:u})},P.prototype._computeCenter=function(e,i){var n=E.getValueOrUndefined(this._entity.corridor.positions,e);if(s(n)&&0!==n.length)return t.clone(n[Math.floor(n.length/2)],i)},P.prototype._isHidden=function(e,t){return!s(t.positions)||!s(t.width)||C.prototype._isHidden.call(this,e,t)},P.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!s(t.height)&&!s(t.extrudedHeight)&&_.isSupported(this._scene)},P.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight;return 0===t||s(i)&&i!==t},P.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!E.isConstant(t.height)||!E.isConstant(t.extrudedHeight)||!E.isConstant(t.granularity)||!E.isConstant(t.width)||!E.isConstant(t.outlineWidth)||!E.isConstant(t.cornerType)||!E.isConstant(t.zIndex)||this._onTerrain&&!E.isConstant(this._materialProperty)},P.prototype._setStaticOptions=function(t,i){var n=i.height,r=i.heightReference,a=i.extrudedHeight,s=i.extrudedHeightReference,u=this._options;u.vertexFormat=this._materialProperty instanceof w?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,u.positions=i.positions.getValue(h.MINIMUM_VALUE,u.positions),u.width=i.width.getValue(h.MINIMUM_VALUE),u.granularity=E.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),u.cornerType=E.getValueOrUndefined(i.cornerType,h.MINIMUM_VALUE),u.offsetAttribute=T.computeGeometryOffsetAttribute(r,s,h.MINIMUM_VALUE),u.height=T.getGeometryHeight(n,r,h.MINIMUM_VALUE);var l=T.getGeometryExtrudedHeight(a,s,h.MINIMUM_VALUE);l===T.CLAMP_TO_GROUND&&(l=e.getApproximateTerrainHeights(o.computeRectangle(u,O)).minimumTerrainHeight),u.extrudedHeight=l},P.DynamicGeometryUpdater=S,s(Object.create)&&(S.prototype=Object.create(x.prototype),S.prototype.constructor=S),S.prototype._isHidden=function(e,t,i){var n=this._options;return!s(n.positions)||!s(n.width)||x.prototype._isHidden.call(this,e,t,i)},S.prototype._setOptions=function(t,i,n){var r=this._options,a=i.height,s=i.heightReference,u=i.extrudedHeight,l=i.extrudedHeightReference;r.positions=E.getValueOrUndefined(i.positions,n),r.width=E.getValueOrUndefined(i.width,n),r.granularity=E.getValueOrUndefined(i.granularity,n),r.cornerType=E.getValueOrUndefined(i.cornerType,n),r.offsetAttribute=T.computeGeometryOffsetAttribute(s,l,n),r.height=T.getGeometryHeight(a,s,n);var c=T.getGeometryExtrudedHeight(u,l,n);c===T.CLAMP_TO_GROUND&&(c=e.getApproximateTerrainHeights(o.computeRectangle(r,O)).minimumTerrainHeight),r.extrudedHeight=c},P}.apply(t,n))&&(e.exports=r)},2232:function(e,t,i){var n,r;n=[i(130),i(292),i(38),i(10),i(24),i(12),i(31),i(1938),i(1979),i(1),i(0),i(2),i(23),i(76),i(90),i(129),i(151),i(49),i(9),i(291),i(54),i(16),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function E(e,t,i,r,o,a){var s=e.normals,l=e.tangents,c=e.bitangents,d=n.normalize(n.cross(i,t,U),U);a.normal&&u.addAttribute(s,t,r,o),a.tangent&&u.addAttribute(l,d,r,o),a.bitangent&&u.addAttribute(c,i,r,o)}function A(e,t,i){var r,o,s,l=e.positions,d=e.corners,h=e.endPositions,p=e.lefts,_=e.normals,y=new f,w=0,x=0,C=0;for(o=0;o<l.length;o+=2)s=l[o].length-3,w+=s,C+=2*s,x+=l[o+1].length-3;for(w+=3,x+=3,o=0;o<d.length;o++){r=d[o];var T=d[o].leftPositions;c(T)?(s=T.length,w+=s,C+=s):(s=d[o].rightPositions.length,x+=s,C+=s)}var A,P=c(h);P&&(A=h[0].length-3,w+=A,x+=A,A/=3,C+=6*A);var S,b,D,I,O,R,B=w+x,H=new Float64Array(B),k=t.normal?new Float32Array(B):void 0,G=t.tangent?new Float32Array(B):void 0,W=t.bitangent?new Float32Array(B):void 0,Y={normals:k,tangents:G,bitangents:W},j=0,X=B-1,Q=M,q=F,Z=A/2,K=g.createTypedArray(B/3,C),J=0;if(P){R=N,O=L;var $=h[0];for(Q=n.fromArray(_,0,Q),q=n.fromArray(p,0,q),o=0;o<Z;o++)R=n.fromArray($,3*(Z-1-o),R),O=n.fromArray($,3*(Z+o),O),u.addAttribute(H,O,j),u.addAttribute(H,R,void 0,X),E(Y,Q,q,j,X,t),b=j/3,I=b+1,S=(X-2)/3,D=S-1,K[J++]=S,K[J++]=b,K[J++]=D,K[J++]=D,K[J++]=b,K[J++]=I,j+=3,X-=3}var ee=0,te=0,ie=l[ee++],ne=l[ee++];H.set(ie,j),H.set(ne,X-ne.length+1),q=n.fromArray(p,te,q);var re,oe;for(s=ne.length-3,o=0;o<s;o+=3)re=i.geodeticSurfaceNormal(n.fromArray(ie,o,U),U),oe=i.geodeticSurfaceNormal(n.fromArray(ne,s-o,z),z),Q=n.normalize(n.add(re,oe,Q),Q),E(Y,Q,q,j,X,t),b=j/3,I=b+1,S=(X-2)/3,D=S-1,K[J++]=S,K[J++]=b,K[J++]=D,K[J++]=D,K[J++]=b,K[J++]=I,j+=3,X-=3;for(re=i.geodeticSurfaceNormal(n.fromArray(ie,s,U),U),oe=i.geodeticSurfaceNormal(n.fromArray(ne,s,z),z),Q=n.normalize(n.add(re,oe,Q),Q),te+=3,o=0;o<d.length;o++){var ae;r=d[o];var se,ue,le=r.leftPositions,ce=r.rightPositions,de=V,he=N,pe=L;if(Q=n.fromArray(_,te,Q),c(le)){for(E(Y,Q,q,void 0,X,t),X-=3,se=I,ue=D,ae=0;ae<le.length/3;ae++)de=n.fromArray(le,3*ae,de),K[J++]=se,K[J++]=ue-ae-1,K[J++]=ue-ae,u.addAttribute(H,de,void 0,X),he=n.fromArray(H,3*(ue-ae-1),he),pe=n.fromArray(H,3*se,pe),q=n.normalize(n.subtract(he,pe,q),q),E(Y,Q,q,void 0,X,t),X-=3;de=n.fromArray(H,3*se,de),he=n.subtract(n.fromArray(H,3*ue,he),de,he),pe=n.subtract(n.fromArray(H,3*(ue-ae),pe),de,pe),q=n.normalize(n.add(he,pe,q),q),E(Y,Q,q,j,void 0,t),j+=3}else{for(E(Y,Q,q,j,void 0,t),j+=3,se=D,ue=I,ae=0;ae<ce.length/3;ae++)de=n.fromArray(ce,3*ae,de),K[J++]=se,K[J++]=ue+ae,K[J++]=ue+ae+1,u.addAttribute(H,de,j),he=n.fromArray(H,3*se,he),pe=n.fromArray(H,3*(ue+ae),pe),q=n.normalize(n.subtract(he,pe,q),q),E(Y,Q,q,j,void 0,t),j+=3;de=n.fromArray(H,3*se,de),he=n.subtract(n.fromArray(H,3*(ue+ae),he),de,he),pe=n.subtract(n.fromArray(H,3*ue,pe),de,pe),q=n.normalize(n.negate(n.add(pe,he,q),q),q),E(Y,Q,q,void 0,X,t),X-=3}for(ie=l[ee++],ne=l[ee++],ie.splice(0,3),ne.splice(ne.length-3,3),H.set(ie,j),H.set(ne,X-ne.length+1),s=ne.length-3,te+=3,q=n.fromArray(p,te,q),ae=0;ae<ne.length;ae+=3)re=i.geodeticSurfaceNormal(n.fromArray(ie,ae,U),U),oe=i.geodeticSurfaceNormal(n.fromArray(ne,s-ae,z),z),Q=n.normalize(n.add(re,oe,Q),Q),E(Y,Q,q,j,X,t),I=j/3,b=I-1,D=(X-2)/3,S=D+1,K[J++]=S,K[J++]=b,K[J++]=D,K[J++]=D,K[J++]=b,K[J++]=I,j+=3,X-=3;j-=3,X+=3}if(Q=n.fromArray(_,_.length-3,Q),E(Y,Q,q,j,X,t),P){j+=3,X-=3,R=N,O=L;var me=h[1];for(o=0;o<Z;o++)R=n.fromArray(me,3*(A-o-1),R),O=n.fromArray(me,3*o,O),u.addAttribute(H,R,void 0,X),u.addAttribute(H,O,j),E(Y,Q,q,j,X,t),I=j/3,b=I-1,D=(X-2)/3,S=D+1,K[J++]=S,K[J++]=b,K[J++]=D,K[J++]=D,K[J++]=b,K[J++]=I,j+=3,X-=3}if(y.position=new m({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:H}),t.st){var fe,_e,ge=new Float32Array(B/3*2),ve=0;if(P){w/=3,x/=3;var ye=Math.PI/(A+1);_e=1/(w-A+1),fe=1/(x-A+1);var we,xe=A/2;for(o=xe+1;o<A+1;o++)we=v.PI_OVER_TWO+ye*o,ge[ve++]=fe*(1+Math.cos(we)),ge[ve++]=.5*(1+Math.sin(we));for(o=1;o<x-A+1;o++)ge[ve++]=o*fe,ge[ve++]=0;for(o=A;o>xe;o--)we=v.PI_OVER_TWO-o*ye,ge[ve++]=1-fe*(1+Math.cos(we)),ge[ve++]=.5*(1+Math.sin(we));for(o=xe;o>0;o--)we=v.PI_OVER_TWO-ye*o,ge[ve++]=1-_e*(1+Math.cos(we)),ge[ve++]=.5*(1+Math.sin(we));for(o=w-A;o>0;o--)ge[ve++]=o*_e,ge[ve++]=1;for(o=1;o<xe+1;o++)we=v.PI_OVER_TWO+ye*o,ge[ve++]=_e*(1+Math.cos(we)),ge[ve++]=.5*(1+Math.sin(we))}else{for(w/=3,x/=3,_e=1/(w-1),fe=1/(x-1),o=0;o<x;o++)ge[ve++]=o*fe,ge[ve++]=0;for(o=w;o>0;o--)ge[ve++]=(o-1)*_e,ge[ve++]=1}y.st=new m({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:ge})}return t.normal&&(y.normal=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:Y.normals})),t.tangent&&(y.tangent=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:Y.tangents})),t.bitangent&&(y.bitangent=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:Y.bitangents})),{attributes:y,indices:K}}function P(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;var i,r,o=e.position.values;(t.normal||t.bitangent)&&(i=e.normal.values,r=e.bitangent.values);var a,s=e.position.values.length/18,l=3*s,c=2*s,d=2*l;if(t.normal||t.bitangent||t.tangent){var h=t.normal?new Float32Array(6*l):void 0,p=t.tangent?new Float32Array(6*l):void 0,m=t.bitangent?new Float32Array(6*l):void 0,f=M,_=F,g=N,v=L,y=R,w=V,x=d;for(a=0;a<l;a+=3){var C=x+d;f=n.fromArray(o,a,f),_=n.fromArray(o,a+l,_),g=n.fromArray(o,(a+3)%l,g),_=n.subtract(_,f,_),g=n.subtract(g,f,g),v=n.normalize(n.cross(_,g,v),v),t.normal&&(u.addAttribute(h,v,C),u.addAttribute(h,v,C+3),u.addAttribute(h,v,x),u.addAttribute(h,v,x+3)),(t.tangent||t.bitangent)&&(w=n.fromArray(i,a,w),t.bitangent&&(u.addAttribute(m,w,C),u.addAttribute(m,w,C+3),u.addAttribute(m,w,x),u.addAttribute(m,w,x+3)),t.tangent&&(y=n.normalize(n.cross(w,v,y),y),u.addAttribute(p,y,C),u.addAttribute(p,y,C+3),u.addAttribute(p,y,x),u.addAttribute(p,y,x+3))),x+=6}if(t.normal){for(h.set(i),a=0;a<l;a+=3)h[a+l]=-i[a],h[a+l+1]=-i[a+1],h[a+l+2]=-i[a+2];e.normal.values=h}else e.normal=void 0;if(t.bitangent?(m.set(r),m.set(r,l),e.bitangent.values=m):e.bitangent=void 0,t.tangent){var T=e.tangent.values;p.set(T),p.set(T,l),e.tangent.values=p}}if(t.st){var E=e.st.values,A=new Float32Array(6*c);A.set(E),A.set(E,c);for(var P=2*c,S=0;S<2;S++){for(A[P++]=E[0],A[P++]=E[1],a=2;a<c;a+=2){var b=E[a],D=E[a+1];A[P++]=b,A[P++]=D,A[P++]=b,A[P++]=D}A[P++]=E[0],A[P++]=E[1]}e.st.values=A}return e}function S(e,t,i){i[t++]=e[0],i[t++]=e[1],i[t++]=e[2];for(var n=3;n<e.length;n+=3){var r=e[n],o=e[n+1],a=e[n+2];i[t++]=r,i[t++]=o,i[t++]=a,i[t++]=r,i[t++]=o,i[t++]=a}return i[t++]=e[0],i[t++]=e[1],i[t++]=e[2],i}function b(t,i){var n=new C({position:i.position,normal:i.normal||i.bitangent||t.shadowVolume,tangent:i.tangent,bitangent:i.normal||i.bitangent,st:i.st}),r=t.ellipsoid,o=u.computePositions(t),s=A(o,n,r),l=t.height,d=t.extrudedHeight,h=s.attributes,p=s.indices,f=h.position.values,v=f.length,w=new Float64Array(6*v),x=new Float64Array(v);x.set(f);var T=new Float64Array(4*v);f=y.scaleToGeodeticHeight(f,l,r),T=S(f,0,T),x=y.scaleToGeodeticHeight(x,d,r),T=S(x,2*v,T),w.set(f),w.set(x,v),w.set(T,2*v),h.position.values=w,h=P(h,i);var E,b=v/3;if(t.shadowVolume){var D=h.normal.values;v=D.length;var I=new Float32Array(6*v);for(E=0;E<v;E++)D[E]=-D[E];I.set(D,v),I=S(D,4*v,I),h.extrudeDirection=new m({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:I}),i.normal||(h.normal=void 0)}if(c(t.offsetAttribute)){var O=new Uint8Array(6*b);if(t.offsetAttribute===_.TOP)O=e(O,1,0,b),O=e(O,1,2*b,4*b);else{var M=t.offsetAttribute===_.NONE?0:1;O=e(O,M)}h.applyOffset=new m({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}var F=p.length,N=b+b,L=g.createTypedArray(w.length/3,2*F+3*N);L.set(p);var R=F;for(E=0;E<F;E+=3){var V=p[E],U=p[E+1],z=p[E+2];L[R++]=z+b,L[R++]=U+b,L[R++]=V+b}var B,H,k,G;for(E=0;E<N;E+=2)B=E+N,H=B+N,k=B+1,G=H+1,L[R++]=B,L[R++]=H,L[R++]=k,L[R++]=k,L[R++]=H,L[R++]=G;return{attributes:h,indices:L}}function D(e,t,i,r,o,a){var s=n.subtract(t,e,B);n.normalize(s,s);var u=i.geodeticSurfaceNormal(e,H),l=n.cross(s,u,B);n.multiplyByScalar(l,r,l);var c=o.latitude,d=o.longitude,h=a.latitude,p=a.longitude;n.add(e,l,H),i.cartesianToCartographic(H,k);var m=k.latitude,f=k.longitude;c=Math.min(c,m),d=Math.min(d,f),h=Math.max(h,m),p=Math.max(p,f),n.subtract(e,l,H),i.cartesianToCartographic(H,k),m=k.latitude,f=k.longitude,c=Math.min(c,m),d=Math.min(d,f),h=Math.max(h,m),p=Math.max(p,f),o.latitude=c,o.longitude=d,a.latitude=h,a.longitude=p}function I(e,i,r,o,a){e=T(e,i);var u=t(e,n.equalsEpsilon),l=u.length;if(l<2||r<=0)return new x;var d=.5*r;Y.latitude=Number.POSITIVE_INFINITY,Y.longitude=Number.POSITIVE_INFINITY,j.latitude=Number.NEGATIVE_INFINITY,j.longitude=Number.NEGATIVE_INFINITY;var h,p;if(o===s.ROUNDED){var m=u[0];n.subtract(m,u[1],G),n.normalize(G,G),n.multiplyByScalar(G,d,G),n.add(m,G,W),i.cartesianToCartographic(W,k),h=k.latitude,p=k.longitude,Y.latitude=Math.min(Y.latitude,h),Y.longitude=Math.min(Y.longitude,p),j.latitude=Math.max(j.latitude,h),j.longitude=Math.max(j.longitude,p)}for(var f=0;f<l-1;++f)D(u[f],u[f+1],i,d,Y,j);var _=u[l-1];n.subtract(_,u[l-2],G),n.normalize(G,G),n.multiplyByScalar(G,d,G),n.add(_,G,W),D(_,W,i,d,Y,j),o===s.ROUNDED&&(i.cartesianToCartographic(W,k),h=k.latitude,p=k.longitude,Y.latitude=Math.min(Y.latitude,h),Y.longitude=Math.min(Y.longitude,p),j.latitude=Math.max(j.latitude,h),j.longitude=Math.max(j.longitude,p));var g=c(a)?a:new x;return g.north=j.latitude,g.south=Y.latitude,g.east=j.longitude,g.west=Y.longitude,g}function O(e){e=l(e,l.EMPTY_OBJECT);var t=e.positions,i=e.width,r=l(e.height,0),o=l(e.extrudedHeight,r);this._positions=t,this._ellipsoid=h.clone(l(e.ellipsoid,h.WGS84)),this._vertexFormat=C.clone(l(e.vertexFormat,C.DEFAULT)),this._width=i,this._height=Math.max(r,o),this._extrudedHeight=Math.min(r,o),this._cornerType=l(e.cornerType,s.ROUNDED),this._granularity=l(e.granularity,v.RADIANS_PER_DEGREE),this._shadowVolume=l(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*n.packedLength+h.packedLength+C.packedLength+7}var M=new n,F=new n,N=new n,L=new n,R=new n,V=new n,U=new n,z=new n,B=new n,H=new n,k=new r,G=new n,W=new n,Y=new r,j=new r;O.pack=function(e,t,i){i=l(i,0);var r=e._positions,o=r.length;t[i++]=o;for(var a=0;a<o;++a,i+=n.packedLength)n.pack(r[a],t,i);return h.pack(e._ellipsoid,t,i),i+=h.packedLength,C.pack(e._vertexFormat,t,i),i+=C.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i++]=e._shadowVolume?1:0,t[i]=l(e._offsetAttribute,-1),t};var X=h.clone(h.UNIT_SPHERE),Q=new C,q={positions:void 0,ellipsoid:X,vertexFormat:Q,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};return O.unpack=function(e,t,i){t=l(t,0);for(var r=e[t++],o=new Array(r),a=0;a<r;++a,t+=n.packedLength)o[a]=n.unpack(e,t);var s=h.unpack(e,t,X);t+=h.packedLength;var u=C.unpack(e,t,Q);t+=C.packedLength;var d=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t++],g=1===e[t++],v=e[t];return c(i)?(i._positions=o,i._ellipsoid=h.clone(s,i._ellipsoid),i._vertexFormat=C.clone(u,i._vertexFormat),i._width=d,i._height=p,i._extrudedHeight=m,i._cornerType=f,i._granularity=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i):(q.positions=o,q.width=d,q.height=p,q.extrudedHeight=m,q.cornerType=f,q.granularity=_,q.shadowVolume=g,q.offsetAttribute=-1===v?void 0:v,new O(q))},O.computeRectangle=function(e,t){e=l(e,l.EMPTY_OBJECT);var i=e.positions,n=e.width;return I(i,l(e.ellipsoid,h.WGS84),n,l(e.cornerType,s.ROUNDED),t)},O.createGeometry=function(r){var o=r._positions,s=r._width,l=r._ellipsoid;o=T(o,l);var d=t(o,n.equalsEpsilon);if(!(d.length<2||s<=0)){var h,f=r._height,g=r._extrudedHeight,x=!v.equalsEpsilon(f,g,0,v.EPSILON2),C=r._vertexFormat,E={ellipsoid:l,positions:d,width:s,cornerType:r._cornerType,granularity:r._granularity,saveAttributes:!0};if(x)E.height=f,E.extrudedHeight=g,E.shadowVolume=r._shadowVolume,E.offsetAttribute=r._offsetAttribute,h=b(E,C);else{if(h=A(u.computePositions(E),C,l),h.attributes.position.values=y.scaleToGeodeticHeight(h.attributes.position.values,f,l),c(r._offsetAttribute)){var P=r._offsetAttribute===_.NONE?0:1,S=h.attributes.position.values.length,D=new Uint8Array(S/3);e(D,P),h.attributes.applyOffset=new m({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:D})}}var I=h.attributes,O=i.fromVertices(I.position.values,void 0,3);return C.position||(h.attributes.position.values=void 0),new p({attributes:I,indices:h.indices,primitiveType:w.TRIANGLES,boundingSphere:O,offsetAttribute:r._offsetAttribute})}},O.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new O({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:r,granularity:n,extrudedHeight:o,height:a,vertexFormat:C.POSITION_ONLY,shadowVolume:!0})},d(O.prototype,{rectangle:{get:function(){return c(this._rectangle)||(this._rectangle=I(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}}),O}.apply(t,n))&&(e.exports=r)},2233:function(e,t,i){var n,r;n=[i(130),i(292),i(38),i(10),i(12),i(31),i(1938),i(1979),i(1),i(0),i(23),i(76),i(90),i(129),i(151),i(49),i(9),i(291),i(54)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v){"use strict";function y(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function w(e,t){var i,r,u,c=[],d=e.positions,m=e.corners,_=e.endPositions,g=new p,v=0,y=0,w=0;for(r=0;r<d.length;r+=2)u=d[r].length-3,v+=u,w+=u/3*4,y+=d[r+1].length-3;for(v+=3,y+=3,r=0;r<m.length;r++){i=m[r];var x=m[r].leftPositions;l(x)?(u=x.length,v+=u,w+=u/3*2):(u=m[r].rightPositions.length,y+=u,w+=u/3*2)}var C,P=l(_);P&&(C=_[0].length-3,v+=C,y+=C,C/=3,w+=4*C);var S,b,D,I,O,M,F=v+y,N=new Float64Array(F),L=0,R=F-1,V=C/2,U=f.createTypedArray(F/3,w+4),z=0;if(U[z++]=L/3,U[z++]=(R-2)/3,P){c.push(L/3),M=T,O=E;var B=_[0];for(r=0;r<V;r++)M=n.fromArray(B,3*(V-1-r),M),O=n.fromArray(B,3*(V+r),O),s.addAttribute(N,O,L),s.addAttribute(N,M,void 0,R),b=L/3,I=b+1,S=(R-2)/3,D=S-1,U[z++]=S,U[z++]=D,U[z++]=b,U[z++]=I,L+=3,R-=3}var H=0,k=d[H++],G=d[H++];for(N.set(k,L),N.set(G,R-G.length+1),u=G.length-3,c.push(L/3,(R-2)/3),r=0;r<u;r+=3)b=L/3,I=b+1,S=(R-2)/3,D=S-1,U[z++]=S,U[z++]=D,U[z++]=b,U[z++]=I,L+=3,R-=3;for(r=0;r<m.length;r++){var W;i=m[r];var Y,j=i.leftPositions,X=i.rightPositions,Q=A;if(l(j)){for(R-=3,Y=D,c.push(I),W=0;W<j.length/3;W++)Q=n.fromArray(j,3*W,Q),U[z++]=Y-W-1,U[z++]=Y-W,s.addAttribute(N,Q,void 0,R),R-=3;c.push(Y-Math.floor(j.length/6)),t===a.BEVELED&&c.push((R-2)/3+1),L+=3}else{for(L+=3,Y=I,c.push(D),W=0;W<X.length/3;W++)Q=n.fromArray(X,3*W,Q),U[z++]=Y+W,U[z++]=Y+W+1,s.addAttribute(N,Q,L),L+=3;c.push(Y+Math.floor(X.length/6)),t===a.BEVELED&&c.push(L/3-1),R-=3}for(k=d[H++],G=d[H++],k.splice(0,3),G.splice(G.length-3,3),N.set(k,L),N.set(G,R-G.length+1),u=G.length-3,W=0;W<G.length;W+=3)I=L/3,b=I-1,D=(R-2)/3,S=D+1,U[z++]=S,U[z++]=D,U[z++]=b,U[z++]=I,L+=3,R-=3;L-=3,R+=3,c.push(L/3,(R-2)/3)}if(P){L+=3,R-=3,M=T,O=E;var q=_[1];for(r=0;r<V;r++)M=n.fromArray(q,3*(C-r-1),M),O=n.fromArray(q,3*r,O),s.addAttribute(N,M,void 0,R),s.addAttribute(N,O,L),I=L/3,b=I-1,D=(R-2)/3,S=D+1,U[z++]=S,U[z++]=D,U[z++]=b,U[z++]=I,L+=3,R-=3;c.push(L/3)}else c.push(L/3,(R-2)/3);return U[z++]=L/3,U[z++]=(R-2)/3,g.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:N}),{attributes:g,indices:U,wallIndices:c}}function x(t){var i=t.ellipsoid,n=s.computePositions(t),r=w(n,t.cornerType),a=r.wallIndices,u=t.height,c=t.extrudedHeight,d=r.attributes,p=r.indices,_=d.position.values,v=_.length,y=new Float64Array(v);y.set(_);var x=new Float64Array(2*v);if(_=g.scaleToGeodeticHeight(_,u,i),y=g.scaleToGeodeticHeight(y,c,i),x.set(_),x.set(y,v),d.position.values=x,v/=3,l(t.offsetAttribute)){var C=new Uint8Array(2*v);if(t.offsetAttribute===m.TOP)C=e(C,1,0,v);else{var T=t.offsetAttribute===m.NONE?0:1;C=e(C,T)}d.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}var E,A=p.length,P=f.createTypedArray(x.length/3,2*(A+a.length));P.set(p);var S=A;for(E=0;E<A;E+=2){var b=p[E],D=p[E+1];P[S++]=b+v,P[S++]=D+v}var I,O;for(E=0;E<a.length;E++)I=a[E],O=I+v,P[S++]=I,P[S++]=O;return{attributes:d,indices:P}}function C(e){e=u(e,u.EMPTY_OBJECT);var t=e.positions,i=e.width,r=u(e.height,0),o=u(e.extrudedHeight,r);this._positions=t,this._ellipsoid=c.clone(u(e.ellipsoid,c.WGS84)),this._width=i,this._height=Math.max(r,o),this._extrudedHeight=Math.min(r,o),this._cornerType=u(e.cornerType,a.ROUNDED),this._granularity=u(e.granularity,_.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*n.packedLength+c.packedLength+6}var T=new n,E=new n,A=new n;C.pack=function(e,t,i){i=u(i,0);var r=e._positions,o=r.length;t[i++]=o;for(var a=0;a<o;++a,i+=n.packedLength)n.pack(r[a],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=u(e._offsetAttribute,-1),t};var P=c.clone(c.UNIT_SPHERE),S={positions:void 0,ellipsoid:P,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return C.unpack=function(e,t,i){t=u(t,0);for(var r=e[t++],o=new Array(r),a=0;a<r;++a,t+=n.packedLength)o[a]=n.unpack(e,t);var s=c.unpack(e,t,P);t+=c.packedLength;var d=e[t++],h=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t];return l(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=d,i._height=h,i._extrudedHeight=p,i._cornerType=m,i._granularity=f,i._offsetAttribute=-1===_?void 0:_,i):(S.positions=o,S.width=d,S.height=h,S.extrudedHeight=p,S.cornerType=m,S.granularity=f,S.offsetAttribute=-1===_?void 0:_,new C(S))},C.createGeometry=function(r){var a=r._positions,u=r._width,c=r._ellipsoid;a=y(a,c);var p=t(a,n.equalsEpsilon);if(!(p.length<2||u<=0)){var f,C=r._height,T=r._extrudedHeight,E=!_.equalsEpsilon(C,T,0,_.EPSILON2),A={ellipsoid:c,positions:p,width:u,cornerType:r._cornerType,granularity:r._granularity,saveAttributes:!1};if(E)A.height=C,A.extrudedHeight=T,A.offsetAttribute=r._offsetAttribute,f=x(A);else{if(f=w(s.computePositions(A),A.cornerType),f.attributes.position.values=g.scaleToGeodeticHeight(f.attributes.position.values,C,c),l(r._offsetAttribute)){var P=f.attributes.position.values.length,S=new Uint8Array(P/3),b=r._offsetAttribute===m.NONE?0:1;e(S,b),f.attributes.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}}var D=f.attributes,I=i.fromVertices(D.position.values,void 0,3);return new d({attributes:D,indices:f.indices,primitiveType:v.LINES,boundingSphere:I,offsetAttribute:r._offsetAttribute})}},C}.apply(t,n))&&(e.exports=r)},2234:function(e,t,i){var n,r;n=[i(293),i(10),i(12),i(25),i(150),i(0),i(3),i(1934),i(2235),i(2236),i(128),i(151),i(215),i(745),i(16),i(1933),i(746),i(153),i(1935),i(152),i(421),i(1937),i(1936),i(1950),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E){"use strict";function A(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function P(e,t){T.call(this,{entity:e,scene:t,geometryOptions:new A(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function S(e,t,i){x.call(this,e,t,i)}var b=new n,D=t.ZERO,I=new t,O=new m;return o(Object.create)&&(P.prototype=Object.create(T.prototype),P.prototype.constructor=P),P.prototype.createFillGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),a={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:s.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof w){var l;o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(l=this._materialProperty.color.getValue(e,b)),o(l)||(l=n.WHITE),a.color=r.fromColor(l)}return o(this._options.offsetAttribute)&&(a.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,D,I))),new c({id:t,geometry:new u(this._options),attributes:a})},P.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),a=E.getValueOrDefault(this._outlineColorProperty,e,n.BLACK,b),u=this._distanceDisplayConditionProperty.getValue(e),d={show:new f(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(a),distanceDisplayCondition:s.fromDistanceDisplayCondition(u),offset:void 0};return o(this._options.offsetAttribute)&&(d.offset=p.fromCartesian3(E.getValueOrDefault(this._terrainOffsetProperty,e,D,I))),new c({id:t,geometry:new l(this._options),attributes:d})},P.prototype._computeCenter=function(e,t){return E.getValueOrUndefined(this._entity.position,e,t)},P.prototype._isHidden=function(e,t){var i=e.position;return!o(i)||!o(t.semiMajorAxis)||!o(t.semiMinorAxis)||C.prototype._isHidden.call(this,e,t)},P.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!o(t.height)&&!o(t.extrudedHeight)&&_.isSupported(this._scene)},P.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!E.isConstant(t.rotation)||!E.isConstant(t.height)||!E.isConstant(t.extrudedHeight)||!E.isConstant(t.granularity)||!E.isConstant(t.stRotation)||!E.isConstant(t.outlineWidth)||!E.isConstant(t.numberOfVerticalLines)||!E.isConstant(t.zIndex)||this._onTerrain&&!E.isConstant(this._materialProperty)},P.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight;return 0===t||o(i)&&i!==t},P.prototype._setStaticOptions=function(t,i){var n=i.height,r=i.heightReference,o=i.extrudedHeight,a=i.extrudedHeightReference,s=this._options;s.vertexFormat=this._materialProperty instanceof w?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,s.center=t.position.getValue(h.MINIMUM_VALUE,s.center),s.semiMajorAxis=i.semiMajorAxis.getValue(h.MINIMUM_VALUE,s.semiMajorAxis),s.semiMinorAxis=i.semiMinorAxis.getValue(h.MINIMUM_VALUE,s.semiMinorAxis),s.rotation=E.getValueOrUndefined(i.rotation,h.MINIMUM_VALUE),s.granularity=E.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),s.stRotation=E.getValueOrUndefined(i.stRotation,h.MINIMUM_VALUE),s.numberOfVerticalLines=E.getValueOrUndefined(i.numberOfVerticalLines,h.MINIMUM_VALUE),s.offsetAttribute=T.computeGeometryOffsetAttribute(r,a,h.MINIMUM_VALUE),s.height=T.getGeometryHeight(n,r,h.MINIMUM_VALUE);var l=T.getGeometryExtrudedHeight(o,a,h.MINIMUM_VALUE);l===T.CLAMP_TO_GROUND&&(l=e.getApproximateTerrainHeights(u.computeRectangle(s,O)).minimumTerrainHeight),s.extrudedHeight=l},P.DynamicGeometryUpdater=S,o(Object.create)&&(S.prototype=Object.create(x.prototype),S.prototype.constructor=S),S.prototype._isHidden=function(e,t,i){var n=this._options;return!o(n.center)||!o(n.semiMajorAxis)||!o(n.semiMinorAxis)||x.prototype._isHidden.call(this,e,t,i)},S.prototype._setOptions=function(t,i,n){var r=this._options,o=i.height,a=i.heightReference,s=i.extrudedHeight,l=i.extrudedHeightReference;r.center=E.getValueOrUndefined(t.position,n,r.center),r.semiMajorAxis=E.getValueOrUndefined(i.semiMajorAxis,n),r.semiMinorAxis=E.getValueOrUndefined(i.semiMinorAxis,n),r.rotation=E.getValueOrUndefined(i.rotation,n),r.granularity=E.getValueOrUndefined(i.granularity,n),r.stRotation=E.getValueOrUndefined(i.stRotation,n),r.numberOfVerticalLines=E.getValueOrUndefined(i.numberOfVerticalLines,n),r.offsetAttribute=T.computeGeometryOffsetAttribute(a,l,n),r.height=T.getGeometryHeight(o,a,n);var c=T.getGeometryExtrudedHeight(s,l,n);c===T.CLAMP_TO_GROUND&&(c=e.getApproximateTerrainHeights(u.computeRectangle(r,O)).minimumTerrainHeight),r.extrudedHeight=c},P}.apply(t,n))&&(e.exports=r)},2235:function(e,t,i){var n,r;n=[i(130),i(38),i(17),i(10),i(24),i(12),i(31),i(1),i(0),i(2),i(3),i(1981),i(23),i(72),i(76),i(90),i(129),i(128),i(151),i(290),i(49),i(9),i(40),i(54),i(59),i(16),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P){"use strict";function S(t,r,o){var s=r.vertexFormat,l=r.center,c=r.semiMajorAxis,h=r.semiMinorAxis,m=r.ellipsoid,g=r.stRotation,y=o?t.length/3*2:t.length/3,w=r.shadowVolume,x=s.st?new Float32Array(2*y):void 0,T=s.normal?new Float32Array(3*y):void 0,A=s.tangent?new Float32Array(3*y):void 0,P=s.bitangent?new Float32Array(3*y):void 0,S=w?new Float32Array(3*y):void 0,b=0,D=W,I=Y,O=j,M=new p(m),F=M.project(m.cartesianToCartographic(l,X),Q),N=m.scaleToGeodeticSurface(l,R);m.geodeticSurfaceNormal(N,N);var L=H,z=k;if(0!==g){var K=E.fromAxisAngle(N,g,G);L=C.fromQuaternion(K,L),K=E.fromAxisAngle(N,-g,G),z=C.fromQuaternion(K,z)}else L=C.clone(C.IDENTITY,L),z=C.clone(C.IDENTITY,z);for(var J=i.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,q),$=i.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Z),ee=t.length,te=o?ee:0,ie=te/3*2,ne=0;ne<ee;ne+=3){var re=ne+1,oe=ne+2,ae=n.fromArray(t,ne,R);if(s.st){var se=C.multiplyByVector(L,ae,V),ue=M.project(m.cartesianToCartographic(se,X),U);n.subtract(ue,F,ue),B.x=(ue.x+c)/(2*c),B.y=(ue.y+h)/(2*h),J.x=Math.min(B.x,J.x),J.y=Math.min(B.y,J.y),$.x=Math.max(B.x,$.x),$.y=Math.max(B.y,$.y),o&&(x[b+ie]=B.x,x[b+1+ie]=B.y),x[b++]=B.x,x[b++]=B.y}(s.normal||s.tangent||s.bitangent||w)&&(D=m.geodeticSurfaceNormal(ae,D),w&&(S[ne+te]=-D.x,S[re+te]=-D.y,S[oe+te]=-D.z),(s.normal||s.tangent||s.bitangent)&&((s.tangent||s.bitangent)&&(I=n.normalize(n.cross(n.UNIT_Z,D,I),I),C.multiplyByVector(z,I,I)),s.normal&&(T[ne]=D.x,T[re]=D.y,T[oe]=D.z,o&&(T[ne+te]=-D.x,T[re+te]=-D.y,T[oe+te]=-D.z)),s.tangent&&(A[ne]=I.x,A[re]=I.y,A[oe]=I.z,o&&(A[ne+te]=-I.x,A[re+te]=-I.y,A[oe+te]=-I.z)),s.bitangent&&(O=n.normalize(n.cross(D,I,O),O),P[ne]=O.x,P[re]=O.y,P[oe]=O.z,o&&(P[ne+te]=O.x,P[re+te]=O.y,P[oe+te]=O.z))))}if(s.st){ee=x.length;for(var le=0;le<ee;le+=2)x[le]=(x[le]-J.x)/($.x-J.x),x[le+1]=(x[le+1]-J.y)/($.y-J.y)}var ce=new _;if(s.position){var de=d.raisePositionsToHeight(t,r,o);ce.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:de})}if(s.st&&(ce.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:x})),s.normal&&(ce.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:T})),s.tangent&&(ce.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:A})),s.bitangent&&(ce.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:P})),w&&(ce.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:S})),o&&u(r.offsetAttribute)){var he=new Uint8Array(y);if(r.offsetAttribute===v.TOP)he=e(he,1,0,y/2);else{var pe=r.offsetAttribute===v.NONE?0:1;he=e(he,pe)}ce.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:he})}return ce}function b(e){var t,i,n,r,o,a=new Array(e*(e+1)*12-6),s=0;for(t=0,n=1,r=0;r<3;r++)a[s++]=n++,a[s++]=t,a[s++]=n;for(r=2;r<e+1;++r){for(n=r*(r+1)-1,t=(r-1)*r-1,a[s++]=n++,a[s++]=t,a[s++]=n,i=2*r,o=0;o<i-1;++o)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;a[s++]=n++,a[s++]=t,a[s++]=n}for(i=2*e,++n,++t,r=0;r<i-1;++r)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;for(a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t++,a[s++]=t,++t,r=e-1;r>1;--r){for(a[s++]=t++,a[s++]=t,a[s++]=n,i=2*r,o=0;o<i-1;++o)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;a[s++]=t++,a[s++]=t++,a[s++]=n++}for(r=0;r<3;r++)a[s++]=t++,a[s++]=t,a[s++]=n;return a}function D(e){var i=e.center;K=n.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(i,K),e.height,K),K=n.add(i,K,K);var r=new t(K,e.semiMajorAxis),o=d.computeEllipsePositions(e,!0,!1),a=o.positions,s=o.numPts,u=S(a,e,!1),l=b(s);return l=w.createTypedArray(a.length/3,l),{boundingSphere:r,attributes:u,indices:l}}function I(t,r){var o=r.vertexFormat,s=r.center,l=r.semiMajorAxis,c=r.semiMinorAxis,d=r.ellipsoid,h=r.height,m=r.extrudedHeight,g=r.stRotation,y=t.length/3*2,w=new Float64Array(3*y),x=o.st?new Float32Array(2*y):void 0,T=o.normal?new Float32Array(3*y):void 0,A=o.tangent?new Float32Array(3*y):void 0,P=o.bitangent?new Float32Array(3*y):void 0,S=r.shadowVolume,b=S?new Float32Array(3*y):void 0,D=0,I=W,O=Y,M=j,F=new p(d),N=F.project(d.cartesianToCartographic(s,X),Q),L=d.scaleToGeodeticSurface(s,R);d.geodeticSurfaceNormal(L,L);for(var k=E.fromAxisAngle(L,g,G),K=C.fromQuaternion(k,H),J=i.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,q),$=i.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Z),ee=t.length,te=ee/3*2,ie=0;ie<ee;ie+=3){var ne,re=ie+1,oe=ie+2,ae=n.fromArray(t,ie,R);if(o.st){var se=C.multiplyByVector(K,ae,V),ue=F.project(d.cartesianToCartographic(se,X),U);n.subtract(ue,N,ue),B.x=(ue.x+l)/(2*l),B.y=(ue.y+c)/(2*c),J.x=Math.min(B.x,J.x),J.y=Math.min(B.y,J.y),$.x=Math.max(B.x,$.x),$.y=Math.max(B.y,$.y),x[D+te]=B.x,x[D+1+te]=B.y,x[D++]=B.x,x[D++]=B.y}ae=d.scaleToGeodeticSurface(ae,ae),ne=n.clone(ae,V),I=d.geodeticSurfaceNormal(ae,I),S&&(b[ie+ee]=-I.x,b[re+ee]=-I.y,b[oe+ee]=-I.z);var le=n.multiplyByScalar(I,h,z);if(ae=n.add(ae,le,ae),le=n.multiplyByScalar(I,m,le),ne=n.add(ne,le,ne),o.position&&(w[ie+ee]=ne.x,w[re+ee]=ne.y,w[oe+ee]=ne.z,w[ie]=ae.x,w[re]=ae.y,w[oe]=ae.z),o.normal||o.tangent||o.bitangent){M=n.clone(I,M);var ce=n.fromArray(t,(ie+3)%ee,z);n.subtract(ce,ae,ce);var de=n.subtract(ne,ae,U);I=n.normalize(n.cross(de,ce,I),I),o.normal&&(T[ie]=I.x,T[re]=I.y,T[oe]=I.z,T[ie+ee]=I.x,T[re+ee]=I.y,T[oe+ee]=I.z),o.tangent&&(O=n.normalize(n.cross(M,I,O),O),A[ie]=O.x,A[re]=O.y,A[oe]=O.z,A[ie+ee]=O.x,A[ie+1+ee]=O.y,A[ie+2+ee]=O.z),o.bitangent&&(P[ie]=M.x,P[re]=M.y,P[oe]=M.z,P[ie+ee]=M.x,P[re+ee]=M.y,P[oe+ee]=M.z)}}if(o.st){ee=x.length;for(var he=0;he<ee;he+=2)x[he]=(x[he]-J.x)/($.x-J.x),x[he+1]=(x[he+1]-J.y)/($.y-J.y)}var pe=new _;if(o.position&&(pe.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:w})),o.st&&(pe.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:x})),o.normal&&(pe.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:T})),o.tangent&&(pe.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:A})),o.bitangent&&(pe.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:P})),S&&(pe.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:b})),u(r.offsetAttribute)){var me=new Uint8Array(y);if(r.offsetAttribute===v.TOP)me=e(me,1,0,y/2);else{var fe=r.offsetAttribute===v.NONE?0:1;me=e(me,fe)}pe.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:me})}return pe}function O(e){for(var t=e.length/3,i=w.createTypedArray(t,6*t),n=0,r=0;r<t;r++){var o=r,a=r+t,s=(o+1)%t,u=s+t;i[n++]=o,i[n++]=a,i[n++]=s,i[n++]=s,i[n++]=a,i[n++]=u}return i}function M(e){var i=e.center,r=e.ellipsoid,o=e.semiMajorAxis,a=n.multiplyByScalar(r.geodeticSurfaceNormal(i,R),e.height,R);J.center=n.add(i,a,J.center),J.radius=o,a=n.multiplyByScalar(r.geodeticSurfaceNormal(i,a),e.extrudedHeight,a),$.center=n.add(i,a,$.center),$.radius=o;var s=d.computeEllipsePositions(e,!0,!0),u=s.positions,l=s.numPts,c=s.outerPositions,h=t.union(J,$),p=S(u,e,!0),f=b(l),_=f.length;f.length=2*_;for(var v=u.length/3,x=0;x<_;x+=3)f[x+_]=f[x+2]+v,f[x+1+_]=f[x+1]+v,f[x+2+_]=f[x]+v;var C=w.createTypedArray(2*v/3,f),E=new m({attributes:p,indices:C,primitiveType:T.TRIANGLES}),A=I(c,e);f=O(c);var P=w.createTypedArray(2*c.length/3,f),D=new m({attributes:A,indices:P,primitiveType:T.TRIANGLES}),M=y.combineInstances([new g({geometry:E}),new g({geometry:D})]);return{boundingSphere:h,attributes:M[0].attributes,indices:M[0].indices}}function F(e,t,i,r,o,a,s){for(var u=d.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:i,rotation:r,granularity:o},!1,!0),l=u.outerPositions,c=l.length/3,h=new Array(c),p=0;p<c;++p)h[p]=n.fromArray(l,3*p);var m=A.fromCartesianArray(h,a,s);return m.width>x.PI&&(m.north=m.north>0?x.PI_OVER_TWO-x.EPSILON7:m.north,m.south=m.south<0?x.EPSILON7-x.PI_OVER_TWO:m.south,m.east=x.PI,m.west=-x.PI),m}function N(e){e=s(e,s.EMPTY_OBJECT);var t=e.center,i=s(e.ellipsoid,h.WGS84),r=e.semiMajorAxis,o=e.semiMinorAxis,a=s(e.granularity,x.RADIANS_PER_DEGREE),u=s(e.vertexFormat,P.DEFAULT),l=s(e.height,0),c=s(e.extrudedHeight,l);this._center=n.clone(t),this._semiMajorAxis=r,this._semiMinorAxis=o,this._ellipsoid=h.clone(i),this._rotation=s(e.rotation,0),this._stRotation=s(e.stRotation,0),this._height=Math.max(c,l),this._granularity=a,this._vertexFormat=P.clone(u),this._extrudedHeight=Math.min(c,l),this._shadowVolume=s(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}function L(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];for(var i=d.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0),r=i.outerPositions,o=r.length/3,a=new Array(o),s=0;s<o;++s)a[s]=n.fromArray(r,3*s);var u=e._ellipsoid,l=e.rectangle;return m._textureCoordinateRotationPoints(a,t,u,l)}var R=new n,V=new n,U=new n,z=new n,B=new i,H=new C,k=new C,G=new E,W=new n,Y=new n,j=new n,X=new r,Q=new n,q=new i,Z=new i,K=new n,J=new t,$=new t;N.packedLength=n.packedLength+h.packedLength+P.packedLength+9,N.pack=function(e,t,i){return i=s(i,0),n.pack(e._center,t,i),i+=n.packedLength,h.pack(e._ellipsoid,t,i),i+=h.packedLength,P.pack(e._vertexFormat,t,i),i+=P.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=s(e._offsetAttribute,-1),t};var ee=new n,te=new h,ie=new P,ne={center:ee,ellipsoid:te,vertexFormat:ie,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};return N.unpack=function(e,t,i){t=s(t,0);var r=n.unpack(e,t,ee);t+=n.packedLength;var o=h.unpack(e,t,te);t+=h.packedLength;var a=P.unpack(e,t,ie);t+=P.packedLength;var l=e[t++],c=e[t++],d=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t++],g=1===e[t++],v=e[t];return u(i)?(i._center=n.clone(r,i._center),i._ellipsoid=h.clone(o,i._ellipsoid),i._vertexFormat=P.clone(a,i._vertexFormat),i._semiMajorAxis=l,i._semiMinorAxis=c,i._rotation=d,i._stRotation=p,i._height=m,i._granularity=f,i._extrudedHeight=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i):(ne.height=m,ne.extrudedHeight=_,ne.granularity=f,ne.stRotation=p,ne.rotation=d,ne.semiMajorAxis=l,ne.semiMinorAxis=c,ne.shadowVolume=g,ne.offsetAttribute=-1===v?void 0:v,new N(ne))},N.computeRectangle=function(e,t){e=s(e,s.EMPTY_OBJECT);var i=e.center,n=s(e.ellipsoid,h.WGS84),r=e.semiMajorAxis,o=e.semiMinorAxis,a=s(e.granularity,x.RADIANS_PER_DEGREE);return F(i,r,o,s(e.rotation,0),a,n,t)},N.createGeometry=function(t){if(!(t._semiMajorAxis<=0||t._semiMinorAxis<=0)){var i=t._height,n=t._extrudedHeight,r=!x.equalsEpsilon(i,n,0,x.EPSILON2);t._center=t._ellipsoid.scaleToGeodeticSurface(t._center,t._center);var o,s={center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,ellipsoid:t._ellipsoid,rotation:t._rotation,height:i,granularity:t._granularity,vertexFormat:t._vertexFormat,stRotation:t._stRotation};if(r)s.extrudedHeight=n,s.shadowVolume=t._shadowVolume,s.offsetAttribute=t._offsetAttribute,o=M(s);else if(o=D(s),u(t._offsetAttribute)){var l=o.attributes.position.values.length,c=new Uint8Array(l/3),d=t._offsetAttribute===v.NONE?0:1;e(c,d),o.attributes.applyOffset=new f({componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:1,values:c})}return new m({attributes:o.attributes,indices:o.indices,primitiveType:T.TRIANGLES,boundingSphere:o.boundingSphere,offsetAttribute:t._offsetAttribute})}},N.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new N({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:r,rotation:e._rotation,stRotation:e._stRotation,granularity:n,extrudedHeight:o,height:a,vertexFormat:P.POSITION_ONLY,shadowVolume:!0})},l(N.prototype,{rectangle:{get:function(){return u(this._rectangle)||(this._rectangle=F(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=L(this)),this._textureCoordinateRotationPoints}}}),N}.apply(t,n))&&(e.exports=r)},2236:function(e,t,i){var n,r;n=[i(130),i(38),i(10),i(31),i(1),i(0),i(3),i(1981),i(23),i(76),i(90),i(129),i(151),i(49),i(9),i(54)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f){"use strict";function _(e){var r=e.center;w=i.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(r,w),e.height,w),w=i.add(r,w,w);for(var o=new t(w,e.semiMajorAxis),a=s.computeEllipsePositions(e,!1,!0).outerPositions,u=new d({position:new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:s.raisePositionsToHeight(a,e,!1)})}),l=a.length/3,h=p.createTypedArray(l,2*l),m=0,f=0;f<l;++f)h[m++]=f,h[m++]=(f+1)%l;return{boundingSphere:o,attributes:u,indices:h}}function g(a){var u=a.center,l=a.ellipsoid,f=a.semiMajorAxis,_=i.multiplyByScalar(l.geodeticSurfaceNormal(u,y),a.height,y);x.center=i.add(u,_,x.center),x.radius=f,_=i.multiplyByScalar(l.geodeticSurfaceNormal(u,_),a.extrudedHeight,_),C.center=i.add(u,_,C.center),C.radius=f;var g=s.computeEllipsePositions(a,!1,!0).outerPositions,v=new d({position:new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:s.raisePositionsToHeight(g,a,!0)})});g=v.position.values;var w=t.union(x,C),T=g.length/3;if(o(a.offsetAttribute)){var E=new Uint8Array(T);if(a.offsetAttribute===h.TOP)E=e(E,1,0,T/2);else{var A=a.offsetAttribute===h.NONE?0:1;E=e(E,A)}v.applyOffset=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}var P=r(a.numberOfVerticalLines,16);P=m.clamp(P,0,T/2);var S=p.createTypedArray(T,2*T+2*P);T/=2;var b,D=0;for(b=0;b<T;++b)S[D++]=b,S[D++]=(b+1)%T,S[D++]=b+T,S[D++]=(b+1)%T+T;var I;if(P>0){var O=Math.min(P,T);I=Math.round(T/O);var M=Math.min(I*P,T);for(b=0;b<M;b+=I)S[D++]=b,S[D++]=b+T}return{boundingSphere:w,attributes:v,indices:S}}function v(e){e=r(e,r.EMPTY_OBJECT);var t=e.center,n=r(e.ellipsoid,u.WGS84),o=e.semiMajorAxis,a=e.semiMinorAxis,s=r(e.granularity,m.RADIANS_PER_DEGREE),l=r(e.height,0),c=r(e.extrudedHeight,l);this._center=i.clone(t),this._semiMajorAxis=o,this._semiMinorAxis=a,this._ellipsoid=u.clone(n),this._rotation=r(e.rotation,0),this._height=Math.max(c,l),this._granularity=s,this._extrudedHeight=Math.min(c,l),this._numberOfVerticalLines=Math.max(r(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}var y=new i,w=new i,x=new t,C=new t;v.packedLength=i.packedLength+u.packedLength+8,v.pack=function(e,t,n){return n=r(n,0),i.pack(e._center,t,n),n+=i.packedLength,u.pack(e._ellipsoid,t,n),n+=u.packedLength,t[n++]=e._semiMajorAxis,t[n++]=e._semiMinorAxis,t[n++]=e._rotation,t[n++]=e._height,t[n++]=e._granularity,t[n++]=e._extrudedHeight,t[n++]=e._numberOfVerticalLines,t[n]=r(e._offsetAttribute,-1),t};var T=new i,E=new u,A={center:T,ellipsoid:E,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};return v.unpack=function(e,t,n){t=r(t,0);var a=i.unpack(e,t,T);t+=i.packedLength;var s=u.unpack(e,t,E);t+=u.packedLength;var l=e[t++],c=e[t++],d=e[t++],h=e[t++],p=e[t++],m=e[t++],f=e[t++],_=e[t];return o(n)?(n._center=i.clone(a,n._center),n._ellipsoid=u.clone(s,n._ellipsoid),n._semiMajorAxis=l,n._semiMinorAxis=c,n._rotation=d,n._height=h,n._granularity=p,n._extrudedHeight=m,n._numberOfVerticalLines=f,n._offsetAttribute=-1===_?void 0:_,n):(A.height=h,A.extrudedHeight=m,A.granularity=p,A.rotation=d,A.semiMajorAxis=l,A.semiMinorAxis=c,A.numberOfVerticalLines=f,A.offsetAttribute=-1===_?void 0:_,new v(A))},v.createGeometry=function(t){if(!(t._semiMajorAxis<=0||t._semiMinorAxis<=0)){var i=t._height,r=t._extrudedHeight,a=!m.equalsEpsilon(i,r,0,m.EPSILON2);t._center=t._ellipsoid.scaleToGeodeticSurface(t._center,t._center);var s,u={center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,ellipsoid:t._ellipsoid,rotation:t._rotation,height:i,granularity:t._granularity,numberOfVerticalLines:t._numberOfVerticalLines};if(a)u.extrudedHeight=r,u.offsetAttribute=t._offsetAttribute,s=g(u);else if(s=_(u),o(t._offsetAttribute)){var d=s.attributes.position.values.length,p=new Uint8Array(d/3),v=t._offsetAttribute===h.NONE?0:1;e(p,v),s.attributes.applyOffset=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})}return new l({attributes:s.attributes,indices:s.indices,primitiveType:f.LINES,boundingSphere:s.boundingSphere,offsetAttribute:t._offsetAttribute})}},v}.apply(t,n))&&(e.exports=r)},2237:function(e,t,i){var n,r;n=[i(10),i(12),i(25),i(150),i(1),i(0),i(2),i(154),i(1934),i(1954),i(797),i(128),i(151),i(215),i(745),i(20),i(1933),i(153),i(1935),i(152),i(183),i(46),i(1958),i(421),i(1937),i(1936),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S){"use strict";function b(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function D(e,t){A.call(this,{entity:e,scene:t,geometryOptions:new b(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function I(t,i,n){E.call(this,t,i,n),this._scene=t._scene,this._modelMatrix=new f,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new e,this._material={}}var O=new T(i.WHITE),M=e.ZERO,F=new e,N=new e,L=new i,R=new e(1,1,1);return o(Object.create)&&(D.prototype=Object.create(A.prototype),D.prototype.constructor=D),a(D.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),D.prototype.createFillGeometryInstance=function(e,t,r){var a,s=this._entity,c=s.isAvailable(e),h=new _(c&&s.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),p=this._distanceDisplayConditionProperty.getValue(e),f=u.fromDistanceDisplayCondition(p),g={show:h,distanceDisplayCondition:f,color:void 0,offset:void 0};if(this._materialProperty instanceof T){var v;o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||c)&&(v=this._materialProperty.color.getValue(e,L)),o(v)||(v=i.WHITE),a=n.fromColor(v),g.color=a}return o(this._options.offsetAttribute)&&(g.offset=m.fromCartesian3(S.getValueOrDefault(this._terrainOffsetProperty,e,M,F))),new d({id:s,geometry:new l(this._options),modelMatrix:t?void 0:s.computeModelMatrixForHeightReference(e,s.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,r),attributes:g})},D.prototype.createOutlineGeometryInstance=function(e,t,r){var a=this._entity,s=a.isAvailable(e),l=S.getValueOrDefault(this._outlineColorProperty,e,i.BLACK,L),h=this._distanceDisplayConditionProperty.getValue(e),p={show:new _(s&&a.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(l),distanceDisplayCondition:u.fromDistanceDisplayCondition(h),offset:void 0};return o(this._options.offsetAttribute)&&(p.offset=m.fromCartesian3(S.getValueOrDefault(this._terrainOffsetProperty,e,M,F))),new d({id:a,geometry:new c(this._options),modelMatrix:t?void 0:a.computeModelMatrixForHeightReference(e,a.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,r),attributes:p})},D.prototype._computeCenter=function(e,t){return S.getValueOrUndefined(this._entity.position,e,t)},D.prototype._isHidden=function(e,t){return!o(e.position)||!o(t.radii)||A.prototype._isHidden.call(this,e,t)},D.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&S.isConstant(e.orientation)&&t.radii.isConstant&&S.isConstant(t.stackPartitions)&&S.isConstant(t.slicePartitions)&&S.isConstant(t.outlineWidth)&&S.isConstant(t.subdivisions))},D.prototype._setStaticOptions=function(e,t){var i=S.getValueOrDefault(t.heightReference,p.MINIMUM_VALUE,g.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof T?y.VERTEX_FORMAT:v.MaterialSupport.TEXTURED.vertexFormat,n.radii=t.radii.getValue(p.MINIMUM_VALUE,n.radii),n.stackPartitions=S.getValueOrUndefined(t.stackPartitions,p.MINIMUM_VALUE),n.slicePartitions=S.getValueOrUndefined(t.slicePartitions,p.MINIMUM_VALUE),n.subdivisions=S.getValueOrUndefined(t.subdivisions,p.MINIMUM_VALUE),n.offsetAttribute=i!==g.NONE?h.ALL:void 0},D.prototype._onEntityPropertyChanged=C,D.DynamicGeometryUpdater=I,o(Object.create)&&(I.prototype=Object.create(E.prototype),I.prototype.constructor=I),I.prototype.update=function(t){var a=this._entity,l=a.ellipsoid;if(!a.isShowing||!a.isAvailable(t)||!S.getValueOrDefault(l.show,t,!0))return o(this._primitive)&&(this._primitive.show=!1),void(o(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var c=S.getValueOrUndefined(l.radii,t,N),d=o(c)?a.computeModelMatrixForHeightReference(t,l.heightReference,.5*c.z,this._scene.mapProjection.ellipsoid,this._modelMatrix):void 0;if(!o(d)||!o(c))return o(this._primitive)&&(this._primitive.show=!1),void(o(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var p=S.getValueOrDefault(l.fill,t,!0),C=S.getValueOrDefault(l.outline,t,!1),T=S.getValueOrClonedDefault(l.outlineColor,t,i.BLACK,L),E=P.getValue(t,r(l.material,O),this._material),A=S.getValueOrUndefined(l.stackPartitions,t),b=S.getValueOrUndefined(l.slicePartitions,t),D=S.getValueOrUndefined(l.subdivisions,t),I=S.getValueOrDefault(l.outlineWidth,t,1),V=S.getValueOrDefault(l.heightReference,t,g.NONE),U=V!==g.NONE?h.ALL:void 0,z=this._scene.mode,B=z===x.SCENE3D&&V===g.NONE,H=this._options,k=this._geometryUpdater.shadowsProperty.getValue(t),G=this._geometryUpdater.distanceDisplayConditionProperty,W=G.getValue(t),Y=S.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,t,M,F);if(B&&this._lastSceneMode===z&&o(this._primitive)&&H.stackPartitions===A&&H.slicePartitions===b&&H.subdivisions===D&&this._lastOutlineWidth===I&&H.offsetAttribute===U){if(this._primitive.ready){var j=this._primitive,X=this._outlinePrimitive;j.show=!0,X.show=!0,j.appearance.material=E;var Q=this._attributes;o(Q)||(Q=j.getGeometryInstanceAttributes(a),this._attributes=Q),p!==this._lastShow&&(Q.show=_.toValue(p,Q.show),this._lastShow=p);var q=this._outlineAttributes;o(q)||(q=X.getGeometryInstanceAttributes(a),this._outlineAttributes=q),C!==this._lastOutlineShow&&(q.show=_.toValue(C,q.show),this._lastOutlineShow=C),i.equals(T,this._lastOutlineColor)||(q.color=n.toValue(T,q.color),i.clone(T,this._lastOutlineColor)),s.equals(W,this._lastDistanceDisplayCondition)||(Q.distanceDisplayCondition=u.toValue(W,Q.distanceDisplayCondition),q.distanceDisplayCondition=u.toValue(W,q.distanceDisplayCondition),s.clone(W,this._lastDistanceDisplayCondition)),e.equals(Y,this._lastOffset)||(Q.offset=m.toValue(Y,Q.offset),q.offset=m.toValue(Y,Q.offset),e.clone(Y,this._lastOffset))}}else{var Z=this._primitives;Z.removeAndDestroy(this._primitive),Z.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=z,this._lastOutlineWidth=I,H.stackPartitions=A,H.slicePartitions=b,H.subdivisions=D,H.offsetAttribute=U,H.radii=B?R:c;var K=new v({material:E,translucent:E.isTranslucent(),closed:!0});H.vertexFormat=K.vertexFormat;var J=this._geometryUpdater.createFillGeometryInstance(t,B,this._modelMatrix);this._primitive=Z.add(new w({geometryInstances:J,appearance:K,asynchronous:!1,shadows:k}));var $=this._geometryUpdater.createOutlineGeometryInstance(t,B,this._modelMatrix);this._outlinePrimitive=Z.add(new w({geometryInstances:$,appearance:new y({flat:!0,translucent:255!==$.attributes.color.value[3],renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(I)}}),asynchronous:!1,shadows:k})),this._lastShow=p,this._lastOutlineShow=C,this._lastOutlineColor=i.clone(T,this._lastOutlineColor),this._lastDistanceDisplayCondition=W,this._lastOffset=e.clone(Y,this._lastOffset)}B&&(c.x=Math.max(c.x,.001),c.y=Math.max(c.y,.001),c.z=Math.max(c.z,.001),d=f.multiplyByScale(d,c,d),this._primitive.modelMatrix=d,this._outlinePrimitive.modelMatrix=d)},D}.apply(t,n))&&(e.exports=r)},2238:function(e,t,i){var n,r;n=[i(17),i(10),i(12),i(25),i(150),i(0),i(3),i(1934),i(128),i(215),i(9),i(40),i(20),i(2239),i(2240),i(59),i(1933),i(1935),i(152),i(421),i(1937),i(1936),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function E(e,t){x.call(this,{entity:e,scene:t,geometryOptions:new T(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function A(e,t,i){w.call(this,e,t,i)}function P(i,n,r,o,a){var s=i.normal,u=i.distance,l=t.multiplyByScalar(s,-u,O);l=h.multiplyByPoint(r,l,l);var p=h.multiplyByPointAsVector(r,s,M);t.normalize(p,p);var m=o.geodeticSurfaceNormal(l,I);c.equalsEpsilon(Math.abs(t.dot(m,p)),1,c.EPSILON8)&&(m=t.clone(t.UNIT_Z,m));var _=t.cross(m,p,D);m=t.cross(p,_,m),t.normalize(_,_),t.normalize(m,m);var g=L;d.setColumn(g,0,_,g),d.setColumn(g,1,m,g),d.setColumn(g,2,p,g);var v=f.fromRotationMatrix(g,N),y=e.clone(n,F);return y.z=1,h.fromTranslationQuaternionRotationScale(l,v,y,a)}var S=new t,b=new n;o(Object.create)&&(E.prototype=Object.create(x.prototype),E.prototype.constructor=E),E.prototype.createFillGeometryInstance=function(e){var t,i,a=this._entity,l=a.isAvailable(e),c=new _(l&&a.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),d=this._distanceDisplayConditionProperty.getValue(e),h=s.fromDistanceDisplayCondition(d);if(this._materialProperty instanceof y){var m;o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||l)&&(m=this._materialProperty.color.getValue(e,b)),o(m)||(m=n.WHITE),i=r.fromColor(m),t={show:c,distanceDisplayCondition:h,color:i}}else t={show:c,distanceDisplayCondition:h};var f=a.plane,g=this._options,v=a.computeModelMatrix(e),w=C.getValueOrDefault(f.plane,e,g.plane),x=C.getValueOrUndefined(f.dimensions,e,g.dimensions);return g.plane=w,g.dimensions=x,v=P(w,x,v,this._scene.mapProjection.ellipsoid,v),new u({id:a,geometry:new p(this._options),modelMatrix:v,attributes:t})},E.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),o=C.getValueOrDefault(this._outlineColorProperty,e,n.BLACK,b),a=this._distanceDisplayConditionProperty.getValue(e),l=t.plane,c=this._options,d=t.computeModelMatrix(e),h=C.getValueOrDefault(l.plane,e,c.plane),p=C.getValueOrUndefined(l.dimensions,e,c.dimensions);return c.plane=h,c.dimensions=p,d=P(h,p,d,this._scene.mapProjection.ellipsoid,d),new u({id:t,geometry:new m,modelMatrix:d,attributes:{show:new _(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(o),distanceDisplayCondition:s.fromDistanceDisplayCondition(a)}})},E.prototype._isHidden=function(e,t){return!o(t.plane)||!o(t.dimensions)||!o(e.position)||x.prototype._isHidden.call(this,e,t)},E.prototype._getIsClosed=function(e){return!1},E.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&C.isConstant(e.orientation)&&t.plane.isConstant&&t.dimensions.isConstant&&C.isConstant(t.outlineWidth))},E.prototype._setStaticOptions=function(e,t){var i=this._materialProperty instanceof y,n=this._options;n.vertexFormat=i?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,n.plane=t.plane.getValue(l.MINIMUM_VALUE,n.plane),n.dimensions=t.dimensions.getValue(l.MINIMUM_VALUE,n.dimensions)},E.DynamicGeometryUpdater=A,o(Object.create)&&(A.prototype=Object.create(w.prototype),A.prototype.constructor=A),A.prototype._isHidden=function(e,t,i){var n=this._options,r=C.getValueOrUndefined(e.position,i,S);return!o(r)||!o(n.plane)||!o(n.dimensions)||w.prototype._isHidden.call(this,e,t,i)},A.prototype._setOptions=function(e,t,i){var n=this._options;n.plane=C.getValueOrDefault(t.plane,i,n.plane),n.dimensions=C.getValueOrUndefined(t.dimensions,i,n.dimensions)};var D=new t,I=new t,O=new t,M=new t,F=new t,N=new f,L=new d;return E.createPrimitiveMatrix=P,E}.apply(t,n))&&(e.exports=r)},2239:function(e,t,i){var n,r;n=[i(38),i(10),i(12),i(31),i(1),i(0),i(76),i(90),i(129),i(54),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c){"use strict";function d(e){e=r(e,r.EMPTY_OBJECT);var t=r(e.vertexFormat,c.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}d.packedLength=c.packedLength,d.pack=function(e,t,i){return i=r(i,0),c.pack(e._vertexFormat,t,i),t};var h=new c,p={vertexFormat:h};d.unpack=function(e,t,i){t=r(t,0);var n=c.unpack(e,t,h);return o(i)?(i._vertexFormat=c.clone(n,i._vertexFormat),i):new d(p)};var m=new t(-.5,-.5,0),f=new t(.5,.5,0);return d.createGeometry=function(i){var r,o,c=i._vertexFormat,d=new u;if(c.position){if(o=new Float64Array(12),o[0]=m.x,o[1]=m.y,o[2]=0,o[3]=f.x,o[4]=m.y,o[5]=0,o[6]=f.x,o[7]=f.y,o[8]=0,o[9]=m.x,o[10]=f.y,o[11]=0,d.position=new s({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:o}),c.normal){var h=new Float32Array(12);h[0]=0,h[1]=0,h[2]=1,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=1,h[9]=0,h[10]=0,h[11]=1,d.normal=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:h})}if(c.st){var p=new Float32Array(8);p[0]=0,p[1]=0,p[2]=1,p[3]=0,p[4]=1,p[5]=1,p[6]=0,p[7]=1,d.st=new s({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:p})}if(c.tangent){var _=new Float32Array(12);_[0]=1,_[1]=0,_[2]=0,_[3]=1,_[4]=0,_[5]=0,_[6]=1,_[7]=0,_[8]=0,_[9]=1,_[10]=0,_[11]=0,d.tangent=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:_})}if(c.bitangent){var g=new Float32Array(12);g[0]=0,g[1]=1,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=0,g[7]=1,g[8]=0,g[9]=0,g[10]=1,g[11]=0,d.bitangent=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:g})}r=new Uint16Array(6),r[0]=0,r[1]=1,r[2]=2,r[3]=0,r[4]=2,r[5]=3}return new a({attributes:d,indices:r,primitiveType:l.TRIANGLES,boundingSphere:new e(t.ZERO,Math.sqrt(2))})},d}.apply(t,n))&&(e.exports=r)},2240:function(e,t,i){var n,r;n=[i(38),i(10),i(12),i(31),i(0),i(76),i(90),i(129),i(54)],void 0!==(r=function(e,t,i,n,r,o,a,s,u){"use strict";function l(){this._workerName="createPlaneOutlineGeometry"}l.packedLength=0,l.pack=function(e,t){return t},l.unpack=function(e,t,i){return r(i)?i:new l};var c=new t(-.5,-.5,0),d=new t(.5,.5,0);return l.createGeometry=function(){var i=new s,r=new Uint16Array(8),l=new Float64Array(12);return l[0]=c.x,l[1]=c.y,l[2]=c.z,l[3]=d.x,l[4]=c.y,l[5]=c.z,l[6]=d.x,l[7]=d.y,l[8]=c.z,l[9]=c.x,l[10]=d.y,l[11]=c.z,i.position=new a({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:l}),r[0]=0,r[1]=1,r[2]=1,r[3]=2,r[4]=2,r[5]=3,r[6]=3,r[7]=0,new o({attributes:i,indices:r,primitiveType:u.LINES,boundingSphere:new e(t.ZERO,Math.sqrt(2))})},l}.apply(t,n))&&(e.exports=r)},2241:function(e,t,i){var n,r;n=[i(293),i(17),i(10),i(12),i(25),i(150),i(2242),i(2243),i(0),i(3),i(1934),i(426),i(128),i(151),i(62),i(215),i(745),i(2244),i(296),i(2245),i(16),i(1933),i(746),i(153),i(1935),i(152),i(421),i(1937),i(1936),i(1950),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b,D,I){"use strict";function O(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0}function M(e,t){D.call(this,{entity:e,scene:t,geometryOptions:new O(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function F(e,t,i){S.call(this,e,t,i)}var N=new r,L=i.ZERO,R=new i,V=new w,U=[],z=new t;return u(Object.create)&&(M.prototype=Object.create(D.prototype),M.prototype.constructor=M),M.prototype.createFillGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),n=this._options,s={show:new x(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:c.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof P){var l;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(l=this._materialProperty.color.getValue(e,N)),u(l)||(l=r.WHITE),s.color=o.fromColor(l)}u(n.offsetAttribute)&&(s.offset=_.fromCartesian3(I.getValueOrDefault(this._terrainOffsetProperty,e,L,R)));var d;return d=n.perPositionHeight&&!u(n.extrudedHeight)?new a(n):new g(n),new h({id:t,geometry:d,attributes:s})},M.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),n=this._options,a=I.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,N),l=this._distanceDisplayConditionProperty.getValue(e),d={show:new x(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:o.fromColor(a),distanceDisplayCondition:c.fromDistanceDisplayCondition(l),offset:void 0};u(n.offsetAttribute)&&(d.offset=_.fromCartesian3(I.getValueOrDefault(this._terrainOffsetProperty,e,L,R)));var p;return p=n.perPositionHeight&&!u(n.extrudedHeight)?new s(n):new y(n),new h({id:t,geometry:p,attributes:d})},M.prototype._computeCenter=function(e,i){var n=I.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(u(n)&&!m(n)&&(n=n.positions),0!==n.length){for(var r=this._scene.mapProjection.ellipsoid,o=d.fromPoints(n,r),a=o.projectPointsOntoPlane(n,U),s=a.length,l=0,c=s-1,h=new t,p=0;p<s;c=p++){var f=a[p],_=a[c],g=f.x*_.y-_.x*f.y,v=t.add(f,_,z);v=t.multiplyByScalar(v,g,v),h=t.add(h,v,h),l+=g}var y=1/(3*l);return h=t.multiplyByScalar(h,y,h),o.projectPointOntoEllipsoid(h,i)}},M.prototype._isHidden=function(e,t){return!u(t.hierarchy)||b.prototype._isHidden.call(this,e,t)},M.prototype._isOnTerrain=function(e,t){var i=t.perPositionHeight,n=u(i)&&(!i.isConstant||i.getValue(f.MINIMUM_VALUE));return this._fillEnabled&&!u(t.height)&&!u(t.extrudedHeight)&&!n&&C.isSupported(this._scene)},M.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!I.isConstant(t.height)||!I.isConstant(t.extrudedHeight)||!I.isConstant(t.granularity)||!I.isConstant(t.stRotation)||!I.isConstant(t.outlineWidth)||!I.isConstant(t.perPositionHeight)||!I.isConstant(t.closeTop)||!I.isConstant(t.closeBottom)||!I.isConstant(t.zIndex)||this._onTerrain&&!I.isConstant(this._materialProperty)},M.prototype._setStaticOptions=function(t,i){var n=this._materialProperty instanceof P,r=this._options;r.vertexFormat=n?A.VERTEX_FORMAT:E.MaterialSupport.TEXTURED.vertexFormat;var o=i.hierarchy.getValue(f.MINIMUM_VALUE);m(o)&&(o=new v(o));var a=i.height,s=i.heightReference,l=i.extrudedHeight,c=i.extrudedHeightReference,d=D.getGeometryHeight(a,s,f.MINIMUM_VALUE),h=I.getValueOrUndefined(l,f.MINIMUM_VALUE),p=I.getValueOrUndefined(i.perPositionHeight,f.MINIMUM_VALUE);!u(h)||u(d)||u(p)||(d=0),r.polygonHierarchy=o,r.granularity=I.getValueOrUndefined(i.granularity,f.MINIMUM_VALUE),r.stRotation=I.getValueOrUndefined(i.stRotation,f.MINIMUM_VALUE),r.perPositionHeight=p,r.closeTop=I.getValueOrDefault(i.closeTop,f.MINIMUM_VALUE,!0),r.closeBottom=I.getValueOrDefault(i.closeBottom,f.MINIMUM_VALUE,!0),r.offsetAttribute=D.computeGeometryOffsetAttribute(s,c,f.MINIMUM_VALUE),r.height=d,h=D.getGeometryExtrudedHeight(l,c,f.MINIMUM_VALUE),h===D.CLAMP_TO_GROUND&&(h=e.getApproximateTerrainHeights(g.computeRectangle(r,V)).minimumTerrainHeight),r.extrudedHeight=h},M.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight,n=u(i)&&i!==t;return!e.perPositionHeight&&(!n&&0===t||n&&e.closeTop&&e.closeBottom)},M.DynamicGeometryUpdater=F,u(Object.create)&&(F.prototype=Object.create(S.prototype),F.prototype.constructor=F),F.prototype._isHidden=function(e,t,i){return!u(this._options.polygonHierarchy)||S.prototype._isHidden.call(this,e,t,i)},F.prototype._setOptions=function(t,i,n){var r=this._options,o=i.height,a=i.heightReference,s=i.extrudedHeight,l=i.extrudedHeightReference,c=I.getValueOrUndefined(i.hierarchy,n);m(c)?r.polygonHierarchy=new v(c):r.polygonHierarchy=c;var d=D.getGeometryHeight(o,a,n),h=I.getValueOrUndefined(s,n),p=I.getValueOrUndefined(i.perPositionHeight,n);!u(h)||u(d)||u(p)||(d=0),r.granularity=I.getValueOrUndefined(i.granularity,n),r.stRotation=I.getValueOrUndefined(i.stRotation,n),r.perPositionHeight=I.getValueOrUndefined(i.perPositionHeight,n),r.closeTop=I.getValueOrDefault(i.closeTop,n,!0),r.closeBottom=I.getValueOrDefault(i.closeBottom,n,!0),r.offsetAttribute=D.computeGeometryOffsetAttribute(a,l,n),r.height=d,h=D.getGeometryExtrudedHeight(s,l,n),h===D.CLAMP_TO_GROUND&&(h=e.getApproximateTerrainHeights(g.computeRectangle(r,V)).minimumTerrainHeight),r.extrudedHeight=h},M}.apply(t,n))&&(e.exports=r)},2242:function(e,t,i){var n,r;n=[i(292),i(99),i(38),i(17),i(10),i(12),i(31),i(1982),i(1),i(0),i(76),i(90),i(129),i(128),i(290),i(49),i(9),i(40),i(750),i(291),i(54),i(59),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e,t,i,o,s,u,l,p){var m=e.positions,v=y.triangulate(e.positions2D,e.holes);v.length<3&&(v=[0,1,2]);var C=f.createTypedArray(m.length,v.length);C.set(v);var T=R;if(0!==o){var E=x.fromAxisAngle(u,o,L);if(T=g.fromQuaternion(E,T),t.tangent||t.bitangent){E=x.fromAxisAngle(u,-o,L);var P=g.fromQuaternion(E,V);l=r.normalize(g.multiplyByVector(P,l,l),l),t.bitangent&&(p=r.normalize(r.cross(u,l,p),p))}}else T=g.clone(g.IDENTITY,T);var D=b;t.st&&(D.x=i.x,D.y=i.y);for(var I=m.length,O=3*I,M=new Float64Array(O),F=t.normal?new Float32Array(O):void 0,N=t.tangent?new Float32Array(O):void 0,U=t.bitangent?new Float32Array(O):void 0,z=t.st?new Float32Array(2*I):void 0,B=0,H=0,k=0,G=0,W=0,Y=0;Y<I;Y++){var j=m[Y];if(M[B++]=j.x,M[B++]=j.y,M[B++]=j.z,t.st){var X=g.multiplyByVector(T,j,A),Q=s(X,S);n.subtract(Q,D,Q);var q=_.clamp(Q.x/i.width,0,1),Z=_.clamp(Q.y/i.height,0,1);z[W++]=q,z[W++]=Z}t.normal&&(F[H++]=u.x,F[H++]=u.y,F[H++]=u.z),t.tangent&&(N[G++]=l.x,N[G++]=l.y,N[G++]=l.z),t.bitangent&&(U[k++]=p.x,U[k++]=p.y,U[k++]=p.z)}var K=new h;return t.position&&(K.position=new d({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:M})),t.normal&&(K.normal=new d({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:F})),t.tangent&&(K.tangent=new d({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:N})),t.bitangent&&(K.bitangent=new d({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:U})),t.st&&(K.st=new d({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:z})),new c({attributes:K,indices:C,primitiveType:w.TRIANGLES})}function E(e){e=u(e,u.EMPTY_OBJECT);var t=e.polygonHierarchy,i=u(e.vertexFormat,C.DEFAULT);this._vertexFormat=C.clone(i),this._polygonHierarchy=t,this._stRotation=u(e.stRotation,0),this._workerName="createCoplanarPolygonGeometry",this.packedLength=v.computeHierarchyPackedLength(t)+C.packedLength+2}var A=new r,P=new t,S=new n,b=new n,D=new r,I=new r,O=new r,M=new r,F=new r,N=new r,L=new x,R=new g,V=new g;E.fromPositions=function(e){return e=u(e,u.EMPTY_OBJECT),new E({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation})},E.pack=function(e,t,i){return i=u(i,0),i=v.packPolygonHierarchy(e._polygonHierarchy,t,i),C.pack(e._vertexFormat,t,i),i+=C.packedLength,t[i++]=e._stRotation,t[i]=e.packedLength,t};var U=new C,z={polygonHierarchy:{}};return E.unpack=function(e,t,i){t=u(t,0);var n=v.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=C.unpack(e,t,U);t+=C.packedLength;var o=e[t++],a=e[t];return l(i)||(i=new E(z)),i._polygonHierarchy=n,i._vertexFormat=C.clone(r,i._vertexFormat),i._stRotation=o,i.packedLength=a,i},E.createGeometry=function(t){var n=t._vertexFormat,o=t._polygonHierarchy,a=t._stRotation,u=o.positions;if(u=e(u,r.equalsEpsilon,!0),!(u.length<3)){var l=D,d=I,h=O;if(s.computeProjectTo2DArguments(u,M,F,N)){var _=s.createProjectPointsTo2DFunction(M,F,N),g=s.createProjectPointTo2DFunction(M,F,N);l=r.cross(F,N,l),l=r.normalize(l,l),n.tangent&&(d=r.clone(F,d)),n.bitangent&&(h=r.clone(N,h));var y=v.polygonsFromHierarchy(o,_,!1),w=y.hierarchy,x=y.polygons;if(0!==w.length){u=w[0].outerRing;for(var C=i.fromPoints(u),E=v.computeBoundingRectangle(l,g,u,a,P),A=[],S=0;S<x.length;S++){var b=new p({geometry:T(x[S],n,E,a,g,l,d,h)});A.push(b)}var L=m.combineInstances(A)[0];L.attributes.position.values=new Float64Array(L.attributes.position.values),L.indices=f.createTypedArray(L.attributes.position.values.length/3,L.indices);var R=L.attributes;return n.position||delete R.position,new c({attributes:R,indices:L.indices,primitiveType:L.primitiveType,boundingSphere:C})}}}},E}.apply(t,n))&&(e.exports=r)},2243:function(e,t,i){var n,r;n=[i(292),i(38),i(10),i(12),i(31),i(1982),i(1),i(0),i(76),i(90),i(129),i(128),i(290),i(49),i(750),i(291),i(54)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){for(var t=e.length,i=new Float64Array(3*t),n=p.createTypedArray(t,2*t),o=0,a=0,s=0;s<t;s++){var d=e[s];i[o++]=d.x,i[o++]=d.y,i[o++]=d.z,n[a++]=s,n[a++]=(s+1)%t}var h=new c({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:i})});return new u({attributes:h,indices:n,primitiveType:_.LINES})}function v(e){e=a(e,a.EMPTY_OBJECT);var t=e.polygonHierarchy;this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=m.computeHierarchyPackedLength(t)+1}v.fromPositions=function(e){return e=a(e,a.EMPTY_OBJECT),new v({polygonHierarchy:{positions:e.positions}})},v.pack=function(e,t,i){return i=a(i,0),i=m.packPolygonHierarchy(e._polygonHierarchy,t,i),t[i]=e.packedLength,t};var y={polygonHierarchy:{}};return v.unpack=function(e,t,i){t=a(t,0);var n=m.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=e[t];return s(i)||(i=new v(y)),i._polygonHierarchy=n,i.packedLength=r,i},v.createGeometry=function(n){var r=n._polygonHierarchy,a=r.positions;if(a=e(a,i.equalsEpsilon,!0),!(a.length<3)){if(o.validOutline(a)){var s=m.polygonOutlinesFromHierarchy(r,!1);if(0!==s.length){for(var l=[],c=0;c<s.length;c++){var p=new d({geometry:g(s[c])});l.push(p)}var f=h.combineInstances(l)[0],_=t.fromPoints(r.positions);return new u({attributes:f.attributes,indices:f.indices,primitiveType:f.primitiveType,boundingSphere:_})}}}},v}.apply(t,n))&&(e.exports=r)},2244:function(e,t,i){var n,r;n=[i(130),i(99),i(38),i(17),i(10),i(24),i(12),i(31),i(1),i(0),i(2),i(3),i(23),i(426),i(76),i(90),i(128),i(151),i(290),i(49),i(9),i(120),i(40),i(750),i(291),i(59),i(16),i(181),i(155)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b){"use strict";function D(e,t,i,n){var r=n.cartesianToCartographic(e,L),o=r.height,a=n.cartesianToCartographic(t,R);a.height=o,n.cartographicToCartesian(a,t);var s=n.cartesianToCartographic(i,R);s.height=o-100,n.cartographicToCartesian(s,i)}function I(t){var i=t.vertexFormat,o=t.geometry,a=t.shadowVolume,u=o.attributes.position.values,c=u.length,d=t.wall,h=t.top||d,p=t.bottom||d;if(i.st||i.normal||i.tangent||i.bitangent||a){var m=t.boundingRectangle,_=t.tangentPlane,v=t.ellipsoid,y=t.stRotation,x=t.perPositionHeight,T=X;T.x=m.x,T.y=m.y;var E,P=i.st?new Float32Array(c/3*2):void 0;i.normal&&(E=x&&h&&!d?o.attributes.normal.values:new Float32Array(c));var S=i.tangent?new Float32Array(c):void 0,b=i.bitangent?new Float32Array(c):void 0,I=a?new Float32Array(c):void 0,O=0,M=0,F=z,N=B,L=H,R=!0,V=K,$=J;if(0!==y){var ee=A.fromAxisAngle(_._plane.normal,y,Z);V=C.fromQuaternion(ee,V),ee=A.fromAxisAngle(_._plane.normal,-y,Z),$=C.fromQuaternion(ee,$)}else V=C.clone(C.IDENTITY,V),$=C.clone(C.IDENTITY,$);var te=0,ie=0;h&&p&&(te=c/2,ie=c/3,c/=2);for(var ne=0;ne<c;ne+=3){var re=r.fromArray(u,ne,q);if(i.st){var oe=C.multiplyByVector(V,re,U);oe=v.scaleToGeodeticSurface(oe,oe);var ae=_.projectPointOntoPlane(oe,Q);n.subtract(ae,T,ae);var se=w.clamp(ae.x/m.width,0,1),ue=w.clamp(ae.y/m.height,0,1);p&&(P[O+ie]=se,P[O+1+ie]=ue),h&&(P[O]=se,P[O+1]=ue),O+=2}if(i.normal||i.tangent||i.bitangent||a){var le=M+1,ce=M+2;if(d){if(ne+3<c){var de=r.fromArray(u,ne+3,k);if(R){var he=r.fromArray(u,ne+c,G);x&&D(re,de,he,v),r.subtract(de,re,de),r.subtract(he,re,he),F=r.normalize(r.cross(he,de,F),F),R=!1}r.equalsEpsilon(de,re,w.EPSILON10)&&(R=!0)}(i.tangent||i.bitangent)&&(L=v.geodeticSurfaceNormal(re,L),i.tangent&&(N=r.normalize(r.cross(L,F,N),N)))}else F=v.geodeticSurfaceNormal(re,F),(i.tangent||i.bitangent)&&(x&&(W=r.fromArray(E,M,W),Y=r.cross(r.UNIT_Z,W,Y),Y=r.normalize(C.multiplyByVector($,Y,Y),Y),i.bitangent&&(j=r.normalize(r.cross(W,Y,j),j))),N=r.cross(r.UNIT_Z,F,N),N=r.normalize(C.multiplyByVector($,N,N),N),i.bitangent&&(L=r.normalize(r.cross(F,N,L),L)));i.normal&&(t.wall?(E[M+te]=F.x,E[le+te]=F.y,E[ce+te]=F.z):p&&(E[M+te]=-F.x,E[le+te]=-F.y,E[ce+te]=-F.z),(h&&!x||d)&&(E[M]=F.x,E[le]=F.y,E[ce]=F.z)),a&&(d&&(F=v.geodeticSurfaceNormal(re,F)),I[M+te]=-F.x,I[le+te]=-F.y,I[ce+te]=-F.z),i.tangent&&(t.wall?(S[M+te]=N.x,S[le+te]=N.y,S[ce+te]=N.z):p&&(S[M+te]=-N.x,S[le+te]=-N.y,S[ce+te]=-N.z),h&&(x?(S[M]=Y.x,S[le]=Y.y,S[ce]=Y.z):(S[M]=N.x,S[le]=N.y,S[ce]=N.z))),i.bitangent&&(p&&(b[M+te]=L.x,b[le+te]=L.y,b[ce+te]=L.z),h&&(x?(b[M]=j.x,b[le]=j.y,b[ce]=j.z):(b[M]=L.x,b[le]=L.y,b[ce]=L.z))),M+=3}}i.st&&(o.attributes.st=new f({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:P})),i.normal&&(o.attributes.normal=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:E})),i.tangent&&(o.attributes.tangent=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:S})),i.bitangent&&(o.attributes.bitangent=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:b})),a&&(o.attributes.extrudeDirection=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:I}))}if(t.extrude&&l(t.offsetAttribute)){var pe=u.length/3,me=new Uint8Array(pe);if(t.offsetAttribute===g.TOP)h&&p||d?me=e(me,1,0,pe/2):h&&(me=e(me,1));else{var fe=t.offsetAttribute===g.NONE?0:1;me=e(me,fe)}o.attributes.applyOffset=new f({componentDatatype:s.UNSIGNED_BYTE,componentsPerAttribute:1,values:me})}return o}function O(e,t,i){return!l(e)||e.length<3?l(i)?(i.west=0,i.north=0,i.south=0,i.east=0,i):new P:P.fromCartesianArray(e,t,i)}function M(e,t,i,n,r,o,a,s){var u,l={walls:[]};if(o||a){var c,d,h=T.createGeometryFromPositions(e,t,i,r,s),m=h.attributes.position.values,f=h.indices;if(o&&a){var g=m.concat(m);c=g.length/3,d=y.createTypedArray(c,2*f.length),d.set(f);var v=f.length,w=c/2;for(u=0;u<v;u+=3){var x=d[u]+w,C=d[u+1]+w,A=d[u+2]+w;d[u+v]=A,d[u+1+v]=C,d[u+2+v]=x}if(h.attributes.position.values=g,r&&s.normal){var P=h.attributes.normal.values;h.attributes.normal.values=new Float32Array(g.length),h.attributes.normal.values.set(P)}h.indices=d}else if(a){for(c=m.length/3,d=y.createTypedArray(c,f.length),u=0;u<f.length;u+=3)d[u]=f[u+2],d[u+1]=f[u+1],d[u+2]=f[u];h.indices=d}l.topAndBottom=new _({geometry:h})}var S=n.outerRing,D=p.fromPoints(S,e),I=D.projectPointsOntoPlane(S,$),O=E.computeWindingOrder2D(I);O===b.CLOCKWISE&&(S=S.slice().reverse());var M=T.computeWallGeometry(S,e,i,r);l.walls.push(new _({geometry:M}));var F=n.holes;for(u=0;u<F.length;u++){var N=F[u];D=p.fromPoints(N,e),I=D.projectPointsOntoPlane(N,$),O=E.computeWindingOrder2D(I),O===b.COUNTER_CLOCKWISE&&(N=N.slice().reverse()),M=T.computeWallGeometry(N,e,i),l.walls.push(new _({geometry:M}))}return l}function F(e){var t=e.polygonHierarchy,i=u(e.vertexFormat,S.DEFAULT),n=u(e.ellipsoid,h.WGS84),r=u(e.granularity,w.RADIANS_PER_DEGREE),o=u(e.stRotation,0),a=u(e.perPositionHeight,!1),s=a&&l(e.extrudedHeight),c=u(e.height,0),d=u(e.extrudedHeight,c);if(!s){var p=Math.max(c,d);d=Math.min(c,d),c=p}this._vertexFormat=S.clone(i),this._ellipsoid=h.clone(n),this._granularity=r,this._stRotation=o,this._height=c,this._extrudedHeight=d,this._closeTop=u(e.closeTop,!0),this._closeBottom=u(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=a,this._perPositionHeightExtrude=s,this._shadowVolume=u(e.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this.packedLength=T.computeHierarchyPackedLength(t)+h.packedLength+S.packedLength+11}function N(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];var i=e._ellipsoid,n=e._polygonHierarchy.positions,r=e.rectangle;return m._textureCoordinateRotationPoints(n,t,i,r)}var L=new o,R=new o,V=new t,U=new r,z=new r,B=new r,H=new r,k=new r,G=new r,W=new r,Y=new r,j=new r,X=new n,Q=new n,q=new r,Z=new A,K=new C,J=new C,$=[];F.fromPositions=function(e){return e=u(e,u.EMPTY_OBJECT),new F({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute})},F.pack=function(e,t,i){return i=u(i,0),i=T.packPolygonHierarchy(e._polygonHierarchy,t,i),h.pack(e._ellipsoid,t,i),i+=h.packedLength,S.pack(e._vertexFormat,t,i),i+=S.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._stRotation,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._closeTop?1:0,t[i++]=e._closeBottom?1:0,t[i++]=e._shadowVolume?1:0,t[i++]=u(e._offsetAttribute,-1),t[i]=e.packedLength,t};var ee=h.clone(h.UNIT_SPHERE),te=new S,ie={polygonHierarchy:{}};return F.unpack=function(e,t,i){t=u(t,0);var n=T.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=h.unpack(e,t,ee);t+=h.packedLength;var o=S.unpack(e,t,te);t+=S.packedLength;var a=e[t++],s=e[t++],c=e[t++],d=e[t++],p=1===e[t++],m=1===e[t++],f=1===e[t++],_=1===e[t++],g=1===e[t++],v=e[t++],y=e[t];return l(i)||(i=new F(ie)),i._polygonHierarchy=n,i._ellipsoid=h.clone(r,i._ellipsoid),i._vertexFormat=S.clone(o,i._vertexFormat),i._height=a,i._extrudedHeight=s,i._granularity=c,i._stRotation=d,i._perPositionHeightExtrude=p,i._perPositionHeight=m,i._closeTop=f,i._closeBottom=_,i._shadowVolume=g,i._offsetAttribute=-1===v?void 0:v,i.packedLength=y,i},F.computeRectangle=function(e,t){var i=e.polygonHierarchy,n=u(e.ellipsoid,h.WGS84);return O(i.positions,n,t)},F.createGeometry=function(t){var n=t._vertexFormat,r=t._ellipsoid,o=t._granularity,a=t._stRotation,u=t._polygonHierarchy,c=t._perPositionHeight,d=t._closeTop,h=t._closeBottom,x=u.positions;if(!(x.length<3)){var C=p.fromPoints(x,r),A=T.polygonsFromHierarchy(u,C.projectPointsOntoPlane.bind(C),!c,r),P=A.hierarchy,S=A.polygons;if(0!==P.length){x=P[0].outerRing;var b,D=T.computeBoundingRectangle(C.plane.normal,C.projectPointOntoPlane.bind(C),x,a,V),O=[],F=t._height,N=t._extrudedHeight,L=t._perPositionHeightExtrude||!w.equalsEpsilon(F,N,0,w.EPSILON2),R={perPositionHeight:c,vertexFormat:n,geometry:void 0,tangentPlane:C,boundingRectangle:D,ellipsoid:r,stRotation:a,bottom:!1,top:!0,wall:!1,extrude:!1};if(L)for(R.extrude=!0,R.top=d,R.bottom=h,R.shadowVolume=t._shadowVolume,R.offsetAttribute=t._offsetAttribute,b=0;b<S.length;b++){var U,z=M(r,S[b],o,P[b],c,d,h,n);d&&h?(U=z.topAndBottom,R.geometry=T.scaleToGeodeticHeightExtruded(U.geometry,F,N,r,c)):d?(U=z.topAndBottom,U.geometry.attributes.position.values=E.scaleToGeodeticHeight(U.geometry.attributes.position.values,F,r,!c),R.geometry=U.geometry):h&&(U=z.topAndBottom,U.geometry.attributes.position.values=E.scaleToGeodeticHeight(U.geometry.attributes.position.values,N,r,!0),R.geometry=U.geometry),(d||h)&&(R.wall=!1,U.geometry=I(R),O.push(U));var B=z.walls;R.wall=!0;for(var H=0;H<B.length;H++){var k=B[H];R.geometry=T.scaleToGeodeticHeightExtruded(k.geometry,F,N,r,c),k.geometry=I(R),O.push(k)}}else for(b=0;b<S.length;b++){var G=new _({geometry:T.createGeometryFromPositions(r,S[b],o,c,n)});if(G.geometry.attributes.position.values=E.scaleToGeodeticHeight(G.geometry.attributes.position.values,F,r,!c),R.geometry=G.geometry,G.geometry=I(R),l(t._offsetAttribute)){var W=G.geometry.attributes.position.values.length,Y=new Uint8Array(W/3),j=t._offsetAttribute===g.NONE?0:1;e(Y,j),G.geometry.attributes.applyOffset=new f({componentDatatype:s.UNSIGNED_BYTE,componentsPerAttribute:1,values:Y})}O.push(G)}var X=v.combineInstances(O)[0];X.attributes.position.values=new Float64Array(X.attributes.position.values),X.indices=y.createTypedArray(X.attributes.position.values.length/3,X.indices);var Q=X.attributes,q=i.fromVertices(Q.position.values);return n.position||delete Q.position,new m({attributes:Q,indices:X.indices,primitiveType:X.primitiveType,boundingSphere:q,offsetAttribute:t._offsetAttribute})}}},F.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new F({polygonHierarchy:e._polygonHierarchy,ellipsoid:r,stRotation:e._stRotation,granularity:n,perPositionHeight:!1,extrudedHeight:o,height:a,vertexFormat:S.POSITION_ONLY,shadowVolume:!0})},c(F.prototype,{rectangle:{get:function(){if(!l(this._rectangle)){var e=this._polygonHierarchy.positions;this._rectangle=O(e,this._ellipsoid)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return l(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=N(this)),this._textureCoordinateRotationPoints}}}),F}.apply(t,n))&&(e.exports=r)},2245:function(e,t,i){var n,r;n=[i(130),i(292),i(38),i(10),i(12),i(31),i(1),i(0),i(3),i(23),i(426),i(76),i(90),i(129),i(128),i(151),i(290),i(49),i(9),i(750),i(291),i(54),i(450),i(155)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T){"use strict";function E(e,t,i,n){var r=c.fromPoints(t,e),a=r.projectPointsOntoPlane(t,S);w.computeWindingOrder2D(a)===T.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var s,u,l=t.length,f=0;if(n)for(s=new Float64Array(2*l*3),u=0;u<l;u++){var _=t[u],v=t[(u+1)%l];s[f++]=_.x,s[f++]=_.y,s[f++]=_.z,s[f++]=v.x,s[f++]=v.y,s[f++]=v.z}else{var C=0;for(u=0;u<l;u++)C+=y.subdivideLineCount(t[u],t[(u+1)%l],i);for(s=new Float64Array(3*C),u=0;u<l;u++)for(var E=y.subdivideLine(t[u],t[(u+1)%l],i,b),A=E.length,P=0;P<A;++P)s[f++]=E[P]}l=s.length/3;var D=2*l,I=g.createTypedArray(l,D);for(f=0,u=0;u<l-1;u++)I[f++]=u,I[f++]=u+1;return I[f++]=l-1,I[f++]=0,new m({geometry:new d({attributes:new p({position:new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:s})}),indices:I,primitiveType:x.LINES})})}function A(e,t,i,n){var r=c.fromPoints(t,e),a=r.projectPointsOntoPlane(t,S);w.computeWindingOrder2D(a)===T.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var s,u,l=t.length,f=new Array(l),_=0;if(n)for(s=new Float64Array(2*l*3*2),u=0;u<l;++u){f[u]=_/3;var v=t[u],C=t[(u+1)%l];s[_++]=v.x,s[_++]=v.y,s[_++]=v.z,s[_++]=C.x,s[_++]=C.y,s[_++]=C.z}else{var E=0;for(u=0;u<l;u++)E+=y.subdivideLineCount(t[u],t[(u+1)%l],i);for(s=new Float64Array(3*E*2),u=0;u<l;++u){f[u]=_/3;for(var A=y.subdivideLine(t[u],t[(u+1)%l],i,b),P=A.length,D=0;D<P;++D)s[_++]=A[D]}}l=s.length/6;var I=f.length,O=2*(2*l+I),M=g.createTypedArray(l,O);for(_=0,u=0;u<l;++u)M[_++]=u,M[_++]=(u+1)%l,M[_++]=u+l,M[_++]=(u+1)%l+l;for(u=0;u<I;u++){var F=f[u];M[_++]=F,M[_++]=F+l}return new m({geometry:new d({attributes:new p({position:new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:s})}),indices:M,primitiveType:x.LINES})})}function P(e){var t=e.polygonHierarchy,i=a(e.ellipsoid,l.WGS84),n=a(e.granularity,v.RADIANS_PER_DEGREE),r=a(e.perPositionHeight,!1),o=r&&s(e.extrudedHeight),u=a(e.height,0),c=a(e.extrudedHeight,u);if(!o){var d=Math.max(u,c);c=Math.min(u,c),u=d}this._ellipsoid=l.clone(i),this._granularity=n,this._height=u,this._extrudedHeight=c,this._polygonHierarchy=t,this._perPositionHeight=r,this._perPositionHeightExtrude=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=y.computeHierarchyPackedLength(t)+l.packedLength+7}var S=[],b=[];P.pack=function(e,t,i){return i=a(i,0),i=y.packPolygonHierarchy(e._polygonHierarchy,t,i),l.pack(e._ellipsoid,t,i),i+=l.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=a(e._offsetAttribute,-1),t[i]=e.packedLength,t};var D=l.clone(l.UNIT_SPHERE),I={polygonHierarchy:{}};return P.unpack=function(e,t,i){t=a(t,0);var n=y.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=l.unpack(e,t,D);t+=l.packedLength;var o=e[t++],u=e[t++],c=e[t++],d=1===e[t++],h=1===e[t++],p=e[t++],m=e[t];return s(i)||(i=new P(I)),i._polygonHierarchy=n,i._ellipsoid=l.clone(r,i._ellipsoid),i._height=o,i._extrudedHeight=u,i._granularity=c,i._perPositionHeight=h,i._perPositionHeightExtrude=d,i._offsetAttribute=-1===p?void 0:p,i.packedLength=m,i},P.fromPositions=function(e){return e=a(e,a.EMPTY_OBJECT),new P({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,offsetAttribute:e.offsetAttribute})},P.createGeometry=function(t){var n=t._ellipsoid,r=t._granularity,a=t._polygonHierarchy,u=t._perPositionHeight,l=y.polygonOutlinesFromHierarchy(a,!u,n);if(0!==l.length){var c,p,m,g=[],x=v.chordLength(r,n.maximumRadius),C=t._height,T=t._extrudedHeight,P=t._perPositionHeightExtrude||!v.equalsEpsilon(C,T,0,v.EPSILON2);if(P)for(m=0;m<l.length;m++){if(c=A(n,l[m],x,u),c.geometry=y.scaleToGeodeticHeightExtruded(c.geometry,C,T,n,u),s(t._offsetAttribute)){var S=c.geometry.attributes.position.values.length/3,b=new Uint8Array(S);t._offsetAttribute===f.TOP?b=e(b,1,0,S/2):(p=t._offsetAttribute===f.NONE?0:1,b=e(b,p)),c.geometry.attributes.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})}g.push(c)}else for(m=0;m<l.length;m++){if(c=E(n,l[m],x,u),c.geometry.attributes.position.values=w.scaleToGeodeticHeight(c.geometry.attributes.position.values,C,n,!u),s(t._offsetAttribute)){var D=c.geometry.attributes.position.values.length,I=new Uint8Array(D/3);p=t._offsetAttribute===f.NONE?0:1,e(I,p),c.geometry.attributes.applyOffset=new h({componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:1,values:I})}g.push(c)}var O=_.combineInstances(g)[0],M=i.fromVertices(O.attributes.position.values);return new d({attributes:O.attributes,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:M,offsetAttribute:t._offsetAttribute})}},P}.apply(t,n))&&(e.exports=r)},2246:function(e,t,i){var n,r;n=[i(12),i(25),i(150),i(0),i(3),i(1934),i(128),i(215),i(2248),i(2247),i(1933),i(1935),i(152),i(421),i(1937),i(1936),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function v(e,t){f.call(this,{entity:e,scene:t,geometryOptions:new g(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function y(e,t,i){m.call(this,e,t,i)}var w=new t;return n(Object.create)&&(v.prototype=Object.create(f.prototype),v.prototype.constructor=v),v.prototype.createFillGeometryInstance=function(e){var r,s,l=this._entity,d=l.isAvailable(e),h=new c(d&&l.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),m=this._distanceDisplayConditionProperty.getValue(e),f=o.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof p){var _;n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||d)&&(_=this._materialProperty.color.getValue(e,w)),n(_)||(_=t.WHITE),s=i.fromColor(_),r={show:h,distanceDisplayCondition:f,color:s}}else r={show:h,distanceDisplayCondition:f};return new a({id:l,geometry:new u(this._options),attributes:r})},v.prototype.createOutlineGeometryInstance=function(e){var n=this._entity,r=n.isAvailable(e),s=_.getValueOrDefault(this._outlineColorProperty,e,t.BLACK,w),u=this._distanceDisplayConditionProperty.getValue(e);return new a({id:n,geometry:new l(this._options),attributes:{show:new c(r&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:o.fromDistanceDisplayCondition(u)}})},v.prototype._isHidden=function(e,t){return!n(t.positions)||!n(t.shape)||f.prototype._isHidden.call(this,e,t)},v.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&_.isConstant(t.granularity)&&_.isConstant(t.outlineWidth)&&_.isConstant(t.cornerType))},v.prototype._setStaticOptions=function(e,t){var i=t.granularity,r=t.cornerType,o=this._options,a=this._materialProperty instanceof p;o.vertexFormat=a?h.VERTEX_FORMAT:d.MaterialSupport.TEXTURED.vertexFormat,o.polylinePositions=t.positions.getValue(s.MINIMUM_VALUE,o.polylinePositions),o.shapePositions=t.shape.getValue(s.MINIMUM_VALUE,o.shape),o.granularity=n(i)?i.getValue(s.MINIMUM_VALUE):void 0,o.cornerType=n(r)?r.getValue(s.MINIMUM_VALUE):void 0},v.DynamicGeometryUpdater=y,n(Object.create)&&(y.prototype=Object.create(m.prototype),y.prototype.constructor=y),y.prototype._isHidden=function(e,t,i){var r=this._options;return!n(r.polylinePositions)||!n(r.shapePositions)||m.prototype._isHidden.call(this,e,t,i)},y.prototype._setOptions=function(e,t,i){var n=this._options;n.polylinePositions=_.getValueOrUndefined(t.positions,i,n.polylinePositions),n.shapePositions=_.getValueOrUndefined(t.shape,i),n.granularity=_.getValueOrUndefined(t.granularity,i),n.cornerType=_.getValueOrUndefined(t.cornerType,i)},v}.apply(t,n))&&(e.exports=r)},2247:function(e,t,i){var n,r;n=[i(292),i(99),i(38),i(17),i(10),i(31),i(1938),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(49),i(9),i(291),i(1959),i(54),i(155)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y){"use strict";function w(e,t){var n=new p;n.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e});var r,a,s=t.length,u=n.position.values.length/3,l=e.length/3,c=l/s,f=m.createTypedArray(u,2*s*(c+1)),_=0;r=0;var g=r*s;for(a=0;a<s-1;a++)f[_++]=a+g,f[_++]=a+g+1;for(f[_++]=s-1+g,f[_++]=g,r=c-1,g=r*s,a=0;a<s-1;a++)f[_++]=a+g,f[_++]=a+g+1;for(f[_++]=s-1+g,f[_++]=g,r=0;r<c-1;r++){var y=s*r,w=y+s;for(a=0;a<s;a++)f[_++]=a+y,f[_++]=a+w}return new d({attributes:n,indices:m.createTypedArray(u,f),boundingSphere:i.fromVertices(e),primitiveType:v.LINES})}function x(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._granularity=s(e.granularity,f.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var o=1+t.length*r.packedLength;o+=1+i.length*n.packedLength,this.packedLength=o+c.packedLength+2}x.pack=function(e,t,i){i=s(i,0);var o,a=e._positions,u=a.length;for(t[i++]=u,o=0;o<u;++o,i+=r.packedLength)r.pack(a[o],t,i);var l=e._shape;for(u=l.length,t[i++]=u,o=0;o<u;++o,i+=n.packedLength)n.pack(l[o],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var C=c.clone(c.UNIT_SPHERE),T={polylinePositions:void 0,shapePositions:void 0,ellipsoid:C,height:void 0,cornerType:void 0,granularity:void 0};x.unpack=function(e,t,i){t=s(t,0);var o,a=e[t++],l=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)l[o]=r.unpack(e,t);a=e[t++];var d=new Array(a);for(o=0;o<a;++o,t+=n.packedLength)d[o]=n.unpack(e,t);var h=c.unpack(e,t,C);t+=c.packedLength;var p=e[t++],m=e[t];return u(i)?(i._positions=l,i._shape=d,i._ellipsoid=c.clone(h,i._ellipsoid),i._cornerType=p,i._granularity=m,i):(T.polylinePositions=l,T.shapePositions=d,T.cornerType=p,T.granularity=m,new x(T))};var E=new t;return x.createGeometry=function(i){var n=i._positions,o=e(n,r.equalsEpsilon),a=i._shape;if(a=g.removeDuplicatesFromShape(a),!(o.length<2||a.length<3)){_.computeWindingOrder2D(a)===y.CLOCKWISE&&a.reverse();var s=t.fromPoints(a,E);return w(g.computePositions(o,a,s,i,!1),a)}},x}.apply(t,n))&&(e.exports=r)},2248:function(e,t,i){var n,r;n=[i(292),i(99),i(38),i(17),i(10),i(31),i(1938),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(290),i(49),i(9),i(428),i(291),i(1959),i(54),i(181),i(155)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C){"use strict";function T(e,t,n,r){var a=new p;r.position&&(a.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e}));var s,u,l,c,_,y,x=t.length,C=e.length/3,T=(C-2*x)/(2*x),E=v.triangulate(t),A=(T-1)*x*6+2*E.length,P=f.createTypedArray(C,A),S=2*x,b=0;for(s=0;s<T-1;s++){for(u=0;u<x-1;u++)l=2*u+s*x*2,y=l+S,c=l+1,_=c+S,P[b++]=c,P[b++]=l,P[b++]=_,P[b++]=_,P[b++]=l,P[b++]=y;l=2*x-2+s*x*2,c=l+1,_=c+S,y=l+S,P[b++]=c,P[b++]=l,P[b++]=_,P[b++]=_,P[b++]=l,P[b++]=y}if(r.st||r.tangent||r.bitangent){var D,I,O=new Float32Array(2*C),M=1/(T-1),F=1/n.height,N=n.height/2,L=0;for(s=0;s<T;s++){for(D=s*M,I=F*(t[0].y+N),O[L++]=D,O[L++]=I,u=1;u<x;u++)I=F*(t[u].y+N),O[L++]=D,O[L++]=I,O[L++]=D,O[L++]=I;I=F*(t[0].y+N),O[L++]=D,O[L++]=I}for(u=0;u<x;u++)D=0,I=F*(t[u].y+N),O[L++]=D,O[L++]=I;for(u=0;u<x;u++)D=(T-1)*M,I=F*(t[u].y+N),O[L++]=D,O[L++]=I;a.st=new h({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:new Float32Array(O)})}var R=C-2*x;for(s=0;s<E.length;s+=3){var V=E[s]+R,U=E[s+1]+R,z=E[s+2]+R;P[b++]=V,P[b++]=U,P[b++]=z,P[b++]=z+x,P[b++]=U+x,P[b++]=V+x}var B=new d({attributes:a,indices:P,boundingSphere:i.fromVertices(e),primitiveType:w.TRIANGLES});if(r.normal&&(B=m.computeNormal(B)),r.tangent||r.bitangent){try{B=m.computeTangentAndBitangent(B)}catch(e){g("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(B.attributes.tangent=void 0),r.bitangent||(B.attributes.bitangent=void 0),r.st||(B.attributes.st=void 0)}return B}function E(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._vertexFormat=x.clone(s(e.vertexFormat,x.DEFAULT)),this._granularity=s(e.granularity,_.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var o=1+t.length*r.packedLength;o+=1+i.length*n.packedLength,this.packedLength=o+c.packedLength+x.packedLength+2}E.pack=function(e,t,i){i=s(i,0);var o,a=e._positions,u=a.length;for(t[i++]=u,o=0;o<u;++o,i+=r.packedLength)r.pack(a[o],t,i);var l=e._shape;for(u=l.length,t[i++]=u,o=0;o<u;++o,i+=n.packedLength)n.pack(l[o],t,i);return c.pack(e._ellipsoid,t,i),i+=c.packedLength,x.pack(e._vertexFormat,t,i),i+=x.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var A=c.clone(c.UNIT_SPHERE),P=new x,S={polylinePositions:void 0,shapePositions:void 0,ellipsoid:A,vertexFormat:P,cornerType:void 0,granularity:void 0};E.unpack=function(e,t,i){t=s(t,0);var o,a=e[t++],l=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)l[o]=r.unpack(e,t);a=e[t++];var d=new Array(a);for(o=0;o<a;++o,t+=n.packedLength)d[o]=n.unpack(e,t);var h=c.unpack(e,t,A);t+=c.packedLength;var p=x.unpack(e,t,P);t+=x.packedLength;var m=e[t++],f=e[t];return u(i)?(i._positions=l,i._shape=d,i._ellipsoid=c.clone(h,i._ellipsoid),i._vertexFormat=x.clone(p,i._vertexFormat),i._cornerType=m,i._granularity=f,i):(S.polylinePositions=l,S.shapePositions=d,S.cornerType=m,S.granularity=f,new E(S))};var b=new t;return E.createGeometry=function(i){var n=i._positions,o=e(n,r.equalsEpsilon),a=i._shape;if(a=y.removeDuplicatesFromShape(a),!(o.length<2||a.length<3)){v.computeWindingOrder2D(a)===C.CLOCKWISE&&a.reverse();var s=t.fromPoints(a,b);return T(y.computePositions(o,a,s,i,!0),a,s,i._vertexFormat)}},E}.apply(t,n))&&(e.exports=r)},2249:function(e,t,i){var n,r;n=[i(293),i(10),i(24),i(12),i(25),i(150),i(0),i(3),i(1934),i(23),i(128),i(151),i(215),i(745),i(16),i(775),i(796),i(1933),i(746),i(153),i(1935),i(152),i(421),i(1937),i(1936),i(1950),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P){"use strict";function S(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function b(e,t){A.call(this,{entity:e,scene:t,geometryOptions:new S(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function D(e,t,i){T.call(this,e,t,i)}var I=new r,O=t.ZERO,M=new t,F=new m,N=new m,L=new i;return a(Object.create)&&(b.prototype=Object.create(A.prototype),b.prototype.constructor=b),b.prototype.createFillGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),n={show:new g(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:u.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof C){var s;a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(s=this._materialProperty.color.getValue(e,I)),a(s)||(s=r.WHITE),n.color=o.fromColor(s)}return a(this._options.offsetAttribute)&&(n.offset=p.fromCartesian3(P.getValueOrDefault(this._terrainOffsetProperty,e,O,M))),new c({id:t,geometry:new f(this._options),attributes:n})},b.prototype.createOutlineGeometryInstance=function(e){var t=this._entity,i=t.isAvailable(e),n=P.getValueOrDefault(this._outlineColorProperty,e,r.BLACK,I),s=this._distanceDisplayConditionProperty.getValue(e),l={show:new g(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:o.fromColor(n),distanceDisplayCondition:u.fromDistanceDisplayCondition(s),offset:void 0};return a(this._options.offsetAttribute)&&(l.offset=p.fromCartesian3(P.getValueOrDefault(this._terrainOffsetProperty,e,O,M))),new c({id:t,geometry:new _(this._options),attributes:l})},b.prototype._computeCenter=function(e,t){var n=P.getValueOrUndefined(this._entity.rectangle.coordinates,e,N);if(a(n)){var r=m.center(n,L);return i.toCartesian(r,l.WGS84,t)}},b.prototype._isHidden=function(e,t){return!a(t.coordinates)||E.prototype._isHidden.call(this,e,t)},b.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!a(t.height)&&!a(t.extrudedHeight)&&v.isSupported(this._scene)},b.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!P.isConstant(t.height)||!P.isConstant(t.extrudedHeight)||!P.isConstant(t.granularity)||!P.isConstant(t.stRotation)||!P.isConstant(t.rotation)||!P.isConstant(t.outlineWidth)||!P.isConstant(t.zIndex)||this._onTerrain&&!P.isConstant(this._materialProperty)},b.prototype._setStaticOptions=function(t,i){var n=this._materialProperty instanceof C,r=i.height,o=i.heightReference,a=i.extrudedHeight,s=i.extrudedHeightReference,u=this._options;u.vertexFormat=n?x.VERTEX_FORMAT:w.MaterialSupport.TEXTURED.vertexFormat,u.rectangle=i.coordinates.getValue(h.MINIMUM_VALUE,u.rectangle),u.granularity=P.getValueOrUndefined(i.granularity,h.MINIMUM_VALUE),u.stRotation=P.getValueOrUndefined(i.stRotation,h.MINIMUM_VALUE),u.rotation=P.getValueOrUndefined(i.rotation,h.MINIMUM_VALUE),u.offsetAttribute=A.computeGeometryOffsetAttribute(o,s,h.MINIMUM_VALUE),u.height=A.getGeometryHeight(r,o,h.MINIMUM_VALUE);var l=A.getGeometryExtrudedHeight(a,s,h.MINIMUM_VALUE);l===A.CLAMP_TO_GROUND&&(l=e.getApproximateTerrainHeights(f.computeRectangle(u,F)).minimumTerrainHeight),u.extrudedHeight=l},b.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight;return 0===t||a(i)&&i!==t},b.DynamicGeometryUpdater=D,a(Object.create)&&(D.prototype=Object.create(T.prototype),D.prototype.constructor=D),D.prototype._isHidden=function(e,t,i){return!a(this._options.rectangle)||T.prototype._isHidden.call(this,e,t,i)},D.prototype._setOptions=function(t,i,n){var r=this._options,o=i.height,a=i.heightReference,s=i.extrudedHeight,u=i.extrudedHeightReference;r.rectangle=P.getValueOrUndefined(i.coordinates,n,r.rectangle),r.granularity=P.getValueOrUndefined(i.granularity,n),r.stRotation=P.getValueOrUndefined(i.stRotation,n),r.rotation=P.getValueOrUndefined(i.rotation,n),r.offsetAttribute=A.computeGeometryOffsetAttribute(a,u,n),r.height=A.getGeometryHeight(o,a,n);var l=A.getGeometryExtrudedHeight(s,u,n);l===A.CLAMP_TO_GROUND&&(l=e.getApproximateTerrainHeights(f.computeRectangle(r,F)).minimumTerrainHeight),r.extrudedHeight=l},b}.apply(t,n))&&(e.exports=r)},2250:function(e,t,i){var n,r;n=[i(182),i(25),i(0),i(154),i(1934),i(1933),i(746),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u){"use strict";function l(t,i,n,r,o){this.primitives=t,this.zIndex=o,this.classificationType=i,this.color=n,this.key=r,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[],this.isDirty=!1}function c(t,i){this._batches=new e,this._primitives=t,this._classificationType=i}var d=new t,h=new n,p=new n;l.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&u.isConstant(e.distanceDisplayConditionProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,r,o){"isShowing"===i&&n.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},l.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);return i(n)&&(n(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var m=new Array(4);return l.prototype.update=function(e){var s,l=!0,c=0,f=this.primitive,_=this.primitives;if(this.createPrimitive){var g=this.geometry.values;if(g.length>0)i(f)&&(i(this.oldPrimitive)?_.remove(f):this.oldPrimitive=f),f=new a({show:!1,asynchronous:!0,geometryInstances:g,classificationType:this.classificationType}),_.add(f,this.zIndex),l=!1;else{i(f)&&(_.remove(f),f=void 0);var v=this.oldPrimitive;i(v)&&(_.remove(v),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=f,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(i(f)&&f.ready){f.show=!0,i(this.oldPrimitive)&&(_.remove(this.oldPrimitive),this.oldPrimitive=void 0);var y=this.updatersWithAttributes.values,w=y.length,x=this.waitingOnCreate;for(s=0;s<w;s++){var C=y[s],T=this.geometry.get(C.id),E=this.attributes.get(T.id.id);if(i(E)||(E=f.getGeometryInstanceAttributes(T.id),this.attributes.set(T.id.id,E)),!C.fillMaterialProperty.isConstant||x){var A=C.fillMaterialProperty.color,P=u.getValueOrDefault(A,e,t.WHITE,d);if(!t.equals(E._lastColor,P)){E._lastColor=t.clone(P,E._lastColor);var S=this.color,b=P.toBytes(m);S[0]===b[0]&&S[1]===b[1]&&S[2]===b[2]&&S[3]===b[3]||(this.itemsToRemove[c++]=C)}}var D=C.entity.isShowing&&(C.hasConstantFill||C.isFilled(e)),I=1===E.show[0];D!==I&&(E.show=o.toValue(D,E.show));var O=C.distanceDisplayConditionProperty;if(!u.isConstant(O)){var M=u.getValueOrDefault(O,e,p,h);n.equals(M,E._lastDistanceDisplayCondition)||(E._lastDistanceDisplayCondition=n.clone(M,E._lastDistanceDisplayCondition),E.distanceDisplayCondition=r.toValue(M,E.distanceDisplayCondition))}}this.updateShows(f),this.waitingOnCreate=!1}else i(f)&&!f.ready&&(l=!1);return this.itemsToRemove.length=c,l},l.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,n=t.length,r=0;r<n;r++){var a=t[r],s=this.geometry.get(a.id),u=this.attributes.get(s.id.id);i(u)||(u=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,u));var l=a.entity.isShowing;l!==(1===u.show[0])&&(u.show=o.toValue(l,u.show))}this.showsUpdated.removeAll()},l.prototype.contains=function(e){return this.updaters.contains(e.id)},l.prototype.getBoundingSphere=function(e,t){var n=this.primitive;if(!n.ready)return s.PENDING;var r=n.getBoundingSphere(e.entity);return i(r)?(r.clone(t),s.DONE):s.FAILED},l.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;i(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var n=this.oldPrimitive;i(n)&&(e.remove(n),this.oldPrimitive=void 0)},c.prototype.add=function(e,t){var i,n=t.createFillGeometryInstance(e),r=this._batches,o=u.getValueOrDefault(t.zIndex,0),a=new Uint32Array(n.attributes.color.value.buffer)[0]+":"+o;return r.contains(a)?i=r.get(a):(i=new l(this._primitives,this._classificationType,n.attributes.color.value,a,o),r.set(a,i)),i.add(t,n),i},c.prototype.remove=function(e){for(var t=this._batches.values,i=t.length,n=0;n<i;++n)if(t[n].remove(e))return},c.prototype.update=function(e){var t,i,n=!0,r=this._batches,o=r.values,a=o.length;for(t=0;t<a;++t)n=o[t].update(e)&&n;for(t=0;t<a;++t)for(var s=o[t],u=s.itemsToRemove,l=u.length,c=0;c<l;c++){i=u[c],s.remove(i);var d=this.add(e,i);s.isDirty=!0,d.isDirty=!0}var h=o.slice(),p=h.length;for(t=0;t<p;++t){var m=h[t];m.isDirty&&(n=h[t].update(e)&&n,m.isDirty=!1),0===m.geometry.length&&r.remove(m.key)}return n},c.prototype.getBoundingSphere=function(e,t){for(var i=this._batches.values,n=i.length,r=0;r<n;++r){var o=i[r];if(o.contains(e))return o.getBoundingSphere(e,t)}return s.FAILED},c.prototype.removeAllPrimitives=function(){for(var e=this._batches.values,t=e.length,i=0;i<t;++i)e[i].removeAllPrimitives()},c}.apply(t,n))&&(e.exports=r)},2251:function(e,t,i){var n,r;n=[i(182),i(150),i(0),i(154),i(1934),i(1933),i(2252),i(159),i(746),i(442),i(744),i(421),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(t,i,n,r,o){this.primitives=t,this.appearanceType=i,this.materialProperty=n,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(m.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e,this.usingSphericalTextureCoordinates=r,this.zIndex=o,this.rectangleCollisionCheck=new a}function f(e,t){this._items=[],this._primitives=e,this._appearanceType=t}var _=new n,g=new n;return m.prototype.onMaterialChanged=function(){this.invalidated=!0},m.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},m.prototype.isMaterial=function(e){var t=this.materialProperty,n=e.fillMaterialProperty;return n===t||n instanceof d&&t instanceof d||i(t)&&t.equals(n)},m.prototype.add=function(e,t,i){var n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),this.rectangleCollisionCheck.insert(n,i.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&p.isConstant(t.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener(function(e,i,n,o){"isShowing"===i&&r.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},m.prototype.remove=function(e){var t=e.id,n=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,n.geometry.rectangle),this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);return i(r)&&(r(),this.subscriptions.remove(t)),!0}return!1},m.prototype.update=function(e){var t,a=!0,l=this.primitive,c=this.primitives,d=this.geometry.values;if(this.createPrimitive){if(d.length>0)i(l)&&(i(this.oldPrimitive)?c.remove(l):this.oldPrimitive=l),this.material=h.getValue(e,this.materialProperty,this.material),l=new u({show:!1,asynchronous:!0,geometryInstances:d,appearance:new this.appearanceType({material:this.material}),classificationType:s.TERRAIN}),c.add(l,this.zIndex),a=!1;else{i(l)&&(c.remove(l),l=void 0);var m=this.oldPrimitive;i(m)&&(c.remove(m),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=l,this.createPrimitive=!1}else if(i(l)&&l.ready){l.show=!0,i(this.oldPrimitive)&&(c.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=h.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;var f=this.updatersWithAttributes.values,v=f.length;for(t=0;t<v;t++){var y=f[t],w=y.entity,x=this.geometry.get(y.id),C=this.attributes.get(x.id.id);i(C)||(C=l.getGeometryInstanceAttributes(x.id),this.attributes.set(x.id.id,C));var T=w.isShowing&&(y.hasConstantFill||y.isFilled(e)),E=1===C.show[0];T!==E&&(C.show=o.toValue(T,C.show));var A=y.distanceDisplayConditionProperty;if(!p.isConstant(A)){var P=p.getValueOrDefault(A,e,g,_);n.equals(P,C._lastDistanceDisplayCondition)||(C._lastDistanceDisplayCondition=n.clone(P,C._lastDistanceDisplayCondition),C.distanceDisplayCondition=r.toValue(P,C.distanceDisplayCondition))}}this.updateShows(l)}else i(l)&&!l.ready&&(a=!1);return a},m.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,n=t.length,r=0;r<n;r++){var a=t[r],s=a.entity,u=this.geometry.get(a.id),l=this.attributes.get(u.id.id);i(l)||(l=e.getGeometryInstanceAttributes(u.id),this.attributes.set(u.id.id,l));var c=s.isShowing;c!==(1===l.show[0])&&(l.show=o.toValue(c,l.show))}this.showsUpdated.removeAll()},m.prototype.contains=function(e){return this.updaters.contains(e.id)},m.prototype.getBoundingSphere=function(e,t){var n=this.primitive;if(!n.ready)return c.PENDING;var r=n.getGeometryInstanceAttributes(e.entity);return!i(r)||!i(r.boundingSphere)||i(r.show)&&0===r.show[0]?c.FAILED:(r.boundingSphere.clone(t),c.DONE)},m.prototype.destroy=function(){var e=this.primitive,t=this.primitives;i(e)&&t.remove(e);var n=this.oldPrimitive;i(n)&&t.remove(n),this.removeMaterialSubscription()},f.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=t.createFillGeometryInstance(e),o=l.shouldUseSphericalCoordinates(r.geometry.rectangle),a=p.getValueOrDefault(t.zIndex,0),s=0;s<n;++s){var u=i[s];if(u.isMaterial(t)&&u.usingSphericalTextureCoordinates===o&&u.zIndex===a&&!u.overlapping(r.geometry.rectangle))return void u.add(e,t,r)}var c=new m(this._primitives,this._appearanceType,t.fillMaterialProperty,o,a);c.add(e,t,r),i.push(c)},f.prototype.remove=function(e){for(var t=this._items,i=t.length,n=i-1;n>=0;n--){var r=t[n];if(r.remove(e)){0===r.updaters.length&&(t.splice(n,1),r.destroy());break}}},f.prototype.update=function(e){var t,i=this._items,n=i.length;for(t=n-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var o=r.updaters.values,a=o.length,s=0;s<a;s++)this.add(e,o[s]);r.destroy()}}var u=!0;for(t=0;t<i.length;t++)u=i[t].update(e)&&u;return u},f.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var o=i[r];if(o.contains(e))return o.getBoundingSphere(e,t)}return c.FAILED},f.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},f}.apply(t,n))&&(e.exports=r)},2252:function(e,t,i){var n,r;n=[i(2253),i(12)],void 0!==(r=function(e,t){"use strict";function i(){this._tree=e()}function n(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}function r(e,t){return e.id===t.id}n.fromRectangleAndId=function(e,t,i){return i.minX=t.west,i.minY=t.south,i.maxX=t.east,i.maxY=t.north,i.id=e,i},i.prototype.insert=function(e,t){var i=n.fromRectangleAndId(e,t,new n);this._tree.insert(i)};var o=new n;i.prototype.remove=function(e,t){var i=n.fromRectangleAndId(e,t,o);this._tree.remove(i,r)};var a=new n;return i.prototype.collides=function(e){var t=n.fromRectangleAndId("",e,a);return this._tree.collides(t)},i}.apply(t,n))&&(e.exports=r)},2253:function(e,t,i){var n,r;n=[i(2254)],void 0!==(r=function(e){"use strict";function t(e,i){if(!(this instanceof t))return new t(e,i);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),this.clear()}function i(e,t,i){if(!i)return t.indexOf(e);for(var n=0;n<t.length;n++)if(i(e,t[n]))return n;return-1}function n(e,t){r(e,0,e.children.length,t,e)}function r(e,t,i,n,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a,s=t;s<i;s++)a=e.children[s],o(r,e.leaf?n(a):a);return r}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function a(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function d(e,t){var i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),r=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,i,n,r,o){for(var a,s=[i,n];s.length;)n=s.pop(),i=s.pop(),n-i<=r||(a=i+Math.ceil((n-i)/r/2)*r,e(t,a,i,n,o),s.push(i,a,a,n))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],n=this.toBBox;if(!p(e,t))return i;for(var r,o,a,s,u=[];t;){for(r=0,o=t.children.length;r<o;r++)a=t.children[r],s=t.leaf?n(a):a,p(e,s)&&(t.leaf?i.push(a):h(e,s)?this._all(a,i):u.push(a));t=u.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!p(e,t))return!1;for(var n,r,o,a,s=[];t;){for(n=0,r=t.children.length;n<r;n++)if(o=t.children[n],a=t.leaf?i(o):o,p(e,a)){if(t.leaf||h(e,a))return!0;s.push(o)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var n,r,o,a,s=this.data,u=this.toBBox(e),l=[],c=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=c.pop(),a=!0),s.leaf&&-1!==(o=i(e,s.children,t)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!h(s,u)?r?(n++,s=r.children[n],a=!1):s=null:(l.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:a,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var o,a=i-t+1,s=this._maxEntries;if(a<=s)return o=m(e.slice(t,i+1)),n(o,this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),o=m([]),o.leaf=!1,o.height=r;var u,l,c,d,h=Math.ceil(a/s),p=h*Math.ceil(Math.sqrt(s));for(f(e,t,i,p,this.compareMinX),u=t;u<=i;u+=p)for(c=Math.min(u+p-1,i),f(e,u,c,h,this.compareMinY),l=u;l<=c;l+=h)d=Math.min(l+h-1,c),o.children.push(this._build(e,l,d,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(e,t,i,n){for(var r,o,a,s,l,d,h,p;;){if(n.push(t),t.leaf||n.length-1===i)break;for(h=p=1/0,r=0,o=t.children.length;r<o;r++)a=t.children[r],l=u(a),d=c(e,a)-l,d<p?(p=d,h=l<h?l:h,s=a):d===p&&l<h&&(h=l,s=a);t=s||t.children[0]}return t},_insert:function(e,t,i){var n=this.toBBox,r=i?e:n(e),a=[],s=this._chooseSubtree(r,this.data,t,a);for(s.children.push(e),o(s,r);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(r,a,t)},_split:function(e,t){var i=e[t],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var a=this._chooseSplitIndex(i,o,r),s=m(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,n(i,this.toBBox),n(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var n,o,a,s,l,c,h,p;for(c=h=1/0,n=t;n<=i-t;n++)o=r(e,0,n,this.toBBox),a=r(e,n,i,this.toBBox),s=d(o,a),l=u(o)+u(a),s<c?(c=s,p=n,h=l<h?l:h):s===c&&l<h&&(h=l,p=n);return p},_chooseSplitAxis:function(e,t,i){var n=e.leaf?this.compareMinX:a,r=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)},_allDistMargin:function(e,t,i,n){e.children.sort(n);var a,s,u=this.toBBox,c=r(e,0,t,u),d=r(e,i-t,i,u),h=l(c)+l(d);for(a=t;a<i-t;a++)s=e.children[a],o(c,e.leaf?u(s):s),h+=l(c);for(a=i-t-1;a>=t;a--)s=e.children[a],o(d,e.leaf?u(s):s),h+=l(d);return h},_adjustParentBBoxes:function(e,t,i){for(var n=i;n>=0;n--)o(t[n],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children,t.splice(t.indexOf(e[i]),1)):this.clear():n(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}.apply(t,n))&&(e.exports=r)},2254:function(e,t,i){var n,r;n=[],void 0!==(r=function(){"use strict";function e(e,i,r,o,a){t(e,i,r||0,o||e.length-1,a||n)}function t(e,n,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,u=n-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-u*c/s+d)),Math.min(o,Math.floor(n+(s-u)*c/s+d)),a)}var h=e[n],p=r,m=o;for(i(e,r,n),a(e[o],h)>0&&i(e,r,o);p<m;){for(i(e,p,m),p++,m--;a(e[p],h)<0;)p++;for(;a(e[m],h)>0;)m--}0===a(e[r],h)?i(e,r,m):(m++,i(e,m,o)),m<=n&&(r=m+1),n<=m&&(o=m-1)}}function i(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function n(e,t){return e<t?-1:e>t?1:0}return e}.apply(t,n))&&(e.exports=r)},2255:function(e,t,i){var n,r;n=[i(182),i(10),i(25),i(150),i(0),i(154),i(1934),i(745),i(1933),i(152),i(183),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h){"use strict";function p(t,i,n,r){this.translucent=i,this.width=n,this.shadows=r,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.itemsToRemove=[],this.subscriptions=new e,this.showsUpdated=new e}function m(t,i,n){this._primitives=t,this._scene=i,this._shadows=n,this._solidBatches=new e,this._translucentBatches=new e}var f=new i,_=new o,g=new o,v=t.ZERO,y=new t;return p.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&h.isConstant(e.distanceDisplayConditionProperty)&&h.isConstant(e.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener(function(t,i,r,o){"isShowing"===i&&n.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(i,e)},p.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);r(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t))}},p.prototype.update=function(e){var d,p=!0,m=0,w=this.primitive,x=this.primitives;if(this.createPrimitive){var C=this.geometry.values;if(C.length>0)r(w)&&(r(this.oldPrimitive)?x.remove(w):this.oldPrimitive=w),w=new c({show:!1,asynchronous:!0,geometryInstances:C,appearance:new l({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),x.add(w),p=!1;else{r(w)&&(x.remove(w),w=void 0);var T=this.oldPrimitive;r(T)&&(x.remove(T),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=w,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(r(w)&&w.ready){w.show=!0,r(this.oldPrimitive)&&(x.remove(this.oldPrimitive),this.oldPrimitive=void 0);var E=this.updatersWithAttributes.values,A=E.length,P=this.waitingOnCreate;for(d=0;d<A;d++){var S=E[d],b=this.geometry.get(S.id),D=this.attributes.get(b.id.id);if(r(D)||(D=w.getGeometryInstanceAttributes(b.id),this.attributes.set(b.id.id,D)),!S.outlineColorProperty.isConstant||P){var I=S.outlineColorProperty,O=h.getValueOrDefault(I,e,i.WHITE,f);i.equals(D._lastColor,O)||(D._lastColor=i.clone(O,D._lastColor),D.color=n.toValue(O,D.color),(this.translucent&&255===D.color[3]||!this.translucent&&255!==D.color[3])&&(this.itemsToRemove[m++]=S))}var M=S.entity.isShowing&&(S.hasConstantOutline||S.isOutlineVisible(e)),F=1===D.show[0];M!==F&&(D.show=u.toValue(M,D.show));var N=S.distanceDisplayConditionProperty;if(!h.isConstant(N)){var L=h.getValueOrDefault(N,e,g,_);o.equals(L,D._lastDistanceDisplayCondition)||(D._lastDistanceDisplayCondition=o.clone(L,D._lastDistanceDisplayCondition),D.distanceDisplayCondition=a.toValue(L,D.distanceDisplayCondition))}var R=S.terrainOffsetProperty;if(!h.isConstant(R)){var V=h.getValueOrDefault(R,e,v,y);t.equals(V,D._lastOffset)||(D._lastOffset=t.clone(V,D._lastOffset),D.offset=s.toValue(V,D.offset))}}this.updateShows(w),this.waitingOnCreate=!1}else r(w)&&!w.ready&&(p=!1);return this.itemsToRemove.length=m,p},p.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var o=t[n],a=this.geometry.get(o.id),s=this.attributes.get(a.id.id);r(s)||(s=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s));var l=o.entity.isShowing;l!==(1===s.show[0])&&(s.show=u.toValue(l,s.show))}this.showsUpdated.removeAll()},p.prototype.contains=function(e){return this.updaters.contains(e.id)},p.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return d.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!r(n)||!r(n.boundingSphere)||r(n.show)&&0===n.show[0]?d.FAILED:(n.boundingSphere.clone(t),d.DONE)},p.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;r(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var i=this.oldPrimitive;r(i)&&(e.remove(i),this.oldPrimitive=void 0)},m.prototype.add=function(e,t){var i,n,o=t.createOutlineGeometryInstance(e),a=this._scene.clampLineWidth(t.outlineWidth);255===o.attributes.color.value[3]?(i=this._solidBatches,n=i.get(a),r(n)||(n=new p(this._primitives,!1,a,this._shadows),i.set(a,n)),n.add(t,o)):(i=this._translucentBatches,n=i.get(a),r(n)||(n=new p(this._primitives,!0,a,this._shadows),i.set(a,n)),n.add(t,o))},m.prototype.remove=function(e){var t,i=this._solidBatches.values,n=i.length;for(t=0;t<n;t++)if(i[t].remove(e))return;var r=this._translucentBatches.values,o=r.length;for(t=0;t<o;t++)if(r[t].remove(e))return},m.prototype.update=function(e){var t,i,n,r,o,a=this._solidBatches.values,s=a.length,u=this._translucentBatches.values,l=u.length,c=!0,d=!1;do{for(d=!1,i=0;i<s;i++){r=a[i],c=r.update(e),o=r.itemsToRemove;var h=o.length;if(h>0)for(d=!0,t=0;t<h;t++)n=o[t],r.remove(n),this.add(e,n)}for(i=0;i<l;i++){r=u[i],c=r.update(e),o=r.itemsToRemove;var p=o.length;if(p>0)for(d=!0,t=0;t<p;t++)n=o[t],r.remove(n),this.add(e,n)}}while(d);return c},m.prototype.getBoundingSphere=function(e,t){var i,n=this._solidBatches.values,r=n.length;for(i=0;i<r;i++){var o=n[i];if(o.contains(e))return o.getBoundingSphere(e,t)}var a=this._translucentBatches.values,s=a.length;for(i=0;i<s;i++){var u=a[i];if(u.contains(e))return u.getBoundingSphere(e,t)}return d.FAILED},m.prototype.removeAllPrimitives=function(){var e,t=this._solidBatches.values,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._translucentBatches.values,r=n.length;for(e=0;e<r;e++)n[e].removeAllPrimitives()},m}.apply(t,n))&&(e.exports=r)},2256:function(e,t,i){var n,r;n=[i(12),i(25),i(150),i(0),i(3),i(1934),i(128),i(215),i(1933),i(2257),i(2258),i(1935),i(152),i(421),i(1937),i(1936),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_){"use strict";function g(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function v(e,t){f.call(this,{entity:e,scene:t,geometryOptions:new g(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function y(e,t,i){m.call(this,e,t,i)}var w=new t;return n(Object.create)&&(v.prototype=Object.create(f.prototype),v.prototype.constructor=v),v.prototype.createFillGeometryInstance=function(e){var r,s,c=this._entity,d=c.isAvailable(e),h=new u(d&&c.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),m=this._distanceDisplayConditionProperty.getValue(e),f=o.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof p){var _;n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||d)&&(_=this._materialProperty.color.getValue(e,w)),n(_)||(_=t.WHITE),s=i.fromColor(_),r={show:h,distanceDisplayCondition:f,color:s}}else r={show:h,distanceDisplayCondition:f};return new a({id:c,geometry:new l(this._options),attributes:r})},v.prototype.createOutlineGeometryInstance=function(e){var n=this._entity,r=n.isAvailable(e),s=_.getValueOrDefault(this._outlineColorProperty,e,t.BLACK,w),l=this._distanceDisplayConditionProperty.getValue(e);return new a({id:n,geometry:new c(this._options),attributes:{show:new u(r&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:o.fromDistanceDisplayCondition(l)}})},v.prototype._isHidden=function(e,t){return!n(t.positions)||f.prototype._isHidden.call(this,e,t)},v.prototype._getIsClosed=function(e){return!1},v.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&_.isConstant(t.minimumHeights)&&_.isConstant(t.maximumHeights)&&_.isConstant(t.outlineWidth)&&_.isConstant(t.granularity))},v.prototype._setStaticOptions=function(e,t){var i=t.minimumHeights,r=t.maximumHeights,o=t.granularity,a=this._materialProperty instanceof p,u=this._options;u.vertexFormat=a?h.VERTEX_FORMAT:d.MaterialSupport.TEXTURED.vertexFormat,u.positions=t.positions.getValue(s.MINIMUM_VALUE,u.positions),u.minimumHeights=n(i)?i.getValue(s.MINIMUM_VALUE,u.minimumHeights):void 0,u.maximumHeights=n(r)?r.getValue(s.MINIMUM_VALUE,u.maximumHeights):void 0,u.granularity=n(o)?o.getValue(s.MINIMUM_VALUE):void 0},v.DynamicGeometryUpdater=y,n(Object.create)&&(y.prototype=Object.create(m.prototype),y.prototype.constructor=y),y.prototype._isHidden=function(e,t,i){return!n(this._options.positions)||m.prototype._isHidden.call(this,e,t,i)},y.prototype._setOptions=function(e,t,i){var n=this._options;n.positions=_.getValueOrUndefined(t.positions,i,n.positions),n.minimumHeights=_.getValueOrUndefined(t.minimumHeights,i,n.minimumHeights),n.maximumHeights=_.getValueOrUndefined(t.maximumHeights,i,n.maximumHeights),n.granularity=_.getValueOrUndefined(t.granularity,i)},v}.apply(t,n))&&(e.exports=r)},2257:function(e,t,i){var n,r;n=[i(38),i(10),i(31),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(49),i(9),i(54),i(181),i(1985)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(e){e=n(e,n.EMPTY_OBJECT);var i=e.positions,o=e.maximumHeights,s=e.minimumHeights,u=n(e.vertexFormat,p.DEFAULT),l=n(e.granularity,d.RADIANS_PER_DEGREE),c=n(e.ellipsoid,a.WGS84);this._positions=i,this._minimumHeights=s,this._maximumHeights=o,this._vertexFormat=p.clone(u),this._granularity=l,this._ellipsoid=a.clone(c),this._workerName="createWallGeometry";var h=1+i.length*t.packedLength+2;r(s)&&(h+=s.length),r(o)&&(h+=o.length),this.packedLength=h+a.packedLength+p.packedLength+1}var _=new t,g=new t,v=new t,y=new t,w=new t,x=new t,C=new t,T=new t;f.pack=function(e,i,o){o=n(o,0);var s,u=e._positions,l=u.length;for(i[o++]=l,s=0;s<l;++s,o+=t.packedLength)t.pack(u[s],i,o);var c=e._minimumHeights;if(l=r(c)?c.length:0,i[o++]=l,r(c))for(s=0;s<l;++s)i[o++]=c[s];var d=e._maximumHeights;if(l=r(d)?d.length:0,i[o++]=l,r(d))for(s=0;s<l;++s)i[o++]=d[s];return a.pack(e._ellipsoid,i,o),o+=a.packedLength,p.pack(e._vertexFormat,i,o),o+=p.packedLength,i[o]=e._granularity,i};var E=a.clone(a.UNIT_SPHERE),A=new p,P={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:E,vertexFormat:A,granularity:void 0};return f.unpack=function(e,i,o){i=n(i,0);var s,u=e[i++],l=new Array(u);for(s=0;s<u;++s,i+=t.packedLength)l[s]=t.unpack(e,i);u=e[i++];var c;if(u>0)for(c=new Array(u),s=0;s<u;++s)c[s]=e[i++];u=e[i++];var d;if(u>0)for(d=new Array(u),s=0;s<u;++s)d[s]=e[i++];var h=a.unpack(e,i,E);i+=a.packedLength;var m=p.unpack(e,i,A);i+=p.packedLength;var _=e[i];return r(o)?(o._positions=l,o._minimumHeights=c,o._maximumHeights=d,o._ellipsoid=a.clone(h,o._ellipsoid),o._vertexFormat=p.clone(m,o._vertexFormat),o._granularity=_,o):(P.positions=l,P.minimumHeights=c,P.maximumHeights=d,P.granularity=_,new f(P))},f.fromConstantHeights=function(e){e=n(e,n.EMPTY_OBJECT);var t,i,o=e.positions,a=e.minimumHeight,s=e.maximumHeight,u=r(a),l=r(s);if(u||l){var c=o.length;t=u?new Array(c):void 0,i=l?new Array(c):void 0;for(var d=0;d<c;++d)u&&(t[d]=a),l&&(i[d]=s)}return new f({positions:o,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},f.createGeometry=function(n){var o=n._positions,a=n._minimumHeights,p=n._maximumHeights,f=n._vertexFormat,E=n._granularity,A=n._ellipsoid,P=m.computePositions(A,o,p,a,E,!0);if(r(P)){var S=P.bottomPositions,b=P.topPositions,D=P.numCorners,I=b.length,O=2*I,M=f.position?new Float64Array(O):void 0,F=f.normal?new Float32Array(O):void 0,N=f.tangent?new Float32Array(O):void 0,L=f.bitangent?new Float32Array(O):void 0,R=f.st?new Float32Array(O/3*2):void 0,V=0,U=0,z=0,B=0,H=0,k=T,G=C,W=x,Y=!0;I/=3;var j,X=0,Q=1/(I-o.length+1);for(j=0;j<I;++j){var q=3*j,Z=t.fromArray(b,q,_),K=t.fromArray(S,q,g);if(f.position&&(M[V++]=K.x,M[V++]=K.y,M[V++]=K.z,M[V++]=Z.x,M[V++]=Z.y,M[V++]=Z.z),f.st&&(R[H++]=X,R[H++]=0,R[H++]=X,R[H++]=1),f.normal||f.tangent||f.bitangent){var J,$=t.clone(t.ZERO,w),ee=A.scaleToGeodeticSurface(t.fromArray(b,q,g),g);if(j+1<I&&(J=A.scaleToGeodeticSurface(t.fromArray(b,q+3,v),v),$=t.fromArray(b,q+3,w)),Y){var te=t.subtract($,Z,y),ie=t.subtract(ee,Z,_);k=t.normalize(t.cross(ie,te,k),k),Y=!1}t.equalsEpsilon(J,ee,d.EPSILON10)?Y=!0:(X+=Q,f.tangent&&(G=t.normalize(t.subtract(J,ee,G),G)),f.bitangent&&(W=t.normalize(t.cross(k,G,W),W))),f.normal&&(F[U++]=k.x,F[U++]=k.y,F[U++]=k.z,F[U++]=k.x,F[U++]=k.y,F[U++]=k.z),f.tangent&&(N[B++]=G.x,N[B++]=G.y,N[B++]=G.z,N[B++]=G.x,N[B++]=G.y,N[B++]=G.z),f.bitangent&&(L[z++]=W.x,L[z++]=W.y,L[z++]=W.z,L[z++]=W.x,L[z++]=W.y,L[z++]=W.z)}}var ne=new l;f.position&&(ne.position=new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:M})),f.normal&&(ne.normal=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:F})),f.tangent&&(ne.tangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:N})),f.bitangent&&(ne.bitangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:L})),f.st&&(ne.st=new u({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:R}));var re=O/3;O-=6*(D+1);var oe=c.createTypedArray(re,O),ae=0;for(j=0;j<re-2;j+=2){var se=j,ue=j+2,le=t.fromArray(M,3*se,_),ce=t.fromArray(M,3*ue,g);if(!t.equalsEpsilon(le,ce,d.EPSILON10)){var de=j+1,he=j+3;oe[ae++]=de,oe[ae++]=se,oe[ae++]=he,oe[ae++]=he,oe[ae++]=se,oe[ae++]=ue}}return new s({attributes:ne,indices:oe,primitiveType:h.TRIANGLES,boundingSphere:new e.fromVertices(M)})}},f}.apply(t,n))&&(e.exports=r)},2258:function(e,t,i){var n,r;n=[i(38),i(10),i(31),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(49),i(9),i(54),i(1985)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(e){e=n(e,n.EMPTY_OBJECT);var i=e.positions,o=e.maximumHeights,s=e.minimumHeights,u=n(e.granularity,d.RADIANS_PER_DEGREE),l=n(e.ellipsoid,a.WGS84);this._positions=i,this._minimumHeights=s,this._maximumHeights=o,this._granularity=u,this._ellipsoid=a.clone(l),this._workerName="createWallOutlineGeometry";var c=1+i.length*t.packedLength+2;r(s)&&(c+=s.length),r(o)&&(c+=o.length),this.packedLength=c+a.packedLength+1}var f=new t,_=new t;m.pack=function(e,i,o){o=n(o,0);var s,u=e._positions,l=u.length;for(i[o++]=l,s=0;s<l;++s,o+=t.packedLength)t.pack(u[s],i,o);var c=e._minimumHeights;if(l=r(c)?c.length:0,i[o++]=l,r(c))for(s=0;s<l;++s)i[o++]=c[s];var d=e._maximumHeights;if(l=r(d)?d.length:0,i[o++]=l,r(d))for(s=0;s<l;++s)i[o++]=d[s];return a.pack(e._ellipsoid,i,o),o+=a.packedLength,i[o]=e._granularity,i};var g=a.clone(a.UNIT_SPHERE),v={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:g,granularity:void 0};return m.unpack=function(e,i,o){i=n(i,0);var s,u=e[i++],l=new Array(u);for(s=0;s<u;++s,i+=t.packedLength)l[s]=t.unpack(e,i);u=e[i++];var c;if(u>0)for(c=new Array(u),s=0;s<u;++s)c[s]=e[i++];u=e[i++];var d;if(u>0)for(d=new Array(u),s=0;s<u;++s)d[s]=e[i++];var h=a.unpack(e,i,g);i+=a.packedLength;var p=e[i];return r(o)?(o._positions=l,o._minimumHeights=c,o._maximumHeights=d,o._ellipsoid=a.clone(h,o._ellipsoid),o._granularity=p,o):(v.positions=l,v.minimumHeights=c,v.maximumHeights=d,v.granularity=p,new m(v))},m.fromConstantHeights=function(e){e=n(e,n.EMPTY_OBJECT);var t,i,o=e.positions,a=e.minimumHeight,s=e.maximumHeight,u=r(a),l=r(s);if(u||l){var c=o.length;t=u?new Array(c):void 0,i=l?new Array(c):void 0;for(var d=0;d<c;++d)u&&(t[d]=a),l&&(i[d]=s)}return new m({positions:o,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid})},m.createGeometry=function(n){var o=n._positions,a=n._minimumHeights,m=n._maximumHeights,g=n._granularity,v=n._ellipsoid,y=p.computePositions(v,o,m,a,g,!1);if(r(y)){var w=y.bottomPositions,x=y.topPositions,C=x.length,T=2*C,E=new Float64Array(T),A=0;C/=3;var P;for(P=0;P<C;++P){var S=3*P,b=t.fromArray(x,S,f),D=t.fromArray(w,S,_);E[A++]=D.x,E[A++]=D.y,E[A++]=D.z,E[A++]=b.x,E[A++]=b.y,E[A++]=b.z}var I=new l({position:new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:E})}),O=T/3;T=2*O-4+O;var M=c.createTypedArray(O,T),F=0;for(P=0;P<O-2;P+=2){var N=P,L=P+2,R=t.fromArray(E,3*N,f),V=t.fromArray(E,3*L,_);if(!t.equalsEpsilon(R,V,d.EPSILON10)){var U=P+1,z=P+3;M[F++]=U,M[F++]=N,M[F++]=U,M[F++]=z,M[F++]=N,M[F++]=L}}return M[F++]=O-2,M[F++]=O-1,new s({attributes:I,indices:M,primitiveType:h.LINES,boundingSphere:new e.fromVertices(E)})}},m}.apply(t,n))&&(e.exports=r)},2259:function(e,t,i){var n,r;n=[i(182),i(17),i(10),i(25),i(1),i(0),i(21),i(3),i(154),i(218),i(153),i(158),i(297),i(132),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f){"use strict";function _(e){this.entity=e,this.label=void 0,this.index=void 0}function g(t,i){i.collectionChanged.addEventListener(g.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function v(e,t,i){o(e)&&(e.label=void 0,i.removeLabel(t))}var y=h.FILL,w=n.WHITE,x=n.BLACK,C=new n(.165,.165,.165,.8),T=new t(7,5),E=t.ZERO,A=i.ZERO,P=c.NONE,S=d.CENTER,b=p.CENTER,D=new i,I=new n,O=new n,M=new n,F=new t,N=new i,L=new t,R=new l,V=new l,U=new l,z=new u;return g.prototype.update=function(e){for(var t=this._items.values,i=this._cluster,n=0,r=t.length;n<r;n++){var a,s,u=t[n],l=u.entity,c=l._label,d=u.label,h=l.isShowing&&l.isAvailable(e)&&f.getValueOrDefault(c._show,e,!0);h&&(s=f.getValueOrUndefined(l._position,e,D),a=f.getValueOrUndefined(c._text,e),h=o(s)&&o(a)),h?(f.isConstant(l._position)||(i._clusterDirty=!0),o(d)||(d=i.getLabel(l),d.id=l,u.label=d),d.show=!0,d.position=s,d.text=a,d.scale=f.getValueOrDefault(c._scale,e,1),d.font=f.getValueOrDefault(c._font,e,"30px sans-serif"),d.style=f.getValueOrDefault(c._style,e,y),d.fillColor=f.getValueOrDefault(c._fillColor,e,w,I),d.outlineColor=f.getValueOrDefault(c._outlineColor,e,x,O),d.outlineWidth=f.getValueOrDefault(c._outlineWidth,e,1),d.showBackground=f.getValueOrDefault(c._showBackground,e,!1),d.backgroundColor=f.getValueOrDefault(c._backgroundColor,e,C,M),d.backgroundPadding=f.getValueOrDefault(c._backgroundPadding,e,T,F),d.pixelOffset=f.getValueOrDefault(c._pixelOffset,e,E,L),d.eyeOffset=f.getValueOrDefault(c._eyeOffset,e,A,N),d.heightReference=f.getValueOrDefault(c._heightReference,e,P),d.horizontalOrigin=f.getValueOrDefault(c._horizontalOrigin,e,S),d.verticalOrigin=f.getValueOrDefault(c._verticalOrigin,e,b),d.translucencyByDistance=f.getValueOrUndefined(c._translucencyByDistance,e,R),d.pixelOffsetScaleByDistance=f.getValueOrUndefined(c._pixelOffsetScaleByDistance,e,V),d.scaleByDistance=f.getValueOrUndefined(c._scaleByDistance,e,U),d.distanceDisplayCondition=f.getValueOrUndefined(c._distanceDisplayCondition,e,z),d.disableDepthTestDistance=f.getValueOrUndefined(c._disableDepthTestDistance,e)):v(u,l,i)}return!0},g.prototype.getBoundingSphere=function(e,t){var n=this._items.get(e.id);if(!o(n)||!o(n.label))return m.FAILED;var a=n.label;return t.center=i.clone(r(a._clampedPosition,a.position),t.center),t.radius=0,m.DONE},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(g.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return a(this)},g.prototype._onCollectionChanged=function(e,t,i,n){var r,a,s=this._items,u=this._cluster;for(r=t.length-1;r>-1;r--)a=t[r],o(a._label)&&o(a._position)&&s.set(a.id,new _(a));for(r=n.length-1;r>-1;r--)a=n[r],o(a._label)&&o(a._position)?s.contains(a.id)||s.set(a.id,new _(a)):(v(s.get(a.id),a,u),s.remove(a.id));for(r=i.length-1;r>-1;r--)a=i[r],v(s.get(a.id),a,u),s.remove(a.id)},g}.apply(t,n))&&(e.exports=r)},2260:function(e,t,i){var n,r;n=[i(182),i(38),i(25),i(0),i(21),i(3),i(20),i(29),i(769),i(153),i(451),i(453),i(184),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m){"use strict";function f(t,i){i.collectionChanged.addEventListener(f.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=i,this._modelHash={},this._entitiesToVisualize=new e,this._onCollectionChanged(i,i.values,[],[])}function _(e,t,i,r){var o=i[t.id];n(o)&&(r.removeAndDestroy(o.modelPrimitive),delete i[t.id])}function g(e,t){var i=t[e.id];n(i)&&(i.nodeTransformationsScratch={})}function v(e,t,i){e.readyPromise.otherwise(function(e){console.error(e),i[t.id].loadFail=!0})}var y=h.ENABLED,w=l.NONE,x=i.RED,C=i.WHITE,T=u.HIGHLIGHT,E=new a,A=new a;return f.prototype.update=function(e){for(var t=this._entitiesToVisualize.values,i=this._modelHash,r=this._primitives,o=0,u=t.length;o<u;o++){var l,h,p=t[o],f=p._model,_=i[p.id],g=p.isShowing&&p.isAvailable(e)&&m.getValueOrDefault(f._show,e,!0);if(g&&(h=p.computeModelMatrix(e,E),l=s.createIfNeeded(m.getValueOrUndefined(f._uri,e)),g=n(h)&&n(l)),g){var P=n(_)?_.modelPrimitive:void 0;if(n(P)&&l.url===_.url||(n(P)&&(r.removeAndDestroy(P),delete i[p.id]),P=c.fromGltf({url:l,incrementallyLoadTextures:m.getValueOrDefault(f._incrementallyLoadTextures,e,!0),scene:this._scene}),P.id=p,r.add(P),_={modelPrimitive:P,url:l.url,animationsRunning:!1,nodeTransformationsScratch:{},originalNodeMatrixHash:{},loadFail:!1},i[p.id]=_,v(P,p,i)),P.show=!0,P.scale=m.getValueOrDefault(f._scale,e,1),P.minimumPixelSize=m.getValueOrDefault(f._minimumPixelSize,e,0),P.maximumScale=m.getValueOrUndefined(f._maximumScale,e),P.modelMatrix=a.clone(h,P.modelMatrix),P.shadows=m.getValueOrDefault(f._shadows,e,y),P.heightReference=m.getValueOrDefault(f._heightReference,e,w),P.distanceDisplayCondition=m.getValueOrUndefined(f._distanceDisplayCondition,e),P.silhouetteColor=m.getValueOrDefault(f._silhouetteColor,e,x,P._silhouetteColor),P.silhouetteSize=m.getValueOrDefault(f._silhouetteSize,e,0),P.color=m.getValueOrDefault(f._color,e,C,P._color),P.colorBlendMode=m.getValueOrDefault(f._colorBlendMode,e,T),P.colorBlendAmount=m.getValueOrDefault(f._colorBlendAmount,e,.5),P.clippingPlanes=m.getValueOrUndefined(f._clippingPlanes,e),P.clampAnimations=m.getValueOrDefault(f._clampAnimations,e,!0),P.ready){var S=m.getValueOrDefault(f._runAnimations,e,!0);_.animationsRunning!==S&&(S?P.activeAnimations.addAll({loop:d.REPEAT}):P.activeAnimations.removeAll(),_.animationsRunning=S);var b=m.getValueOrUndefined(f._nodeTransformations,e,_.nodeTransformationsScratch);if(n(b))for(var D=_.originalNodeMatrixHash,I=Object.keys(b),O=0,M=I.length;O<M;++O){var F=I[O],N=b[F];if(n(N)){var L=P.getNode(F);if(n(L)){var R=D[F];n(R)||(R=L.matrix.clone(),D[F]=R);var V=a.fromTranslationRotationScale(N,A);L.matrix=a.multiply(R,V,V)}}}}}else n(_)&&(_.modelPrimitive.show=!1)}return!0},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(f.prototype._onCollectionChanged,this);for(var e=this._entitiesToVisualize.values,t=this._modelHash,i=this._primitives,n=e.length-1;n>-1;n--)_(this,e[n],t,i);return r(this)},f.prototype.getBoundingSphere=function(e,i){var r=this._modelHash[e.id];if(!n(r)||r.loadFail)return p.FAILED;var o=r.modelPrimitive;if(!n(o)||!o.show)return p.FAILED;if(!o.ready)return p.PENDING;if(o.heightReference===l.NONE)t.transform(o.boundingSphere,o.modelMatrix,i);else{if(!n(o._clampedModelMatrix))return p.PENDING;t.transform(o.boundingSphere,o._clampedModelMatrix,i)}return p.DONE},f.prototype._onCollectionChanged=function(e,t,i,r){var o,a,s=this._entitiesToVisualize,u=this._modelHash,l=this._primitives;for(o=t.length-1;o>-1;o--)a=t[o],n(a._model)&&n(a._position)&&s.set(a.id,a);for(o=r.length-1;o>-1;o--)a=r[o],n(a._model)&&n(a._position)?(g(a,u),s.set(a.id,a)):(_(this,a,u,l),s.remove(a.id));for(o=i.length-1;o>-1;o--)a=i[o],_(this,a,u,l),s.remove(a.id)},f}.apply(t,n))&&(e.exports=r)},2261:function(e,t,i){var n,r;n=[i(182),i(10),i(0),i(21),i(3),i(36),i(40),i(20),i(216),i(78),i(50),i(770),i(46),i(1943),i(751),i(1939),i(89),i(1944),i(759),i(1952),i(767)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w){"use strict";function x(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function C(e,t,n,r,a,s,u,l,c){var d,h=l;d=e.getValueInReferenceFrame(t,s,c[h]),i(d)&&(c[h++]=d);for(var p,m,f,_=!i(a)||o.lessThanOrEquals(a,t)||o.greaterThanOrEquals(a,n),g=0,v=r.length,y=r[g],w=n,x=!1;g<v;){if(!_&&o.greaterThanOrEquals(y,a)&&(d=e.getValueInReferenceFrame(a,s,c[h]),i(d)&&(c[h++]=d),_=!0),o.greaterThan(y,t)&&o.lessThan(y,w)&&!y.equals(a)&&(d=e.getValueInReferenceFrame(y,s,c[h]),i(d)&&(c[h++]=d)),g<v-1){if(u>0&&!x){var C=r[g+1],T=o.secondsDifference(C,y);x=T>u,x&&(p=Math.ceil(T/u),m=0,f=T/Math.max(p,2),p=Math.max(p-1,1))}if(x&&m<p){y=o.addSeconds(y,f,new o),m++;continue}}x=!1,g++,y=r[g]}return d=e.getValueInReferenceFrame(n,s,c[h]),i(d)&&(c[h++]=d),h}function T(e,t,n,r,a,s,u,l){for(var c,d=0,h=u,p=t,m=Math.max(s,60),f=!i(r)||o.lessThanOrEquals(r,t)||o.greaterThanOrEquals(r,n);o.lessThan(p,n);)!f&&o.greaterThanOrEquals(p,r)&&(f=!0,c=e.getValueInReferenceFrame(r,a,l[h]),i(c)&&(l[h]=c,h++)),c=e.getValueInReferenceFrame(p,a,l[h]),i(c)&&(l[h]=c,h++),d++,p=o.addSeconds(t,m*d,new o);return c=e.getValueInReferenceFrame(n,a,l[h]),i(c)&&(l[h]=c,h++),h}function E(e,t,n,r,a,s,u,c){F.start=t,F.stop=n;for(var d=u,h=e.intervals,p=0;p<h.length;p++){var m=h.get(p);if(!l.intersect(m,F,O).isEmpty){var f=m.start;m.isStartIncluded||(f=m.isStopIncluded?m.stop:o.addSeconds(m.start,o.secondsDifference(m.stop,m.start)/2,new o));var _=e.getValueInReferenceFrame(f,a,c[d]);i(_)&&(c[d]=_,d++)}}return d}function A(e,t,n,r,o,a,s,u){var l=e.getValueInReferenceFrame(t,o,u[s]);return i(l)&&(u[s++]=l),s}function P(e,t,i,n,r,a,s,u){M.start=t,M.stop=i;for(var c=s,d=e.intervals,h=0;h<d.length;h++){var p=d.get(h);if(!l.intersect(p,M,O).isEmpty){var m=p.start,f=p.stop,_=t;o.greaterThan(m,_)&&(_=m);var g=i;o.lessThan(f,g)&&(g=f),c=S(p.data,_,g,n,r,a,c,u)}}return c}function S(e,t,i,n,r,o,a,s){for(;e instanceof g;)e=e.resolvedProperty;if(e instanceof v){a=C(e,t,i,e._property._times,n,r,o,a,s)}else a=e instanceof p?P(e,t,i,n,r,o,a,s):e instanceof w?E(e,t,i,n,r,o,a,s):e instanceof m||e instanceof y&&_.isConstant(e)?A(e,t,i,n,r,o,a,s):T(e,t,i,n,r,o,a,s);return a}function b(e,t,n,r,o,a,s){i(s)||(s=[]);var u=S(e,t,n,r,o,a,0,s);return s.length=u,s}function D(e,t){this._unusedIndexes=[],this._polylineCollection=new d,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function I(t,i){i.collectionChanged.addEventListener(I.prototype._onCollectionChanged,this),this._scene=t,this._updaters={},this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}var O=new l,M=new l,F=new l,N=new a;return D.prototype.update=function(e){if(this._referenceFrame===u.INERTIAL){var n=c.computeIcrfToFixedMatrix(e,N);i(n)||(n=c.computeTemeToPseudoFixedMatrix(e,N)),s.fromRotationTranslation(n,t.ZERO,this._polylineCollection.modelMatrix)}},D.prototype.updateObject=function(e,t){var n,r,a=t.entity,s=a._path,u=a._position,l=s._show,c=t.polyline,d=a.isShowing&&(!i(l)||l.getValue(e));if(d){var h=_.getValueOrUndefined(s._leadTime,e),p=_.getValueOrUndefined(s._trailTime,e),m=a._availability,g=i(m),v=i(h),y=i(p);if(d=g||v&&y){if(y&&(n=o.addSeconds(e,-p,new o)),v&&(r=o.addSeconds(e,h,new o)),g){var w=m.start,x=m.stop;y&&!o.greaterThan(w,n)||(n=w),v&&!o.lessThan(x,r)||(r=x)}d=o.lessThan(n,r)}}if(!d)return void(i(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0));if(!i(c)){var C=this._unusedIndexes;if(C.length>0){var T=C.pop();c=this._polylineCollection.get(T),t.index=T}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=a,t.polyline=c}var E=_.getValueOrDefault(s._resolution,e,60);c.show=!0,c.positions=b(u,n,r,e,this._referenceFrame,E,c.positions.slice()),c.material=f.getValue(e,s._material,c.material),c.width=_.getValueOrDefault(s._width,e,1),c.distanceDisplayCondition=_.getValueOrUndefined(s._distanceDisplayCondition,e,c.distanceDisplayCondition)},D.prototype.removeObject=function(e){var t=e.polyline;i(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},D.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),n(this)},I.prototype.update=function(e){var t=this._updaters;for(var n in t)t.hasOwnProperty(n)&&t[n].update(e);for(var r=this._items.values,o=0,a=r.length;o<a;o++){var s=r[o],l=s.entity,c=l._position,d=s.updater,p=u.FIXED;this._scene.mode===h.SCENE3D&&(p=c.referenceFrame);var m=this._updaters[p];d===m&&i(m)?m.updateObject(e,s):(i(d)&&d.removeObject(s),i(m)||(m=new D(this._scene,p),m.update(e),this._updaters[p]=m),s.updater=m,i(m)&&m.updateObject(e,s))}return!0},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(I.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();return n(this)},I.prototype._onCollectionChanged=function(e,t,n,r){var o,a,s,u=this._items;for(o=t.length-1;o>-1;o--)a=t[o],i(a._path)&&i(a._position)&&u.set(a.id,new x(a));for(o=r.length-1;o>-1;o--)a=r[o],i(a._path)&&i(a._position)?u.contains(a.id)||u.set(a.id,new x(a)):(s=u.get(a.id),i(s)&&(s.updater.removeObject(s),u.remove(a.id)));for(o=n.length-1;o>-1;o--)a=n[o],s=u.get(a.id),i(s)&&(i(s.updater)&&s.updater.removeObject(s),u.remove(a.id))},I._subSample=b,I}.apply(t,n))&&(e.exports=r)},2262:function(e,t,i){var n,r;n=[i(182),i(10),i(25),i(0),i(21),i(3),i(154),i(218),i(795),i(153),i(744),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d){"use strict";function h(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function p(t,i){i.collectionChanged.addEventListener(p.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=i,this._items=new e,this._onCollectionChanged(i,i.values,[],[])}function m(e,t,i){if(n(e)){var r=e.pointPrimitive;if(n(r))return e.pointPrimitive=void 0,void i.removePoint(t);var o=e.billboard;n(o)&&(e.billboard=void 0,i.removeBillboard(t))}}var f=i.WHITE,_=i.BLACK,g=new i,v=new t,y=new i,w=new s,x=new s,C=new a;return p.prototype.update=function(e){for(var t=this._items.values,r=this._cluster,o=0,a=t.length;o<a;o++){var s,c=t[o],h=c.entity,p=h._point,T=c.pointPrimitive,E=c.billboard,A=d.getValueOrDefault(p._heightReference,e,l.NONE),P=h.isShowing&&h.isAvailable(e)&&d.getValueOrDefault(p._show,e,!0);if(P&&(s=d.getValueOrUndefined(h._position,e,v),P=n(s)),P){d.isConstant(h._position)||(r._clusterDirty=!0);var S=!1;if(A===l.NONE||n(E)?A!==l.NONE||n(T)||(n(E)&&(m(c,h,r),E=void 0),T=r.getPoint(h),T.id=h,c.pointPrimitive=T):(n(T)&&(m(c,h,r),T=void 0),E=r.getBillboard(h),E.id=h,E.image=void 0,c.billboard=E,S=!0),n(T))T.show=!0,T.position=s,T.scaleByDistance=d.getValueOrUndefined(p._scaleByDistance,e,w),T.translucencyByDistance=d.getValueOrUndefined(p._translucencyByDistance,e,x),T.color=d.getValueOrDefault(p._color,e,f,g),T.outlineColor=d.getValueOrDefault(p._outlineColor,e,_,y),T.outlineWidth=d.getValueOrDefault(p._outlineWidth,e,0),T.pixelSize=d.getValueOrDefault(p._pixelSize,e,1),T.distanceDisplayCondition=d.getValueOrUndefined(p._distanceDisplayCondition,e,C),T.disableDepthTestDistance=d.getValueOrDefault(p._disableDepthTestDistance,e,0);else if(n(E)){E.show=!0,E.position=s,E.scaleByDistance=d.getValueOrUndefined(p._scaleByDistance,e,w),E.translucencyByDistance=d.getValueOrUndefined(p._translucencyByDistance,e,x),E.distanceDisplayCondition=d.getValueOrUndefined(p._distanceDisplayCondition,e,C),E.disableDepthTestDistance=d.getValueOrDefault(p._disableDepthTestDistance,e,0),E.heightReference=A;var b=d.getValueOrDefault(p._color,e,f,g),D=d.getValueOrDefault(p._outlineColor,e,_,y),I=Math.round(d.getValueOrDefault(p._outlineWidth,e,0)),O=Math.max(1,Math.round(d.getValueOrDefault(p._pixelSize,e,1)));if(I>0?(E.scale=1,S=S||I!==c.outlineWidth||O!==c.pixelSize||!i.equals(b,c.color)||!i.equals(D,c.outlineColor)):(E.scale=O/50,O=50,S=S||I!==c.outlineWidth||!i.equals(b,c.color)||!i.equals(D,c.outlineColor)),S){c.color=i.clone(b,c.color),c.outlineColor=i.clone(D,c.outlineColor),c.pixelSize=O,c.outlineWidth=I;var M=b.alpha,F=b.toCssColorString(),N=D.toCssColorString(),L=JSON.stringify([F,O,N,I]);E.setImage(L,u(M,F,N,I,O))}}}else m(c,h,r)}return!0},p.prototype.getBoundingSphere=function(e,i){var r=this._items.get(e.id);if(!n(r)||!n(r.pointPrimitive)&&!n(r.billboard))return c.FAILED;if(n(r.pointPrimitive))i.center=t.clone(r.pointPrimitive.position,i.center);else{var o=r.billboard;if(!n(o._clampedPosition))return c.PENDING;i.center=t.clone(o._clampedPosition,i.center)}return i.radius=0,c.DONE},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(p.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return r(this)},p.prototype._onCollectionChanged=function(e,t,i,r){var o,a,s=this._items,u=this._cluster;for(o=t.length-1;o>-1;o--)a=t[o],n(a._point)&&n(a._position)&&s.set(a.id,new h(a));for(o=r.length-1;o>-1;o--)a=r[o],n(a._point)&&n(a._position)?s.contains(a.id)||s.set(a.id,new h(a)):(m(s.get(a.id),a,u),s.remove(a.id));for(o=i.length-1;o>-1;o--)a=i[o],m(s.get(a.id),a,u),s.remove(a.id)},p}.apply(t,n))&&(e.exports=r)},2263:function(e,t,i){var n,r;n=[i(182),i(38),i(12),i(1),i(0),i(21),i(753),i(754),i(184),i(744),i(421),i(1980),i(2264),i(1983),i(1984),i(2266)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f){"use strict";function _(e,t){for(var i=e._batches,n=i.length,r=0;r<n;r++)i[r].remove(t)}function g(e,t,i){if(i.isDynamic)return void e._dynamicBatch.add(t,i);if(i.clampToGround&&i.fillEnabled)return void e._groundBatch.add(t,i);var n;i.fillEnabled&&(n=i.shadowsProperty.getValue(t));var o=0;r(i.depthFailMaterialProperty)&&(o=i.depthFailMaterialProperty instanceof c?1:2);var a;r(n)&&(a=n+o*u.NUMBER_OF_SHADOW_MODES),i.fillEnabled&&(i.fillMaterialProperty instanceof c?e._colorBatches[a].add(t,i):e._materialBatches[a].add(t,i))}function v(t,i,r,o){o=n(o,t.groundPrimitives),r=n(r,t.primitives),this._scene=t,this._primitives=r,this._entityCollection=void 0,this._addedObjects=new e,this._removedObjects=new e,this._changedObjects=new e;var l=u.NUMBER_OF_SHADOW_MODES;this._colorBatches=new Array(3*l),this._materialBatches=new Array(3*l);for(var c=0;c<l;++c)this._colorBatches[c]=new p(r,a,void 0,!1,c),this._materialBatches[c]=new m(r,s,void 0,!1,c),this._colorBatches[c+l]=new p(r,a,a,!1,c),this._materialBatches[c+l]=new m(r,s,a,!1,c),this._colorBatches[c+2*l]=new p(r,a,s,!1,c),this._materialBatches[c+2*l]=new m(r,s,s,!1,c);this._dynamicBatch=new d(r,o),this._groundBatch=new f(o),this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatch),this._subscriptions=new e,this._updaters=new e,this._entityCollection=i,i.collectionChanged.addEventListener(v.prototype._onCollectionChanged,this),this._onCollectionChanged(i,i.values,y)}var y=[];v.prototype.update=function(e){var t,i,n,r,o=this._addedObjects,a=o.values,s=this._removedObjects,u=s.values,l=this._changedObjects,c=l.values;for(t=c.length-1;t>-1;t--)i=c[t],n=i.id,r=this._updaters.get(n),r.entity===i?(_(this,r),g(this,e,r)):(u.push(i),a.push(i));for(t=u.length-1;t>-1;t--)i=u[t],n=i.id,r=this._updaters.get(n),_(this,r),r.destroy(),this._updaters.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=a.length-1;t>-1;t--)i=a[t],n=i.id,r=new h(i,this._scene),this._updaters.set(n,r),g(this,e,r),this._subscriptions.set(n,r.geometryChanged.addEventListener(v._onGeometryChanged,this));o.removeAll(),s.removeAll(),l.removeAll();var d=!0,p=this._batches,m=p.length;for(t=0;t<m;t++)d=p[t].update(e)&&d;return d};var w=[],x=new t;return v.prototype.getBoundingSphere=function(e,i){for(var n=w,r=x,o=0,a=l.DONE,s=this._batches,u=s.length,c=this._updaters.get(e.id),d=0;d<u;d++){if((a=s[d].getBoundingSphere(c,r))===l.PENDING)return l.PENDING;a===l.DONE&&(n[o]=t.clone(r,n[o]),o++)}return 0===o?l.FAILED:(n.length=o,t.fromBoundingSpheres(n,i),l.DONE)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(v.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var e,t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();return this._subscriptions.removeAll(),o(this)},v._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,n=e.entity,o=n.id;r(t.get(o))||r(i.get(o))||i.set(o,n)},v.prototype._onCollectionChanged=function(e,t,i){var n,r,o,a=this._addedObjects,s=this._removedObjects,u=this._changedObjects;for(n=i.length-1;n>-1;n--)o=i[n],r=o.id,a.remove(r)||(s.set(r,o),u.remove(r));for(n=t.length-1;n>-1;n--)o=t[n],r=o.id,s.remove(r)?u.set(r,o):a.set(r,o)},v}.apply(t,n))&&(e.exports=r)},2264:function(e,t,i){var n,r;n=[i(38),i(12),i(25),i(150),i(1),i(0),i(2),i(21),i(3),i(154),i(1934),i(15),i(128),i(778),i(215),i(2265),i(748),i(1933),i(156),i(752),i(770),i(753),i(754),i(184),i(744),i(421),i(425),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T,E,A,P,S,b){"use strict";function D(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.followSurface=void 0,this.granularity=void 0}function I(){this.positions=void 0,this.width=void 0}function O(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(O.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new d,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new D,this._groundGeometryOptions=new I,this._id="polyline-"+e.id,this._clampToGround=!1,this._supportsPolylinesOnTerrain=v.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}function M(e,t,i){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=i,this._positions=[]}function F(e){if(o(e._line))return e._line;var t=e._geometryUpdater._scene.id,i=L[t],n=e._primitives;!o(i)||i.isDestroyed()?(i=new w,L[t]=i,n.add(i)):n.contains(i)||n.add(i);var r=i.add();return r.id=e._geometryUpdater._entity,e._line=r,r}var N=new P(0),L={},R=new i,V=new A(i.WHITE),U=new P(!0),z=new P(T.DISABLED),B=new P(new l);a(O.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!o(this._entity.availability)&&b.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}}),O.prototype.isOutlineVisible=function(e){return!1},O.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)},O.prototype.createFillGeometryInstance=function(e){var t,r=this._entity,a=r.isAvailable(e),s=new g(a&&r.isShowing&&this._showProperty.getValue(e)),u=this._distanceDisplayConditionProperty.getValue(e),l=c.fromDistanceDisplayCondition(u),d={show:s,distanceDisplayCondition:l};return this._materialProperty instanceof A&&(o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(t=this._materialProperty.color.getValue(e,R)),o(t)||(t=i.WHITE),d.color=n.fromColor(t)),this.clampToGround?new h({id:r,geometry:new p(this._groundGeometryOptions),attributes:d}):(o(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof A&&(o(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||a)&&(t=this._depthFailMaterialProperty.color.getValue(e,R)),o(t)||(t=i.WHITE),d.depthFailColor=n.fromColor(t)),new h({id:r,geometry:new f(this._geometryOptions),attributes:d}))},O.prototype.createOutlineGeometryInstance=function(e){},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){this._entitySubscription(),s(this)},O.prototype._onEntityPropertyChanged=function(e,t,i,n){if("availability"===t||"polyline"===t){var a=this._entity.polyline;if(!o(a))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.positions,u=a.show;if(o(u)&&u.isConstant&&!u.getValue(m.MINIMUM_VALUE)||!o(s))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));var l=a.zIndex,c=r(a.material,V),d=c instanceof A;this._materialProperty=c,this._depthFailMaterialProperty=a.depthFailMaterial,this._showProperty=r(u,U),this._shadowsProperty=r(a.shadows,z),this._distanceDisplayConditionProperty=r(a.distanceDisplayCondition,B),this._fillEnabled=!0,this._zIndex=r(l,N);var h=a.width,p=a.followSurface,f=a.clampToGround,_=a.granularity;if(s.isConstant&&b.isConstant(h)&&b.isConstant(p)&&b.isConstant(_)&&b.isConstant(f)&&b.isConstant(l)){var g=this._geometryOptions,v=s.getValue(m.MINIMUM_VALUE,g.positions);if(!o(v)||v.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));var y;y=d&&(!o(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof A)?x.VERTEX_FORMAT:C.VERTEX_FORMAT,g.vertexFormat=y,g.positions=v,g.width=o(h)?h.getValue(m.MINIMUM_VALUE):void 0,g.followSurface=o(p)?p.getValue(m.MINIMUM_VALUE):void 0,g.granularity=o(_)?_.getValue(m.MINIMUM_VALUE):void 0;var w=this._groundGeometryOptions;w.positions=v,w.width=g.width,this._clampToGround=!!o(f)&&f.getValue(m.MINIMUM_VALUE),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},O.prototype.createDynamicUpdater=function(e,t){return new M(e,t,this)};var H={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};return M.prototype.update=function(e){var t=this._geometryUpdater,i=t._entity,n=i.polyline,r=n.positions,a=b.getValueOrUndefined(r,e,this._positions);t._clampToGround=b.getValueOrDefault(n._clampToGround,e,!1),t._groundGeometryOptions.positions=a,t._groundGeometryOptions.width=b.getValueOrDefault(n._width,e,1);var s=this._groundPrimitives;if(o(this._groundPolylinePrimitive)&&(s.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),t.clampToGround){if(!i.isShowing||!i.isAvailable(e)||!b.getValueOrDefault(n._show,e,!0))return;if(!o(a)||a.length<2)return;var u,l=t.fillMaterialProperty;if(l instanceof A)u=new x;else{var c=S.getValue(e,l,this._material);u=new C({material:c,translucent:c.isTranslucent()}),this._material=c}return this._groundPolylinePrimitive=s.add(new y({geometryInstances:t.createFillGeometryInstance(e),appearance:u,asynchronous:!1}),b.getValueOrUndefined(t.zIndex,e)),void(o(this._line)&&(this._line.show=!1))}var d=F(this);if(!i.isShowing||!i.isAvailable(e)||!b.getValueOrDefault(n._show,e,!0))return void(d.show=!1);if(!o(a)||a.length<2)return void(d.show=!1);var h=b.getValueOrDefault(n._followSurface,e,!0),p=t._scene.globe;h&&o(p)&&(H.ellipsoid=p.ellipsoid,H.positions=a,H.granularity=b.getValueOrUndefined(n._granularity,e),H.height=_.extractHeights(a,p.ellipsoid),a=_.generateCartesianArc(H)),d.show=!0,d.positions=a.slice(),d.material=S.getValue(e,t.fillMaterialProperty,d.material),d.width=b.getValueOrDefault(n._width,e,1),d.distanceDisplayCondition=b.getValueOrUndefined(n._distanceDisplayCondition,e,d.distanceDisplayCondition)},M.prototype.getBoundingSphere=function(t){if(this._geometryUpdater.clampToGround){var i=this._groundPolylinePrimitive;if(o(i)&&i.show&&i.ready){var n=i.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(o(n)&&o(n.boundingSphere))return e.clone(n.boundingSphere,t),E.DONE}return o(i)&&!i.ready?E.PENDING:E.DONE}var r=F(this);return r.show&&r.positions.length>0?(e.fromPoints(r.positions,t),E.DONE):E.FAILED},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){var e=this._geometryUpdater,t=e._scene.id,i=L[t];o(i)&&(i.remove(this._line),0===i.length&&(this._primitives.removeAndDestroy(i),delete L[t])),o(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),s(this)},O}.apply(t,n))&&(e.exports=r)},2265:function(e,t,i){var n,r;n=[i(292),i(38),i(10),i(25),i(31),i(1),i(0),i(3),i(23),i(76),i(90),i(129),i(441),i(49),i(9),i(748),i(54),i(181)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g){"use strict";function v(e,t,i,r,o){var a=w;a.length=o;var s,u=i.red,l=i.green,c=i.blue,d=i.alpha,h=r.red,p=r.green,m=r.blue,f=r.alpha;if(n.equals(i,r)){for(s=0;s<o;s++)a[s]=n.clone(i);return a}var _=(h-u)/o,g=(p-l)/o,v=(m-c)/o,y=(f-d)/o;for(s=0;s<o;s++)a[s]=new n(u+s*_,l+s*g,c+s*v,d+s*y);return a}function y(e){e=o(e,o.EMPTY_OBJECT);var t=e.positions,r=e.colors,s=o(e.width,1),l=o(e.colorsPerVertex,!1);this._positions=t,this._colors=r,this._width=s,this._colorsPerVertex=l,this._vertexFormat=g.clone(o(e.vertexFormat,g.DEFAULT)),this._followSurface=o(e.followSurface,!0),this._granularity=o(e.granularity,m.RADIANS_PER_DEGREE),this._ellipsoid=u.clone(o(e.ellipsoid,u.WGS84)),this._workerName="createPolylineGeometry";var c=1+t.length*i.packedLength;c+=a(r)?1+r.length*n.packedLength:1,this.packedLength=c+u.packedLength+g.packedLength+4}var w=[];y.pack=function(e,t,r){r=o(r,0);var s,l=e._positions,c=l.length;for(t[r++]=c,s=0;s<c;++s,r+=i.packedLength)i.pack(l[s],t,r);var d=e._colors;for(c=a(d)?d.length:0,t[r++]=c,s=0;s<c;++s,r+=n.packedLength)n.pack(d[s],t,r);return u.pack(e._ellipsoid,t,r),r+=u.packedLength,g.pack(e._vertexFormat,t,r),r+=g.packedLength,t[r++]=e._width,t[r++]=e._colorsPerVertex?1:0,t[r++]=e._followSurface?1:0,t[r]=e._granularity,t};var x=u.clone(u.UNIT_SPHERE),C=new g,T={positions:void 0,colors:void 0,ellipsoid:x,vertexFormat:C,width:void 0,colorsPerVertex:void 0,followSurface:void 0,granularity:void 0};y.unpack=function(e,t,r){t=o(t,0);var s,l=e[t++],c=new Array(l);for(s=0;s<l;++s,t+=i.packedLength)c[s]=i.unpack(e,t);l=e[t++];var d=l>0?new Array(l):void 0;for(s=0;s<l;++s,t+=n.packedLength)d[s]=n.unpack(e,t);var h=u.unpack(e,t,x);t+=u.packedLength;var p=g.unpack(e,t,C);t+=g.packedLength;var m=e[t++],f=1===e[t++],_=1===e[t++],v=e[t];return a(r)?(r._positions=c,r._colors=d,r._ellipsoid=u.clone(h,r._ellipsoid),r._vertexFormat=g.clone(p,r._vertexFormat),r._width=m,r._colorsPerVertex=f,r._followSurface=_,r._granularity=v,r):(T.positions=c,T.colors=d,T.width=m,T.colorsPerVertex=f,T.followSurface=_,T.granularity=v,new y(T))};var E=new i,A=new i,P=new i,S=new i;return y.createGeometry=function(o){var s,u,g,y=o._width,x=o._vertexFormat,C=o._colors,T=o._colorsPerVertex,b=o._followSurface,D=o._granularity,I=o._ellipsoid,O=e(o._positions,i.equalsEpsilon),M=O.length;if(!(M<2||y<=0)){if(b){var F=f.extractHeights(O,I),N=m.chordLength(D,I.maximumRadius);if(a(C)){var L=1;for(s=0;s<M-1;++s)L+=f.numberOfPoints(O[s],O[s+1],N);var R=new Array(L),V=0;for(s=0;s<M-1;++s){var U=O[s],z=O[s+1],B=C[s],H=f.numberOfPoints(U,z,N);if(T&&s<L){var k=C[s+1],G=v(U,z,B,k,H),W=G.length;for(u=0;u<W;++u)R[V++]=G[u]}else for(u=0;u<H;++u)R[V++]=n.clone(B)}R[V]=n.clone(C[C.length-1]),C=R,w.length=0}O=f.generateCartesianArc({positions:O,minDistance:N,ellipsoid:I,height:F})}M=O.length;var Y,j=4*M-4,X=new Float64Array(3*j),Q=new Float64Array(3*j),q=new Float64Array(3*j),Z=new Float32Array(2*j),K=x.st?new Float32Array(2*j):void 0,J=a(C)?new Uint8Array(4*j):void 0,$=0,ee=0,te=0,ie=0;for(u=0;u<M;++u){0===u?(Y=E,i.subtract(O[0],O[1],Y),i.add(O[0],Y,Y)):Y=O[u-1],i.clone(Y,P),i.clone(O[u],A),u===M-1?(Y=E,i.subtract(O[M-1],O[M-2],Y),i.add(O[M-1],Y,Y)):Y=O[u+1],i.clone(Y,S);var ne,re;a(J)&&(ne=0===u||T?C[u]:C[u-1],u!==M-1&&(re=C[u]));var oe=0===u?2:0,ae=u===M-1?2:4;for(g=oe;g<ae;++g){i.pack(A,X,$),i.pack(P,Q,$),i.pack(S,q,$),$+=3;var se=g-2<0?-1:1;if(Z[ee++]=g%2*2-1,Z[ee++]=se*y,x.st&&(K[te++]=u/(M-1),K[te++]=Math.max(Z[ee-2],0)),a(J)){var ue=g<2?ne:re;J[ie++]=n.floatToByte(ue.red),J[ie++]=n.floatToByte(ue.green),J[ie++]=n.floatToByte(ue.blue),J[ie++]=n.floatToByte(ue.alpha)}}}var le=new d;le.position=new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:X}),le.prevPosition=new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:Q}),le.nextPosition=new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:q}),le.expandAndWidth=new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:Z}),x.st&&(le.st=new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:K})),a(J)&&(le.color=new c({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:4,values:J,normalize:!0}));var ce=p.createTypedArray(j,6*M-6),de=0,he=0,pe=M-1;for(u=0;u<pe;++u)ce[he++]=de,ce[he++]=de+2,ce[he++]=de+1,ce[he++]=de+1,ce[he++]=de+2,ce[he++]=de+3,de+=4;return new l({attributes:le,indices:ce,primitiveType:_.TRIANGLES,boundingSphere:t.fromPoints(O),geometryType:h.POLYLINES})}},y}.apply(t,n))&&(e.exports=r)},2266:function(e,t,i){var n,r;n=[i(182),i(25),i(150),i(0),i(154),i(1934),i(1933),i(752),i(753),i(754),i(744),i(421),i(1939),i(89)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p){"use strict";function m(t,i,n){var r;r=i instanceof d?u:l,this.orderedGroundPrimitives=t,this.appearanceType=r,this.materialProperty=i,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(m.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e,this.zIndex=n}function f(e){this._items=[],this._orderedGroundPrimitives=e}var _=new t,g=new r,v=new r;return m.prototype.onMaterialChanged=function(){this.invalidated=!0},m.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof d&&t instanceof d||n(t)&&t.equals(i)},m.prototype.add=function(e,t,i){var n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&p.isConstant(t.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener(function(e,i,n,o){"isShowing"===i&&r.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},m.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return n(i)&&(i(),this.subscriptions.remove(t)),!0}return!1},m.prototype.update=function(e){var u,c=!0,d=this.primitive,m=this.orderedGroundPrimitives,f=this.geometry.values;if(this.createPrimitive){if(f.length>0)n(d)&&(n(this.oldPrimitive)?m.remove(d):this.oldPrimitive=d),d=new s({show:!1,asynchronous:!0,geometryInstances:f,appearance:new this.appearanceType}),this.appearanceType===l&&(this.material=h.getValue(e,this.materialProperty,this.material),d.appearance.material=this.material),m.add(d,this.zIndex),c=!1;else{n(d)&&(m.remove(d),d=void 0);var y=this.oldPrimitive;n(y)&&(m.remove(y),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=d,this.createPrimitive=!1}else if(n(d)&&d.ready){d.show=!0,n(this.oldPrimitive)&&(m.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===l&&(this.material=h.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);var w=this.updatersWithAttributes.values,x=w.length;for(u=0;u<x;u++){var C=w[u],T=C.entity,E=this.geometry.get(C.id),A=this.attributes.get(E.id.id);if(n(A)||(A=d.getGeometryInstanceAttributes(E.id),this.attributes.set(E.id.id,A)),!C.fillMaterialProperty.isConstant){var P=C.fillMaterialProperty.color,S=p.getValueOrDefault(P,e,t.WHITE,_);t.equals(A._lastColor,S)||(A._lastColor=t.clone(S,A._lastColor),A.color=i.toValue(S,A.color))}var b=T.isShowing&&(C.hasConstantFill||C.isFilled(e)),D=1===A.show[0];b!==D&&(A.show=a.toValue(b,A.show));var I=C.distanceDisplayConditionProperty;if(!p.isConstant(I)){var O=p.getValueOrDefault(I,e,v,g);r.equals(O,A._lastDistanceDisplayCondition)||(A._lastDistanceDisplayCondition=r.clone(O,A._lastDistanceDisplayCondition),A.distanceDisplayCondition=o.toValue(O,A.distanceDisplayCondition))}}this.updateShows(d)}else n(d)&&!d.ready&&(c=!1);return c},m.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,r=0;r<i;r++){var o=t[r],s=o.entity,u=this.geometry.get(o.id),l=this.attributes.get(u.id.id);n(l)||(l=e.getGeometryInstanceAttributes(u.id),this.attributes.set(u.id.id,l));var c=s.isShowing;c!==(1===l.show[0])&&(l.show=a.toValue(c,l.show))}this.showsUpdated.removeAll()},m.prototype.contains=function(e){return this.updaters.contains(e.id)},m.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return c.PENDING;var r=i.getGeometryInstanceAttributes(e.entity);return!n(r)||!n(r.boundingSphere)||n(r.show)&&0===r.show[0]?c.FAILED:(r.boundingSphere.clone(t),c.DONE)},m.prototype.destroy=function(){var e=this.primitive,t=this.orderedGroundPrimitives;n(e)&&t.remove(e);var i=this.oldPrimitive;n(i)&&t.remove(i),this.removeMaterialSubscription()},f.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=t.createFillGeometryInstance(e),o=p.getValueOrDefault(t.zIndex,0),a=0;a<n;++a){var s=i[a];if(s.isMaterial(t)&&s.zIndex===o)return void s.add(e,t,r)}var u=new m(this._orderedGroundPrimitives,t.fillMaterialProperty,o);u.add(e,t,r),i.push(u)},f.prototype.remove=function(e){for(var t=this._items,i=t.length,n=i-1;n>=0;n--){var r=t[n];if(r.remove(e)){0===r.updaters.length&&(t.splice(n,1),r.destroy());break}}},f.prototype.update=function(e){var t,i=this._items,n=i.length;for(t=n-1;t>=0;t--){var r=i[t];if(r.invalidated){i.splice(t,1);for(var o=r.updaters.values,a=o.length,s=0;s<a;s++)this.add(e,o[s]);r.destroy()}}var u=!0;for(t=0;t<i.length;t++)u=i[t].update(e)&&u;return u},f.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var o=i[r];if(o.contains(e))return o.getBoundingSphere(e,t)}return c.FAILED},f.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0},f}.apply(t,n))&&(e.exports=r)},2267:function(e,t,i){"use strict";var n=i(17),r=i(0),o=i(2),a=i(3),s=i(294),u=i(13),l=i(427),c=i(791),d=new n,h=function(e){function t(){i.style.top=o._screenPositionY,i.style.left=o._screenPositionX,i.style.transform=o.transform,i.style.opacity=o.opacity}if(!r(e))throw new a("cesium is required.");this._cesium=e,this._screenPositionX="-1000px",this._screenPositionY="-1000px",this._tweens=e.scene.tweens,this._container=e.viewer.container,this.position=void 0,this.showSelection=!0,this.transform="",this.opacity=1,u.track(this,["position","_screenPositionX","_screenPositionY","_scale","rotate","showSelection","transform","opacity"]),this.isVisible=void 0,u.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&r(this.position)}}),this.computeScreenSpacePosition=function(t,i){return l.wgs84ToWindowCoordinates(e.scene,t,i)};var i=document.createElement("div");i.className="selection-indicator",this._container.appendChild(i),this._selectionIndicatorElement=i;var n=document.createElement("img");n.setAttribute("src",c),n.setAttribute("alt",""),n.setAttribute("width",50),n.setAttribute("height",50),i.appendChild(n);var o=this;t(),this._subscriptions=[],this._subscriptions.push(u.getObservable(this,"_screenPositionX").subscribe(t)),this._subscriptions.push(u.getObservable(this,"_screenPositionY").subscribe(t)),this._subscriptions.push(u.getObservable(this,"transform").subscribe(t)),this._subscriptions.push(u.getObservable(this,"opacity").subscribe(t))};h.prototype.destroy=function(){this._selectionIndicatorElement.parentNode.removeChild(this._selectionIndicatorElement),this._subscriptions.forEach(function(e){e.dispose()})},h.prototype.update=function(){if(this.showSelection&&r(this.position)){var e=this.computeScreenSpacePosition(this.position,d);if(r(e)){var t=this._container,i=t.clientWidth,n=t.clientHeight,o=this._selectionIndicatorElement.clientWidth,a=.5*o;e.x=Math.min(Math.max(e.x,-o),i+o)-a,e.y=Math.min(Math.max(e.y,-o),n+o)-a,this._screenPositionX=Math.floor(e.x+.25)+"px",this._screenPositionY=Math.floor(e.y+.25)+"px"}else this._screenPositionX="-1000px",this._screenPositionY="-1000px"}},h.prototype.animateAppear=function(){if(r(this._selectionIndicatorTween)){if(this._selectionIndicatorIsAppearing)return;this._selectionIndicatorTween.cancelTween(),this._selectionIndicatorTween=void 0}this._selectionIndicatorIsAppearing=!0;var e=this;this._selectionIndicatorTween=this._tweens.add({startObject:{scale:2,opacity:0,rotate:-180},stopObject:{scale:1,opacity:1,rotate:0},duration:.8,easingFunction:s.EXPONENTIAL_OUT,update:function(t){e.opacity=t.opacity,e.transform="scale("+t.scale+") rotate("+t.rotate+"deg)"},complete:function(){e._selectionIndicatorTween=void 0},cancel:function(){e._selectionIndicatorTween=void 0}})},h.prototype.animateDepart=function(){if(r(this._selectionIndicatorTween)){if(!this._selectionIndicatorIsAppearing)return;this._selectionIndicatorTween.cancelTween(),this._selectionIndicatorTween=void 0}this._selectionIndicatorIsAppearing=!1;var e=this;this._selectionIndicatorTween=this._tweens.add({startObject:{scale:1,opacity:1},stopObject:{scale:1.5,opacity:0},duration:.8,easingFunction:s.EXPONENTIAL_OUT,update:function(t){e.opacity=t.opacity,e.transform="scale("+t.scale+") rotate(0deg)"},complete:function(){e._selectionIndicatorTween=void 0},cancel:function(){e._selectionIndicatorTween=void 0}})},o(h.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}}),e.exports=h},803:function(e,t,i){var n,r;n=[i(103),i(10),i(439),i(1),i(0),i(2),i(21),i(3),i(23),i(39),i(188),i(440),i(432),i(2122),i(2123),i(2137),i(2145),i(46),i(184),i(2200),i(2203),i(2207),i(436)],void 0!==(r=function(e,t,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x,C,T){"use strict";function E(e){return i(2211)("./tycho2t3_80_"+e+".jpg")}function A(e){function t(n){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{var r=e._targetFrameRate;if(o(r)){var a=1e3/r,s=n-i;s>a&&(e.resize(),e.render(),i=n-s%a),h(t)}else e.resize(),e.render(),h(t)}catch(t){if(e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors){e.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}}else e._renderLoopRunning=!1}e._renderLoopRunning=!0;var i=0;h(t)}function P(e){var t=e._canvas,i=t.clientWidth,n=t.clientHeight,o=e._resolutionScale;e._supportsImageRenderingPixelated||(o*=r(window.devicePixelRatio,1)),e._canvasWidth=i,e._canvasHeight=n,i*=o,n*=o,t.width=i,t.height=n,e._canRender=0!==i&&0!==n}function S(e){var t=e._canvas,i=t.width,n=t.height;if(0!==i&&0!==n){var r=e._scene.camera.frustum;o(r.aspectRatio)?r.aspectRatio=i/n:(r.top=r.right*(n/i),r.bottom=-r.top)}}function b(e,i){e=T(e),i=r(i,{});var a=document.createElement("div");a.className="cesium-widget",e.appendChild(a);var s=document.createElement("canvas"),u=c.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=u,u&&(s.style.imageRendering=c.imageRenderingValue()),s.oncontextmenu=function(){return!1},s.onselectstart=function(){return!1},a.appendChild(s);var d=document.createElement("div");d.className="cesium-widget-credits";var h=o(i.creditContainer)?T(i.creditContainer):a;h.appendChild(d);var A=o(i.creditViewport)?T(i.creditViewport):a,b=r(i.showRenderLoopErrors,!0);this._element=a,this._container=e,this._canvas=s,this._canvasWidth=0,this._canvasHeight=0,this._creditViewport=A,this._creditContainer=h,this._innerCreditContainer=d,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=b,this._resolutionScale=1,this._forceResize=!1,this._clock=o(i.clock)?i.clock:new n,P(this);try{var D=new g({canvas:s,contextOptions:i.contextOptions,creditContainer:d,creditViewport:A,mapProjection:i.mapProjection,orderIndependentTranslucency:i.orderIndependentTranslucency,scene3DOnly:r(i.scene3DOnly,!1),terrainExaggeration:i.terrainExaggeration,shadows:i.shadows,mapMode2D:i.mapMode2D,requestRenderMode:i.requestRenderMode,maximumRenderTimeChange:i.maximumRenderTimeChange});this._scene=D,D.camera.constrainedAxis=t.UNIT_Z,S(this);var I=r(D.mapProjection.ellipsoid,l.WGS84),O=i.globe;o(O)||(O=new f(I)),!1!==O&&(D.globe=O,D.globe.shadows=r(i.terrainShadows,y.RECEIVE_ONLY));var M=i.skyBox;o(M)||(M=new x({sources:{positiveX:E("px"),negativeX:E("mx"),positiveY:E("py"),negativeY:E("my"),positiveZ:E("pz"),negativeZ:E("mz")}})),!1!==M&&(D.skyBox=M,D.sun=new C,D.moon=new _);var F=i.skyAtmosphere;o(F)||(F=new w(I)),!1!==F&&(D.skyAtmosphere=F);var N=!1!==i.globe&&i.imageryProvider;o(N)||(N=m()),!1!==N&&D.imageryLayers.addImageryProvider(N),o(i.terrainProvider)&&!1!==i.globe&&(D.terrainProvider=i.terrainProvider),this._screenSpaceEventHandler=new p(s,!1),o(i.sceneMode)&&(i.sceneMode===v.SCENE2D&&this._scene.morphTo2D(0),i.sceneMode===v.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=r(i.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=i.targetFrameRate;var L=this;D.renderError.addEventListener(function(e,t){if(L._useDefaultRenderLoop=!1,L._renderLoopRunning=!1,L._showRenderLoopErrors){L.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}})}catch(e){if(b){this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',e)}throw e}}return a(b.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&A(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){this._resolutionScale=e,this._forceResize=!0}}}),b.prototype.showErrorPanel=function(e,t,i){function n(){l.style.maxHeight=Math.max(Math.round(.9*r.clientHeight-100),30)+"px"}var r=this._element,a=document.createElement("div");a.className="cesium-widget-errorPanel";var s=document.createElement("div");s.className="cesium-widget-errorPanel-content",a.appendChild(s);var u=document.createElement("div");u.className="cesium-widget-errorPanel-header",u.appendChild(document.createTextNode(e)),s.appendChild(u);var l=document.createElement("div");if(l.className="cesium-widget-errorPanel-scroll",s.appendChild(l),n(),o(window.addEventListener)&&window.addEventListener("resize",n,!1),o(t)){var c=document.createElement("div");c.className="cesium-widget-errorPanel-message",c.innerHTML="<p>"+t+"</p>",l.appendChild(c)}var h="(no error details available)";o(i)&&(h=d(i));var p=document.createElement("div");p.className="cesium-widget-errorPanel-message",p.appendChild(document.createTextNode(h)),l.appendChild(p);var m=document.createElement("div");m.className="cesium-widget-errorPanel-buttonPanel",s.appendChild(m);var f=document.createElement("button");f.setAttribute("type","button"),f.className="cesium-button",f.appendChild(document.createTextNode("OK")),f.onclick=function(){o(n)&&o(window.removeEventListener)&&window.removeEventListener("resize",n,!1),r.removeChild(a)},m.appendChild(f),r.appendChild(a),"undefined"!=typeof console&&console.error(e+"\n"+t+"\n"+h)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy(),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),s(this)},b.prototype.resize=function(){var e=this._canvas,t=e.clientWidth,i=e.clientHeight;(this._forceResize||this._canvasWidth!==t||this._canvasHeight!==i)&&(this._forceResize=!1,P(this),S(this),this._scene.requestRender())},b.prototype.forceResize=function(){this._lastWidth=0,this.resize()},b.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else this._clock.tick()},b}.apply(t,n))&&(e.exports=r)},806:function(e,t,i){var n,r;n=[i(293),i(38),i(12),i(101),i(1),i(0),i(2),i(21),i(217),i(752),i(746),i(2218),i(1957),i(2219),i(744),i(164),i(2220),i(2259),i(2260),i(2261),i(2262),i(2263)],void 0!==(r=function(e,t,i,n,r,o,a,s,u,l,c,d,h,p,m,f,_,g,v,y,w,x){"use strict";function C(e){this._displayID=n(),c.initializeTerrainHeights(),l.initializeTerrainHeights();var t=e.scene,i=e.dataSourceCollection;this._eventHelper=new u,this._eventHelper.add(i.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(i.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(i.dataSourceMoved,this._onDataSourceMoved,this),this._dataSourceCollection=i,this._scene=t,this._visualizersCallback=r(e.visualizersCallback,C.defaultVisualizersCallback);var o=!1,a=new h,s=new h;i.length>0&&(t.primitives.add(a),t.groundPrimitives.add(s),o=!0),this._primitives=a,this._groundPrimitives=s;for(var d=0,p=i.length;d<p;d++)this._onDataSourceAdded(i,i.get(d));var m=new f;this._onDataSourceAdded(void 0,m),this._defaultDataSource=m;var _,g;if(!o){var v=this,y=function(){t.primitives.add(a),t.groundPrimitives.add(s),_(),g(),v._removeDefaultDataSoureListener=void 0,v._removeDataSourceCollectionListener=void 0};_=m.entities.collectionChanged.addEventListener(y),g=i.dataSourceAdded.addEventListener(y)}this._removeDefaultDataSoureListener=_,this._removeDataSourceCollectionListener=g,this._ready=!1}C.defaultVisualizersCallback=function(e,t,i){var n=i.entities;return[new p(t,n),new _(e,n,i._primitives,i._groundPrimitives),new g(t,n),new v(e,n),new w(t,n),new y(e,n),new x(e,n,i._primitives,i._groundPrimitives)]},a(C.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){this._eventHelper.removeAll();for(var e=this._dataSourceCollection,t=0,i=e.length;t<i;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),o(this._removeDefaultDataSoureListener)?(this._removeDefaultDataSoureListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),s(this)},C.prototype.update=function(t){if(!e.initialized)return this._ready=!1,!1;var i,n,r,a,s=!0,u=this._dataSourceCollection,l=u.length;for(i=0;i<l;i++){var c=u.get(i);for(o(c.update)&&(s=c.update(t)&&s),r=c._visualizersByDisplayID[this._displayID],a=r.length,n=0;n<a;n++)s=r[n].update(t)&&s}for(r=this._defaultDataSource._visualizersByDisplayID[this._displayID],a=r.length,n=0;n<a;n++)s=r[n].update(t)&&s;return this._ready=s,s};var T=[],E=new t;return C.prototype.getBoundingSphere=function(e,i,n){if(!this._ready)return m.PENDING;var r,a,s=this._defaultDataSource;if(!s.entities.contains(e)){s=void 0;var u=this._dataSourceCollection;for(a=u.length,r=0;r<a;r++){var l=u.get(r);if(l.entities.contains(e)){s=l;break}}}if(!o(s))return m.FAILED;var c=T,d=E,h=0,p=m.DONE,f=s._visualizers,_=f.length;for(r=0;r<_;r++){var g=f[r];if(o(g.getBoundingSphere)){if(p=f[r].getBoundingSphere(e,d),!i&&p===m.PENDING)return m.PENDING;p===m.DONE&&(c[h]=t.clone(d,c[h]),h++)}}return 0===h?m.FAILED:(c.length=h,t.fromBoundingSpheres(c,n),m.DONE)},C.prototype._onDataSourceAdded=function(e,t){var i=this._scene,n=this._primitives,r=this._groundPrimitives,o=n.add(new h),a=r.add(new d);t._primitives=o,t._groundPrimitives=a;var s=t.clustering;s._initialize(i),o.add(s);var u=this._visualizersCallback(i,s,t);t._visualizersByDisplayID=t._visualizersByDisplayID||{},t._visualizersByDisplayID[this._displayID]=u,t._visualizers=t._visualizers||[],t._visualizers=t._visualizers.concat(u)},C.prototype._onDataSourceRemoved=function(e,t){var i=this._primitives,n=this._groundPrimitives,r=t._primitives,a=t._groundPrimitives,s=t.clustering;r.remove(s);var u=t._visualizersByDisplayID[this._displayID];if(o(u)){for(var l=u.length,c=0;c<l;c++){var d=u[c];d.destroy();var h=t._visualizers.indexOf(d);t._visualizers.splice(h,1)}delete t._visualizersByDisplayID[this._displayID],i.remove(r),n.remove(a)}},C.prototype._onDataSourceMoved=function(e,t,i){var n=this._primitives,r=this._groundPrimitives,o=e._primitives,a=e._groundPrimitives;t===i+1?(n.raise(o),r.raise(a)):t===i-1?(n.lower(o),r.lower(a)):0===t?(n.lowerToBottom(o),r.lowerToBottom(a),n.raise(o),r.raise(a)):(n.raiseToTop(o),r.raiseToTop(a))},C}.apply(t,n))&&(e.exports=r)},807:function(e,t,i){"use strict";function n(e){return d(e.items)?e.items.length:1}function r(e,t){var i=g(),n=e.scene;C.equalsEpsilon(e._lastCameraViewMatrix,n.camera.viewMatrix,1e-5)||(e._lastCameraMoveTime=i);var r=i-e._lastCameraMoveTime<1e3,o=n.globe._surface,a=!o._tileProvider.ready||o._tileLoadQueueHigh.length>0||o._tileLoadQueueMedium.length>0||o._tileLoadQueueLow.length>0||o._debug.tilesWaitingForChildren>0;r||a||e.viewer.clock.shouldAnimate||0!==e.scene.tweens.length||(e.verboseRendering&&console.log("stopping rendering @ "+g()),e.viewer.useDefaultRenderLoop=!1,e.stoppedRendering=!0),C.clone(n.camera.viewMatrix,e._lastCameraViewMatrix);var s=e.terria.selectedFeature;d(s)&&d(s.position)&&(e._selectionIndicator.position=s.position.getValue(e.terria.clock.currentTime)),e._selectionIndicator.update()}function o(e){var t=e.terria.selectedFeature;e._highlightFeature(t),d(t)&&d(t.position)?(e._selectionIndicator.position=t.position.getValue(e.terria.clock.currentTime),e._selectionIndicator.animateAppear()):e._selectionIndicator.animateDepart(),e._selectionIndicator.update()}var a=i(17),s=i(10),u=i(24),l=i(9),c=i(1),d=i(0),h=i(21),p=i(3),m=i(23),f=i(156),_=i(188),g=i(117),v=i(758),y=i(36),w=i(13),x=i(105),C=i(20),T=i(16),E=i(309),A=i(427),P=i(222),S=i(104),b=i(50),D=i(7),I=i(217),O=i(162),M=i(2267),F=i(224),N=i(445),L=i(14),R=i(22),V=i(448),U=i(133),z=function(e,t){N.call(this,e),this.viewer=t,this.scene=t.scene,this.stoppedRendering=!1,this.verboseRendering=!1,this.canShowSplitter=!0,this._lastClockTime=new y(0,0),this._lastCameraViewMatrix=new C,this._lastCameraMoveTime=0,this._selectionIndicator=new M(this),this._removePostRenderListener=this.scene.postRender.addEventListener(r.bind(void 0,this)),this._removeInfoBoxCloseListener=void 0,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this._pauseMapInteractionCount=0,this.scene.imagerySplitPosition=this.terria.splitPosition,t.screenSpaceEventHandler.setInputAction(function(e){this.pickFromScreenPosition(e.position)}.bind(this),P.LEFT_CLICK);var i=this.viewer.canvas;if(i.addEventListener("mousemove",this._boundNotifyRepaintRequired,!1),i.addEventListener("mousedown",this._boundNotifyRepaintRequired,!1),i.addEventListener("mouseup",this._boundNotifyRepaintRequired,!1),i.addEventListener("touchstart",this._boundNotifyRepaintRequired,!1),i.addEventListener("touchend",this._boundNotifyRepaintRequired,!1),i.addEventListener("touchmove",this._boundNotifyRepaintRequired,!1),d(window.PointerEvent)&&(i.addEventListener("pointerdown",this._boundNotifyRepaintRequired,!1),i.addEventListener("pointerup",this._boundNotifyRepaintRequired,!1),i.addEventListener("pointermove",this._boundNotifyRepaintRequired,!1)),this._wheelEvent=void 0,"onwheel"in i?this._wheelEvent="wheel":d(document.onmousewheel)?this._wheelEvent="mousewheel":this._wheelEvent="DOMMouseScroll",i.addEventListener(this._wheelEvent,this._boundNotifyRepaintRequired,!1),window.addEventListener("resize",this._boundNotifyRepaintRequired,!1),d(this.viewer.infoBox)&&(this._removeInfoBoxCloseListener=this.viewer.infoBox.viewModel.closeClicked.addEventListener(this._boundNotifyRepaintRequired)),d(this.viewer._clockViewModel)){var n=this.viewer._clockViewModel;this._shouldAnimateSubscription=w.getObservable(n,"shouldAnimate").subscribe(this._boundNotifyRepaintRequired),this._currentTimeSubscription=w.getObservable(n,"currentTime").subscribe(this._boundNotifyRepaintRequired)}d(this.viewer.timeline)&&this.viewer.timeline.addEventListener("settime",this._boundNotifyRepaintRequired,!1),this._selectedFeatureSubscription=w.getObservable(this.terria,"selectedFeature").subscribe(function(){o(this)},this),this._splitterPositionSubscription=w.getObservable(this.terria,"splitPosition").subscribe(function(){this.scene&&(this.scene.imagerySplitPosition=this.terria.splitPosition,this.notifyRepaintRequired())},this),this._showSplitterSubscription=w.getObservable(e,"showSplitter").subscribe(function(){this.updateAllItemsForSplitter()},this);var a=this;this._originalLoadWithXhr=x.load,x.load=function(e,t,i,n,r,o,s,u,l){o.promise.always(a._boundNotifyRepaintRequired),a._originalLoadWithXhr(e,t,i,n,r,o,s,u,l)},this._originalScheduleTask=S.prototype.scheduleTask,S.prototype.scheduleTask=function(e,t){var i=a._originalScheduleTask.call(this,e,t);if(!d(this._originalWorkerMessageSinkRepaint)){this._originalWorkerMessageSinkRepaint=this._worker.onmessage;var n=this;this._worker.onmessage=function(e){n._originalWorkerMessageSinkRepaint(e),a.isDestroyed()?(n._worker.onmessage=n._originalWorkerMessageSinkRepaint,n._originalWorkerMessageSinkRepaint=void 0):a.notifyRepaintRequired()}}return i},this.eventHelper=new I,this.eventHelper.add(this.scene.renderError,function(t,i){this.terria.error.raiseEvent(new R({sender:this,title:"Error rendering in 3D",message:"<p>An error occurred while rendering in 3D.  This probably indicates a bug in "+e.appName+" or an incompatibility with your system or web browser.  We'll now switch you to 2D so that you can continue your work.  We would appreciate it if you report this error by sending an email to <a href=\"mailto:"+e.supportEmail+'">'+e.supportEmail+"</a> with the technical details below.  Thank you!</p><pre>"+_(i)+"</pre>"})),this.terria.viewerMode=U.Leaflet},this),this.eventHelper.add(this.scene.globe.tileLoadProgressEvent,this.updateTilesLoadingCount.bind(this)),o(this)};L(N,z),z.prototype.destroy=function(){return d(this._selectionIndicator)&&(this._selectionIndicator.destroy(),this._selectionIndicator=void 0),d(this._removePostRenderListener)&&(this._removePostRenderListener(),this._removePostRenderListener=void 0),d(this._removeInfoBoxCloseListener)&&this._removeInfoBoxCloseListener(),d(this._shouldAnimateSubscription)&&(this._shouldAnimateSubscription.dispose(),this._shouldAnimateSubscription=void 0),d(this._currentTimeSubscription)&&(this._currentTimeSubscription.dispose(),this._currentTimeSubscription=void 0),d(this.viewer.timeline)&&this.viewer.timeline.removeEventListener("settime",this._boundNotifyRepaintRequired,!1),d(this._selectedFeatureSubscription)&&(this._selectedFeatureSubscription.dispose(),this._selectedFeatureSubscription=void 0),d(this._splitterPositionSubscription)&&(this._splitterPositionSubscription.dispose(),this._splitterPositionSubscription=void 0),d(this._showSplitterSubscription)&&(this._showSplitterSubscription.dispose(),this._showSplitterSubscription=void 0),this.viewer.canvas.removeEventListener("mousemove",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("mousedown",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("mouseup",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("touchstart",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("touchend",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("touchmove",this._boundNotifyRepaintRequired,!1),d(window.PointerEvent)&&(this.viewer.canvas.removeEventListener("pointerdown",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("pointerup",this._boundNotifyRepaintRequired,!1),this.viewer.canvas.removeEventListener("pointermove",this._boundNotifyRepaintRequired,!1)),this.viewer.canvas.removeEventListener(this._wheelEvent,this._boundNotifyRepaintRequired,!1),window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),x.load=this._originalLoadWithXhr,S.prototype.scheduleTask=this._originalScheduleTask,this.eventHelper.removeAll(),N.disposeCommonListeners(this),h(this)},z.prototype.isDestroyed=function(){return!1};var B=new s,H=new C,k=new s,G=new s,W=new s,Y=new s,j=new u,X=new u,Q=new u,q=new u;z.prototype.getCurrentExtent=function(){var e=this.scene,t=e.camera,i=e.canvas.clientWidth,n=e.canvas.clientHeight,r=new a(i/2,n/2),o=e.camera.getPickRay(r),u=e.globe.pick(o,e);if(!d(u))return this.terria.homeView.rectangle;var c=this.scene.globe.ellipsoid,h=.5*e.camera.frustum.fovy,p=Math.atan(Math.tan(h)*e.camera.frustum.aspectRatio),m=s.subtract(t.positionWC,u,B),f=s.magnitude(m),_=f*Math.tan(p),g=f*Math.tan(h),v=new s(-_,-g,0),y=new s(_,-g,0),w=new s(_,g,0),x=new s(-_,g,0),E=b.eastNorthUpToFixedFrame(u,c,H),A=C.multiplyByPoint(E,v,k),P=C.multiplyByPoint(E,y,G),S=C.multiplyByPoint(E,w,W),D=C.multiplyByPoint(E,x,Y),I=c.cartesianToCartographic(A,j),O=c.cartesianToCartographic(P,X),M=c.cartesianToCartographic(S,Q),F=c.cartesianToCartographic(D,q);O.longitude<I.longitude&&(O.longitude+=l.TWO_PI),M.longitude<F.longitude&&(M.longitude+=l.TWO_PI);var N=new T(l.convertLongitudeRange(Math.min(I.longitude,F.longitude)),Math.min(I.latitude,O.latitude),l.convertLongitudeRange(Math.max(M.longitude,O.longitude)),Math.max(M.latitude,F.latitude));return N.center=u,N},z.prototype.getContainer=function(){return this.viewer.container},z.prototype.zoomTo=function(e,t){if(!d(e))throw new p("viewOrExtent is required.");t=c(t,3);var i=this;return D().then(function(){if(e instanceof T){var n=i.scene.camera,r=n.getRectangleCameraCoordinates(e),o=m.WGS84.cartesianToCartographic(r),a=i.scene.globe.terrainProvider,s=[T.center(e)];return E(a,6,s).then(function(e){var i={longitude:o.longitude,latitude:o.latitude,height:o.height+e[0].height},r=m.WGS84.cartographicToCartesian(i);n.flyTo({duration:t,destination:r})})}d(e.position)?i.scene.camera.flyTo({duration:t,destination:e.position,orientation:{direction:e.direction,up:e.up}}):i.scene.camera.flyTo({duration:t,destination:e.rectangle})}).then(function(){i.notifyRepaintRequired()})},z.prototype.captureScreenshot=function(){var e=D.defer(),t=this.scene.postRender.addEventListener(function(){t();try{var i=this.scene.canvas,n=i;if(this.terria.showSplitter){n=document.createElement("canvas"),n.width=i.width,n.height=i.height;var r=n.getContext("2d");r.drawImage(i,0,0);var o=this.terria.splitPosition*i.width;r.strokeStyle=this.terria.baseMapContrastColor,r.beginPath(),r.moveTo(o,0),r.lineTo(o,i.height),r.stroke()}e.resolve(n.toDataURL("image/png"))}catch(t){e.reject(t)}},this);return this.scene.render(this.terria.clock.currentTime),e.promise},z.prototype.notifyRepaintRequired=function(){this.verboseRendering&&!this.viewer.useDefaultRenderLoop&&console.log("starting rendering @ "+g()),this._lastCameraMoveTime=g(),this.viewer.useDefaultRenderLoop=!0},z.prototype.computePositionOnScreen=function(e,t){return A.wgs84ToWindowCoordinates(this.scene,e,t)},z.prototype.addAttribution=function(e){e&&this.scene.frameState.creditDisplay.addDefaultCredit(e)},z.prototype.removeAttribution=function(e){e&&this.scene.frameState.creditDisplay.removeDefaultCredit(e)},z.prototype.getAllAttribution=function(){return this.scene.frameState.creditDisplay._currentFrameCredits.screenCredits.values.concat(this.scene.frameState.creditDisplay._currentFrameCredits.lightboxCredits.values).map(function(e){return e.html})},z.prototype.updateLayerOrderToKeepOnTop=function(){for(var e=this.terria.nowViewing.items,t=this.scene,i=e.length-1;i>=0;i--)e[i].imageryLayer&&e[i].keepOnTop&&t.imageryLayers.raiseToTop(e[i].imageryLayer)},z.prototype.updateLayerOrderAfterReorder=function(){},z.prototype.raise=function(e){var t=this.terria.nowViewing.items,i=t[e],r=t[e-1];if(d(r.items)||d(r.imageryLayer)){var o,a,s,u=n(r);if(d(i.items))for(o=i.items.length-1;o>=0;--o)if(s=i.items[o],d(s.imageryLayer))for(a=0;a<u;++a)this.scene.imageryLayers.raise(s.imageryLayer);if(d(i.imageryLayer))for(a=0;a<u;++a)this.scene.imageryLayers.raise(i.imageryLayer)}},z.prototype.lower=function(e){var t=this.terria.nowViewing.items,i=t[e],r=t[e+1];if(d(r.items)||d(r.imageryLayer)){var o,a,s,u=n(r);if(d(i.items))for(o=0;o<i.items.length;++o)if(s=i.items[o],d(s.imageryLayer))for(a=0;a<u;++a)this.scene.imageryLayers.lower(s.imageryLayer);if(d(i.imageryLayer))for(a=0;a<u;++a)this.scene.imageryLayers.lower(i.imageryLayer)}},z.prototype.lowerToBottom=function(e){if(d(e.items))for(var t=e.items.length-1;t>=0;--t){var i=e.items[t];this.lowerToBottom(i)}d(e._imageryLayer)&&this.terria.cesium.scene.imageryLayers.lowerToBottom(e._imageryLayer)},z.prototype.adjustDisclaimer=function(){},z.prototype.pickFromLocation=function(e,t,i){for(var n=this.scene.globe.ellipsoid.cartographicToCartesian(u.fromDegrees(e.lng,e.lat,e.height)),r=m.WGS84.cartesianToCartographic(n),o=[],a=[],s=this.scene.imageryLayers.length-1;s>=0;s--){var l=this.scene.imageryLayers.get(s),c=l._imageryProvider;if(c.url&&t[c.url]){var h=t[c.url];o.push(c.pickFeatures(h.x,h.y,h.level,r.longitude,r.latitude)),a.push(l)}}var p=this._buildPickedFeatures(t,n,i,o,a,r.height),f=this.terria.mapInteractionModeStack;d(f)&&f.length>0?f[f.length-1].pickedFeatures=p:this.terria.pickedFeatures=p},z.prototype.pickFromScreenPosition=function(e){var t=this.scene.camera.getPickRay(e),i=this.scene.globe.pick(t,this.scene),n=m.WGS84.cartesianToCartographic(i),r=this.pickVectorFeatures(e),o=this._attachProviderCoordHooks(),a=this.scene.imageryLayers.pickImageryLayerFeatures(t,this.scene),s=this._buildPickedFeatures(o,i,r,[a],void 0,n.height),u=this.terria.mapInteractionModeStack;d(u)&&u.length>0?u[u.length-1].pickedFeatures=s:this.terria.pickedFeatures=s},z.prototype.pickVectorFeatures=function(e){for(var t=[],i=this.scene.drillPick(e),n=0;n<i.length;++n){var r=i[n].id;if(!(r&&r.entityCollection&&r.entityCollection.owner&&r.entityCollection.owner.name===N._featureHighlightName)&&(!d(r)&&d(i[n].primitive)&&(r=i[n].primitive.id),r instanceof f&&-1===t.indexOf(r))){var o=F.fromEntityCollectionOrEntity(r);t.push(o)}}return t},z.prototype._attachProviderCoordHooks=function(){for(var e={},t=function(t,i,n,r,o,a,s){var u=i.call(t,n,r,o,a,s);return t.url&&(e[t.url]={x:n,y:r,level:o}),t.pickFeatures=i,u},i=0;i<this.scene.imageryLayers.length;i++){var n=this.scene.imageryLayers.get(i).imageryProvider;n.pickFeatures=t.bind(void 0,n,n.pickFeatures)}return e},z.prototype._buildPickedFeatures=function(e,t,i,n,r,o){var a=new V;return a.providerCoords=e,a.pickPosition=t,a.allFeaturesAvailablePromise=D.all(n).then(function(e){a.isLoading=!1,a.features=e.reduce(function(e,i,n){return d(i)?e.concat(i.map(function(e){return d(r)&&(e.imageryLayer=r[n]),d(e.position)||(e.position=m.WGS84.cartesianToCartographic(t)),d(e.position.height)&&0!==e.position.height||(e.position.height=o),this._createFeatureFromImageryLayerFeature(e)}.bind(this))):e}.bind(this),c(i,[]))}.bind(this)).otherwise(function(){a.isLoading=!1,a.error="An unknown error occurred while picking features."}),a},z.prototype.addImageryProvider=function(e){var t=this.scene,i=e.imageryProvider.errorEvent;d(i)&&i.addEventListener(e.onLoadError);var n=new v(e.imageryProvider,{show:!1,alpha:e.opacity,rectangle:e.clipToRectangle?e.rectangle:void 0,isRequired:e.isRequiredForRendering});return t.imageryLayers.add(n,e.layerIndex),this.updateLayerOrderToKeepOnTop(),n},z.prototype.removeImageryLayer=function(e){this.scene.imageryLayers.remove(e.layer)},z.prototype.showImageryLayer=function(e){e.layer.show=!0},z.prototype.hideImageryLayer=function(e){e.layer.show=!1},z.prototype.isImageryLayerShown=function(e){return e.layer.show},z.prototype.updateItemForSplitter=function(e){if(d(e.splitDirection)&&d(e.imageryLayer)){e.terria.showSplitter?e.imageryLayer.splitDirection=e.splitDirection:e.imageryLayer.splitDirection=O.NONE,e._nextLayer&&(e._nextLayer.splitDirection=e.imageryLayer.splitDirection),this.notifyRepaintRequired()}},z.prototype.pauseMapInteraction=function(){1===++this._pauseMapInteractionCount&&(this.scene.screenSpaceCameraController.enableInputs=!1)},z.prototype.resumeMapInteraction=function(){var e=this;0===--this._pauseMapInteractionCount&&setTimeout(function(){0===e._pauseMapInteractionCount&&(e.scene.screenSpaceCameraController.enableInputs=!0)},0)},e.exports=z}});
//# sourceMappingURL=1.TerriaMap.js.map